/*! dmn-js - dmn-modeler v14.1.1 | Copyright (c) 2014-present, camunda Services GmbH | bpmn.io/license */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).DmnJS=t()}(this,function(){"use strict";function r(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){V(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Fe(e){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,G(i.key),i)}}function u(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function V(e,t,n){return(t=G(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e,t){return($=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function z(e,t){if(null==e)return{};var n,i=function(e,t){if(null==e)return{};for(var n,i={},r=Object.keys(e),o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);return i}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(n),t=(e=i?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return d(t)}}function F(){return(F="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(i)return(i=Object.getOwnPropertyDescriptor(i,t)).get?i.get.call(arguments.length<3?e:n):i.value}).apply(this,arguments)}function U(e,t){return t=t||e.slice(0),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=o.call(n)).done)&&(s.push(i.value),s.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return s}}(e,t)||W(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e){return function(e){if(Array.isArray(e))return q(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||W(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){var n;if(e)return"string"==typeof e?q(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(e,t):void 0}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function G(e){e=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);if("object"!=typeof(n=n.call(e,t||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==typeof e?e:String(e)}function K(e){return Array.prototype.concat.apply([],e)}var X=Object.prototype.toString,Y=Object.prototype.hasOwnProperty;function Z(e){return void 0===e}function Q(e){return void 0!==e}function J(e){return null==e}function m(e){return"[object Array]"===X.call(e)}function ee(e){return"[object Object]"===X.call(e)}function g(e){return"[object Number]"===X.call(e)}function te(e){e=X.call(e);return"[object Function]"===e||"[object AsyncFunction]"===e||"[object GeneratorFunction]"===e||"[object AsyncGeneratorFunction]"===e||"[object Proxy]"===e}function ne(e){return"[object String]"===X.call(e)}function ie(e,n){var t,i;return n=te(t=n)?t:function(e){return e===t},y(e,function(e,t){if(n(e,t))return i=e,!1}),i}function re(e,n){var i=[];return y(e,function(e,t){n(e,t)&&i.push(e)}),i}function y(e,t){if(!Z(e)){var n,i,r=m(e)?ge:me;for(n in e)if(i=n,Y.call(e,i)&&!1===t(e[n],r(n)))return}}function oe(e,n,i){return y(e,function(e,t){i=n(i,e,t)}),i}function ae(e,i){return!!oe(e,function(e,t,n){return e&&i(t,n)},!0)}function se(e,t){return!!ie(e,t)}function ce(e,n){var i=[];return y(e,function(e,t){i.push(n(e,t))}),i}function ue(e){return e&&Object.keys(e)||[]}function le(e){return ce(e,function(e){return e})}function de(e,n,t){var i=2<arguments.length&&void 0!==t?t:{};return n=fe(n),y(e,function(e){var t=n(e)||"_";(i[t]||(i[t]=[])).push(e)}),i}function pe(e,o){o=fe(o);var a=[];return y(e,function(e,t){for(var n=o(e,t),i={d:n,v:e},r=0;r<a.length;r++)if(n<a[r].d)return void a.splice(r,0,i);a.push(i)}),ce(a,function(e){return e.v})}function he(e){return function(n){return ae(e,function(e,t){return n[t]===e})}}function fe(t){return te(t)?t:function(e){return e[t]}}function me(e){return e}function ge(e){return Number(e)}function ve(n,i){var r,o,a,s;function t(e){var t=Date.now(),e=e?0:s+i-t;if(0<e)return c(e);n.apply(a,o),u()}function c(e){r=setTimeout(t,e)}function u(){r&&clearTimeout(r),r=s=o=a=void 0}function e(){s=Date.now();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];o=t,a=this,r||c(i)}return e.flush=function(){r&&t(!0),u()},e.cancel=u,e}function ye(e,t){return e.bind(t)}function C(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Object.assign.apply(Object,[e].concat(n))}function _e(t,e){var n={},i=Object(t);return y(e,function(e){e in i&&(n[e]=t[e])}),n}function be(e,n){var i={};return y(Object(e),function(e,t){-1===n.indexOf(t)&&(i[t]=e)}),i}var xe="__fn",we=Array.prototype.slice;function Ce(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}function Ee(){}Ce.prototype.on=function(e,t,n,i){if(e=m(e)?e:[e],te(t)&&(i=n,n=t,t=1e3),!g(t))throw new Error("priority must be a number");var r=n,o=(i&&((r=ye(n,i))[xe]=n[xe]||n),this);e.forEach(function(e){o._addListener(e,{priority:t,callback:r,next:null})})},Ce.prototype.once=function(t,e,n,i){var r=this;if(te(e)&&(i=n,n=e,e=1e3),!g(e))throw new Error("priority must be a number");function o(){o.__isTomb=!0;var e=n.apply(i,arguments);return r.off(t,o),e}o[xe]=n,this.on(t,e,o)},Ce.prototype.off=function(e,t){e=m(e)?e:[e];var n=this;e.forEach(function(e){n._removeListener(e,t)})},Ce.prototype.createEvent=function(e){var t=new Ee;return t.init(e),t},Ce.prototype.fire=function(e,t){var n,i,r=we.call(arguments);if(!(e="object"===Fe(e)?(t=e).type:e))throw new Error("no event type specified");if(n=this._listeners[e]){var t=t instanceof Ee?t:this.createEvent(t),o=(r[0]=t).type;e!==o&&(t.type=e);try{i=this._invokeListeners(t,r,n)}finally{e!==o&&(t.type=o)}return i=void 0===i&&t.defaultPrevented?!1:i}},Ce.prototype.handleError=function(e){return!1===this.fire("error",{error:e})},Ce.prototype._destroy=function(){this._listeners={}},Ce.prototype._invokeListeners=function(e,t,n){for(var i;n&&!e.cancelBubble;)i=this._invokeListener(e,t,n),n=n.next;return i},Ce.prototype._invokeListener=function(e,t,n){var i,r,o;if(!n.callback.__isTomb)try{r=n.callback,o=t,void 0!==(i=r.apply(null,o))&&(e.returnValue=i,e.stopPropagation()),!1===i&&e.preventDefault()}catch(e){if(!this.handleError(e))throw console.error("unhandled error in event listener",e),e}return i},Ce.prototype._addListener=function(e,t){var n,i=this._getListeners(e);if(i){for(;i;){if(i.priority<t.priority)return t.next=i,void(n?n.next=t:this._setListeners(e,t));i=(n=i).next}n.next=t}else this._setListeners(e,t)},Ce.prototype._getListeners=function(e){return this._listeners[e]},Ce.prototype._setListeners=function(e,t){this._listeners[e]=t},Ce.prototype._removeListener=function(e,t){var n,i,r,o=this._getListeners(e);if(t)for(;o;)n=o.next,(r=o.callback)!==t&&r[xe]!==t||(i?i.next=n:this._setListeners(e,n)),i=o,o=n;else this._setListeners(e,null)},Ee.prototype.stopPropagation=function(){this.cancelBubble=!0},Ee.prototype.preventDefault=function(){this.defaultPrevented=!0},Ee.prototype.init=function(e){C(this,e||{})};var ke=Object.prototype.toString;function Se(){return(Se=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,i=arguments[t];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function je(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Se.apply(void 0,[e].concat(n))}var Oe=Object.prototype.toString,Pe=Object.prototype.hasOwnProperty;function De(e){return"[object String]"===Oe.call(e)}function Re(e,t){if(void 0!==e){var n,i,r="[object Array]"===Oe.call(e)?Me:Te;for(n in e)if(i=n,Pe.call(e,i)&&!1===t(e[n],r(n)))return}}function Te(e){return e}function Me(e){return Number(e)}function Ie(e,t){return e.bind(t)}function Ae(){return(Ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,i=arguments[t];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function Ne(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Ae.apply(void 0,[e].concat(n))}function Be(){}function Le(e,t){this.model=e,this.properties=t}Be.prototype.get=function(e){return this.$model.properties.get(this,e)},Be.prototype.set=function(e,t){this.$model.properties.set(this,e,t)},Le.prototype.createType=function(e){var t=this.model,n=this.properties,i=Object.create(Be.prototype),r=(Re(e.properties,function(e){e.isMany||void 0===e.default||(i[e.name]=e.default)}),n.defineModel(i,t),n.defineDescriptor(i,e),e.ns.name);function o(e){n.define(this,"$type",{value:r,enumerable:!0}),n.define(this,"$attrs",{value:{}}),n.define(this,"$parent",{writable:!0}),Re(e,Ie(function(e,t){this.set(t,e)},this))}return o.prototype=i,o.hasType=i.$instanceOf=this.model.hasType,n.defineModel(o,t),n.defineDescriptor(o,e),o};var Ve={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},$e={String:function(e){return e},Boolean:function(e){return"true"===e},Integer:function(e){return parseInt(e,10)},Real:function(e){return parseFloat(e)}};function ze(e,t){e=$e[e];return e?e(t):t}function Ue(e){return Ve[e]}function He(e){return $e[e]}function We(e,t){var n,i,r=e.split(/:/);if(1===r.length)n=e,i=t;else{if(2!==r.length)throw new Error("expected <prefix:localName> or <localName>, got "+e);n=r[1],i=r[0]}return{name:e=(i?i+":":"")+n,prefix:i,localName:n}}function qe(e){this.ns=e,this.name=e.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}function Ge(e,t){this.packageMap={},this.typeMap={},this.packages=[],this.properties=t,Re(e,Ie(this.registerPackage,this))}function Ke(e,t,n){t=t[n];if(t in e)throw new Error("package with "+n+" <"+t+"> already defined")}function Xe(e){this.model=e}function Ye(e,t,n){Object.defineProperty(e,t.name,{enumerable:!t.isReference,writable:!0,value:n,configurable:!0})}function Ze(e){this.properties=new Xe(this),this.factory=new Le(this,this.properties),this.registry=new Ge(e,this.properties),this.typeCache={}}qe.prototype.build=function(){return t=this,e=["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"],n={},i=Object(t),Re(e,function(e){e in i&&(n[e]=t[e])}),n;var t,e,n,i},qe.prototype.addProperty=function(e,t,n){"boolean"==typeof t&&(n=t,t=void 0),this.addNamedProperty(e,!1!==n);n=this.properties;void 0!==t?n.splice(t,0,e):n.push(e)},qe.prototype.replaceProperty=function(e,t,n){var i=e.ns,r=this.properties,o=this.propertiesByName,a=e.name!==t.name;if(e.isId){if(!t.isId)throw new Error("property <"+t.ns.name+"> must be id property to refine <"+e.ns.name+">");this.setIdProperty(t,!1)}if(e.isBody){if(!t.isBody)throw new Error("property <"+t.ns.name+"> must be body property to refine <"+e.ns.name+">");this.setBodyProperty(t,!1)}e=r.indexOf(e);if(-1===e)throw new Error("property <"+i.name+"> not found in property list");r.splice(e,1),this.addProperty(t,n?void 0:e,a),o[i.name]=o[i.localName]=t},qe.prototype.redefineProperty=function(e,t,n){var i=e.ns.prefix,t=t.split("#"),i=We(t[0],i),t=We(t[1],i.prefix).name,i=this.propertiesByName[t];if(!i)throw new Error("refined property <"+t+"> not found");this.replaceProperty(i,e,n),delete e.redefines},qe.prototype.addNamedProperty=function(e,t){var n=e.ns,i=this.propertiesByName;t&&(this.assertNotDefined(e,n.name),this.assertNotDefined(e,n.localName)),i[n.name]=i[n.localName]=e},qe.prototype.removeNamedProperty=function(e){var e=e.ns,t=this.propertiesByName;delete t[e.name],delete t[e.localName]},qe.prototype.setBodyProperty=function(e,t){if(t&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+e.ns.name+">)");this.bodyProperty=e},qe.prototype.setIdProperty=function(e,t){if(t&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+e.ns.name+">)");this.idProperty=e},qe.prototype.assertNotDefined=function(e,t){var n=e.name,i=this.propertiesByName[n];if(i)throw new Error("property <"+n+"> already defined; override of <"+i.definedBy.ns.name+"#"+i.ns.name+"> by <"+e.definedBy.ns.name+"#"+e.ns.name+"> not allowed without redefines")},qe.prototype.hasProperty=function(e){return this.propertiesByName[e]},qe.prototype.addTrait=function(i,r){var e=this.allTypesByName,t=this.allTypes,n=i.name;n in e||(Re(i.properties,Ie(function(e){e=Ne({},e,{name:e.ns.localName,inherited:r}),Object.defineProperty(e,"definedBy",{value:i});var t=e.replaces,n=e.redefines;t||n?this.redefineProperty(e,t||n,t):(e.isBody&&this.setBodyProperty(e),e.isId&&this.setIdProperty(e),this.addProperty(e))},this)),t.push(i),e[n]=i)},Ge.prototype.getPackage=function(e){return this.packageMap[e]},Ge.prototype.getPackages=function(){return this.packages},Ge.prototype.registerPackage=function(t){t=Ne({},t);var e=this.packageMap;Ke(e,t,"prefix"),Ke(e,t,"uri"),Re(t.types,Ie(function(e){this.registerType(e,t)},this)),e[t.uri]=e[t.prefix]=t,this.packages.push(t)},Ge.prototype.registerType=function(e,t){var i=We((e=Ne({},e,{superClass:(e.superClass||[]).slice(),extends:(e.extends||[]).slice(),properties:(e.properties||[]).slice(),meta:Ne(e.meta||{})})).name,t.prefix),n=i.name,r={};Re(e.properties,Ie(function(e){var t=We(e.name,i.prefix),n=t.name;Ue(e.type)||(e.type=We(e.type,t.prefix).name),Ne(e,{ns:t,name:n}),r[n]=e},this)),Ne(e,{ns:i,name:n,propertiesByName:r}),Re(e.extends,Ie(function(e){e=this.typeMap[e];e.traits=e.traits||[],e.traits.push(n)},this)),this.definePackage(e,t),this.typeMap[n]=e},Ge.prototype.mapTypes=function(n,i,e){var t=Ue(n.name)?{name:n.name}:this.typeMap[n.name],r=this;function o(e){return a(e,!0)}function a(e,t){e=We(e,Ve[e]?"":n.prefix);r.mapTypes(e,i,t)}if(!t)throw new Error("unknown type <"+n.name+">");Re(t.superClass,e?o:a),i(t,!e),Re(t.traits,o)},Ge.prototype.getEffectiveDescriptor=function(e){var e=We(e),n=new qe(e),e=(this.mapTypes(e,function(e,t){n.addTrait(e,t)}),n.build());return this.definePackage(e,e.allTypes[e.allTypes.length-1].$pkg),e},Ge.prototype.definePackage=function(e,t){this.properties.define(e,"$pkg",{value:t})},Xe.prototype.set=function(e,t,n){if(!De(t)||!t.length)throw new TypeError("property name must be a non-empty string");var i=this.model.getPropertyDescriptor(e,t),r=i&&i.name;void 0===n?i?delete e[r]:delete e.$attrs[t]:i?r in e?e[r]=n:Ye(e,i,n):e.$attrs[t]=n},Xe.prototype.get=function(e,t){var n,i=this.model.getPropertyDescriptor(e,t);return i?(!e[n=i.name]&&i.isMany&&Ye(e,i,[]),e[n]):e.$attrs[t]},Xe.prototype.define=function(e,t,n){var i;n.writable||(i=n.value,delete(n=Ne({},n,{get:function(){return i}})).value),Object.defineProperty(e,t,n)},Xe.prototype.defineDescriptor=function(e,t){this.define(e,"$descriptor",{value:t})},Xe.prototype.defineModel=function(e,t){this.define(e,"$model",{value:t})},Ze.prototype.create=function(e,t){var n=this.getType(e);if(n)return new n(t);throw new Error("unknown type <"+e+">")},Ze.prototype.getType=function(e){var t=this.typeCache,n=De(e)?e:e.ns.name,i=t[n];return i||(e=this.registry.getEffectiveDescriptor(n),i=t[n]=this.factory.createType(e)),i},Ze.prototype.createAny=function(e,t,n){var i=We(e),r={$type:e,$instanceOf:function(e){return e===this.$type}},e={name:e,isGeneric:!0,ns:{prefix:i.prefix,localName:i.localName,uri:t}};return this.properties.defineDescriptor(r,e),this.properties.defineModel(r,this),this.properties.define(r,"$parent",{enumerable:!1,writable:!0}),this.properties.define(r,"$instanceOf",{enumerable:!1,writable:!0}),Re(n,function(e,t){"[object Object]"===Oe.call(e)&&void 0!==e.value?r[e.name]=e.value:r[t]=e}),r},Ze.prototype.getPackage=function(e){return this.registry.getPackage(e)},Ze.prototype.getPackages=function(){return this.registry.getPackages()},Ze.prototype.getElementDescriptor=function(e){return e.$descriptor},Ze.prototype.hasType=function(e,t){return void 0===t&&(t=e,e=this),t in e.$model.getElementDescriptor(e).allTypesByName},Ze.prototype.getPropertyDescriptor=function(e,t){return this.getElementDescriptor(e).propertiesByName[t]},Ze.prototype.getTypeDescriptor=function(e){return this.registry.typeMap[e]};var Qe=Object.prototype.toString,Je=Object.prototype.hasOwnProperty;function et(e){return"[object Array]"===Qe.call(e)}function tt(e){return"[object String]"===Qe.call(e)}function nt(e,t){return Je.call(e,t)}function it(e,n){var i;return n=at(n),ot(e,function(e,t){if(n(e,t))return i=e,!1}),i}function rt(e,n){var i=[];return ot(e,function(e,t){n(e,t)&&i.push(e)}),i}function ot(e,t){if(void 0!==e){var n,i=et(e)?ct:st;for(n in e)if(nt(e,n)&&!1===t(e[n],i(n)))return}}function at(t){return e=t,"[object Function]"===(e=Qe.call(e))||"[object AsyncFunction]"===e||"[object GeneratorFunction]"===e||"[object AsyncGeneratorFunction]"===e||"[object Proxy]"===e?t:function(e){return e===t};var e}function st(e){return e}function ct(e){return Number(e)}function ut(){return(ut=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,i=arguments[t];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function lt(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return ut.apply(void 0,[e].concat(n))}var dt=String.fromCharCode,pt=Object.prototype.hasOwnProperty,ht=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/gi,ft={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'};function mt(e,t,n,i){return i?pt.call(ft,i)?ft[i]:"&"+i+";":dt(t||parseInt(n,16))}function gt(e){return 3<e.length&&-1!==e.indexOf("&")?e.replace(ht,mt):e}Object.keys(ft).forEach(function(e){ft[e.toUpperCase()]=ft[e]});var vt="xsi:type",yt="non-whitespace outside of root node";function _t(e){return new Error(e)}function bt(e){return"missing namespace for prefix <"+e+">"}function xt(e){return{get:e,enumerable:!0}}function wt(e){return e+"$uri"}function Ct(){return{line:0,column:0}}function Et(e){throw e}function kt(e){if(!this)return new kt(e);var C,E,k,S,n,j,O,P,D,R=e&&e.proxy,i=Et,T=Ct,M=!1,I=!1,t=null,A=!1;function N(e){e instanceof Error||(e=_t(e)),i(t=e,T)}function B(e){n&&(e instanceof Error||(e=_t(e)),n(e,T))}this.on=function(e,t){if("function"!=typeof t)throw _t("required args <name, cb>");switch(e){case"openTag":E=t;break;case"text":C=t;break;case"closeTag":k=t;break;case"error":i=t;break;case"warn":n=t;break;case"cdata":S=t;break;case"attention":P=t;break;case"question":O=t;break;case"comment":j=t;break;default:throw _t("unsupported event: "+e)}return this},this.ns=function(e){if("object"!==Fe(e=void 0===e?{}:e))throw _t("required args <nsMap={}>");var t,n={};for(t in e)n[t]=e[t];return n["http://www.w3.org/2001/XMLSchema-instance"]="xsi",I=!0,D=n,this},this.parse=function(e){if("string"!=typeof e)throw _t("required args <xml=string>");return t=null,function(a){var e,t,n,i,r,o,s,c,u,l,y,d=I?[]:null,_=I?function(e){var t,n,i={};for(t in e)i[n=e[t]]=n,i[wt(n)]=t;return i}(D):null,p=[],b=0,h=!1,f=!1,m=0,g=0,x="",w=0;function v(){if(null!==y)return y;var e,t,n,i,r,o,a,s,c,u,l,d=I&&_.xmlns,p=I&&M?[]:null,h=w,f=x,m=f.length,g={},v={};e:for(;h<m;h++)if(c=!1,!(32===(u=f.charCodeAt(h))||u<14&&8<u)){for((u<65||122<u||90<u&&u<97)&&95!==u&&58!==u&&(B("illegal first char attribute name"),c=!0),l=h+1;l<m;l++)if(!(96<(u=f.charCodeAt(l))&&u<123||64<u&&u<91||47<u&&u<59||46===u||45===u||95===u)){if(32===u||u<14&&8<u){B("missing attribute value"),h=l;continue e}if(61===u)break;B("illegal attribute name char"),c=!0}if("xmlns:xmlns"===(s=f.substring(h,l))&&(B("illegal declaration of xmlns"),c=!0),34===(u=f.charCodeAt(l+1)))-1===(l=f.indexOf('"',h=l+2))&&-1!==(l=f.indexOf("'",h))&&(B("attribute value quote missmatch"),c=!0);else if(39===u)-1===(l=f.indexOf("'",h=l+2))&&-1!==(l=f.indexOf('"',h))&&(B("attribute value quote missmatch"),c=!0);else for(B("missing attribute value quotes"),c=!0,l+=1;l<m&&!(32===(u=f.charCodeAt(l+1))||u<14&&8<u);l++);for(-1===l&&(B("missing closing quotes"),l=m,c=!0),c||(o=f.substring(h,l)),h=l;l+1<m&&!(32===(u=f.charCodeAt(l+1))||u<14&&8<u);l++)h===l&&(B("illegal character after attribute end"),c=!0);if(h=l+1,!c)if(s in v)B("attribute <"+s+"> already defined");else if(v[s]=!0,I)if(M)if(null!==(r="xmlns"===s?"xmlns":120===s.charCodeAt(0)&&"xmlns:"===s.substr(0,6)?s.substr(6):null)){if(e=gt(o),t=wt(r),!(a=D[e])){if("xmlns"===r||t in _&&_[t]!==e)for(;a="ns"+b++,void 0!==_[a];);else a=r;D[e]=a}_[r]!==a&&(i||(_=function(e){var t,n={};for(t in e)n[t]=e[t];return n}(_),i=!0),_[r]=a,"xmlns"===r&&(_[wt(a)]=e,d=a),_[t]=e),g[s]=o}else p.push(s,o);else-1===(u=s.indexOf(":"))?g[s]=o:(n=_[s.substring(0,u)])?((s=d===n?s.substr(u+1):n+s.substr(u))===vt&&(o=-1!==(u=o.indexOf(":"))?(n=o.substring(0,u),(n=_[n]||n)+o.substring(u)):d+":"+o),g[s]=o):B(bt(s.substring(0,u)));else g[s]=o}if(M)for(h=0,m=p.length;h<m;h++){if(s=p[h++],o=p[h],-1!==(u=s.indexOf(":"))){if(!(n=_[s.substring(0,u)])){B(bt(s.substring(0,u)));continue}(s=d===n?s.substr(u+1):n+s.substr(u))===vt&&(o=-1!==(u=o.indexOf(":"))?(n=o.substring(0,u),(n=_[n]||n)+o.substring(u)):d+":"+o)}g[s]=o}return y=g}T=function(){for(var e,t=/(\r\n|\r|\n)/g,n=0,i=0,r=0,o=g;r<=m&&(e=t.exec(a))&&(o=e[0].length+e.index,!(m<o));)n+=1,r=o;return{data:-1==m?(i=o,a.substring(g)):0===g?a.substring(g,m):(i=m-r,-1==g?a.substring(m):a.substring(m,g+1)),line:n,column:i}},R&&(l=Object.create({},{name:xt(function(){return c}),originalName:xt(function(){return u}),attrs:xt(v),ns:xt(function(){return _})}));for(;-1!==g;){if(-1===(m=60===a.charCodeAt(g)?g:a.indexOf("<",g)))return p.length?N("unexpected end of file"):0===g?N("missing start tag"):g<a.length&&a.substring(g).trim()&&B(yt);if(g!==m)if(p.length){if(C&&(C(a.substring(g,m),gt,T),A))return}else if(a.substring(g,m).trim()&&(B(yt),A))return;if(33===(r=a.charCodeAt(m+1))){if(91===(i=a.charCodeAt(m+2))&&"CDATA["===a.substr(m+3,6)){if(-1===(g=a.indexOf("]]>",m)))return N("unclosed cdata");if(S&&(S(a.substring(m+9,g),T),A))return;g+=3;continue}if(45===i&&45===a.charCodeAt(m+3)){if(-1===(g=a.indexOf("--\x3e",m)))return N("unclosed comment");if(j&&(j(a.substring(m+4,g),gt,T),A))return;g+=3;continue}}if(63===r){if(-1===(g=a.indexOf("?>",m)))return N("unclosed question");if(O&&(O(a.substring(m,g+2),T),A))return;g+=2}else{for(t=m+1;;t++){if(o=a.charCodeAt(t),isNaN(o))return g=-1,N("unclosed tag");if(34===o)i=a.indexOf('"',t+1),t=-1!==i?i:t;else if(39===o)i=a.indexOf("'",t+1),t=-1!==i?i:t;else if(62===o){g=t;break}}if(33===r){if(P&&(P(a.substring(m,g+1),gt,T),A))return}else{if(y={},47===r){if(f=!(h=!1),!p.length)return N("missing open tag");if(t=c=p.pop(),i=m+2+t.length,a.substring(m+2,i)!==t)return N("closing tag mismatch");for(;i<g;i++)if(!(32===(r=a.charCodeAt(i))||8<r&&r<14))return N("close tag")}else{if(f=47===a.charCodeAt(g-1)?(t=c=a.substring(m+1,g-1),h=!0):(t=c=a.substring(m+1,g),!(h=!0)),!(96<r&&r<123||64<r&&r<91||95===r||58===r))return N("illegal first char nodeName");for(i=1,n=t.length;i<n;i++)if(!(96<(r=t.charCodeAt(i))&&r<123||64<r&&r<91||47<r&&r<59||45===r||95===r||46==r)){if(32===r||r<14&&8<r){c=t.substring(0,i),y=null;break}return N("invalid nodeName")}f||p.push(c)}if(I){if(e=_,h&&(f||d.push(e),null===y)&&(M=-1!==t.indexOf("xmlns",i))&&(w=i,x=t,v(),M=!1),-1!==(r=(u=c).indexOf(":"))){if(!(s=_[c.substring(0,r)]))return N("missing namespace on <"+u+">");c=c.substr(r+1)}else s=_.xmlns;s&&(c=s+":"+c)}if(h&&(w=i,x=t,E)&&(R?E(l,gt,f,T):E(c,v,gt,f,T),A))return;if(f){if(k&&(k(R?l:c,gt,h,T),A))return;I&&(_=h?e:d.pop())}}g+=1}}}(e),T=Ct,A=!1,t},this.stop=function(){A=!0}}function St(e){return e.xml&&"lowerCase"===e.xml.tagAlias}var jt={xsi:"http://www.w3.org/2001/XMLSchema-instance",xml:"http://www.w3.org/XML/1998/namespace"},Ot="xsi:type";function Pt(e){return e.xml&&e.xml.serialize}function Dt(e){return Pt(e)===Ot}function Rt(e,t){return St(t)?e.prefix+":"+((t=e.localName).charAt(0).toUpperCase()+t.slice(1)):e.name}function Tt(e){return new Error(e)}function Mt(e){return e.$descriptor}function It(e){lt(this,e),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(e){this.references.push(e)},this.addElement=function(e){if(!e)throw Tt("expected element");var t=this.elementsById,n=Mt(e).idProperty;if(n&&(n=e.get(n.name))){if(!/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i.test(n))throw new Error("illegal ID <"+n+">");if(t[n])throw Tt("duplicate ID <"+n+">");t[n]=e}},this.addWarning=function(e){this.warnings.push(e)}}function At(){}function Nt(){}function Bt(){}function Lt(e,t){this.property=e,this.context=t}function Vt(e,t){this.element=t,this.propertyDesc=e}function $t(){}function zt(e,t,n){this.model=e,this.type=e.getType(t),this.context=n}function Ft(e,t,n){zt.call(this,e,t,n)}function Ut(e,t,n){this.model=e,this.context=n}function Ht(e){lt(this,{lax:!1},e=e instanceof Ze?{model:e}:e)}At.prototype.handleEnd=function(){},At.prototype.handleText=function(){},At.prototype.handleNode=function(){},(Nt.prototype=Object.create(At.prototype)).handleNode=function(){return this},(Bt.prototype=Object.create(At.prototype)).handleText=function(e){this.body=(this.body||"")+e},(Lt.prototype=Object.create(Bt.prototype)).handleNode=function(e){if(this.element)throw Tt("expected no sub nodes");return this.element=this.createReference(e),this},Lt.prototype.handleEnd=function(){this.element.id=this.body},Lt.prototype.createReference=function(e){return{property:this.property.ns.name,id:""}},(Vt.prototype=Object.create(Bt.prototype)).handleEnd=function(){var e=this.body||"",t=this.element,n=this.propertyDesc,e=ze(n.type,e);n.isMany?t.get(n.name).push(e):t.set(n.name,e)},($t.prototype=Object.create(Bt.prototype)).handleNode=function(e){var t=this;return this.element?t=this.handleChild(e):(e=this.element=this.createElement(e),this.context.addElement(e)),t},(zt.prototype=Object.create($t.prototype)).addReference=function(e){this.context.addReference(e)},zt.prototype.handleText=function(e){if(!Mt(this.element).bodyProperty)throw Tt("unexpected body text <"+e+">");Bt.prototype.handleText.call(this,e)},zt.prototype.handleEnd=function(){var e=this.body,t=this.element,n=Mt(t).bodyProperty;n&&void 0!==e&&(e=ze(n.type,e),t.set(n.name,e))},zt.prototype.createElement=function(e){var i,e=e.attributes,t=this.type,r=Mt(t),o=this.context,a=new t({}),s=this.model;return ot(e,function(e,t){var n=r.propertiesByName[t];n&&n.isReference?n.isMany?ot(e.split(" "),function(e){o.addReference({element:a,property:n.ns.name,id:e})}):o.addReference({element:a,property:n.ns.name,id:e}):(n?e=ze(n.type,e):"xmlns"!==t&&(i=We(t,r.ns.prefix),s.getPackage(i.prefix))&&o.addWarning({message:"unknown attribute <"+t+">",element:a,property:t,value:e}),a.set(t,e))}),a},zt.prototype.getPropertyForNode=function(e){var t,n,i,r,o=We(e.name),a=this.type,s=this.model,a=Mt(a),c=o.name,c=a.propertiesByName[c];if(c&&!c.isAttr)return Dt(c)&&(t=e.attributes[Ot])?(e=s,u=We(u=t),e=e=e.getPackage(u.prefix),i=(u=u).name,r=u.localName,t=(e=e.xml&&e.xml.typePrefix)&&0===r.indexOf(e)?u.prefix+":"+r.slice(e.length):i,lt({},c,{effectiveType:Mt(n=s.getType(t)).name})):c;var u=s.getPackage(o.prefix);if(u){if(t=Rt(o,u),n=s.getType(t),c=it(a.properties,function(e){return!e.isVirtual&&!e.isReference&&!e.isAttribute&&n.hasType(e.type)}))return lt({},c,{effectiveType:Mt(n).name})}else if(c=it(a.properties,function(e){return!e.isReference&&!e.isAttribute&&"Element"===e.type}))return c;throw Tt("unrecognized element <"+o.name+">")},zt.prototype.toString=function(){return"ElementDescriptor["+Mt(this.type).name+"]"},zt.prototype.valueHandler=function(e,t){return new Vt(e,t)},zt.prototype.referenceHandler=function(e){return new Lt(e,this.context)},zt.prototype.handler=function(e){return new("Element"===e?Ut:zt)(this.model,e,this.context)},zt.prototype.handleChild=function(e){var t=this.getPropertyForNode(e),n=this.element,i=t.effectiveType||t.type;return $e[i]?this.valueHandler(t,n):(void 0!==(e=(i=(t.isReference?this.referenceHandler(t):this.handler(i)).handleNode(e)).element)&&(t.isMany?n.get(t.name).push(e):n.set(t.name,e),t.isReference?(lt(e,{element:n}),this.context.addReference(e)):e.$parent=n),i)},(Ft.prototype=Object.create(zt.prototype)).createElement=function(e){var t=e.name,n=We(t),i=this.model,r=this.type,i=i.getPackage(n.prefix),n=i&&Rt(n,i)||t;if(r.hasType(n))return zt.prototype.createElement.call(this,e);throw Tt("unexpected element <"+e.originalName+">")},(Ut.prototype=Object.create($t.prototype)).createElement=function(e){var t=e.name,n=We(t).prefix,n=e.ns[n+"$uri"],e=e.attributes;return this.model.createAny(t,n,e)},Ut.prototype.handleChild=function(e){var e=new Ut(this.model,0,this.context).handleNode(e),t=this.element,n=e.element;return void 0!==n&&((t.$children=t.$children||[]).push(n),n.$parent=t),e},Ut.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)},Ht.prototype.fromXML=function(m,e,t){var g=e.rootHandler,n=(e instanceof zt?(g=e,e={}):"string"==typeof e?(g=this.handler(e),e={}):"string"==typeof g&&(g=this.handler(g)),this.model),a=this.lax,v=new It(lt({},e,{rootHandler:g})),y=new kt({proxy:!0}),s=(e=[],Object.defineProperty(e,"peek",{value:function(){return this[this.length-1]}}),e);function c(e,t,n){var t=t(),i=t.line,r=t.column,t=t.data,t="unparsable content "+((t="<"===t.charAt(0)&&-1!==t.indexOf(" ")?t.slice(0,t.indexOf(" "))+">":t)?t+" ":"")+"detected\n\tline: "+i+"\n\tcolumn: "+r+"\n\tnested error: "+e.message;if(n)return v.addWarning({message:t,error:e}),!0;throw Tt(t)}function i(e,t){return c(e,t,!0)}g.context=v,s.push(g);var r=/^<\?xml /i,o=/ encoding="([^"]+)"/i,u=/^utf-8$/i;function l(e,t){try{s.peek().handleText(e)}catch(e){i(e,t)}}e=n.getPackages().reduce(function(e,t){return e[t.uri]=t.prefix,e},{"http://www.w3.org/XML/1998/namespace":"xml"});return y.ns(e).on("openTag",function(t,i,e,n){var r=t.attrs||{},o=Object.keys(r).reduce(function(e,t){var n=i(r[t]);return e[t]=n,e},{}),o={name:t.name,originalName:t.originalName,attributes:o,ns:t.ns},t=n,n=s.peek();try{s.push(n.handleNode(o))}catch(e){c(e,t,a)&&s.push(new Nt)}}).on("question",function(e){r.test(e)&&(e=(e=o.exec(e))&&e[1])&&!u.test(e)&&v.addWarning({message:"unsupported document encoding <"+e+">, falling back to UTF-8"})}).on("closeTag",function(){s.pop().handleEnd()}).on("cdata",l).on("text",function(e,t,n){t=t(e),e=n,t.trim()&&l(t,e)}).on("error",c).on("warn",i),new Promise(function(e,t){var n;try{y.parse(m);for(var i=v.elementsById,r=v.references,o=0;s=r[o];o++){var a,s,c=s.element,u=i[s.id],l=Mt(c).propertiesByName[s.property];u||v.addWarning({message:"unresolved reference <"+s.id+">",element:s.element,property:s.property,value:s.id}),l.isMany?(-1===(s=(a=c.get(l.name)).indexOf(s))&&(s=a.length),u?a[s]=u:a.splice(s,1)):c.set(l.name,u)}}catch(e){n=e}var d=g.element,p=(n||d||(n=Tt("failed to parse document as <"+g.type.$descriptor.name+">")),v.warnings),h=v.references,f=v.elementsById;return n?(n.warnings=p,t(n)):e({rootElement:d,elementsById:f,references:h,warnings:p})})},Ht.prototype.handler=function(e){return new Ft(this.model,e)};var Wt=/<|>|'|"|&|\n\r|\n/g,qt=/<|>|&/g;function Gt(i){var n={},r={},o={},a=[],s=[];this.byUri=function(e){return r[e]||i&&i.byUri(e)},this.add=function(e,t){r[e.uri]=e,(t?a:s).push(e),this.mapPrefix(e.prefix,e.uri)},this.uriByPrefix=function(e){return n[e||"xmlns"]},this.mapPrefix=function(e,t){n[e||"xmlns"]=t},this.getNSKey=function(e){return void 0!==e.prefix?e.uri+"|"+e.prefix:e.uri},this.logUsed=function(e){var t=e.uri,n=this.getNSKey(e);o[n]=this.byUri(t),i&&i.logUsed(e)},this.getUsed=function(e){var t=this;return[].concat(a,s).filter(function(e){return e=t.getNSKey(e),o[e]})}}function Kt(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function Xt(e){return tt(e)?e:(e.prefix?e.prefix+":":"")+e.localName}function Yt(e,t){return t.isGeneric?lt({localName:t.ns.localName},e):lt({localName:(n=t.ns.localName,St(t=t.$pkg)?(t=n).charAt(0).toLowerCase()+t.slice(1):n)},e);var n}var Zt={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},Qt={"<":"lt",">":"gt","&":"amp"};function Jt(e,t,n){return(e=tt(e)?e:""+e).replace(t,function(e){return"&"+n[e]+";"})}function en(e){this.tagName=e}function tn(){}function nn(e){this.tagName=e}function c(e,t){this.body=[],this.attrs=[],this.parent=e,this.propertyDescriptor=t}function rn(e,t){c.call(this,e,t)}function on(){this.value="",this.write=function(e){this.value+=e}}function an(t,e){var n=[""];this.append=function(e){return t.write(e),this},this.appendNewLine=function(){return e&&t.write("\n"),this},this.appendIndent=function(){return e&&t.write(n.join("  ")),this},this.indent=function(){return n.push(""),this},this.unindent=function(){return n.pop(),this}}function sn(r){return r=lt({format:!1,preamble:!0},r||{}),{toXML:function(e,t){var n=t||new on,i=new an(n,r.format);if(r.preamble&&i.append('<?xml version="1.0" encoding="UTF-8"?>\n'),(new c).build(e).serializeTo(i),!t)return n.value}}}function cn(e,t){Ze.call(this,e,t)}en.prototype.build=function(e){return this.element=e,this},en.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()},tn.prototype.serializeValue=tn.prototype.serializeTo=function(e){e.append(this.escape?Jt(this.value,qt,Qt):this.value)},tn.prototype.build=function(e,t){return this.value=t,"String"===e.type&&-1!==t.search(qt)&&(this.escape=!0),this},Kt(nn,tn),nn.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"),this.serializeValue(e),e.append("</"+this.tagName+">").appendNewLine()},c.prototype.build=function(e){var n,t=(this.element=e).$descriptor,i=this.propertyDescriptor,r=t.isGeneric,o=r?this.parseGeneric(e):this.parseNsAttributes(e);return this.ns=i?this.nsPropertyTagName(i):this.nsTagName(t),this.tagName=this.addTagName(this.ns),r||(i=rt((n=e).$descriptor.properties,function(e){var t=e.name;return!e.isVirtual&&nt(n,t)&&(t=n[t])!==e.default?null!==t&&(!e.isMany||t.length):void 0}),this.parseAttributes(rt(i,function(e){return e.isAttr})),this.parseContainments(rt(i,function(e){return!e.isAttr}))),this.parseGenericAttributes(e,o),this},c.prototype.nsTagName=function(e){return Yt(this.logNamespaceUsed(e.ns),e)},c.prototype.nsPropertyTagName=function(e){var t=this.logNamespaceUsed(e.ns);return lt({localName:e.ns.localName},t)},c.prototype.isLocalNs=function(e){return e.uri===this.ns.uri},c.prototype.nsAttributeName=function(e){var t=tt(e)?We(e):e.ns;return e.inherited||(e=this.logNamespaceUsed(t),this.getNamespaces().logUsed(e),this.isLocalNs(e))?{localName:t.localName}:lt({localName:t.localName},e)},c.prototype.parseGeneric=function(n){var i=this,r=this.body,o=[];return ot(n,function(e,t){"$body"===t?r.push((new tn).build({type:"String"},e)):"$children"===t?ot(e,function(e){r.push(new c(i).build(e))}):0!==t.indexOf("$")&&i.parseNsAttribute(n,t,e)&&o.push({name:t,value:e})}),o},c.prototype.parseNsAttribute=function(e,t,n){var i,e=e.$model,r=We(t);if("xmlns"===r.prefix&&(i={prefix:r.localName,uri:n}),!(i=r.prefix||"xmlns"!==r.localName?i:{uri:n}))return{name:t,value:n};e&&e.getPackage(n)?this.logNamespace(i,!0,!0):(r=this.logNamespaceUsed(i,!0),this.getNamespaces().logUsed(r))},c.prototype.parseNsAttributes=function(n,e){var i=this,t=n.$attrs,r=[];return ot(t,function(e,t){t=i.parseNsAttribute(n,t,e);t&&r.push(t)}),r},c.prototype.parseGenericAttributes=function(n,e){var i=this;ot(e,function(t){if(t.name!==Ot)try{i.addAttribute(i.nsAttributeName(t.name),t.value)}catch(e){console.warn("missing namespace information for ",t.name,"=",t.value,"on",n,e)}})},c.prototype.parseContainments=function(e){var o=this,a=this.body,s=this.element;ot(e,function(n){var i,r,e=s.get(n.name),t=n.isReference;n.isMany||(e=[e]),n.isBody?a.push((new tn).build(n,e[0])):He(n.type)?ot(e,function(e){a.push(new nn(o.addTagName(o.nsPropertyTagName(n))).build(n,e))}):t?ot(e,function(e){a.push(new en(o.addTagName(o.nsPropertyTagName(n))).build(e))}):(i=Dt(n),r="property"===Pt(n),ot(e,function(e){var t=i?new rn(o,n):r?new c(o,n):new c(o);a.push(t.build(e))}))})},c.prototype.getNamespaces=function(e){var t=this.namespaces,n=this.parent;return t||(n=n&&n.getNamespaces(),e||!n?this.namespaces=t=new Gt(n):t=n),t},c.prototype.logNamespace=function(e,t,n){var i=this.getNamespaces(n),r=e.uri,o=e.prefix;return i.byUri(r)&&!n||i.add(e,t),i.mapPrefix(o,r),e},c.prototype.logNamespaceUsed=function(e,t){var n,i,r=this.element.$model,o=this.getNamespaces(t),a=e.prefix,t=e.uri;if(!a&&!t)return{localName:e.localName};if(r=jt[a]||r&&(r.getPackage(a)||{}).uri,!(t=t||r||o.uriByPrefix(a)))throw new Error("no namespace uri given for prefix <"+a+">");if(!(e=o.byUri(t))){for(n=a,i=1;o.uriByPrefix(n);)n=a+"_"+i++;e=this.logNamespace({prefix:n,uri:t},r===t)}return a&&o.mapPrefix(a,t),e},c.prototype.parseAttributes=function(e){var i=this,r=this.element;ot(e,function(e){var t,n=r.get(e.name);e.isReference&&(n=e.isMany?(t=[],ot(n,function(e){t.push(e.id)}),t.join(" ")):n.id),i.addAttribute(i.nsAttributeName(e),n)})},c.prototype.addTagName=function(e){var t=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(t),Xt(e)},c.prototype.addAttribute=function(t,e){var n,i,r=this.attrs,o=(tt(e)&&(e=Jt(e,Wt,Zt)),o=r,n=at(n=function(e){return e.name.localName===t.localName&&e.name.uri===t.uri&&e.name.prefix===t.prefix}),i=et(o)?-1:void 0,ot(o,function(e,t){if(n(e,t))return i=t,!1}),i),e={name:t,value:e};-1!==o?r.splice(o,1,e):r.push(e)},c.prototype.serializeAttributes=function(t){var e=this.attrs,n=this.namespaces;ot(e=n?n.getUsed().filter(function(e){return"xml"!==e.prefix}).map(function(e){return{name:"xmlns"+(e.prefix?":"+e.prefix:""),value:e.uri}}).concat(e):e,function(e){t.append(" ").append(Xt(e.name)).append('="').append(e.value).append('"')})},c.prototype.serializeTo=function(t){var e=this.body[0],n=e&&e.constructor!==tn;t.appendIndent().append("<"+this.tagName),this.serializeAttributes(t),t.append(e?">":" />"),e&&(n&&t.appendNewLine().indent(),ot(this.body,function(e){e.serializeTo(t)}),n&&t.unindent().appendIndent(),t.append("</"+this.tagName+">")),t.appendNewLine()},Kt(rn,c),rn.prototype.parseNsAttributes=function(e){var t,n=c.prototype.parseNsAttributes.call(this,e),i=e.$descriptor;return i.name!==this.propertyDescriptor.type&&(t=this.typeNs=this.nsTagName(i),this.getNamespaces().logUsed(this.typeNs),e=(e=e.$model.getPackage(t.uri)).xml&&e.xml.typePrefix||"",this.addAttribute(this.nsAttributeName(Ot),(t.prefix?t.prefix+":":"")+e+i.ns.localName)),n},rn.prototype.isLocalNs=function(e){return e.uri===(this.typeNs||this.ns).uri},(cn.prototype=Object.create(Ze.prototype)).fromXML=function(e,t,n){i=t,"[object String]"!==ke.call(i)&&(n=t,t="dmn:Definitions");var i=new Ht(je({model:this,lax:!0},n)),n=i.handler(t);return i.fromXML(e,n)},cn.prototype.toXML=function(n,e){var i=new sn(e);return new Promise(function(e,t){try{return e({xml:i.toXML(n)})}catch(e){return t(e)}})};var un={dc:{name:"DC",prefix:"dc",uri:"http://www.omg.org/spec/DMN/20180521/DC/",types:[{name:"Dimension",properties:[{name:"width",isAttr:!0,type:"Real"},{name:"height",isAttr:!0,type:"Real"}]},{name:"Bounds",properties:[{name:"height",isAttr:!0,type:"Real"},{name:"width",isAttr:!0,type:"Real"},{name:"x",isAttr:!0,type:"Real"},{name:"y",isAttr:!0,type:"Real"}]},{name:"Point",properties:[{name:"x",isAttr:!0,type:"Real"},{name:"y",isAttr:!0,type:"Real"}]},{name:"Color",properties:[{name:"red",type:"UML_Standard_Profile.mdzip:eee_1045467100323_917313_65"},{name:"green",type:"UML_Standard_Profile.mdzip:eee_1045467100323_917313_65"},{name:"blue",type:"UML_Standard_Profile.mdzip:eee_1045467100323_917313_65"}]}],associations:[],enumerations:[{name:"AlignmentKind",literalValues:[{name:"start"},{name:"center"},{name:"end"}]}]},di:{name:"DI",prefix:"di",uri:"http://www.omg.org/spec/DMN/20180521/DI/",types:[{name:"DiagramElement",isAbstract:!0,properties:[{name:"extension",type:"Extension"},{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"style",isReference:!0,type:"Style",xml:{serialize:"property"}},{name:"sharedStyle",isReference:!0,isVirtual:!0,type:"Style"}]},{name:"Diagram",superClass:["DiagramElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,type:"Real"}]},{name:"Shape",isAbstract:!0,properties:[{name:"bounds",type:"dc:Bounds"}],superClass:["DiagramElement"]},{name:"Edge",isAbstract:!0,properties:[{name:"waypoint",type:"dc:Point",isMany:!0,xml:{serialize:"property"}}],superClass:["DiagramElement"]},{name:"Style",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"}]},{name:"Extension",properties:[{name:"values",isMany:!0,type:"Element"}]}],associations:[],enumerations:[],xml:{tagAlias:"lowerCase"}},dmn:{name:"DMN",prefix:"dmn",uri:"https://www.omg.org/spec/DMN/20191111/MODEL/",types:[{name:"AuthorityRequirement",superClass:["DMNElement"],properties:[{name:"requiredAuthority",type:"DMNElementReference",xml:{serialize:"property"}},{name:"requiredDecision",type:"DMNElementReference",xml:{serialize:"property"}},{name:"requiredInput",type:"DMNElementReference",xml:{serialize:"property"}}]},{name:"ItemDefinition",superClass:["NamedElement"],properties:[{name:"typeRef",type:"String"},{name:"allowedValues",type:"UnaryTests",xml:{serialize:"property"}},{name:"typeLanguage",type:"String",isAttr:!0},{name:"itemComponent",type:"ItemDefinition",isMany:!0,xml:{serialize:"property"}},{name:"functionItem",type:"FunctionItem"},{name:"isCollection",isAttr:!0,type:"Boolean"}]},{name:"Definitions",superClass:["NamedElement"],properties:[{name:"import",type:"Import",isMany:!0},{name:"itemDefinition",type:"ItemDefinition",isMany:!0},{name:"drgElement",type:"DRGElement",isMany:!0},{name:"artifact",type:"Artifact",isMany:!0},{name:"elementCollection",type:"ElementCollection",isMany:!0},{name:"businessContextElement",type:"BusinessContextElement",isMany:!0},{name:"namespace",type:"String",isAttr:!0},{name:"expressionLanguage",type:"String",isAttr:!0},{name:"typeLanguage",type:"String",isAttr:!0},{name:"exporter",isAttr:!0,type:"String"},{name:"exporterVersion",isAttr:!0,type:"String"},{name:"dmnDI",type:"dmndi:DMNDI"}]},{name:"KnowledgeSource",superClass:["DRGElement"],properties:[{name:"authorityRequirement",type:"AuthorityRequirement",isMany:!0},{name:"type",type:"String"},{name:"owner",type:"DMNElementReference",xml:{serialize:"property"}},{name:"locationURI",type:"String",isAttr:!0}]},{name:"DecisionRule",superClass:["DMNElement"],properties:[{name:"inputEntry",type:"UnaryTests",isMany:!0,xml:{serialize:"property"}},{name:"outputEntry",type:"LiteralExpression",isMany:!0,xml:{serialize:"property"}},{name:"annotationEntry",type:"RuleAnnotation",isMany:!0,xml:{serialize:"property"}}]},{name:"Expression",isAbstract:!0,superClass:["DMNElement"],properties:[{name:"typeRef",isAttr:!0,type:"String"}]},{name:"InformationItem",superClass:["NamedElement"],properties:[{name:"typeRef",isAttr:!0,type:"String"}]},{name:"Decision",superClass:["DRGElement"],properties:[{name:"question",type:"String",xml:{serialize:"property"}},{name:"allowedAnswers",type:"String",xml:{serialize:"property"}},{name:"variable",type:"InformationItem",xml:{serialize:"property"}},{name:"informationRequirement",type:"InformationRequirement",isMany:!0},{name:"knowledgeRequirement",type:"KnowledgeRequirement",isMany:!0},{name:"authorityRequirement",type:"AuthorityRequirement",isMany:!0},{name:"supportedObjective",isMany:!0,type:"DMNElementReference",xml:{serialize:"property"}},{name:"impactedPerformanceIndicator",type:"DMNElementReference",isMany:!0,xml:{serialize:"property"}},{name:"decisionMaker",type:"DMNElementReference",isMany:!0,xml:{serialize:"property"}},{name:"decisionOwner",type:"DMNElementReference",isMany:!0,xml:{serialize:"property"}},{name:"usingProcess",isMany:!0,type:"DMNElementReference",xml:{serialize:"property"}},{name:"usingTask",isMany:!0,type:"DMNElementReference",xml:{serialize:"property"}},{name:"decisionLogic",type:"Expression"}]},{name:"Invocation",superClass:["Expression"],properties:[{name:"calledFunction",type:"Expression"},{name:"binding",type:"Binding",isMany:!0}]},{name:"OrganisationalUnit",superClass:["BusinessContextElement"],properties:[{name:"decisionMade",type:"Decision",isReference:!0,isMany:!0},{name:"decisionOwned",type:"Decision",isReference:!0,isMany:!0}]},{name:"Import",superClass:["NamedElement"],properties:[{name:"importType",type:"String",isAttr:!0},{name:"locationURI",type:"String",isAttr:!0},{name:"namespace",type:"String",isAttr:!0}]},{name:"InformationRequirement",superClass:["DMNElement"],properties:[{name:"requiredDecision",type:"DMNElementReference",xml:{serialize:"property"}},{name:"requiredInput",type:"DMNElementReference",xml:{serialize:"property"}}]},{name:"ElementCollection",superClass:["NamedElement"],properties:[{name:"drgElement",type:"DMNElementReference",isMany:!0,xml:{serialize:"property"}}]},{name:"DRGElement",isAbstract:!0,superClass:["NamedElement"],properties:[]},{name:"InputData",superClass:["DRGElement"],properties:[{name:"variable",type:"InformationItem",xml:{serialize:"property"}}]},{name:"DMNElement",isAbstract:!0,properties:[{name:"description",type:"String"},{name:"extensionElements",type:"ExtensionElements"},{name:"id",type:"String",isAttr:!0,isId:!0},{name:"extensionAttribute",type:"ExtensionAttribute",isMany:!0},{name:"label",isAttr:!0,type:"String"}]},{name:"InputClause",superClass:["DMNElement"],properties:[{name:"inputExpression",type:"LiteralExpression",xml:{serialize:"property"}},{name:"inputValues",type:"UnaryTests",xml:{serialize:"property"}}]},{name:"DecisionTable",superClass:["Expression"],properties:[{name:"input",type:"InputClause",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"OutputClause",isMany:!0,xml:{serialize:"property"}},{name:"annotation",type:"RuleAnnotationClause",isMany:!0,xml:{serialize:"property"}},{name:"rule",type:"DecisionRule",isMany:!0,xml:{serialize:"property"}},{name:"hitPolicy",type:"HitPolicy",isAttr:!0,default:"UNIQUE"},{name:"aggregation",type:"BuiltinAggregator",isAttr:!0},{name:"preferredOrientation",type:"DecisionTableOrientation",isAttr:!0},{name:"outputLabel",isAttr:!0,type:"String"}]},{name:"LiteralExpression",superClass:["Expression"],properties:[{name:"expressionLanguage",type:"String",isAttr:!0},{name:"text",type:"String"},{name:"importedValues",type:"ImportedValues"}]},{name:"Binding",properties:[{name:"parameter",type:"InformationItem",xml:{serialize:"property"}},{name:"bindingFormula",type:"Expression"}]},{name:"KnowledgeRequirement",superClass:["DMNElement"],properties:[{name:"requiredKnowledge",type:"DMNElementReference",xml:{serialize:"property"}}]},{name:"BusinessKnowledgeModel",superClass:["Invocable"],properties:[{name:"encapsulatedLogic",type:"FunctionDefinition",xml:{serialize:"property"}},{name:"knowledgeRequirement",type:"KnowledgeRequirement",isMany:!0},{name:"authorityRequirement",type:"AuthorityRequirement",isMany:!0}]},{name:"BusinessContextElement",isAbstract:!0,superClass:["NamedElement"],properties:[{name:"URI",type:"String",isAttr:!0}]},{name:"PerformanceIndicator",superClass:["BusinessContextElement"],properties:[{name:"impactingDecision",type:"DMNElementReference",isMany:!0,xml:{serialize:"property"}}]},{name:"FunctionDefinition",superClass:["Expression"],properties:[{name:"formalParameter",type:"InformationItem",isMany:!0,xml:{serialize:"property"}},{name:"body",type:"Expression"},{name:"kind",type:"FunctionKind",isAttr:!0}]},{name:"Context",superClass:["Expression"],properties:[{name:"contextEntry",type:"ContextEntry",isMany:!0}]},{name:"ContextEntry",superClass:["DMNElement"],properties:[{name:"variable",type:"InformationItem",xml:{serialize:"property"}},{name:"value",type:"Expression"}]},{name:"List",superClass:["Expression"],properties:[{name:"elements",isMany:!0,type:"Expression"}]},{name:"Relation",superClass:["Expression"],properties:[{name:"column",type:"InformationItem",isMany:!0,xml:{serialize:"property"}},{name:"row",type:"List",isMany:!0,xml:{serialize:"property"}}]},{name:"OutputClause",superClass:["DMNElement"],properties:[{name:"outputValues",type:"UnaryTests",xml:{serialize:"property"}},{name:"defaultOutputEntry",type:"LiteralExpression",xml:{serialize:"property"}},{name:"name",isAttr:!0,type:"String"},{name:"typeRef",isAttr:!0,type:"String"}]},{name:"UnaryTests",superClass:["Expression"],properties:[{name:"text",type:"String"},{name:"expressionLanguage",type:"String",isAttr:!0}]},{name:"NamedElement",isAbstract:!0,superClass:["DMNElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ImportedValues",superClass:["Import"],properties:[{name:"importedElement",type:"String"},{name:"expressionLanguage",type:"String",isAttr:!0}]},{name:"DecisionService",superClass:["Invocable"],properties:[{name:"outputDecision",type:"DMNElementReference",isMany:!0,xml:{serialize:"property"}},{name:"encapsulatedDecision",type:"DMNElementReference",isMany:!0,xml:{serialize:"property"}},{name:"inputDecision",type:"DMNElementReference",isMany:!0,xml:{serialize:"property"}},{name:"inputData",type:"DMNElementReference",isMany:!0,xml:{serialize:"property"}}]},{name:"ExtensionElements",properties:[{name:"values",type:"Element",isMany:!0}]},{name:"ExtensionAttribute",properties:[{name:"value",type:"Element"},{name:"valueRef",type:"Element",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Element",isAbstract:!0,properties:[{name:"extensionAttribute",type:"ExtensionAttribute",isAttr:!0,isReference:!0},{name:"elements",type:"ExtensionElements",isAttr:!0,isReference:!0}]},{name:"Artifact",isAbstract:!0,superClass:["DMNElement"],properties:[]},{name:"Association",superClass:["Artifact"],properties:[{name:"sourceRef",type:"DMNElementReference",xml:{serialize:"property"}},{name:"targetRef",type:"DMNElementReference",xml:{serialize:"property"}},{name:"associationDirection",type:"AssociationDirection",isAttr:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",isAttr:!0,type:"String",default:"text/plain"}]},{name:"RuleAnnotationClause",properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"RuleAnnotation",properties:[{name:"text",type:"String"}]},{name:"Invocable",isAbstract:!0,superClass:["DRGElement"],properties:[{name:"variable",type:"InformationItem",xml:{serialize:"property"}}]},{name:"Group",superClass:["Artifact"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"FunctionItem",superClass:["DMNElement"],properties:[{name:"parameters",isMany:!0,type:"InformationItem",xml:{serialize:"property"}},{name:"outputTypeRef",isAttr:!0,type:"String"}]},{name:"DMNElementReference",properties:[{isAttr:!0,name:"href",type:"String"}]}],enumerations:[{name:"HitPolicy",literalValues:[{name:"UNIQUE"},{name:"FIRST"},{name:"PRIORITY"},{name:"ANY"},{name:"COLLECT"},{name:"RULE ORDER"},{name:"OUTPUT ORDER"}]},{name:"BuiltinAggregator",literalValues:[{name:"SUM"},{name:"COUNT"},{name:"MIN"},{name:"MAX"}]},{name:"DecisionTableOrientation",literalValues:[{name:"Rule-as-Row"},{name:"Rule-as-Column"},{name:"CrossTable"}]},{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"FunctionKind",literalValues:[{name:"FEEL"},{name:"Java"},{name:"PMML"}]}],associations:[],xml:{tagAlias:"lowerCase"}},dmndi:{name:"DMNDI",prefix:"dmndi",uri:"https://www.omg.org/spec/DMN/20191111/DMNDI/",types:[{name:"DMNDI",properties:[{name:"diagrams",type:"DMNDiagram",isMany:!0},{name:"styles",type:"DMNStyle",isMany:!0}]},{name:"DMNStyle",superClass:["di:Style"],properties:[{name:"fillColor",type:"dc:Color",isAttr:!0},{name:"strokeColor",type:"dc:Color",isAttr:!0},{name:"fontColor",type:"dc:Color",isAttr:!0},{name:"fontSize",isAttr:!0,type:"Real"},{name:"fontFamily",isAttr:!0,type:"String"},{name:"fontItalic",isAttr:!0,type:"Boolean"},{name:"fontBold",isAttr:!0,type:"Boolean"},{name:"fontUnderline",isAttr:!0,type:"Boolean"},{name:"fontStrikeThrough",isAttr:!0,type:"Boolean"},{name:"labelHorizontalAlignment",type:"dc:AlignmentKind",isAttr:!0},{name:"labelVerticalAlignment",type:"dc:AlignmentKind",isAttr:!0}]},{name:"DMNDiagram",superClass:["di:Diagram"],properties:[{name:"dmnElementRef",type:"dmn:DMNElement",isAttr:!0,isReference:!0},{name:"size",type:"Size"},{name:"localStyle",type:"DMNStyle",isVirtual:!0},{name:"sharedStyle",type:"DMNStyle",isVirtual:!0,isReference:!0,redefines:"di:DiagramElement#sharedStyle"},{name:"diagramElements",type:"DMNDiagramElement",isMany:!0}]},{name:"DMNDiagramElement",isAbstract:!0,superClass:["di:DiagramElement"],properties:[{name:"dmnElementRef",type:"dmn:DMNElement",isAttr:!0,isReference:!0},{name:"sharedStyle",type:"DMNStyle",isVirtual:!0,isReference:!0,redefines:"di:DiagramElement#sharedStyle"},{name:"localStyle",type:"DMNStyle",isVirtual:!0},{name:"label",type:"DMNLabel"}]},{name:"DMNLabel",superClass:["di:Shape"],properties:[{name:"text",type:"Text"}]},{name:"DMNShape",superClass:["di:Shape","DMNDiagramElement"],properties:[{name:"isListedInputData",isAttr:!0,type:"Boolean"},{name:"decisionServiceDividerLine",type:"DMNDecisionServiceDividerLine"},{name:"isCollapsed",isAttr:!0,type:"Boolean"}]},{name:"DMNEdge",superClass:["di:Edge","DMNDiagramElement"],properties:[{name:"sourceElement",type:"DMNDiagramElement",isAttr:!0,isReference:!0},{name:"targetElement",type:"DMNDiagramElement",isAttr:!0,isReference:!0}]},{name:"DMNDecisionServiceDividerLine",superClass:["di:Edge"]},{name:"Text",properties:[{name:"text",isBody:!0,type:"String"}]},{name:"Size",superClass:["dc:Dimension"]}],associations:[],enumerations:[]},biodi:{name:"bpmn.io DI for DMN",uri:"http://bpmn.io/schema/dmn/biodi/2.0",prefix:"biodi",xml:{tagAlias:"lowerCase"},types:[{name:"DecisionTable",isAbstract:!0,extends:["dmn:DecisionTable"],properties:[{name:"annotationsWidth",isAttr:!0,type:"Integer"}]},{name:"OutputClause",isAbstract:!0,extends:["dmn:OutputClause"],properties:[{name:"width",isAttr:!0,type:"Integer"}]},{name:"InputClause",isAbstract:!0,extends:["dmn:InputClause"],properties:[{name:"width",isAttr:!0,type:"Integer"}]}]}};function ln(e,t){return new cn(je({},un,e),t)}function dn(i,e){return e.forEach(function(n){n&&"string"!=typeof n&&!Array.isArray(n)&&Object.keys(n).forEach(function(e){var t;"default"===e||e in i||(t=Object.getOwnPropertyDescriptor(n,e),Object.defineProperty(i,e,t.get?t:{enumerable:!0,get:function(){return n[e]}}))})}),Object.freeze(i)}var pn=Object.prototype.toString,hn=Object.prototype.hasOwnProperty;function fn(e,t){if(void 0!==e){var n,i,r="[object Array]"===pn.call(e)?gn:mn;for(n in e)if(i=n,hn.call(e,i)&&!1===t(e[n],r(n)))return}}function mn(e){return e}function gn(e){return Number(e)}function vn(e){for(var n=e.style,t=arguments.length,i=new Array(1<t?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];fn(i,function(e){e&&fn(e,function(e,t){n[t]=e})})}function yn(e,t,n){return 2==arguments.length?e.getAttribute(t):null===n?e.removeAttribute(t):(e.setAttribute(t,n),e)}var _n=Object.prototype.toString;function v(e){return new bn(e)}function bn(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}function xn(e){for(var t;e.childNodes.length;)t=e.childNodes[0],e.removeChild(t)}function wn(e,t){return e&&"function"==typeof e.matches&&e.matches(t)}function Cn(e,t,n){for(var i=n?e:e.parentNode;i&&i.nodeType!==document.DOCUMENT_NODE&&i.nodeType!==document.DOCUMENT_FRAGMENT_NODE;){if(wn(i,t))return i;i=i.parentNode}return wn(i,t)?i:null}bn.prototype.add=function(e){return this.list.add(e),this},bn.prototype.remove=function(e){return"[object RegExp]"==_n.call(e)?this.removeMatching(e):(this.list.remove(e),this)},bn.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},bn.prototype.toggle=function(e,t){return void 0!==t&&t===this.list.toggle(e,t)||this.list.toggle(e),this},bn.prototype.array=function(){return Array.from(this.list)},bn.prototype.has=bn.prototype.contains=function(e){return this.list.contains(e)};var e={},En=window.addEventListener?"addEventListener":"attachEvent",kn=window.removeEventListener?"removeEventListener":"detachEvent",Sn="addEventListener"!=En?"on":"",E=dn({__proto__:null,bind:e.bind=function(e,t,n,i){return e[En](Sn+t,n,i||!1),n},unbind:e.unbind=function(e,t,n,i){return e[kn](Sn+t,n,i||!1),n},default:e},[e]),jn=["focus","blur"];function On(e,t){if("string"!=typeof e)throw new TypeError("String expected");if(t=t||document,!(o=/<([\w:]+)/.exec(e)))return t.createTextNode(e);if(e=e.replace(/^\s+|\s+$/g,""),"body"==(o=o[1]))return(n=t.createElement("html")).innerHTML=e,n.removeChild(n.lastChild);var n,i=(o=Object.prototype.hasOwnProperty.call(Dn,o)?Dn[o]:Dn._default)[0],r=o[1],o=o[2];for((n=t.createElement("div")).innerHTML=r+e+o;i--;)n=n.lastChild;if(n.firstChild==n.lastChild)return n.removeChild(n.firstChild);for(var a=t.createDocumentFragment();n.firstChild;)a.appendChild(n.removeChild(n.firstChild));return a}var Pn={bind:function(n,i,e,r,t){return-1!==jn.indexOf(e)&&(t=!0),E.bind(n,e,function(e){var t=e.target||e.srcElement;e.delegateTarget=Cn(t,i,!0),e.delegateTarget&&r.call(n,e)},t)},unbind:function(e,t,n,i){return-1!==jn.indexOf(t)&&(i=!0),E.unbind(e,t,n,i)}},e=!1,Dn=("undefined"!=typeof document&&((Un=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',e=!Un.getElementsByTagName("link").length,Un=void 0),{legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:e?[1,"X<div>","</div>"]:[0,"",""]});Dn.td=Dn.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],Dn.option=Dn.optgroup=[1,'<select multiple="multiple">',"</select>"],Dn.thead=Dn.tbody=Dn.colgroup=Dn.caption=Dn.tfoot=[1,"<table>","</table>"],Dn.polyline=Dn.ellipse=Dn.polygon=Dn.circle=Dn.text=Dn.line=Dn.path=Dn.rect=Dn.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];var _=On;function b(e,t){return(t=t||document).querySelector(e)}function Rn(e,t){return(t=t||document).querySelectorAll(e)}function Tn(e){e.parentNode&&e.parentNode.removeChild(e)}function Mn(t){return function(){if(!window.Promise)throw new Error("Promises is not supported in this environment. Please polyfill Promise.");var e=arguments.length;if(!(1<=e&&te(arguments[e-1])))return t.apply(this,arguments);var n=arguments[e-1],e=(console.warn(new Error("Passing callbacks to "+t.name.replace("bound ","")+" is deprecated and will be removed in a future major release. Please switch to promises: https://bpmn.io/l/moving-to-promises.html")),Array.prototype.slice.call(arguments,0,-1));t.apply(this,e).then(function(e){var t=Object.keys(e)[0];return n(null,e[t])},function(e){return n(e,e.warnings)})}}function In(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function An(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?In(Object(n),!0).forEach(function(e){Nn(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):In(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Nn(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var Bn={width:"100%",height:"100%",position:"relative"},Ln=function(){function n(){var e=this,t=(h(this,n),0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});Nn(this,"_viewsChanged",function(){e._emit("views.changed",{views:e._views,activeView:e._activeView})}),this._eventBus=new Ce,this._viewsChanged=ve(this._viewsChanged,0),this._views=[],this._viewers={},this.open=Mn(this.open.bind(this)),this.importXML=Mn(this.importXML.bind(this)),this.saveXML=Mn(this.saveXML.bind(this)),this._init(t)}return u(n,[{key:"importXML",value:function(i,c){var u=this;return c=c||{open:!0},new Promise(function(o,a){var s=u._activeView;u._clear().then(function(){var r;i=u._emit("import.parse.start",{xml:i})||i,u._moddle.fromXML(i,"dmn:Definitions").then(function(e){var t=e.rootElement,n=e.references,i=e.elementsById;if(r=e.warnings,t=u._emit("import.parse.complete",l({error:null,definitions:t,elementsById:i,references:n,warnings:r}))||t,u._setDefinitions(t),c.open)return(e=u._getInitialView(u._views,s))?void u.open(e).then(function(e){return{warnings:e.warnings}}).catch(function(e){return{error:e,warnings:e.warnings}}).then(function(e){var t=[].concat(r,e.warnings);u._emit("import.done",{error:e.error,warnings:t}),e.error?(e.error.warnings=t,a(e.error)):o({warnings:t})}):(i=new Error("no displayable contents"),u._emit("import.done",{error:i,warnings:r}),i.warnings=r,a(i));u._emit("import.done",{error:null,warnings:r}),o({warnings:r})}).catch(function(e){var t,n;return r=e.warnings,e=function(e,t){if("failed to parse document as <dmn:Definitions>"!==e.message)return null;t=-1!==t.indexOf('"http://www.omg.org/spec/DMN/20151101/dmn.xsd"')?"1.1":-1!==t.indexOf('"http://www.omg.org/spec/DMN/20180521/MODEL/"')&&"1.2";return t?(e=new Error("unsupported DMN "+t+" file detected; only DMN 1.3 files can be opened"),console.error("Cannot open what looks like a DMN "+t+" diagram. Please refer to https://bpmn.io/l/dmn-compatibility.html to learn how to make the toolkit compatible with older DMN files",e),e):null}(e,i)||(t=e,(n=/unparsable content <([^>]+)> detected([\s\S]*)$/.exec(t.message))?(t.message="unparsable content <"+n[1]+"> detected; this may indicate an invalid DMN 1.3 diagram file"+n[2],t):null)||e,u._emit("import.parse.complete",l({error:e,warnings:r})),u._emit("import.done",{error:e,warnings:r}),e.warnings=r,a(e)})}).catch(function(e){return u._emit("import.done",{error:e,warnings:[]}),e.warnings=[],a(e)})});function l(e){var t=u._eventBus.createEvent(e);return Object.defineProperty(t,"context",{enumerable:!0,get:function(){return console.warn(new Error("import.parse.complete <context> is deprecated and will be removed in future library versions")),{warnings:e.warnings,references:e.references,elementsById:e.elementsById}}}),t}}},{key:"getDefinitions",value:function(){return this._definitions}},{key:"getActiveView",value:function(){return this._activeView}},{key:"getActiveViewer",value:function(){var e=this.getActiveView();return e&&this._getViewer(e)}},{key:"getView",value:function(t){return this._views.filter(function(e){return e.element===t})[0]}},{key:"getViews",value:function(){return this._views}},{key:"saveXML",value:function(e){var i=this,r=(e=e||{},this._definitions);return new Promise(function(t,n){r?(r=i._emit("saveXML.start",{definitions:r})||r,i._moddle.toXML(r,e).then(function(e){e=e.xml;return{xml:i._emit("saveXML.serialized",{xml:e})||e}}).catch(function(e){return{error:e}}).then(function(e){i._emit("saveXML.done",e),e.error?n(e.error):t({xml:e.xml})})):n(new Error("no definitions loaded"))})}},{key:"on",value:function(){var e;(e=this._eventBus).on.apply(e,arguments)}},{key:"off",value:function(){var e;(e=this._eventBus).off.apply(e,arguments)}},{key:"once",value:function(){var e;(e=this._eventBus).once.apply(e,arguments)}},{key:"attachTo",value:function(e){(e="string"==typeof(e=e.get&&e.constructor.prototype.jquery?e.get(0):e)?b(e):e).appendChild(this._container),this._emit("attach",{})}},{key:"detach",value:function(){this._emit("detach",{}),Tn(this._container)}},{key:"destroy",value:function(){var t=this;Object.keys(this._viewers).forEach(function(e){Fn(t._viewers[e],"destroy")}),Tn(this._container)}},{key:"_init",value:function(e){this._options=e,this._moddle=this._createModdle(e),this._viewers={},this._views=[];var t=_('<div class="dmn-js-parent"></div>'),n=C({},Bn,e);C(t.style,{width:Vn(n.width),height:Vn(n.height),position:n.position}),this._container=t,e.container&&this.attachTo(e.container)}},{key:"_clear",value:function(){return this._switchView(null)}},{key:"open",value:function(e){return this._switchView(e)}},{key:"_setDefinitions",value:function(e){this._definitions=e,this._updateViews()}},{key:"_updateViews",value:function(){var e=this._definitions;if(e){for(var t=this._getViewProviders(),e=[e].concat(f(e.drgElement||[])),n=this._views,i=[],r=0,o=e;r<o.length;r++){var a=o[r],s=ie(t,function(e){return"string"==typeof e.opens?e.opens===a.$type:e.opens(a)});s&&(s={element:a,id:a.id,name:a.name,type:s.id},i.push(s))}var c,u,l=this._activeView;l&&!(c=ie(i,function(e){return $n(l,e)})||this._getInitialView(i))?this._switchView(null):(e=!$n(l,c)||zn(l,c),u=n.length!==i.length||!ae(i,function(t){return ie(n,function(e){return $n(e,t)&&!zn(e,t)})}),this._activeView=c,this._views=i,(e||u)&&this._viewsChanged())}else this._views=[],this._switchView(null)}},{key:"_getInitialView",value:function(e,t){var n;return(n=t?ie(e,function(e){return $n(e,t)})||ie(e,function(e){return e.type===t}):n)||e[0]}},{key:"_switchView",value:function(s){var c=this;return new Promise(function(n,i){function t(e,t){c._viewsChanged(),e?i(e):n(t)}var e,r=c.getActiveView(),o=s&&c._getViewer(s),a=s&&s.element;r&&(e=c._getViewer(r))!==o&&(Fn(e,"clear"),e.detach()),c._activeView=s,o?(e!==o&&o.attachTo(c._container),c._emit("import.render.start",{view:s,element:a}),o.open(a).then(function(e){c._emit("import.render.complete",{view:s,error:null,warnings:e.warnings}),t(null,e)}).catch(function(e){c._emit("import.render.complete",{view:s,error:e,warnings:e.warnings}),t(e,null)})):t()})}},{key:"_getViewer",value:function(e){var t=e.type,n=this._viewers[t];return n||(n=this._viewers[t]=this._createViewer(e.type),this._emit("viewer.created",{type:t,viewer:n})),n}},{key:"_createViewer",value:function(t){var e,n=ie(this._getViewProviders(),function(e){return e.id===t});if(n)return n=n.constructor,e=this._options[t]||{},new n(An(An(An({},this._options.common||{}),e),{},{additionalModules:[].concat(f(e.additionalModules||[]),[{_parent:["value",this],moddle:["value",this._moddle]}])}));throw new Error("no provider for view type <"+t+">")}},{key:"_emit",value:function(){var e;return(e=this._eventBus).fire.apply(e,arguments)}},{key:"_createModdle",value:function(e){return new ln(e.moddleExtensions)}},{key:"_getViewProviders",value:function(){return[]}}]),n}();function Vn(e){return e+(g(e)?"px":"")}function $n(e,t){return Q(e)?!!Q(t)&&(e.element===t.element||e.id===t.id):!Q(t)}function zn(e,t){return!e||!t||e.name!==t.name}function Fn(e,t){te(e[t])&&e[t]()}(function(e){var s=e.exports=function(e,t){if(t=t||16,(e=void 0===e?128:e)<=0)return"0";for(var n=Math.log(Math.pow(2,e))/Math.log(t),i=2;n===1/0;i*=2)n=Math.log(Math.pow(2,e/i))/Math.log(t)*i;for(var r=n-Math.floor(n),o="",i=0;i<Math.floor(n);i++)o=Math.floor(Math.random()*t).toString(t)+o;r&&(r=Math.pow(t,r),o=Math.floor(Math.random()*r).toString(t)+o);r=parseInt(o,t);return r!==1/0&&r>=Math.pow(2,e)?s(e,t):o};s.rack=function(i,r,o){function n(e){var t=0;do{if(10<t++){if(!o)throw new Error("too many ID collisions, use more bits");i+=o}var n=s(i,r)}while(Object.hasOwnProperty.call(a,n));return a[n]=e,n}var a=n.hats={};return n.get=function(e){return n.hats[e]},n.set=function(e,t){return n.hats[e]=t,n},n.bits=i||128,n.base=r||16,n}})(Un={exports:{}});var Un,Hn=Un.exports;function Wn(e){if(!(this instanceof Wn))return new Wn(e);this._seed=(e=e||[128,36,1]).length?Hn.rack(e[0],e[1],e[2]):e}function k(e,t){e=Gn(e);return e&&"function"==typeof e.$instanceOf&&e.$instanceOf(t)}function x(e){return k(e,"dmn:InputClause")}function qn(e){return k(e,"dmn:OutputClause")}function Gn(e){return e&&e.businessObject||e}function Kn(t,e){return se(e,function(e){return k(t,e)})}Wn.prototype.next=function(e){return this._seed(e||!0)},Wn.prototype.nextPrefixed=function(e,t){for(var n;n=e+this.next(!0),this.assigned(n););return this.claim(n,t),n},Wn.prototype.claim=function(e,t){this._seed.set(e,t||!0)},Wn.prototype.assigned=function(e){return this._seed.get(e)||!1},Wn.prototype.unclaim=function(e){delete this._seed.hats[e]},Wn.prototype.clear=function(){for(var e in this._seed.hats)this.unclaim(e)};var Xn=function(){l(n,Ln);var e=p(n);function n(){return h(this,n),e.apply(this,arguments)}return u(n,[{key:"_init",value:function(e){var t=this;F(s(n.prototype),"_init",this).call(this,e),this.on("import.parse.complete",function(e){e.error||t._collectIds(e.definitions,e.elementsById)}),this.on("destroy",function(){t._moddle.ids.clear()}),this.on("viewer.created",function(e){e.viewer.on("elements.changed",function(e){e.elements.some(function(e){return Kn(e,["dmn:Decision","dmn:Definitions"])})&&t._updateViews()})})}},{key:"_collectIds",value:function(e,t){var n,i=e.$model.ids;for(n in i.clear(),t)i.claim(n,t[n])}},{key:"_createModdle",value:function(e){e=F(s(n.prototype),"_createModdle",this).call(this,e);return e.ids=new Wn([32,36,1]),e}}]),n}();function Yn(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}var Zn=/^class[ {]/;function Qn(e){return Array.isArray(e)}function Jn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ei(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=(t=f(t=1===t.length&&Qn(t[0])?t[0]:t)).pop();return i.$inject=t,i}var ti=/constructor\s*[^(]*\(\s*([^)]*)\)/m,ni=/^(?:async\s+)?(?:function\s*[^(]*)?(?:\(\s*([^)]*)\)|(\w+))/m,ii=/\/\*([^*]*)\*\//m;function ri(e){if("function"!=typeof e)throw new Error('Cannot annotate "'.concat(e,'". Expected a function!'));var e=e.toString().match(Zn.test(e.toString())?ti:ni);return(e=e&&(e[1]||e[2]))&&e.split(",").map(function(e){var t=e.match(ii);return(t&&t[1]||e).trim()})||[]}function oi(e,r){r=r||{get:function(e,t){if(o.push(e),!1===t)return null;throw s('No provider for "'.concat(e,'"!'))}};var o=[],h=this._providers=Object.create(r._providers||null),a=this._instances=Object.create(null),f=a.injector=this,s=function(e){var t=o.join(" -> ");return o.length=0,new Error(t?"".concat(e," (Resolving: ").concat(t,")"):e)};function c(e,t){if(!h[e]&&-1!==e.indexOf(".")){for(var n=e.split("."),i=c(n.shift());n.length;)i=i[n.shift()];return i}if(Jn(a,e))return a[e];if(Jn(h,e)){if(-1!==o.indexOf(e))throw o.push(e),s("Cannot resolve circular dependency!");return o.push(e),a[e]=h[e][0](h[e][1]),o.pop(),a[e]}return r.get(e,t)}function i(e,t){if(void 0===t&&(t={}),"function"!=typeof e){if(!Qn(e))throw s('Cannot invoke "'.concat(e,'". Expected a function!'));e=ei(e.slice())}return{fn:e,dependencies:(e.$inject||ri(e)).map(function(e){return Jn(t,e)?t[e]:c(e)})}}function t(e){var e=i(e),t=e.fn,e=e.dependencies;return new(Function.prototype.bind.apply(t,[null].concat(e)))}function n(e,t,n){e=i(e,n),n=e.fn,e=e.dependencies;return n.apply(t,e)}function u(e,i){if(i&&i.length){var r,o,a,s,t,c=Object.create(null),u=Object.create(null),l=[],d=[],p=[],n=function(t){var n;r=h[t],-1!==i.indexOf(t)&&("private"===r[2]?-1===(o=l.indexOf(r[3]))?(a=r[3].createChild([],i),n=a,s=ei(function(e){return n.get(e)}),l.push(r[3]),d.push(a),p.push(s),c[t]=[s,t,"private",a]):c[t]=[p[o],t,"private",d[o]]:c[t]=[r[2],r[1]],u[t]=!0),"factory"!==r[2]&&"type"!==r[2]||!r[1].$scope||i.forEach(function(e){-1!==r[1].$scope.indexOf(e)&&(c[t]=[r[2],r[1]],u[e]=!0)})};for(t in h)n(t);i.forEach(function(e){if(!u[e])throw new Error('No provider for "'+e+'". Cannot use provider from the parent!')}),e.unshift(c)}return new oi(e,f)}var l,d,p={factory:n,type:t,value:function(e){return e}};function m(e,t){var n=e.__init__||[];return function(){n.forEach(function(e){"string"==typeof e?t.get(e):t.invoke(e)})}}function g(i){var e,t,n,r,o=i.__exports__;return o?(r=i.__modules__,e=Object.keys(i).reduce(function(e,t){return"__exports__"!==t&&"__modules__"!==t&&"__init__"!==t&&"__depends__"!==t&&(e[t]=i[t]),e},Object.create(null)),t=u((r||[]).concat(e)),n=ei(function(e){return t.get(e)}),o.forEach(function(e){h[e]=[n,e,"private",t]}),(r=(i.__init__||[]).slice()).unshift(function(){t.init()}),m(i=Object.assign({},i,{__init__:r}),t)):(Object.keys(i).forEach(function(e){var t,n;"__init__"!==e&&"__depends__"!==e&&("private"===i[e][2]?h[e]=i[e]:(t=i[e][0],n=i[e][1],h[e]=[p[t],function(e,t){"value"!==e&&Qn(t)&&(t=ei(t.slice()));return t}(t,n),t]))}),m(i,f))}function v(e,t){return-1!==e.indexOf(t)||-1!==(e=(t.__depends__||[]).reduce(v,e)).indexOf(t)?e:e.concat(t)}this.get=c,this.invoke=n,this.instantiate=t,this.createChild=u,this.init=(l=e.reduce(v,[]).map(g),d=!1,function(){d||(d=!0,l.forEach(function(e){return e()}))})}function ai(e,t){var r=this;e.on(["render.shape","render.connection"],t=t||1e3,function(e,t){var e=e.type,n=t.element,i=t.gfx,t=t.attrs;if(r.canRender(n))return"render.shape"===e?r.drawShape(i,n,t):r.drawConnection(i,n,t)}),e.on(["render.getShapePath","render.getConnectionPath"],t,function(e,t){if(r.canRender(t))return"render.getShapePath"===e.type?r.getShapePath(t):r.getConnectionPath(t)})}function si(e,t){t.appendChild(function(e,t){if(e.ownerDocument!==t.ownerDocument)try{return t.ownerDocument.importNode(e,!0)}catch(e){}return e}(e,t))}function w(e,t){si(t,e)}ai.prototype.canRender=function(){},ai.prototype.drawShape=function(){},ai.prototype.drawConnection=function(){},ai.prototype.getShapePath=function(){},ai.prototype.getConnectionPath=function(){};var ci=2,ui={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":ci,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":ci,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function li(e,t,n){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=ui[i];r?(r===ci&&"number"==typeof n&&(n=String(n)+"px"),e.style[i]=n):e.setAttributeNS(null,t,n)}function S(e,t,n){if("string"==typeof t){if(void 0===n)return c=e,ui[u=t]?c.style[u]:c.getAttributeNS(null,u);li(e,t,n)}else for(var i,r=e,o=t,a=Object.keys(o),s=0;i=a[s];s++)li(r,i,o[i]);var c,u;return e}var di=Object.prototype.toString;function j(e){return new pi(e)}function pi(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}function hi(e){var t=e.parentNode;return t&&t.removeChild(e),e}function fi(e){for(var t;t=e.firstChild;)hi(t)}function mi(e){return e.cloneNode(!0)}pi.prototype.add=function(e){return this.list.add(e),this},pi.prototype.remove=function(e){return"[object RegExp]"==di.call(e)?this.removeMatching(e):(this.list.remove(e),this)},pi.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},pi.prototype.toggle=function(e,t){return void 0!==t&&t===this.list.toggle(e,t)||this.list.toggle(e),this},pi.prototype.array=function(){return Array.from(this.list)},pi.prototype.has=pi.prototype.contains=function(e){return this.list.contains(e)};var gi={svg:"http://www.w3.org/2000/svg"},vi='<svg xmlns="'+gi.svg+'"';function yi(e){var t=!1,n=("<svg"===e.substring(0,4)?-1===e.indexOf(gi.svg)&&(e=vi+e.substring(4)):(e=vi+">"+e+"</svg>",t=!0),e=e,(n=new DOMParser).async=!1,n.parseFromString(e,"text/xml"));if(!t)return n;for(var i=document.createDocumentFragment(),r=n.firstChild;r.firstChild;)i.appendChild(r.firstChild);return i}function O(e,t){var n="<"===e.charAt(0)?(n=yi(e).firstChild,document.importNode(n,!0)):document.createElementNS(gi.svg,e);return t&&S(n,t),n}var _i=null;function bi(){return _i=null===_i?O("svg"):_i}function xi(e,t){for(var n,i=Object.keys(t),r=0;n=i[r];r++)e[n]=t[n];return e}function wi(e){return e?bi().createSVGTransformFromMatrix(e):bi().createSVGTransform()}var Ci=/([&<>]{1})/g,Ei=/([\n\r"]{1})/g,ki={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function Si(e,t){return e.replace(t,function(e,t){return ki[t]||t})}function ji(e,t){var n=yi(t);if(fi(e),t){"#document-fragment"!==n.nodeName&&(n=n.documentElement);t=n.childNodes;for(var i=Array.prototype.slice.call(t),r=0;r<i.length;r++)si(i[r],e)}}function Oi(e){for(var t=e.firstChild,n=[];t;)!function e(t,n){var i,r,o,a,s;switch(t.nodeType){case 3:n.push(Si(t.textContent,Ci));break;case 1:if(n.push("<",t.tagName),t.hasAttributes())for(i=0,r=(o=t.attributes).length;i<r;++i)a=o.item(i),n.push(" ",a.name,'="',Si(a.value,Ei),'"');if(t.hasChildNodes()){for(n.push(">"),i=0,r=(s=t.childNodes).length;i<r;++i)e(s.item(i),n);n.push("</",t.tagName,">")}else n.push("/>");break;case 8:n.push("\x3c!--",Si(t.nodeValue,Ci),"--\x3e");break;case 4:n.push("<![CDATA[",t.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+t.nodeType)}}(t,n),t=t.nextSibling;return n.join("")}function Pi(e,t){var n,i,r;for(e.clear(),n=0;r=t[n];n++)e.appendItem((i=e,(r=r)instanceof SVGMatrix?i.createSVGTransformFromMatrix(r):r))}function Di(e,t){e=e.transform.baseVal;return t&&Pi(e,t=Array.isArray(t)?t:[t]),e.consolidate()}function Ri(e){return e.join(",").replace(/,?([A-z]),?/g,"$1")}function Ti(e){for(var t,n="",i=0;t=e[i];i++)n+=t.x+","+t.y+" ";return n}function Mi(e,t){var n=O("polyline");return S(n,{points:Ti(e)}),t&&S(n,t),n}function Ii(e){return re(e,function(t){return!ie(e,function(e){return e!==t&&function e(t,n){if(!n)return;if(t===n)return n;if(!t.parent)return;return e(t.parent,n)}(t,e)})})}function Ai(e,t,n){n=!n||-1===e.indexOf(t);return n&&e.push(t),n}function Ni(e,n,i){i=i||0,y(e=m(e)?e:[e],function(e,t){e=n(e,t,i);m(e)&&e.length&&Ni(e,n,i+1)})}function Bi(e,t){return i=!t,r=-1,o=[],a=[],Ni(e,function(e,t,n){Ai(o,e,i);e=e.children;if((-1===r||n<r)&&e&&Ai(a,e,i))return e}),o;var i,r,o,a}function Li(e,t,n){ee(t=Z(t)?!0:t)&&(n=t,t=!0);var i=Fi((n=n||{}).allShapes),r=Fi(n.allConnections),o=Fi(n.enclosedElements),a=Fi(n.enclosedConnections),s=Fi(n.topLevel,t&&de(e,function(e){return e.id}));function c(e){s[e.source.id]&&s[e.target.id]&&(s[e.id]=[e]),i[e.source.id]&&i[e.target.id]&&(a[e.id]=o[e.id]=e),r[e.id]=e}return Ni(e,function(e){if(!(o[e.id]=e).waypoints)return y((i[e.id]=e).incoming,c),y(e.outgoing,c),e.children;a[e.id]=r[e.id]=e}),{allShapes:i,allConnections:r,topLevel:s,enclosedConnections:a,enclosedElements:o}}function Vi(e,r){var o,a,s,c;return r=!!r,y(e=m(e)?e:[e],function(e){var t=e,e=(t=e.waypoints&&!r?Vi(e.waypoints,!0):t).x,n=t.y,i=t.height||0,t=t.width||0;(e<o||void 0===o)&&(o=e),(n<a||void 0===a)&&(a=n),(s<e+t||void 0===s)&&(s=e+t),(c<n+i||void 0===c)&&(c=n+i)}),{x:o,y:a,height:c-a,width:s-o}}function $i(e){return"waypoints"in e?"connection":"x"in e?"shape":"root"}function zi(e){return!(!e||!e.isFrame)}function Fi(e,t){return C({},e||{},t||{})}function Ui(e,t){ai.call(this,e,1),this.CONNECTION_STYLE=t.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=t.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=t.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}Yn(Ui,ai),Ui.prototype.canRender=function(){return!0},Ui.prototype.drawShape=function(e,t,n){var i=O("rect");return S(i,{x:0,y:0,width:t.width||0,height:t.height||0}),zi(t)?S(i,C({},this.FRAME_STYLE,n||{})):S(i,C({},this.SHAPE_STYLE,n||{})),w(e,i),i},Ui.prototype.drawConnection=function(e,t,n){t=Mi(t.waypoints,C({},this.CONNECTION_STYLE,n||{}));return w(e,t),t},Ui.prototype.getShapePath=function(e){var t=e.x,n=e.y,i=e.width;return Ri([["M",t,n],["l",i,0],["l",0,e.height],["l",-i,0],["z"]])},Ui.prototype.getConnectionPath=function(e){for(var t,n=e.waypoints,i=[],r=0;t=n[r];r++)t=t.original||t,i.push([0===r?"M":"L",t.x,t.y]);return Ri(i)},Ui.$inject=["eventBus","styles"];e={__init__:["defaultRenderer"],defaultRenderer:["type",Ui],styles:["type",function(){var n={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},i=this;this.cls=function(e,t,n){return C(this.style(t,n),{class:e})},this.style=function(e,t){m(e)||t||(t=e,e=[]);e=oe(e,function(e,t){return C(e,n[t]||{})},{});return t?C(e,t):e},this.computeStyle=function(e,t,n){return m(t)||(n=t,t=[]),i.style(t||[],C({},n,e||{}))}}]};function Hi(e,t){return e&&t?(-1!==(t=e.indexOf(t))&&e.splice(t,1),t):-1}function Wi(e,t,n){if(e&&t){"number"!=typeof n&&(n=-1);var i=e.indexOf(t);if(-1!==i){if(i===n)return;if(-1===n)return;e.splice(i,1)}-1!==n?e.splice(n,0,t):e.push(t)}}function qi(e,t){return e&&t?e.indexOf(t):-1}function Gi(e,t){return e&&t?Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)):-1}function Ki(e,t,n,i){if(void 0===i&&(i=5),e&&t&&n)return n=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),e=Gi(e,t),Math.abs(n/e)<=i}var Xi=2;function Yi(e,t){var n,i,r,o,e=m(e)?e:[e,t];return t=m(t=e)?t:[t,i],n=t.slice().shift(),ae(t,function(e){return Math.abs(n.y-e.y)<=Xi})?"h":(i=m(i=e)?i:[i,r],o=i.slice().shift(),!!ae(i,function(e){return Math.abs(o.x-e.x)<=Xi})&&"v")}function Zi(e,t){return{x:Math.round(e.x+(t.x-e.x)/2),y:Math.round(e.y+(t.y-e.y)/2)}}
/**
   * This file contains source code adapted from Snap.svg (licensed Apache-2.0).
   *
   * @see https://github.com/adobe-webplatform/Snap.svg/blob/master/src/path.js
   */var Qi=/,?([a-z]),?/gi,Ji=parseFloat,er=Math,tr=er.PI,nr=er.min,ir=er.max,rr=er.pow,or=er.abs,ar=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,sr=/(-?\d*\.?\d*(?:e[-+]?\d+)?)[\s]*,?[\s]*/gi,cr=Array.isArray||function(e){return e instanceof Array};function ur(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function lr(e){if("function"==typeof e||Object(e)!==e)return e;var t,n=new e.constructor;for(t in e)ur(e,t)&&(n[t]=lr(e[t]));return n}function dr(r){function o(){var e=Array.prototype.slice.call(arguments,0),t=e.join(""),n=o.cache=o.cache||{},i=o.count=o.count||[];return ur(n,t)?function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}(i,t):(1e3<=i.length&&delete n[i.shift()],i.push(t),n[t]=r.apply(0,e)),n[t]}return o}function pr(t){var n=pr.ps=pr.ps||{};return n[t]?n[t].sleep=100:n[t]={sleep:100},setTimeout(function(){for(var e in n)ur(n,e)&&e!=t&&(n[e].sleep--,n[e].sleep||delete n[e])}),n[t]}function hr(e,t,n,i){return 1===arguments.length&&(t=e.y,n=e.width,i=e.height,e=e.x),{x:e,y:t,width:n,height:i,x2:e+n,y2:t+i}}function fr(){return this.join(",").replace(Qi,"$1")}function mr(e){e=lr(e);return e.toString=fr,e}function gr(e,t,n,i,r,o,a,s,c){var u=1-c,l=rr(u,3),d=rr(u,2),p=c*c*c,t=l*t+3*d*c*i+3*u*c*c*o+p*s;return{x:xr(l*e+3*d*c*n+3*u*c*c*r+p*a),y:xr(t)}}function vr(e){e=function(e,t,n,i,r,o,a,s){for(var c,u,l,d,p,h=[],f=[[],[]],m=0;m<2;++m)d=0==m?(u=6*e-12*n+6*r,c=-3*e+9*n-9*r+3*a,3*n-3*e):(u=6*t-12*i+6*o,c=-3*t+9*i-9*o+3*s,3*i-3*t),or(c)<1e-12?or(u)<1e-12||0<(l=-d/u)&&l<1&&h.push(l):(d=u*u-4*d*c,p=er.sqrt(d),d<0||(0<(d=(-u+p)/(2*c))&&d<1&&h.push(d),0<(d=(-u-p)/(2*c))&&d<1&&h.push(d)));var g,v=h.length,y=v;for(;v--;)g=1-(l=h[v]),f[0][v]=g*g*g*e+3*g*g*l*n+3*g*l*l*r+l*l*l*a,f[1][v]=g*g*g*t+3*g*g*l*i+3*g*l*l*o+l*l*l*s;return f[0][y]=e,f[1][y]=t,f[0][y+1]=a,f[1][y+1]=s,f[0].length=f[1].length=y+2,{x0:nr.apply(0,f[0]),y0:nr.apply(0,f[1]),x1:ir.apply(0,f[0]),y1:ir.apply(0,f[1])}}.apply(null,e);return hr(e.x0,e.y0,e.x1-e.x0,e.y1-e.y0)}function yr(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function _r(e,t,n,i,r){return e*(e*(-3*t+9*n-9*i+3*r)+6*t-12*n+6*i)-3*t+3*n}function br(e,t,n,i,r,o,a,s,c){for(var u=(c=1<(c=null==c?1:c)?1:c<0?0:c)/2,l=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],d=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0,h=0;h<12;h++){var f=u*l[h]+u,m=_r(f,e,n,r,a),f=_r(f,t,i,o,s);p+=d[h]*er.sqrt(m*m+f*f)}return u*p}function xr(e){return Math.round(1e11*e)/1e11}function wr(e,t,n){var i=vr(e),r=vr(t);if(r=r,i=hr(i=i),!(yr(r=hr(r),i.x,i.y)||yr(r,i.x2,i.y)||yr(r,i.x,i.y2)||yr(r,i.x2,i.y2)||yr(i,r.x,r.y)||yr(i,r.x2,r.y)||yr(i,r.x,r.y2)||yr(i,r.x2,r.y2)||(i.x<r.x2&&i.x>r.x||r.x<i.x2&&r.x>i.x)&&(i.y<r.y2&&i.y>r.y||r.y<i.y2&&r.y>i.y)))return n?0:[];for(var r=br.apply(0,e),i=br.apply(0,t),o=!Er(e)&&~~(r/5)||1,a=!Er(t)&&~~(i/5)||1,s=[],c=[],u={},l=n?0:[],d=0;d<o+1;d++){var p=gr.apply(0,e.concat(d/o));s.push({x:p.x,y:p.y,t:d/o})}for(d=0;d<a+1;d++)p=gr.apply(0,t.concat(d/a)),c.push({x:p.x,y:p.y,t:d/a});for(d=0;d<o;d++)for(var h=0;h<a;h++){var f,m=s[d],g=s[d+1],v=c[h],y=c[h+1],_=or(g.x-m.x)<.01?"y":"x",b=or(y.x-v.x)<.01?"y":"x",x=function(e,t,n,i,r,o,a,s){if(!(ir(e,n)<nr(r,a)||nr(e,n)>ir(r,a)||ir(t,i)<nr(o,s)||nr(t,i)>ir(o,s))){var c=(e*i-t*n)*(r-a)-(e-n)*(r*s-o*a),u=(e*i-t*n)*(o-s)-(t-i)*(r*s-o*a),l=(e-n)*(o-s)-(t-i)*(r-a);if(l){var c=xr(c/l),u=xr(u/l),l=+c.toFixed(2),d=+u.toFixed(2);if(!(l<+nr(e,n).toFixed(2)||l>+ir(e,n).toFixed(2)||l<+nr(r,a).toFixed(2)||l>+ir(r,a).toFixed(2)||d<+nr(t,i).toFixed(2)||d>+ir(t,i).toFixed(2)||d<+nr(o,s).toFixed(2)||d>+ir(o,s).toFixed(2)))return{x:c,y:u}}}}(m.x,m.y,g.x,g.y,v.x,v.y,y.x,y.y);x&&!u[f=x.x.toFixed(9)+"#"+x.y.toFixed(9)]&&(u[f]=!0,f=m.t+or((x[_]-m[_])/(g[_]-m[_]))*(g.t-m.t),_=v.t+or((x[b]-v[b])/(y[b]-v[b]))*(y.t-v.t),0<=f)&&f<=1&&0<=_&&_<=1&&(n?l++:l.push({x:x.x,y:x.y,t1:f,t2:_}))}return l}function Cr(e){var t,o,a,n=pr(e);if(n.abs)return mr(n.abs);if(!(e=cr(e)&&cr(e&&e[0])?e:(d=e)?(t=pr(d)).arr?lr(t.arr):(o={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},a=[],(a=cr(d)&&cr(d[0])?lr(d):a).length||String(d).replace(ar,function(e,t,n){var i=[],r=t.toLowerCase();for(n.replace(sr,function(e,t){t&&i.push(+t)}),"m"==r&&2<i.length&&(a.push([t].concat(i.splice(0,2))),r="l",t="m"==t?"l":"L");o[r]<=i.length&&(a.push([t].concat(i.splice(0,o[r]))),o[r]););}),a.toString=pr.toString,t.arr=lr(a),a):null)||!e.length)return[["M",0,0]];var i,r=[],s=0,c=0,u=0,l=0,d=0;"M"==e[0][0]&&(u=s=+e[0][1],l=c=+e[0][2],d++,r[0]=["M",s,c]);for(var p,h,f=d,m=e.length;f<m;f++){if(r.push(p=[]),(i=(h=e[f])[0])!=i.toUpperCase())switch(p[0]=i.toUpperCase(),p[0]){case"A":p[1]=h[1],p[2]=h[2],p[3]=h[3],p[4]=h[4],p[5]=h[5],p[6]=+h[6]+s,p[7]=+h[7]+c;break;case"V":p[1]=+h[1]+c;break;case"H":p[1]=+h[1]+s;break;case"M":u=+h[1]+s,l=+h[2]+c;default:for(var g=1,v=h.length;g<v;g++)p[g]=+h[g]+(g%2?s:c)}else for(var y=0,_=h.length;y<_;y++)p[y]=h[y];switch(i=i.toUpperCase(),p[0]){case"Z":s=+u,c=+l;break;case"H":s=p[1];break;case"V":c=p[1];break;case"M":u=p[p.length-2],l=p[p.length-1];default:s=p[p.length-2],c=p[p.length-1]}}return r.toString=fr,n.abs=mr(r),r}function Er(e){return e[0]===e[2]&&e[1]===e[3]&&e[4]===e[6]&&e[5]===e[7]}function kr(e,t,n,i){return[e,t,n,i,n,i]}function Sr(e,t,n,i,r,o){return[1/3*e+2/3*n,1/3*t+2/3*i,1/3*r+2/3*n,1/3*o+2/3*i,r,o]}function jr(e,t,n,i,r,o,a,s,c,u){var l=120*tr/180,d=tr/180*(+r||0),p=[],h=dr(function(e,t,n){return{x:e*er.cos(n)-t*er.sin(n),y:e*er.sin(n)+t*er.cos(n)}}),o=(u?(_=u[0],b=u[1],v=u[2],y=u[3]):(e=(g=h(e,t,-d)).x,t=g.y,1<(f=(m=(e-(s=(g=h(s,c,-d)).x))/2)*m/(n*n)+(g=(t-(c=g.y))/2)*g/(i*i))&&(n*=f=er.sqrt(f),i*=f),v=(f=(o==a?-1:1)*er.sqrt(or(((f=n*n)*(o=i*i)-f*g*g-o*m*m)/(f*g*g+o*m*m))))*n*g/i+(e+s)/2,_=er.asin(((t-(y=f*-i*m/n+(t+c)/2))/i).toFixed(9)),b=er.asin(((c-y)/i).toFixed(9)),(_=e<v?tr-_:_)<0&&(_=2*tr+_),(b=s<v?tr-b:b)<0&&(b=2*tr+b),a&&b<_&&(_-=2*tr),!a&&_<b&&(b-=2*tr)),b-_),l=(or(o)>l&&(g=b,f=s,m=c,p=jr(s=v+n*er.cos(b=_+l*(a&&_<b?1:-1)),c=y+i*er.sin(b),n,i,r,0,a,f,m,[b,g,v,y])),o=b-_,er.cos(_)),r=er.sin(_),a=er.cos(b),f=er.sin(b),m=er.tan(o/4),g=4/3*n*m,v=4/3*i*m,y=[e,t],_=[e+g*r,t-v*l],b=[s+g*f,c-v*a],o=[s,c];if(_[0]=2*y[0]-_[0],_[1]=2*y[1]-_[1],u)return[_,b,o].concat(p);for(var x=[],w=0,C=(p=[_,b,o].concat(p).join().split(",")).length;w<C;w++)x[w]=w%2?h(p[w-1],p[w],d).y:h(p[w],p[w+1],d).x;return x}function Or(e){var t=pr(e);if(t.curve)return mr(t.curve);for(var n=Cr(e),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},r=[],o="",a="",s=0,c=n.length;s<c;s++){"C"!=(o=n[s]?n[s][0]:o)&&(r[s]=o,s)&&(a=r[s-1]),n[s]=function(e,t,n){var i,r;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(e[0]in{T:1,Q:1}||(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(jr.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":r="C"==n||"S"==n?(i=2*t.x-t.bx,2*t.y-t.by):(i=t.x,t.y),e=["C",i,r].concat(e.slice(1));break;case"T":"Q"==n||"T"==n?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(Sr(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(Sr(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(kr(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(kr(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(kr(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(kr(t.x,t.y,t.X,t.Y))}return e}(n[s],i,a),"A"!=r[s]&&"C"==o&&(r[s]="C"),d=void 0;var u=n,l=s;if(7<u[l].length){u[l].shift();for(var d=u[l];d.length;)r[l]="A",u.splice(l++,0,["C"].concat(d.splice(0,6)));u.splice(l,1),c=n.length}var p=n[s],h=p.length;i.x=p[h-2],i.y=p[h-1],i.bx=Ji(p[h-4])||i.x,i.by=Ji(p[h-3])||i.y}return t.curve=mr(n),n}var Pr=function(e,t,n){e=Or(e),t=Or(t);for(var i,r,o,a,s,c,u,l,d=n?0:[],p=0,h=e.length;p<h;p++){var f=e[p];if("M"==f[0])i=o=f[1],m=a=f[2];else for(var m="C"==f[0]?(i=(u=[i,m].concat(f.slice(1)))[6],u[7]):(u=[i,m,i,m,o,a,o,a],i=o,a),g=0,v=t.length;g<v;g++){var y=t[g];if("M"==y[0])r=s=y[1],_=c=y[2];else{var _="C"==y[0]?(r=(l=[r,_].concat(y.slice(1)))[6],l[7]):(l=[r,_,r,_,s,c,s,c],r=s,c),b=wr(u,l,n);if(n)d+=b;else{for(var x=0,w=b.length;x<w;x++)b[x].segment1=p,b[x].segment2=g,b[x].bez1=u,b[x].bez2=l;d=d.concat(b)}}}}return d};function Dr(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function P(e){return{top:e.y,right:e.x+(e.width||0),bottom:e.y+(e.height||0),left:e.x}}function Rr(e){return{x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top}}function Tr(e){for(var a=e.waypoints,t=a.reduce(function(e,t,n){var i,r,o,n=a[n-1];return n&&(i=(i=e[e.length-1])&&i.endLength||0,r=n,o=t,r=Math.sqrt(Math.pow(r.x-o.x,2)+Math.pow(r.y-o.y,2)),e.push({start:n,end:t,startLength:i,endLength:i+r,length:r})),e},[]),n=t.reduce(function(e,t){return e+t.length},0)/2,i=0,r=t[i];r.endLength<n;)r=t[++i];e=(n-r.startLength)/r.length;return{x:r.start.x+(r.end.x-r.start.x)*e,y:r.start.y+(r.end.y-r.start.y)*e}}function D(e){return e.waypoints?Tr(e):Dr({x:e.x+(e.width||0)/2,y:e.y+(e.height||0)/2})}function Mr(e,t,n){ee(n=n||0)||(n={x:n,y:n});var e=P(e),t=P(t),i=e.bottom+n.y<=t.top,r=e.left-n.x>=t.right,o=e.top-n.y>=t.bottom,i=i?"top":o?"bottom":null,o=e.right+n.x<=t.left?"left":r?"right":null;return o&&i?i+"-"+o:o||i||"intersect"}function Ir(e,t,n){e=Pr(e,t);return 1===e.length||2===e.length&&Gi(e[0],e[1])<1?Dr(e[0]):1<e.length?Dr((e=pe(e,function(e){var t=Math.floor(100*e.t2)||1;return e.segment2+"#"+(((t=100-t)<10?"0":"")+t)}))[n?0:e.length-1]):null}function Ar(e,t){return Math.round(e*t)/t}function Nr(e){return g(e)?e+"px":e}function Br(e,t,n){var i=O("g"),t=(j(i).add(t),void 0!==n?n:e.childNodes.length-1);return e.insertBefore(i,e.childNodes[t]||null),i}var Lr={shape:["x","y","width","height"],connection:["waypoints"]};function t(e,t,n,i){this._eventBus=t,this._elementRegistry=i,this._graphicsFactory=n,this._rootsIdx=0,this._layers={},this._planes=[],this._rootElement=null,this._init(e||{})}function Vr(e,t){t="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",t)}t.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],t.prototype._init=function(e){var t,n,i=this._eventBus,r=this._container=(t=(r=C({},{width:"100%",height:"100%"},r=e)).container||document.body,(n=document.createElement("div")).setAttribute("class","djs-container djs-parent"),vn(n,{position:"relative",overflow:"hidden",width:Nr(r.width),height:Nr(r.height)}),t.appendChild(n),n),o=this._svg=O("svg"),a=(S(o,{width:"100%",height:"100%"}),w(r,o),this._viewport=Br(o,"viewport"));!1!==e.deferUpdate&&(this._viewboxChanged=ve(ye(this._viewboxChanged,this),300)),i.on("diagram.init",function(){i.fire("canvas.init",{svg:o,viewport:a})},this),i.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed","root.set"],function(){delete this._cachedViewbox},this),i.on("diagram.destroy",500,this._destroy,this),i.on("diagram.clear",500,this._clear,this)},t.prototype._destroy=function(e){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var t=this._container.parentNode;t&&t.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._planes,delete this._rootElement,delete this._viewport},t.prototype._clear=function(){var n=this;this._elementRegistry.getAll().forEach(function(e){var t=$i(e);"root"===t?n.removeRootElement(e):n._removeElement(e,t)}),this._planes=[],this._rootElement=null,delete this._cachedViewbox},t.prototype.getDefaultLayer=function(){return this.getLayer("base",0)},t.prototype.getLayer=function(e,t){if(!e)throw new Error("must specify a name");var n=(n=this._layers[e])||(this._layers[e]=this._createLayer(e,t));if(void 0!==t&&n.index!==t)throw new Error("layer <"+e+"> already created at index <"+t+">");return n.group},t.prototype._getChildIndex=function(n){return oe(this._layers,function(e,t){return t.visible&&n>=t.index&&e++,e},0)},t.prototype._createLayer=function(e,t){var n=this._getChildIndex(t=void 0===t?1:t);return{group:Br(this._viewport,"layer-"+e,n),index:t,visible:!0}},t.prototype.showLayer=function(e){if(!e)throw new Error("must specify a name");var t,n,i,r=this._layers[e];if(r)return t=this._viewport,n=r.group,i=r.index,r.visible||(i=this._getChildIndex(i),t.insertBefore(n,t.childNodes[i]||null),r.visible=!0),n;throw new Error("layer <"+e+"> does not exist")},t.prototype.hideLayer=function(e){if(!e)throw new Error("must specify a name");var t,n=this._layers[e];if(n)return t=n.group,n.visible&&(hi(t),n.visible=!1),t;throw new Error("layer <"+e+"> does not exist")},t.prototype._removeLayer=function(e){var t=this._layers[e];t&&(delete this._layers[e],hi(t.group))},t.prototype.getActiveLayer=function(){var e=this._findPlaneForRoot(this.getRootElement());return e?e.layer:null},t.prototype.findRoot=function(e){if(e="string"==typeof e?this._elementRegistry.get(e):e)return(this._findPlaneForRoot(function(e){for(;e.parent;)e=e.parent;return e}(e))||{}).rootElement},t.prototype.getRootElements=function(){return this._planes.map(function(e){return e.rootElement})},t.prototype._findPlaneForRoot=function(t){return ie(this._planes,function(e){return e.rootElement===t})},t.prototype.getContainer=function(){return this._container},t.prototype._updateMarker=function(e,t,n){var i;e.id||(e=this._elementRegistry.get(e)),(i=this._elementRegistry._elements[e.id])&&(y([i.gfx,i.secondaryGfx],function(e){e&&(n?j(e).add(t):j(e).remove(t))}),this._eventBus.fire("element.marker.update",{element:e,gfx:i.gfx,marker:t,add:!!n}))},t.prototype.addMarker=function(e,t){this._updateMarker(e,t,!0)},t.prototype.removeMarker=function(e,t){this._updateMarker(e,t,!1)},t.prototype.hasMarker=function(e,t){return e.id||(e=this._elementRegistry.get(e)),j(this.getGraphics(e)).has(t)},t.prototype.toggleMarker=function(e,t){this.hasMarker(e,t)?this.removeMarker(e,t):this.addMarker(e,t)},t.prototype.getRootElement=function(){var e=this._rootElement;return e||this._planes.length?e:this.setRootElement(this.addRootElement(null))},t.prototype.addRootElement=function(e){var t=this._rootsIdx++,t=(e=e||{id:"__implicitroot_"+t,children:[],isImplicit:!0}).layer="root-"+t,n=(this._ensureValid("root",e),this.getLayer(t,0));return this.hideLayer(t),this._addRoot(e,n),this._planes.push({rootElement:e,layer:n}),e},t.prototype.removeRootElement=function(t){if("string"==typeof t&&(t=this._elementRegistry.get(t)),this._findPlaneForRoot(t))return this._removeRoot(t),this._removeLayer(t.layer),this._planes=this._planes.filter(function(e){return e.rootElement!==t}),this._rootElement===t&&(this._rootElement=null),t},t.prototype.setRootElement=function(e,t){if(Q(t))throw new Error("override not supported");if(e!==this._rootElement){if(e)return this._findPlaneForRoot(e)||(e=this.addRootElement(e)),this._setRoot(e),e;throw new Error("rootElement required")}},t.prototype._removeRoot=function(e){var t=this._elementRegistry,n=this._eventBus;n.fire("root.remove",{element:e}),n.fire("root.removed",{element:e}),t.remove(e)},t.prototype._addRoot=function(e,t){var n=this._elementRegistry,i=this._eventBus;i.fire("root.add",{element:e}),n.add(e,t),i.fire("root.added",{element:e,gfx:t})},t.prototype._setRoot=function(e,t){var n=this._rootElement;n&&(this._elementRegistry.updateGraphics(n,null,!0),this.hideLayer(n.layer)),e&&(t=t||this._findPlaneForRoot(e).layer,this._elementRegistry.updateGraphics(e,this._svg,!0),this.showLayer(e.layer)),this._rootElement=e,this._eventBus.fire("root.set",{element:e})},t.prototype._ensureValid=function(e,t){if(!t.id)throw new Error("element must have an id");if(this._elementRegistry.get(t.id))throw new Error("element <"+t.id+"> already exists");var n=Lr[e];if(!ae(n,function(e){return void 0!==t[e]}))throw new Error("must supply { "+n.join(", ")+" } with "+e)},t.prototype._setParent=function(e,t,n){Wi(t.children,e,n),e.parent=t},t.prototype._addElement=function(e,t,n,i){n=n||this.getRootElement();var r=this._eventBus,o=this._graphicsFactory,n=(this._ensureValid(e,t),r.fire(e+".add",{element:t,parent:n}),this._setParent(t,n,i),o.create(e,t,i));return this._elementRegistry.add(t,n),o.update(e,t,n),r.fire(e+".added",{element:t,gfx:n}),t},t.prototype.addShape=function(e,t,n){return this._addElement("shape",e,t,n)},t.prototype.addConnection=function(e,t,n){return this._addElement("connection",e,t,n)},t.prototype._removeElement=function(e,t){var n=this._elementRegistry,i=this._graphicsFactory,r=this._eventBus;if(e=n.get(e.id||e))return r.fire(t+".remove",{element:e}),i.remove(e),Hi(e.parent&&e.parent.children,e),e.parent=null,r.fire(t+".removed",{element:e}),n.remove(e),e},t.prototype.removeShape=function(e){return this._removeElement(e,"shape")},t.prototype.removeConnection=function(e){return this._removeElement(e,"connection")},t.prototype.getGraphics=function(e,t){return this._elementRegistry.getGraphics(e,t)},t.prototype._changeViewbox=function(e){this._eventBus.fire("canvas.viewbox.changing"),e.apply(this),this._cachedViewbox=null,this._viewboxChanged()},t.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},t.prototype.viewbox=function(t){var n,i,e,r,o,a;return void 0===t&&this._cachedViewbox?this._cachedViewbox:(n=this._viewport,i=this.getSize(),t?(this._changeViewbox(function(){r=Math.min(i.width/t.width,i.height/t.height);var e=this._svg.createSVGMatrix().scale(r).translate(-t.x,-t.y);Di(n,e)}),t):(e=(e=this._rootElement?this.getActiveLayer():null)&&e.getBBox()||{},a=(a=Di(n))?a.matrix:function(e,t,n,i,r,o){var a=bi().createSVGMatrix();switch(arguments.length){case 0:return a;case 1:return xi(a,e);case 6:return xi(a,{a:e,b:t,c:n,d:i,e:r,f:o})}}(),r=Ar(a.a,1e3),o=Ar(-a.e||0,1e3),a=Ar(-a.f||0,1e3),t=this._cachedViewbox={x:o?o/r:0,y:a?a/r:0,width:i.width/r,height:i.height/r,scale:r,inner:{width:e.width||0,height:e.height||0,x:e.x||0,y:e.y||0},outer:i}))},t.prototype.scroll=function(e){var t=this._viewport,n=t.getCTM();return e&&this._changeViewbox(function(){e=C({dx:0,dy:0},e||{}),n=this._svg.createSVGMatrix().translate(e.dx,e.dy).multiply(n),Vr(t,n)}),{x:n.e,y:n.f}},t.prototype.scrollToElement=function(e,t){var n,i,r,o=100,a=("string"==typeof e&&(e=this._elementRegistry.get(e)),this.findRoot(e)),a=(a!==this.getRootElement()&&this.setRootElement(a),"number"==typeof(t=t||{})&&(o=t),t={top:t.top||o,right:t.right||o,bottom:t.bottom||o,left:t.left||o},Vi(e)),o=P(a),e=this.viewbox(),s=this.zoom(),t=(e.y+=t.top/s,e.x+=t.left/s,e.width-=(t.right+t.left)/s,e.height-=(t.bottom+t.top)/s,P(e));t=a.width<e.width&&a.height<e.height?(r=Math.max(0,o.right-t.right),n=Math.min(0,o.left-t.left),i=Math.max(0,o.bottom-t.bottom),o=Math.min(0,o.top-t.top),r=r||n,i||o):(r=a.x-e.x,a.y-e.y),this.scroll({dx:-r*s,dy:-t*s})},t.prototype.zoom=function(e,t){var n,i;return e?"fit-viewport"===e?this._fitViewport(t):(this._changeViewbox(function(){"object"!==Fe(t)&&(n=this.viewbox().outer,t={x:n.width/2,y:n.height/2}),i=this._setZoom(e,t)}),Ar(i.a,1e3)):this.viewbox(e).scale},t.prototype._fitViewport=function(e){var t,n=this.viewbox(),i=n.outer,n=n.inner,e=0<=n.x&&0<=n.y&&n.x+n.width<=i.width&&n.y+n.height<=i.height&&!e?{x:0,y:0,width:Math.max(n.width+n.x,i.width),height:Math.max(n.height+n.y,i.height)}:(t=Math.min(1,i.width/n.width,i.height/n.height),{x:n.x+(e?n.width/2-i.width/t/2:0),y:n.y+(e?n.height/2-i.height/t/2:0),width:i.width/t,height:i.height/t});return this.viewbox(e),this.viewbox(!1).scale},t.prototype._setZoom=function(e,t){var n=this._svg,i=this._viewport,r=n.createSVGMatrix(),n=n.createSVGPoint(),i=i.getCTM(),o=i.a,o=t?(n=C(n,t).matrixTransform(i.inverse()),t=r.translate(n.x,n.y).scale(1/o*e).translate(-n.x,-n.y),i.multiply(t)):r.scale(e);return Vr(this._viewport,o),o},t.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},t.prototype.getAbsoluteBBox=function(e){var t=this.viewbox();return{x:(e=e.waypoints?this.getGraphics(e).getBBox():e).x*t.scale-t.x*t.scale,y:e.y*t.scale-t.y*t.scale,width:e.width*t.scale,height:e.height*t.scale}},t.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var $r="data-element-id";function zr(e){this._elements={},this._eventBus=e}zr.$inject=["eventBus"],zr.prototype.add=function(e,t,n){var i=e.id;this._validateId(i),S(t,$r,i),n&&S(n,$r,i),this._elements[i]={element:e,gfx:t,secondaryGfx:n}},zr.prototype.remove=function(e){var t=this._elements,e=e.id||e,n=e&&t[e];n&&(S(n.gfx,$r,""),n.secondaryGfx&&S(n.secondaryGfx,$r,""),delete t[e])},zr.prototype.updateId=function(e,t){this._validateId(t),"string"==typeof e&&(e=this.get(e)),this._eventBus.fire("element.updateId",{element:e,newId:t});var n=this.getGraphics(e),i=this.getGraphics(e,!0);this.remove(e),e.id=t,this.add(e,n,i)},zr.prototype.updateGraphics=function(e,t,n){var e=e.id||e,i=this._elements[e];return n?i.secondaryGfx=t:i.gfx=t,t&&S(t,$r,e),t},zr.prototype.get=function(e){e="string"==typeof e?e:e&&S(e,$r),e=this._elements[e];return e&&e.element},zr.prototype.filter=function(n){var i=[];return this.forEach(function(e,t){n(e,t)&&i.push(e)}),i},zr.prototype.find=function(e){for(var t=this._elements,n=Object.keys(t),i=0;i<n.length;i++){var r=t[n[i]],o=r.element;if(e(o,r.gfx))return o}},zr.prototype.getAll=function(){return this.filter(function(e){return e})},zr.prototype.forEach=function(n){var i=this._elements;Object.keys(i).forEach(function(e){var e=i[e],t=e.element,e=e.gfx;return n(t,e)})},zr.prototype.getGraphics=function(e,t){e=e.id||e,e=this._elements[e];return e&&(t?e.secondaryGfx:e.gfx)},zr.prototype._validateId=function(e){if(!e)throw new Error("element must have an id");if(this._elements[e])throw new Error("element with id "+e+" already added")};var Fr={extend:function(e,i,t,r){var o=t.inverse;return Object.defineProperty(e,"remove",{value:function(e){var t=this.indexOf(e);return-1!==t&&(this.splice(t,1),i.unset(e,o,r)),e}}),Object.defineProperty(e,"contains",{value:function(e){return-1!==this.indexOf(e)}}),Object.defineProperty(e,"add",{value:function(e,t){var n=this.indexOf(e);if(void 0===t){if(-1!==n)return;t=this.length}-1!==n&&this.splice(n,1),this.splice(t,0,e),-1===n&&i.set(e,o,r)}}),Object.defineProperty(e,"__refs_collection",{value:!0}),e},isExtended:function(e){return!0===e.__refs_collection}};function Ur(t,n,i){var e=Fr.extend(i[n.name]||[],t,n,i);Object.defineProperty(i,n.name,{enumerable:n.enumerable,value:e}),e.length&&e.forEach(function(e){t.set(e,n.inverse,i)})}function Hr(e,t){if(!(this instanceof Hr))return new Hr(e,t);(e.inverse=t).inverse=e,this.props={},this.props[e.name]=e,this.props[t.name]=t}Hr.prototype.bind=function(e,t){if("string"==typeof t){if(!this.props[t])throw new Error("no property <"+t+"> in ref");t=this.props[t]}var n,i,r,o;t.collection?Ur(this,t,e):(n=this,i=e,r=(e=t).inverse,o=i[e.name],Object.defineProperty(i,e.name,{configurable:e.configurable,enumerable:e.enumerable,get:function(){return o},set:function(e){var t;e!==o&&(t=o,o=null,t&&n.unset(t,r,i),o=e,n.set(o,r,i))}}))},Hr.prototype.ensureRefsCollection=function(e,t){var n=e[t.name];return Fr.isExtended(n)||Ur(this,t,e),n},Hr.prototype.ensureBound=function(e,t){var n;n=t,Object.prototype.hasOwnProperty.call(e,n.name||n)||this.bind(e,t)},Hr.prototype.unset=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).remove(n):e[t.name]=void 0)},Hr.prototype.set=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).add(n):e[t.name]=n)};var Wr=Hr,qr=(Wr.Collection=Fr,new Wr({name:"children",enumerable:!0,collection:!0},{name:"parent"})),Gr=new Wr({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),Kr=new Wr({name:"attachers",collection:!0},{name:"host"}),Xr=new Wr({name:"outgoing",collection:!0},{name:"source"}),Yr=new Wr({name:"incoming",collection:!0},{name:"target"});function Zr(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(e){var t=this.label,n=this.labels;!e&&t?n.remove(t):n.add(e,0)}}),qr.bind(this,"parent"),Gr.bind(this,"labels"),Xr.bind(this,"outgoing"),Yr.bind(this,"incoming")}function Qr(){Zr.call(this),qr.bind(this,"children"),Kr.bind(this,"host"),Kr.bind(this,"attachers")}function Jr(){Qr.call(this)}function eo(){Qr.call(this),Gr.bind(this,"labelTarget")}function to(){Zr.call(this),Xr.bind(this,"source"),Yr.bind(this,"target")}Yn(Qr,Zr),Yn(Jr,Qr),Yn(eo,Qr),Yn(to,Zr);var no={connection:to,shape:Qr,label:eo,root:Jr};function io(){this._uid=12}function ro(e){return e.childNodes[0]}function oo(e,t,n){var i=wi();i.setTranslate(t,n),Di(e,i)}function ao(e,t){this._eventBus=e,this._elementRegistry=t}function so(e,t,n){n=n||t.firstChild;e!==n&&t.insertBefore(e,n)}io.prototype.createRoot=function(e){return this.create("root",e)},io.prototype.createLabel=function(e){return this.create("label",e)},io.prototype.createShape=function(e){return this.create("shape",e)},io.prototype.createConnection=function(e){return this.create("connection",e)},io.prototype.create=function(e,t){(t=C({},t||{})).id||(t.id=e+"_"+this._uid++);var n=no[e];if(n)return C(new n,t);throw new Error("unknown type: <"+e+">")},ao.$inject=["eventBus","elementRegistry"],ao.prototype._getChildrenContainer=function(e){var t,n=this._elementRegistry.getGraphics(e);return e.parent?(t=n.parentNode.childNodes[1])||(j(t=O("g")).add("djs-children"),w(n.parentNode,t)):t=n,t},ao.prototype._clear=function(e){e=ro(e);return xn(e),e},ao.prototype._createContainer=function(e,t,n,i){var r=O("g"),n=(j(r).add("djs-group"),void 0!==n?so(r,t,t.childNodes[n]):w(t,r),O("g")),t=(j(n).add("djs-element"),j(n).add("djs-"+e),i&&j(n).add("djs-frame"),w(r,n),O("g"));return j(t).add("djs-visual"),w(n,t),n},ao.prototype.create=function(e,t,n){var i=this._getChildrenContainer(t.parent);return this._createContainer(e,i,n,zi(t))},ao.prototype.updateContainments=function(e){var i=this,r=this._elementRegistry;y(oe(e,function(e,t){return t.parent&&(e[t.parent.id]=t.parent),e},{}),function(e){var t,n=e.children;n&&(t=i._getChildrenContainer(e),y(n.slice().reverse(),function(e){so(r.getGraphics(e).parentNode,t)}))})},ao.prototype.drawShape=function(e,t){return this._eventBus.fire("render.shape",{gfx:e,element:t})},ao.prototype.getShapePath=function(e){return this._eventBus.fire("render.getShapePath",e)},ao.prototype.drawConnection=function(e,t){return this._eventBus.fire("render.connection",{gfx:e,element:t})},ao.prototype.getConnectionPath=function(e){return this._eventBus.fire("render.getConnectionPath",e)},ao.prototype.update=function(e,t,n){if(t.parent){var i=this._clear(n);if("shape"===e)this.drawShape(i,t),oo(n,t.x,t.y);else{if("connection"!==e)throw new Error("unknown type: "+e);this.drawConnection(i,t)}t.hidden?S(n,"display","none"):S(n,"display","block")}},ao.prototype.remove=function(e){hi(this._elementRegistry.getGraphics(e).parentNode)};var co={__depends__:[e],__init__:["canvas"],canvas:["type",t],elementRegistry:["type",zr],elementFactory:["type",io],eventBus:["type",Ce],graphicsFactory:["type",ao]};function uo(e){var e=[{config:["value",e=e||{}]},co].concat(e.modules||[]);return(e=new oi(e=e)).init(),e}function lo(e,t){this.injector=t=t||uo(e),this.get=t.get,this.invoke=t.invoke,this.get("eventBus").fire("diagram.init")}lo.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},lo.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")};var po=new Wr({name:"dmnElementRef",enumerable:!0},{name:"di",configurable:!0});function ho(i,e){var r=[];function o(t){try{t.di&&function(e){if(e.gfx)throw new Error("already rendered "+e.id);i.element(e)}(t)}catch(e){n(e.message,{element:t,error:e})}}function a(e){var t;(t=(e=e).dmnElementRef)?t.di?n("multiple DI elements defined for element",{element:t}):(po.bind(t,"di"),t.di=e):n("no DMN element referenced in element",{element:e})}function s(e){r.push(e)}function n(e,t){i.error(e,t)}return{handleDefinitions:function(e,t){var n=e.dmnDI;if(!n)throw new Error("no dmndi:DMNDI");if(n=n.diagrams||[],t&&-1===n.indexOf(t))throw new Error("diagram not part of dmndi:DMNDI");if(!(t=!t&&n&&n.length?n[0]:t))throw new Error("no diagram to display");y((e.di=t).diagramElements,a),i.root(e),y(e.get("drgElement"),function(e){var t;o(e),t=e,y(["informationRequirement","knowledgeRequirement","authorityRequirement"],function(e){y(t[e],function(e){s(function(){o(e)})})})}),y(e.get("artifact"),function(e){var t;k(e,"dmn:Association")?(t=e,s(function(){o(t)})):o(e)}),y(r,function(e){e()})}}}function fo(e,t,n){var i,r=e.get("drdImporter"),e=e.get("eventBus"),o=[];e.fire("import.start",{definitions:t});try{new ho({root:function(e){return r.root(e)},element:function(e,t){return r.add(e,t)},error:function(e,t){o.push({message:e,context:t})}}).handleDefinitions(t)}catch(e){i=e}e.fire("import.done",{error:i,warnings:o}),n(i,o)}var mo=new Wn,go="hsl(225, 10%, 15%)";function vo(e,t,i,n,r,a){ai.call(this,t);var o=mo.next(),s=n.computeStyle,c={},u=e&&e.defaultFillColor||"white",l=e&&e.defaultStrokeColor||go,d=e&&e.defaultLabelColor;function p(e,t,n){var i,r,t=e+"-"+_o(t)+"-"+_o(n)+"-"+o;return c[t]||(i=t,n=n,"association-start"===(e=e)?(S(r=O("path"),{d:"M 11 5 L 1 10 L 11 15"}),h(i,{element:r,attrs:{fill:"none",stroke:n,strokeWidth:1.5},ref:{x:1,y:10},scale:.5})):"association-end"===e?(S(r=O("path"),{d:"M 1 5 L 11 10 L 1 15"}),h(i,{element:r,attrs:{fill:"none",stroke:n,strokeWidth:1.5},ref:{x:12,y:10},scale:.5})):"information-requirement-end"===e?(S(r=O("path"),{d:"M 1 5 L 11 10 L 1 15 Z"}),h(i,{element:r,attrs:{fill:n,stroke:"none"},ref:{x:11,y:10},scale:1})):"knowledge-requirement-end"===e?(S(r=O("path"),{d:"M 1 3 L 11 10 L 1 17"}),h(i,{element:r,attrs:{fill:"none",stroke:n,strokeWidth:2},ref:{x:11,y:10},scale:.8})):"authority-requirement-end"===e&&(S(r=O("circle"),{cx:3,cy:3,r:3}),h(i,{element:r,attrs:{fill:n,stroke:"none"},ref:{x:3,y:3},scale:.9}))),"url(#"+t+")"}function h(e,t){var n=C({strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},t.attrs),i=t.ref||{x:0,y:0},r=t.scale||1,o=("none"===n.strokeDasharray&&(n.strokeDasharray=[1e4,1]),O("marker")),n=(S(t.element,n),w(o,t.element),S(o,{id:e,viewBox:"0 0 20 20",refX:i.x,refY:i.y,markerWidth:20*r,markerHeight:20*r,orient:"auto"}),b("defs",a._svg));n||(n=O("defs"),w(a._svg,n)),w(n,o),c[e]=o}function f(e,t,n,i,r,o){ee(r)&&(o=r,r=0),r=r||0,o=s(o,{stroke:go,strokeWidth:2,fill:"white"});var a=O("rect");return S(a,{x:r,y:r,width:t-2*r,height:n-2*r,rx:i,ry:i}),S(a,o),w(e,a),a}function m(e,t,n){t=r.createText(t||"",n);return yn(t,"class","djs-label"),w(e,t),t}function g(e,t,n,i){m(e,Gn(t).name,i=C({box:t,align:n,padding:5,style:{fill:bo(0,d,l)}},i))}function v(e,t,n){n=s(n,["no-fill"],{strokeWidth:2,stroke:go});var i=O("path");return S(i,{d:t}),S(i,n),w(e,i),i}var y={"dmn:Decision":function(e,t){var n=f(e,t.width,t.height,0,{stroke:l,fill:u});return g(e,t,"center-middle"),n},"dmn:KnowledgeSource":function(e,t){var n=v(e,i.getScaledPath("KNOWLEDGE_SOURCE",{xScaleFactor:1.021,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:.075}}),{strokeWidth:2,fill:u,stroke:l});return g(e,t,"center-middle"),n},"dmn:BusinessKnowledgeModel":function(e,t){var n=v(e,i.getScaledPath("BUSINESS_KNOWLEDGE_MODEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:.3}}),{strokeWidth:2,fill:u,stroke:l});return g(e,t,"center-middle"),n},"dmn:InputData":function(e,t){var n=f(e,t.width,t.height,22,{stroke:l,fill:u});return g(e,t,"center-middle"),n},"dmn:TextAnnotation":function(e,t){var n=f(e,t.width,t.height,0,0,{fill:"none",stroke:"none"});return v(e,i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:0}}),{stroke:l}),m(e,yo(t).text||"",{style:{fill:bo(0,d,l)},box:t,align:"left-top",padding:5}),n},"dmn:Association":function(e,t){var n=yo(t),i=u,r=l,o={stroke:r,strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"};return"One"!==n.associationDirection&&"Both"!==n.associationDirection||(o.markerEnd=p("association-end",i,r)),"Both"===n.associationDirection&&(o.markerStart=p("association-start",i,r)),_(e,t.waypoints,o)},"dmn:InformationRequirement":function(e,t){var n={stroke:l,strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:p("information-requirement-end",u,l)};return _(e,t.waypoints,n)},"dmn:KnowledgeRequirement":function(e,t){var n={stroke:l,strokeWidth:1,strokeDasharray:5,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:p("knowledge-requirement-end",u,l)};return _(e,t.waypoints,n)},"dmn:AuthorityRequirement":function(e,t){var n={stroke:l,strokeWidth:1.5,strokeDasharray:5,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:p("authority-requirement-end",u,l)};return _(e,t.waypoints,n)}};function _(e,t,n){t=Mi(t,n=s(n,["no-fill"],{stroke:go,strokeWidth:2,fill:"none"}));return w(e,t),t}this.canRender=function(e){return k(e,"dmn:DMNElement")||k(e,"dmn:InformationRequirement")||k(e,"dmn:KnowledgeRequirement")||k(e,"dmn:AuthorityRequirement")},this.drawShape=function(e,t){var n=y[t.type];return n?n(e,t):ai.prototype.drawShape.apply(this,[e,t])},this.drawConnection=function(e,t){var n=t.type;return(n=y[n])?n(e,t):ai.prototype.drawConnection.apply(this,[e,t])}}function yo(e){return e.businessObject}function _o(e){return e.replace(/[^0-9a-zA-z]+/g,"_")}function bo(e,t,n){return t||n}Yn(vo,ai),vo.$inject=["config.drdRenderer","eventBus","pathMap","styles","textRenderer","canvas"];var xo={width:150,height:50};function wo(e,t,n){for(var i,r,o,a,s,c=e.shift(),u=c;;){if((s=function(e,t){var n;t.textContent=e;try{var i,r=""===e;return t.textContent=r?"dummy":e,i={width:(n=t.getBBox()).width+2*n.x,height:n.height},r&&(i.width=0),i}catch(e){return{width:0,height:0}}}(u,n)).width=u?s.width:0," "===u||""===u||s.width<Math.round(t)||u.length<2)return i=e,o=c,a=s,(r=u).length<o.length&&(o=o.slice(r.length).trim(),i.unshift(o)),{width:a.width,height:a.height,text:r};u=function(e,t,n){n=Math.max(e.length*(n/t),1),t=function(e,t){var n,i=e.split(/(\s|-|\u00AD)/g),r=[],o=0;if(1<i.length)for(;n=i.shift();){if(!(n.length+o<t)){"-"!==n&&n!==Co||r.pop();break}r.push(n),o+=n.length}e=r[r.length-1];e&&e===Co&&(r[r.length-1]="-");return r.join("")}(e,n);t=t||e.slice(0,Math.max(Math.round(n-1),1));return t}(u,s.width,t)}}var Co="";function Eo(e){this._config=C({},{size:xo,padding:0,style:{},align:"center-top"},e||{})}Eo.prototype.createText=function(e,t){return this.layoutText(e,t).element},Eo.prototype.getDimensions=function(e,t){return this.layoutText(e,t).dimensions},Eo.prototype.layoutText=function(e,t){var n,i=C({},this._config.size,t.box),r=C({},this._config.style,t.style),o={horizontal:(n=(n=t.align||this._config.align).split("-"))[0]||"center",vertical:n[1]||"top"},a=ee(n=(void 0!==t.padding?t:this._config).padding)?C({top:0,left:0,right:0,bottom:0},n):{top:n,left:n,right:n,bottom:n},s=t.fitBox||!1,c=function(e){if("fontSize"in e&&"lineHeight"in e)return e.lineHeight*parseInt(e.fontSize,10)}(r),u=e.split(/\u00AD?\r?\n/),l=[],d=i.width-a.left-a.right,p=O("text");for(S(p,{x:0,y:0}),S(p,r),(n=document.getElementById("helper-svg"))||(S(n=O("svg"),{id:"helper-svg"}),vn(n,{visibility:"hidden",position:"fixed",width:0,height:0}),document.body.appendChild(n)),w(n,p);u.length;)l.push(wo(u,d,p));"middle"===o.vertical&&(a.top=a.bottom=0);var t=oe(l,function(e,t,n){return e+(c||t.height)},0)+a.top+a.bottom,h=oe(l,function(e,t,n){return t.width>e?t.width:e},0),f=a.top,m=("middle"===o.vertical&&(f+=(i.height-t)/2),f-=(c||l[0].height)/4,O("text"));return S(m,r),y(l,function(e){var t;switch(f+=c||e.height,o.horizontal){case"left":t=a.left;break;case"right":t=(s?h:d)-a.right-e.width;break;default:t=Math.max(((s?h:d)-e.width)/2+a.left,0)}var n=O("tspan");S(n,{x:t,y:f}),n.textContent=e.text,w(m,n)}),hi(p),{dimensions:{width:h,height:t},element:m}};function ko(e){var n=C({fontFamily:"Arial, sans-serif",fontSize:12,fontWeight:"normal",lineHeight:1.2},e&&e.defaultStyle||{}),t=parseInt(n.fontSize,10)-1,i=C({},n,{fontSize:t},e&&e.externalStyle||{}),r=new Eo({style:n});this.getExternalLabelBounds=function(e,t){t=r.getDimensions(t,{box:{width:90,height:30,x:e.width/2+e.x,y:e.height/2+e.y},style:i});return{x:Math.round(e.x+e.width/2-t.width/2),y:Math.round(e.y),width:Math.ceil(t.width),height:Math.ceil(t.height)}},this.getTextAnnotationBounds=function(e,t){t=r.getDimensions(t,{box:e,style:n,align:"left-top",padding:5});return{x:e.x,y:e.y,width:e.width,height:Math.max(30,Math.round(t.height))}},this.createText=function(e,t){return r.createText(e,t||{})},this.getDefaultStyle=function(){return n},this.getExternalStyle=function(){return i}}ko.$inject=["config.textRenderer"];var So=/\{([^{}]+)\}/g,jo=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;e={__init__:["drdRenderer"],drdRenderer:["type",vo],textRenderer:["type",ko],pathMap:["type",function(){this.pathMap={KNOWLEDGE_SOURCE:{d:"m {mx},{my} l 0,{e.y0} c {e.x0},{e.y1} {e.x1},-{e.y2} {e.x2},-{e.y3} c {e.x3},-{e.y4} {e.x4},{e.y5} {e.x5},{e.y6} l 0,-{e.y7}z",width:100,height:65,widthElements:[29.8,48.4,67.2,12.2,19.8,30.8],heightElements:[55.3,19.7,4.2,6.7,2.3,1.6,6.2,54.6]},BUSINESS_KNOWLEDGE_MODEL:{d:"m {mx},{my} l {e.x0},-{e.y0} l {e.x1},0 l 0,{e.y1} l -{e.x2},{e.y2} l -{e.x3},0z",width:125,height:45,widthElements:[13.8,109.2,13.8,109.1],heightElements:[13.2,29.8,13.2]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",width:10,height:30,widthElements:[10],heightElements:[30]}},this.getRawPath=function(e){return this.pathMap[e].d},this.getScaledPath=function(e,t){var n,i,r=this.pathMap[e],e=t.abspos?(n=t.abspos.x,t.abspos.y):(n=t.containerWidth*t.position.mx,t.containerHeight*t.position.my),o={};if(t.position){for(var a=t.containerHeight/r.height*t.yScaleFactor,s=t.containerWidth/r.width*t.xScaleFactor,c=0;c<r.heightElements.length;c++)o["y"+c]=r.heightElements[c]*a;for(var u=0;u<r.widthElements.length;u++)o["x"+u]=r.widthElements[u]*s}return t=r.d,i={mx:n,my:e,e:o},String(t).replace(So,function(e,t){return e=e,o=n=i,t.replace(jo,function(e,t,n,i,r){t=t||i,o&&"function"==typeof(o=t in o?o[t]:o)&&r&&(o=o())}),o=(null==o||o==n?e:o)+"";var n,o})}}]};function Oo(e,t,n,i){this._eventBus=e,this._canvas=t,this._elementRegistry=i,this._elementFactory=n}function Po(e,t){return C({id:e.id,type:e.$type,businessObject:e},t)}function Do(e){return e.split("#").pop()}Oo.$inject=["eventBus","canvas","elementFactory","elementRegistry"],Oo.prototype.root=function(e){e=this._elementFactory.createRoot(Po(e));return this._canvas.setRootElement(e),e},Oo.prototype.add=function(e){var t,n,i,r,o,a=this._elementFactory,s=this._canvas,c=this._eventBus,u=e.di;if(u.$instanceOf("dmndi:DMNShape"))o=u.bounds,o=Po(e,{x:Math.round(o.x),y:Math.round(o.y),width:Math.round(o.width),height:Math.round(o.height)}),t=a.createShape(o),s.addShape(t),c.fire("drdElement.added",{element:t,di:u});else{if(!u.$instanceOf("dmndi:DMNEdge"))throw new Error("unknown di for element "+e.id);n=function(e){e=e.waypoint;if(e)return ce(e,function(e){e={x:e.x,y:e.y};return C({original:e},e)})}(u),i=this._getSource(e),r=this._getTarget(e),i&&r&&(o=Po(e,{hidden:!1,source:i,target:r,waypoints:n}),t=a.createConnection(o),s.addConnection(t),c.fire("drdElement.added",{element:t,di:u}))}return t},Oo.prototype._getSource=function(e){var t,n;if(k(e,"dmn:Association")?n=e.sourceRef:k(e,"dmn:InformationRequirement")?n=e.requiredDecision||e.requiredInput:k(e,"dmn:KnowledgeRequirement")?n=e.requiredKnowledge:k(e,"dmn:AuthorityRequirement")&&(n=e.requiredDecision||e.requiredInput||e.requiredAuthority),t=n?n.href:t)return this._getShape(Do(t))},Oo.prototype._getTarget=function(e){return k(e,"dmn:Association")?e.targetRef&&this._getShape(Do(e.targetRef.href)):this._getShape(e.$parent.id)},Oo.prototype._getShape=function(e){return this._elementRegistry.get(e)};Wr={__depends__:[e,{drdImporter:["type",Oo]}]};var Ro={translate:["value",function(e,n){return n=n||{},e.replace(/{([^}]+)}/g,function(e,t){return n[t]||"{"+t+"}"})}]};function To(e){e&&"function"==typeof e.stopPropagation&&e.stopPropagation()}function Mo(e){return e.originalEvent||e.srcEvent}function Io(e){To(e),To(Mo(e))}function Ao(e){return(e=(e=e.pointers&&e.pointers.length?e.pointers[0]:e).touches&&e.touches.length?e.touches[0]:e)?{x:e.clientX,y:e.clientY}:null}function No(e,t){return(Mo(e)||e).button===t}function Bo(e){return No(e,0)}function Lo(e){var t=Mo(e)||e;return!!Bo(e)&&(/mac/i.test(navigator.platform)?t.metaKey:t.ctrlKey)}function Vo(e){var t=Mo(e)||e;return Bo(e)&&t.shiftKey}function $o(e){return!0}function zo(e){return Bo(e)||No(e,1)}function Fo(o,a,n){var i=this;function s(e,t,n){var i,r;(l[e]||Bo)(t)&&(n?r=a.getGraphics(n):(i=t.delegateTarget||t.target)&&(n=a.get(r=i)),r)&&n&&!1===o.fire(e,{element:n,gfx:r,originalEvent:t})&&(t.stopPropagation(),t.preventDefault())}var c={};function r(e){return c[e]}var u={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},l={"element.contextmenu":$o,"element.mousedown":zo,"element.mouseup":zo,"element.click":zo,"element.dblclick":zo};var d="svg, .djs-element";function p(e,t,n,i){var r=c[n]=function(e){s(n,e)};i&&(l[n]=i),r.$delegate=Pn.bind(e,d,t,r)}function h(e,t,n){n=r(n);n&&Pn.unbind(e,t,n.$delegate)}o.on("canvas.destroy",function(e){var n;n=e.svg,y(u,function(e,t){h(n,t,e)})}),o.on("canvas.init",function(e){var n;n=e.svg,y(u,function(e,t){p(n,t,e)})}),o.on(["shape.added","connection.added"],function(e){var t=e.element,e=e.gfx;o.fire("interactionEvents.createHit",{element:t,gfx:e})}),o.on(["shape.changed","connection.changed"],500,function(e){var t=e.element,e=e.gfx;o.fire("interactionEvents.updateHit",{element:t,gfx:e})}),o.on("interactionEvents.createHit",500,function(e){var t=e.element,e=e.gfx;i.createDefaultHit(t,e)}),o.on("interactionEvents.updateHit",function(e){var t=e.element,e=e.gfx;i.updateDefaultHit(t,e)});var e=m("djs-hit djs-hit-stroke"),t=m("djs-hit djs-hit-click-stroke"),f={all:m("djs-hit djs-hit-all"),"click-stroke":t,stroke:e,"no-move":m("djs-hit djs-hit-no-move")};function m(e,t){return t=C({stroke:"white",strokeWidth:15},t||{}),n.cls(e,["no-fill","no-border"],t)}function g(e,t){var n=f[t];if(!n)throw new Error("invalid hit type <"+t+">");S(e,n)}function v(e,t){w(e,t)}this.removeHits=function(e){y(Rn(".djs-hit",e),hi)},this.createDefaultHit=function(e,t){var n=e.waypoints,i=e.isFrame;return n?this.createWaypointsHit(t,n):this.createBoxHit(t,i?"stroke":"all",{width:e.width,height:e.height})},this.createWaypointsHit=function(e,t){t=Mi(t);return g(t,"stroke"),v(e,t),t},this.createBoxHit=function(e,t,n){n=C({x:0,y:0},n);var i=O("rect");return g(i,t),S(i,n),v(e,i),i},this.updateDefaultHit=function(e,t){var n,i,t=b(".djs-hit",t);if(t)return e.waypoints?(n=t,i=e.waypoints,S(n,{points:Ti(i)})):S(t,{width:e.width,height:e.height}),t},this.fire=s,this.triggerMouseEvent=function(e,t,n){var i=u[e];if(i)return s(i,t,n);throw new Error("unmapped DOM event name <"+e+">")},this.mouseHandler=r,this.registerEvent=p,this.unregisterEvent=h}Fo.$inject=["eventBus","elementRegistry","styles"];e={__init__:["interactionEvents"],interactionEvents:["type",Fo]};function Uo(e,t,n){this.offset=6;var i=t.cls("djs-outline",["no-fill"]),r=this;function o(e){var t=O("rect");return S(t,C({x:10,y:10,rx:3,width:100,height:100},i)),w(e,t),t}e.on(["shape.added","shape.changed"],500,function(e){var t=e.element,e=e.gfx,n=(n=b(".djs-outline",e))||o(e);r.updateShapeOutline(n,t)}),e.on(["connection.added","connection.changed"],function(e){var t=e.element,e=e.gfx,n=(n=b(".djs-outline",e))||o(e);r.updateConnectionOutline(n,t)})}Uo.prototype.updateShapeOutline=function(e,t){S(e,{x:-this.offset,y:-this.offset,width:t.width+2*this.offset,height:t.height+2*this.offset})},Uo.prototype.updateConnectionOutline=function(e,t){t=Vi(t);S(e,{x:t.x-this.offset,y:t.y-this.offset,width:t.width+2*this.offset,height:t.height+2*this.offset})},Uo.$inject=["eventBus","styles","elementRegistry"];var Ho={__init__:["outline"],outline:["type",Uo]};function Wo(e,t){this._eventBus=e,this._canvas=t,this._selectedElements=[];var n=this;e.on(["shape.remove","connection.remove"],function(e){e=e.element;n.deselect(e)}),e.on(["diagram.clear","root.set"],function(e){n.select(null)})}Wo.$inject=["eventBus","canvas"],Wo.prototype.deselect=function(e){var t,n=this._selectedElements,e=n.indexOf(e);-1!==e&&(t=n.slice(),n.splice(e,1),this._eventBus.fire("selection.changed",{oldSelection:t,newSelection:n}))},Wo.prototype.get=function(){return this._selectedElements},Wo.prototype.isSelected=function(e){return-1!==this._selectedElements.indexOf(e)},Wo.prototype.select=function(e,t){var n=this._selectedElements,i=n.slice(),r=(m(e)||(e=e?[e]:[]),this._canvas),o=r.getRootElement();e=e.filter(function(e){e=r.findRoot(e);return o===e}),t?y(e,function(e){-1===n.indexOf(e)&&n.push(e)}):this._selectedElements=n=e.slice(),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:n})};var qo="selected";function Go(n,e,t){this._canvas=n;var i=this;function r(e,t){n.addMarker(e,t)}function o(e,t){n.removeMarker(e,t)}this._multiSelectionBox=null,e.on("element.hover",function(e){r(e.element,"hover")}),e.on("element.out",function(e){o(e.element,"hover")}),e.on("selection.changed",function(e){var t=e.oldSelection,n=e.newSelection;y(t,function(e){-1===n.indexOf(e)&&o(e,qo)}),y(n,function(e){-1===t.indexOf(e)&&r(e,qo)}),i._updateSelectionOutline(n)}),e.on("element.changed",function(e){t.isSelected(e.element)&&i._updateSelectionOutline(t.get())})}function Ko(e,r,o,i){e.on("create.end",500,function(e){var e=e.context,t=e.canExecute,n=e.elements,e=(e.hints||{}).autoSelect;t&&!1!==e&&(m(e)?r.select(e):r.select(n.filter(Xo)))}),e.on("connect.end",500,function(e){e=e.context.connection;e&&r.select(e)}),e.on("shape.move.end",500,function(e){var t=e.previousSelection||[],n=i.get(e.context.shape.id);ie(t,function(e){return n.id===e.id})||r.select(n)}),e.on("element.click",function(e){if(Bo(e)){var t=e.element,n=(t===o.getRootElement()&&(t=null),r.isSelected(t)),i=1<r.get().length,e=Lo(e)||Vo(e);if(n&&i)return e?r.deselect(t):r.select(t);n?r.deselect(t):r.select(t,e)}})}function Xo(e){return!e.hidden}Go.$inject=["canvas","eventBus","selection"],Go.prototype._updateSelectionOutline=function(e){var t=this._canvas.getLayer("selectionOutline"),n=(fi(t),1<e.length);j(this._canvas.getContainer())[n?"add":"remove"]("djs-multi-select"),n&&(e={x:(n=Vi(e)).x-6,y:n.y-6,width:n.width+12,height:n.height+12},S(n=O("rect"),C({rx:3},e)),j(n).add("djs-selection-outline"),w(t,n))},Ko.$inject=["eventBus","selection","canvas","elementRegistry"];var Yo={__init__:["selectionVisuals","selectionBehavior"],__depends__:[e,Ho],selection:["type",Wo],selectionVisuals:["type",Go],selectionBehavior:["type",Ko]};function Zo(e){this._counter=0,this._prefix=(e?e+"-":"")+Math.floor(1e9*Math.random())+"-"}Zo.prototype.next=function(){return this._prefix+ ++this._counter};var Qo=new Zo("ov");function Jo(e,t,n,i){this._eventBus=t,this._canvas=n,this._elementRegistry=i,this._ids=Qo,this._overlayDefaults=C({show:null,scale:!0},e&&e.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=(t=n.getContainer(),vn(i=_('<div class="djs-overlay-container" />'),{position:"absolute",width:0,height:0}),t.insertBefore(i,t.firstChild),i),this._init()}function ea(e,t,n){vn(e,{left:t+"px",top:n+"px"})}function ta(e,t){e.style.display=!1===t?"none":""}function na(t,n){t.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(e){t.style[e+"transform"]=n})}Jo.$inject=["config.overlays","eventBus","canvas","elementRegistry"],Jo.prototype.get=function(e){var t;return ne(e)&&(e={id:e}),ne(e.element)&&(e.element=this._elementRegistry.get(e.element)),e.element?(t=this._getOverlayContainer(e.element,!0))?e.type?re(t.overlays,he({type:e.type})):t.overlays.slice():[]:e.type?re(this._overlays,he({type:e.type})):e.id?this._overlays[e.id]:null},Jo.prototype.add=function(e,t,n){if(ee(t)&&(n=t,t=null),e.id||(e=this._elementRegistry.get(e)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");var i;if(e)return i=this._ids.next(),n=C({},this._overlayDefaults,n,{id:i,type:t,element:e,html:n.html}),this._addOverlay(n),i;throw new Error("invalid element specified")},Jo.prototype.remove=function(e){var e=this.get(e)||[],n=(m(e)||(e=[e]),this);y(e,function(e){var t=n._getOverlayContainer(e.element,!0);e&&(Tn(e.html),Tn(e.htmlContainer),delete e.htmlContainer,delete e.element,delete n._overlays[e.id]),t&&-1!==(e=t.overlays.indexOf(e))&&t.overlays.splice(e,1)})},Jo.prototype.isShown=function(){return"none"!==this._overlayRoot.style.display},Jo.prototype.show=function(){ta(this._overlayRoot)},Jo.prototype.hide=function(){ta(this._overlayRoot,!1)},Jo.prototype.clear=function(){this._overlays={},this._overlayContainers=[],xn(this._overlayRoot)},Jo.prototype._updateOverlayContainer=function(e){var t,n=e.element,i=e.html,r=n.x,o=n.y;n.waypoints&&(r=(t=Vi(n)).x,o=t.y),ea(i,r,o),yn(e.html,"data-container-id",n.id)},Jo.prototype._updateOverlay=function(e){var t,n=e.position,i=e.htmlContainer,r=e.element,o=n.left,a=n.top;void 0!==n.right&&(t=(r.waypoints?Vi(r):r).width,o=-1*n.right+t),void 0!==n.bottom&&(t=(r.waypoints?Vi(r):r).height,a=-1*n.bottom+t),ea(i,o||0,a||0),this._updateOverlayVisibilty(e,this._canvas.viewbox())},Jo.prototype._createOverlayContainer=function(e){var t=_('<div class="djs-overlays" />'),t=(vn(t,{position:"absolute"}),this._overlayRoot.appendChild(t),{html:t,element:e,overlays:[]});return this._updateOverlayContainer(t),this._overlayContainers.push(t),t},Jo.prototype._updateRoot=function(e){var t=e.scale||1,e="matrix("+[t,0,0,t,-1*e.x*t,-1*e.y*t].join(",")+")";na(this._overlayRoot,e)},Jo.prototype._getOverlayContainer=function(t,e){var n=ie(this._overlayContainers,function(e){return e.element===t});return n||e?n:this._createOverlayContainer(t)},Jo.prototype._addOverlay=function(e){var t,n,i=e.id,r=e.element,o=e.html,o=(ne(o=o.get&&o.constructor.prototype.jquery?o.get(0):o)&&(o=_(o)),n=this._getOverlayContainer(r),vn(t=_('<div class="djs-overlay" data-overlay-id="'+i+'">'),{position:"absolute"}),t.appendChild(o),e.type&&v(t).add("djs-overlay-"+e.type),this._canvas.findRoot(r));ta(t,o===this._canvas.getRootElement()),e.htmlContainer=t,n.overlays.push(e),n.html.appendChild(t),this._overlays[i]=e,this._updateOverlay(e),this._updateOverlayVisibilty(e,this._canvas.viewbox())},Jo.prototype._updateOverlayVisibilty=function(e,t){var n=e.show,i=this._canvas.findRoot(e.element),r=n&&n.minZoom,o=n&&n.maxZoom,a=!0;ta(e.htmlContainer,a=i!==this._canvas.getRootElement()||n&&(Q(r)&&r>t.scale||Q(o)&&o<t.scale)?!1:a),this._updateOverlayScale(e,t)},Jo.prototype._updateOverlayScale=function(e,t){var n,i,r=e.scale,e=e.htmlContainer,o="";!0!==r&&(r=!1===r?n=1:(n=r.min,r.max),Q(n)&&t.scale<n&&(i=(1/t.scale||1)*n),Q(r))&&t.scale>r&&(i=(1/t.scale||1)*r),na(e,o=Q(i)?"scale("+i+","+i+")":o)},Jo.prototype._updateOverlaysVisibilty=function(t){var n=this;y(this._overlays,function(e){n._updateOverlayVisibilty(e,t)})},Jo.prototype._init=function(){var e=this._eventBus,n=this;e.on("canvas.viewbox.changing",function(e){n.hide()}),e.on("canvas.viewbox.changed",function(e){e=e.viewbox,n._updateRoot(e),n._updateOverlaysVisibilty(e),n.show()}),e.on(["shape.remove","connection.remove"],function(e){var e=e.element,e=(y(n.get({element:e}),function(e){n.remove(e.id)}),n._getOverlayContainer(e));e&&(Tn(e.html),-1!==(e=n._overlayContainers.indexOf(e)))&&n._overlayContainers.splice(e,1)}),e.on("element.changed",500,function(e){e=e.element,e=n._getOverlayContainer(e,!0);e&&(y(e.overlays,function(e){n._updateOverlay(e)}),n._updateOverlayContainer(e))}),e.on("element.marker.update",function(e){var t=n._getOverlayContainer(e.element,!0);t&&v(t.html)[e.add?"add":"remove"](e.marker)}),e.on("root.set",function(){n._updateOverlaysVisibilty(n._canvas.viewbox())}),e.on("diagram.clear",this.clear,this)};var ia={__init__:["overlays"],overlays:["type",Jo]};function ra(e,t,n){this._eventBus=e,this._canvas=t,this._translate=n,e.on("diagram.init",function(){this._init()},this),e.on("import.done",function(e){e.error||this.update()},this),this.HTML_MARKUP='<div class="dmn-definitions"><div class="dmn-definitions-name" title="'+this._translate("Definition Name")+'" spellcheck="false"></div><div class="dmn-definitions-id" title="'+this._translate("Definition ID")+'" spellcheck="false"></div></div>'}function oa(e,n){function t(e,t){v(n.getContainer()).toggle(e,t)}e.on("palette.create",function(){t("with-palette",!0)}),e.on("palette.changed",function(e){t("with-palette-two-column",e.twoColumn)})}ra.$inject=["eventBus","canvas","translate"],ra.prototype._init=function(){var e=this._canvas,t=this._eventBus,e=e.getContainer(),n=this._container=_(this.HTML_MARKUP);e.appendChild(n),this.nameElement=b(".dmn-definitions-name",this._container),this.idElement=b(".dmn-definitions-id",this._container),Pn.bind(n,".dmn-definitions-name, .dmn-definitions-id","mousedown",function(e){e.stopPropagation()}),t.fire("definitionIdView.create",{html:n})},ra.prototype.update=function(){var e=this._canvas.getRootElement().businessObject;this.nameElement.textContent=e.name,this.idElement.textContent=e.id},oa.$inject=["eventBus","canvas"];var aa={__depends__:[Ro],__init__:["definitionPropertiesView","definitionPropertiesPaletteAdapter"],definitionPropertiesView:["type",ra],definitionPropertiesPaletteAdapter:["type",oa]},sa=[{className:"dmn-icon-decision-table",matches:function(e){e=e.businessObject;return k(e,"dmn:Decision")&&k(e.decisionLogic,"dmn:DecisionTable")}},{className:"dmn-icon-literal-expression",matches:function(e){e=e.businessObject;return k(e,"dmn:Decision")&&k(e.decisionLogic,"dmn:LiteralExpression")}}],ca=function(){function r(e,t,n,i){var o=this;h(this,r),this._injector=e,this._eventBus=t,this._overlays=n,this._config=i||{enabled:!0},t.on(["shape.added"],function(e){for(var t=e.element,n=0;n<sa.length;n++){var i=sa[n],r=i.matches,i=i.className;r&&r(t)&&o.addOverlay(t,i)}})}return u(r,[{key:"addOverlay",value:function(e,t){var t=_('\n      <div class="drill-down-overlay">\n        <span class="'.concat(t,'"></span>\n      </div>\n    ')),n=this._overlays.add(e,{position:{top:2,left:2},html:t});!1!==this._config.enabled&&(v(t).add("interactive"),this.bindEventListener(e,t,n))}},{key:"bindEventListener",value:function(e,t,n){var i=this,r=this._overlays,o=this._eventBus,r=r._overlayRoot;Pn.bind(r,'[data-overlay-id="'+n+'"]',"click",function(){!1!==o.fire("drillDown.click",{element:e})&&i.drillDown(e)})}},{key:"drillDown",value:function(e){var t=this._injector.get("_parent",!1);return!!t&&!!(e=t.getView(e.businessObject))&&(t.open(e),!0)}}]),r}(),ca=(ca.$inject=["injector","eventBus","overlays","config.drillDown"],{__depends__:[ia],__init__:["drillDown"],drillDown:["type",ca]}),ua='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.02 5.57" width="53" height="21" style="vertical-align:middle"><path fill="#000000" d="M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"/><path fill="#000000" d="M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"/></svg>';function la(e){return e.join(";")}var da,pa='<div class="bjs-powered-by-lightbox" style="'+la(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"])+'"><div class="backdrop" style="'+la(["width: 100%","height: 100%","background: rgba(40,40,40,0.2)"])+'"></div><div class="notice" style="'+la(["position: absolute","left: 50%","top: 40%","transform: translate(-50%)","width: 260px","padding: 10px","background: white","box-shadow: 0 1px 4px rgba(0,0,0,0.3)","font-family: Helvetica, Arial, sans-serif","font-size: 14px","display: flex","line-height: 1.3"])+'"><a href="https://bpmn.io" target="_blank" rel="noopener" style="margin: 15px 20px 15px 10px; align-self: center;">'+ua+'</a><span>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="https://bpmn.io" target="_blank" rel="noopener">bpmn.io</a>.</span></div></div>';var ha=["additionalModules","canvas"];function fa(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function ma(i){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?fa(Object(r),!0).forEach(function(e){var t,n;t=i,n=r[e=e],(e=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):fa(Object(r)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(r,e))})}return i}function ga(e,t){if(null==e)return{};var n,i=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);return i}function va(e){
/**
   * Adds the project logo to the diagram container as
   * required by the bpmn.io license.
   *
   * @see http://bpmn.io/license
   *
   * @param {Element} container
   */
var t,n;this._container=this._createContainer(),t=this._container,n=_('<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100;">'+ua+"</a>"),t.appendChild(n),E.bind(n,"click",function(e){da||(da=_(pa),Pn.bind(da,".backdrop","click",function(e){document.body.removeChild(da)})),document.body.appendChild(da),e.preventDefault()}),this._init(this._container,e)}function ya(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function _a(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ba(e){return Math.log(e)/Math.log(10)}function xa(e,t){var n=ba(e.min),e=ba(e.max);return(Math.abs(n)+Math.abs(e))/t}Yn(va,lo),va.prototype.saveSVG=Mn(function(e){var r=this;return new Promise(function(e){var t=r.get("canvas"),n=t.getActiveLayer(),t=b("defs",t._svg),i=function(e,t){if(void 0===t)return Oi(e);try{ji(e,t)}catch(e){throw new Error("error parsing SVG: "+e.message)}return e}(n),t=t&&t.outerHTML||"",n=n.getBBox();e({svg:'<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- created with dmn-js / http://bpmn.io --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+n.width+'" height="'+n.height+'" viewBox="'+n.x+" "+n.y+" "+n.width+" "+n.height+'" version="1.1">'+t+i+"</svg>"})})}),va.prototype.getModules=function(){return this._modules},va.prototype.destroy=function(){lo.prototype.destroy.call(this),Tn(this._container)},va.prototype.on=function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)},va.prototype.off=function(e,t){this.get("eventBus").off(e,t)},va.prototype._init=function(e,t){var n=t.additionalModules,i=t.canvas,r=ga(t,ha),o=t.modules||this.getModules(),o=[].concat([{drd:["value",this]}],f(o),f(n||[])),n=ma(ma({},r),{},{canvas:ma(ma({},i),{},{container:e}),modules:o});lo.call(this,n),t&&t.container&&this.attachTo(t.container)},va.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)},va.prototype._createContainer=function(){return _('<div class="dmn-drd-container"></div>')},va.prototype.open=function(e){var r=this;return new Promise(function(n,i){var t;try{return r._definitions&&r.clear(),r._definitions=e,fo(r,e,function(e,t){e?(e.warnings=t||[],i(e)):n({warnings:t||[]})})}catch(e){t=e}t?(t.warnings=t.warnings||[],i(t)):n({warnings:[]})})},va.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach();var t=this._container;e.appendChild(t),this._emit("attach",{}),this.get("canvas").resized()},va.prototype.detach=function(){var e=this._container,t=e.parentNode;t&&(this._emit("detach",{}),t.removeChild(e))},va.prototype._modules=[Wr,Ro,Yo,ia,aa,ca];var wa=Math.sign||function(e){return 0<=e?1:-1},Ca={min:.2,max:4};function Ea(t,e,n){t=t||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=ye(this._handleWheel,this),this._totalDelta=0,this._scale=t.scale||.75;var i=this;e.on("canvas.init",function(e){i._init(!1!==t.enabled)})}Ea.$inject=["config.zoomScroll","eventBus","canvas"],Ea.prototype.scroll=function(e){this._canvas.scroll(e)},Ea.prototype.reset=function(){this._canvas.zoom("fit-viewport")},Ea.prototype.zoom=function(e,t){var n=xa(Ca,20);this._totalDelta+=e,.1<Math.abs(this._totalDelta)&&(this._zoom(e,t,n),this._totalDelta=0)},Ea.prototype._handleWheel=function(e){var t,n,i,r,o;Cn(e.target,".djs-scrollable",!0)||(r=this._container,e.preventDefault(),i=e.ctrlKey,t=e.shiftKey,n=-1*this._scale,n*=i?0===e.deltaMode?.02:.32:0===e.deltaMode?1:16,i?(i=r.getBoundingClientRect(),r={x:e.clientX-i.left,y:e.clientY-i.top},o=Math.sqrt(Math.pow(e.deltaY,2)+Math.pow(e.deltaX,2))*wa(e.deltaY)*n,this.zoom(o,r)):(o=t?{dx:n*e.deltaY,dy:0}:{dx:n*e.deltaX,dy:n*e.deltaY},this.scroll(o)))},Ea.prototype.stepZoom=function(e,t){var n=xa(Ca,10);this._zoom(e,t,n)},Ea.prototype._zoom=function(e,t,n){var i=this._canvas,e=0<e?1:-1,r=ba(i.zoom()),r=Math.round(r/n)*n,n=(r+=n*e,Math.pow(10,r));i.zoom(Math.max(Ca.min,Math.min(Ca.max,n)),t)},Ea.prototype.toggle=function(e){var t=this._container,n=this._handleWheel,i=this._enabled;return i!==(e=void 0===e?!i:e)&&E[e?"bind":"unbind"](t,"wheel",n,!1),this._enabled=e},Ea.prototype._init=function(e){this.toggle(e)};var Wr={__init__:["zoomScroll"],zoomScroll:["type",Ea]},ka=/^djs-cursor-.*$/;function Sa(e){var t=v(document.body);t.removeMatching(ka),e&&t.add("djs-cursor-"+e)}function ja(){Sa(null)}var Oa=5e3;function Pa(e,t){function n(){return!1}return t=t||"element.click",e.once(t,Oa,n),function(){e.off(t,n)}}function Da(o,a){var s;function n(e){var t,n=s.start,i=s.button,r=Ao(e),n=_a(r,n);!s.dragging&&(t=n,15<Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2)))&&(s.dragging=!0,0===i&&Pa(o),Sa("grab")),s.dragging&&(n=_a(r,s.last||s.start),a.scroll({dx:n.x,dy:n.y}),s.last=r),e.preventDefault()}function i(e){E.unbind(document,"mousemove",n),E.unbind(document,"mouseup",i),s=null,ja()}o.on("element.mousedown",500,function(e){e=e.originalEvent;if(!Cn(e.target,".djs-draggable")){var t=e.button;if(!(2<=t||e.ctrlKey||e.shiftKey||e.altKey))return s={button:t,start:Ao(e)},E.bind(document,"mousemove",n),E.bind(document,"mouseup",i),!0}}),this.isActive=function(){return!!s}}Da.$inject=["eventBus","canvas"];var ca={__init__:["moveCanvas"],moveCanvas:["type",Da]},Ra="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ta(e,t){return e(t={exports:{}},t.exports),t.exports}var Ma=Ta(function(N){
/*! Hammer.JS - v2.0.7 - 2016-04-22
     * http://hammerjs.github.io/
     *
     * Copyright (c) 2016 Jorik Tangelder;
     * Licensed under the MIT license */
var r=window,B=document,l=void 0,L=["","webkit","Moz","MS","ms","o"],V=B.createElement("div"),$="function",o=Math.round,d=Math.abs,z=Date.now;function F(e,t,n){return setTimeout(q(e,n),t)}function n(e,t,n){return Array.isArray(e)&&(a(e,n[t],n),1)}function a(e,t,n){if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==l)for(i=0;i<e.length;)t.call(n,e[i],i,e),i++;else for(var i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e)}function U(n,e,t){var i="DEPRECATED METHOD: "+e+"\n"+t+" AT \n";return function(){var e=new Error("get-stack-trace"),e=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",t=r.console&&(r.console.warn||r.console.log);return t&&t.call(r.console,i,e),n.apply(this,arguments)}}var s="function"!=typeof Object.assign?function(e){if(e===l||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==l&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}return t}:Object.assign,H=U(function(e,t,n){for(var i=Object.keys(t),r=0;r<i.length;)n&&e[i[r]]!==l||(e[i[r]]=t[i[r]]),r++;return e},"extend","Use `assign`."),W=U(function(e,t){return H(e,t,!0)},"merge","Use `assign`.");function e(e,t,n){var t=t.prototype,i=e.prototype=Object.create(t);i.constructor=e,i._super=t,n&&s(i,n)}function q(e,t){return function(){return e.apply(t,arguments)}}function G(e,t){return Fe(e)==$?e.apply(t&&t[0]||l,t):e}function K(e,t){return e===l?t:e}function t(t,e,n){a(u(e),function(e){t.addEventListener(e,n,!1)})}function i(t,e,n){a(u(e),function(e){t.removeEventListener(e,n,!1)})}function X(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function c(e,t){return-1<e.indexOf(t)}function u(e){return e.trim().split(/\s+/g)}function p(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var i=0;i<e.length;){if(n&&e[i][n]==t||!n&&e[i]===t)return i;i++}return-1}function h(e){return Array.prototype.slice.call(e,0)}function Y(e,n,t){for(var i=[],r=[],o=0;o<e.length;){var a=n?e[o][n]:e[o];p(r,a)<0&&i.push(e[o]),r[o]=a,o++}return i=t?n?i.sort(function(e,t){return e[n]>t[n]}):i.sort():i}function f(e,t){for(var n,i=t[0].toUpperCase()+t.slice(1),r=0;r<L.length;){if((n=(n=L[r])?n+i:t)in e)return n;r++}return l}var Z=1;function Q(e){e=e.ownerDocument||e;return e.defaultView||e.parentWindow||r}var J="ontouchstart"in r,ee=f(r,"PointerEvent")!==l,te=J&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),m="touch",ne=25,g=1,v=4,y=8,_=1,b=2,x=4,w=8,C=16,E=b|x,k=w|C,ie=E|k,re=["x","y"],S=["clientX","clientY"];function j(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){G(t.options.enable,[t])&&n.handler(e)},this.init()}function oe(e,t,n){var i=n.pointers.length,r=n.changedPointers.length,o=t&g&&i-r==0,i=t&(v|y)&&i-r==0,r=(n.isFirst=!!o,n.isFinal=!!i,o&&(e.session={}),n.eventType=t,e),i=n,o=r.session,t=i.pointers,a=t.length,a=(o.firstInput||(o.firstInput=ae(i)),1<a&&!o.firstMultiple?o.firstMultiple=ae(i):1===a&&(o.firstMultiple=!1),o.firstInput),s=o.firstMultiple,c=(s||a).center,u=i.center=se(t),a=(i.timeStamp=z(),i.deltaTime=i.timeStamp-a.timeStamp,i.angle=le(c,u),i.distance=O(c,u),function(e,t){var n=t.center,i=e.offsetDelta||{},r=e.prevDelta||{},o=e.prevInput||{};t.eventType!==g&&o.eventType!==v||(r=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=e.offsetDelta={x:n.x,y:n.y});t.deltaX=r.x+(n.x-i.x),t.deltaY=r.y+(n.y-i.y)}(o,i),i.offsetDirection=ue(i.deltaX,i.deltaY),ce(i.deltaTime,i.deltaX,i.deltaY)),c=(i.overallVelocityX=a.x,i.overallVelocityY=a.y,i.overallVelocity=d(a.x)>d(a.y)?a.x:a.y,i.scale=s?function(e,t){return O(t[0],t[1],S)/O(e[0],e[1],S)}(s.pointers,t):1,i.rotation=s?function(e,t){return le(t[1],t[0],S)+le(e[1],e[0],S)}(s.pointers,t):0,i.maxPointers=!o.prevInput||i.pointers.length>o.prevInput.maxPointers?i.pointers.length:o.prevInput.maxPointers,function(e,t){var n,i,r,o=e.lastInterval||t,a=t.timeStamp-o.timeStamp;{var s,c;t.eventType!=y&&(ne<a||o.velocity===l)?(s=t.deltaX-o.deltaX,c=t.deltaY-o.deltaY,a=ce(a,s,c),i=a.x,r=a.y,n=d(a.x)>d(a.y)?a.x:a.y,s=ue(s,c),e.lastInterval=t):(n=o.velocity,i=o.velocityX,r=o.velocityY,s=o.direction)}t.velocity=n,t.velocityX=i,t.velocityY=r,t.direction=s}(o,i),r.element);X(i.srcEvent.target,c)&&(c=i.srcEvent.target),i.target=c,e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function ae(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:o(e.pointers[n].clientX),clientY:o(e.pointers[n].clientY)},n++;return{timeStamp:z(),pointers:t,center:se(t),deltaX:e.deltaX,deltaY:e.deltaY}}function se(e){var t=e.length;if(1===t)return{x:o(e[0].clientX),y:o(e[0].clientY)};for(var n=0,i=0,r=0;r<t;)n+=e[r].clientX,i+=e[r].clientY,r++;return{x:o(n/t),y:o(i/t)}}function ce(e,t,n){return{x:t/e||0,y:n/e||0}}function ue(e,t){return e===t?_:d(e)>=d(t)?e<0?b:x:t<0?w:C}function O(e,t,n){var i=t[(n=n||re)[0]]-e[n[0]],t=t[n[1]]-e[n[1]];return Math.sqrt(i*i+t*t)}function le(e,t,n){var i=t[(n=n||re)[0]]-e[n[0]],t=t[n[1]]-e[n[1]];return 180*Math.atan2(t,i)/Math.PI}j.prototype={handler:function(){},init:function(){this.evEl&&t(this.element,this.evEl,this.domHandler),this.evTarget&&t(this.target,this.evTarget,this.domHandler),this.evWin&&t(Q(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&i(this.element,this.evEl,this.domHandler),this.evTarget&&i(this.target,this.evTarget,this.domHandler),this.evWin&&i(Q(this.element),this.evWin,this.domHandler)}};var de={mousedown:g,mousemove:2,mouseup:v};function P(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,j.apply(this,arguments)}e(P,j,{handler:function(e){var t=de[e.type];t&g&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=v),this.pressed&&(t&v&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var pe={pointerdown:g,pointermove:2,pointerup:v,pointercancel:y,pointerout:y},he={2:m,3:"pen",4:"mouse",5:"kinect"},fe="pointerdown",me="pointermove pointerup pointercancel";function ge(){this.evEl=fe,this.evWin=me,j.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(fe="MSPointerDown",me="MSPointerMove MSPointerUp MSPointerCancel"),e(ge,j,{handler:function(e){var t=this.store,n=!1,i=e.type.toLowerCase().replace("ms",""),i=pe[i],r=he[e.pointerType]||e.pointerType,o=r==m,a=p(t,e.pointerId,"pointerId");i&g&&(0===e.button||o)?a<0&&(t.push(e),a=t.length-1):i&(v|y)&&(n=!0),a<0||(t[a]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:r,srcEvent:e}),n&&t.splice(a,1))}});var ve={touchstart:g,touchmove:2,touchend:v,touchcancel:y};function ye(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,j.apply(this,arguments)}e(ye,j,{handler:function(e){var t,n=ve[e.type];n===g&&(this.started=!0),this.started&&(t=function(e,t){var n=h(e.touches),e=h(e.changedTouches);t&(v|y)&&(n=Y(n.concat(e),"identifier",!0));return[n,e]}.call(this,e,n),n&(v|y)&&t[0].length-t[1].length==0&&(this.started=!1),this.callback(this.manager,n,{pointers:t[0],changedPointers:t[1],pointerType:m,srcEvent:e}))}});var _e={touchstart:g,touchmove:2,touchend:v,touchcancel:y};function be(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},j.apply(this,arguments)}e(be,j,{handler:function(e){var t=_e[e.type],n=function(e,t){var n=h(e.touches),i=this.targetIds;if(t&(2|g)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,a=h(e.changedTouches),s=[],c=this.target;if(o=n.filter(function(e){return X(e.target,c)}),t===g)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;r=0;for(;r<a.length;)i[a[r].identifier]&&s.push(a[r]),t&(v|y)&&delete i[a[r].identifier],r++;if(s.length)return[Y(o.concat(s),"identifier",!0),s]}.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:m,srcEvent:e})}});var xe=2500;function we(){j.apply(this,arguments);var e=q(this.handler,this);this.touch=new be(this.manager,e),this.mouse=new P(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function Ce(e){var t,n,e=e.changedPointers[0];e.identifier===this.primaryTouch&&(t={x:e.clientX,y:e.clientY},this.lastTouches.push(t),n=this.lastTouches,setTimeout(function(){var e=n.indexOf(t);-1<e&&n.splice(e,1)},xe))}e(we,j,{handler:function(e,t,n){var i=n.pointerType==m,r="mouse"==n.pointerType;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)!function(e,t){e&g?(this.primaryTouch=t.changedPointers[0].identifier,Ce.call(this,t)):e&(v|y)&&Ce.call(this,t)}.call(this,t,n);else if(r&&function(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(t-r.x),r=Math.abs(n-r.y);if(o<=25&&r<=25)return!0}return!1}.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ee,ke,Se=f(V.style,"touchAction"),je=Se!==l,Oe="manipulation",D="none",R="pan-x",T="pan-y",Pe=je&&(Ee={},ke=r.CSS&&r.CSS.supports,["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(e){Ee[e]=!ke||r.CSS.supports("touch-action",e)}),Ee);function De(e,t){this.manager=e,this.set(t)}function M(e){this.options=s({},this.defaults,e||{}),this.id=Z++,this.manager=null,this.options.enable=K(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Re(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Te(e){return e==C?"down":e==w?"up":e==b?"left":e==x?"right":""}function Me(e,t){t=t.manager;return t?t.get(e):e}function I(){M.apply(this,arguments)}function Ie(){I.apply(this,arguments),this.pX=null,this.pY=null}function Ae(){I.apply(this,arguments)}function Ne(){M.apply(this,arguments),this._timer=null,this._input=null}function Be(){I.apply(this,arguments)}function Le(){I.apply(this,arguments)}function Ve(){M.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function A(e,t){return(t=t||{}).recognizers=K(t.recognizers,A.defaults.preset),new $e(e,t)}function $e(e,t){this.options=s({},A.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((t=this).options.inputClass||(ee?ge:te?be:J?we:P))(t,oe),this.touchAction=new De(this,this.options.touchAction),ze(this,!0),a(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function ze(n,i){var r,o=n.element;o.style&&(a(n.options.cssProps,function(e,t){r=f(o.style,t),i?(n.oldCssProps[r]=o.style[r],o.style[r]=e):o.style[r]=n.oldCssProps[r]||""}),i||(n.oldCssProps={}))}De.prototype={set:function(e){"compute"==e&&(e=this.compute()),je&&this.manager.element.style&&Pe[e]&&(this.manager.element.style[Se]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e,t,n=[],i=(a(this.manager.recognizers,function(e){G(e.options.enable,[e])&&(n=n.concat(e.getTouchAction()))}),n.join(" "));return c(i,D)||(e=c(i,R),t=c(i,T),e&&t)?D:e||t?e?R:T:c(i,Oe)?Oe:"auto"},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(!this.manager.session.prevented){var i=this.actions,r=c(i,D)&&!Pe.none,o=c(i,T)&&!Pe[T],i=c(i,R)&&!Pe[R];if(r){var a=1===e.pointers.length,s=e.distance<2,e=e.deltaTime<250;if(a&&s&&e)return}return i&&o?void 0:r||o&&n&E||i&&n&k?this.preventSrc(t):void 0}t.preventDefault()},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}},M.prototype={defaults:{},set:function(e){return s(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){var t;return n(e,"recognizeWith",this)||(t=this.simultaneous)[(e=Me(e,this)).id]||(t[e.id]=e).recognizeWith(this),this},dropRecognizeWith:function(e){return n(e,"dropRecognizeWith",this)||(e=Me(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){var t;return n(e,"requireFailure",this)||-1===p(t=this.requireFail,e=Me(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){return n(e,"dropRequireFailure",this)||(e=Me(e,this),-1<(e=p(this.requireFail,e))&&this.requireFail.splice(e,1)),this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(t){var n=this,e=this.state;function i(e){n.manager.emit(e,t)}e<8&&i(n.options.event+Re(e)),i(n.options.event),t.additionalEvent&&i(t.additionalEvent),8<=e&&i(n.options.event+Re(e))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){e=s({},e);G(this.options.enable,[this,e])?(56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)):(this.reset(),this.state=32)},process:function(e){},getTouchAction:function(){},reset:function(){}},e(I,M,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,i=6&t,e=this.attrTest(e);return i&&(n&y||!e)?16|t:i||e?n&v?8|t:2&t?4|t:2:32}}),e(Ie,I,{defaults:{event:"pan",threshold:10,pointers:1,direction:ie},getTouchAction:function(){var e=this.options.direction,t=[];return e&E&&t.push(T),e&k&&t.push(R),t},directionTest:function(e){var t=this.options,n=!0,i=e.distance,r=e.direction,o=e.deltaX,a=e.deltaY;return r&t.direction||(i=t.direction&E?(r=0===o?_:o<0?b:x,n=o!=this.pX,Math.abs(e.deltaX)):(r=0===a?_:a<0?w:C,n=a!=this.pY,Math.abs(e.deltaY))),e.direction=r,n&&i>t.threshold&&r&t.direction},attrTest:function(e){return I.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Te(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),e(Ae,I,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[D]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){var t;1!==e.scale&&(t=e.scale<1?"in":"out",e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),e(Ne,M,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!i||!n||e.eventType&(v|y)&&!r)this.reset();else if(e.eventType&g)this.reset(),this._timer=F(function(){this.state=8,this.tryEmit()},t.time,this);else if(e.eventType&v)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&e.eventType&v?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=z(),this.manager.emit(this.options.event,this._input)))}}),e(Be,I,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[D]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),e(Le,I,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:E|k,pointers:1},getTouchAction:function(){return Ie.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return n&(E|k)?t=e.overallVelocity:n&E?t=e.overallVelocityX:n&k&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&e.eventType&v},emit:function(e){var t=Te(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),e(Ve,M,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Oe]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),e.eventType&g&&0===this.count)return this.failTimeout();if(i&&r&&n){if(e.eventType!=v)return this.failTimeout();i=!this.pTime||e.timeStamp-this.pTime<t.interval,r=!this.pCenter||O(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,r&&i?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=F(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return 32},failTimeout:function(){return this._timer=F(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),A.VERSION="2.0.7",A.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Be,{enable:!1}],[Ae,{enable:!1},["rotate"]],[Le,{direction:E}],[Ie,{direction:E},["swipe"]],[Ve],[Ve,{event:"doubletap",taps:2},["tap"]],[Ne]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},$e.prototype={set:function(e){return s(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);for(var n,i=this.recognizers,r=t.curRecognizer,o=((!r||8&r.state)&&(r=t.curRecognizer=null),0);o<i.length;)n=i[o],2===t.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(e),!r&&14&n.state&&(r=t.curRecognizer=n),o++}},get:function(e){if(e instanceof M)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){var t;return n(e,"add",this)?this:((t=this.get(e.options.event))&&this.remove(t),this.recognizers.push(e),(e.manager=this).touchAction.update(),e)},remove:function(e){var t;return n(e,"remove",this)||(e=this.get(e))&&-1!==(e=p(t=this.recognizers,e))&&(t.splice(e,1),this.touchAction.update()),this},on:function(e,t){var n;if(e!==l&&t!==l)return n=this.handlers,a(u(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this},off:function(e,t){var n;if(e!==l)return n=this.handlers,a(u(e),function(e){t?n[e]&&n[e].splice(p(n[e],t),1):delete n[e]}),this},emit:function(e,t){this.options.domEvents&&(n=e,i=t,(r=B.createEvent("Event")).initEvent(n,!0,!0),(r.gesture=i).target.dispatchEvent(r));var n,i,r,o=this.handlers[e]&&this.handlers[e].slice();if(o&&o.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var a=0;a<o.length;)o[a](t),a++}},destroy:function(){this.element&&ze(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},s(A,{INPUT_START:g,INPUT_MOVE:2,INPUT_END:v,INPUT_CANCEL:y,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:_,DIRECTION_LEFT:b,DIRECTION_RIGHT:x,DIRECTION_UP:w,DIRECTION_DOWN:C,DIRECTION_HORIZONTAL:E,DIRECTION_VERTICAL:k,DIRECTION_ALL:ie,Manager:$e,Input:j,TouchAction:De,TouchInput:be,MouseInput:P,PointerEventInput:ge,TouchMouseInput:we,SingleTouchInput:ye,Recognizer:M,AttrRecognizer:I,Tap:Ve,Pan:Ie,Swipe:Le,Pinch:Ae,Rotate:Be,Press:Ne,on:t,off:i,each:a,merge:W,extend:H,assign:s,inherit:e,bindFn:q,prefixed:f}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=A,"function"==typeof l&&l.amd?l(function(){return A}):N.exports?N.exports=A:r.Hammer=A}),Ia=["mousedown","mouseup","mouseover","mouseout","click","dblclick"];function Aa(e,t){return t.get(e,!1)}function Na(e){e.preventDefault(),"function"==typeof e.stopPropagation?e.stopPropagation():e.srcEvent&&"function"==typeof e.srcEvent.stopPropagation&&e.srcEvent.stopPropagation(),"function"==typeof e.stopImmediatePropagation&&e.stopImmediatePropagation()}function Ba(t){function e(e){setTimeout(function(){y(Ia,function(e){E.unbind(t,e,Na,!0)})},500)}E.bind(t,"touchstart",function(e){y(Ia,function(e){E.bind(t,e,Na,!0)})},!0),E.bind(t,"touchend",e,!0),E.bind(t,"touchcancel",e,!0);var r=new Ma.Manager(t,{inputClass:Ma.TouchInput,recognizers:[],domEvents:!0}),n=new Ma.Tap,i=new Ma.Pan({threshold:10}),o=new Ma.Press,a=new Ma.Pinch,s=new Ma.Tap({event:"doubletap",taps:2});return a.requireFailure(i),a.requireFailure(o),r.add([i,o,a,s,n]),r.reset=function(e){var n=this.recognizers,i=this.session;i.stopped||(r.stop(e),setTimeout(function(){for(var e,t=0;e=n[t];t++)e.reset(),e.state=8;i.curRecognizer=null},0))},r.on("hammer.input",function(e){e.srcEvent.defaultPrevented&&r.reset(!0)}),r}function La(e,a,t,s,r){var c,i=Aa("dragging",e),u=Aa("move",e),n=Aa("contextPad",e),o=Aa("palette",e);function l(n,i){return function(e){var t=d(e.target),t=t&&s.get(t);return i&&(e.srcEvent.button=i),r.fire(n,e,t)}}function d(e){return Cn(e,"svg, .djs-element",!0)}function p(e){function t(e){var i,r,t=d(e.target),t=t&&s.get(t);if(u&&a.getRootElement()!==t)return u.start(e,t,!0);function n(e){var t=e.deltaX-i,n=e.deltaY-r;a.scroll({dx:t,dy:n}),i=e.deltaX,r=e.deltaY}function o(e){c.off("panmove",n),c.off("panend",o),c.off("pancancel",o)}r=i=0,c.on("panmove",n),c.on("panend",o),c.on("pancancel",o)}(c=Ba(e)).on("tap",l("element.click")),c.on("doubletap",l("element.dblclick",1)),c.on("panstart",t),c.on("press",t),c.on("pinchstart",function(e){var n=a.zoom(),i=e.center;function t(e){var t=1-(1-e.scale)/1.5,t=Math.max(.2,Math.min(4,t*n));a.zoom(t,i),Na(e)}function r(e){c.off("pinchmove",t),c.off("pinchend",r),c.off("pinchcancel",r),c.reset(!0)}c.on("pinchmove",t),c.on("pinchend",r),c.on("pinchcancel",r)})}i&&t.on("drag.move",function(e){var t,n=e.originalEvent;!n||n instanceof MouseEvent||(n=Ao(n),(t=(n=d(document.elementFromPoint(n.x,n.y)))&&s.get(n))!==e.hover&&(e.hover&&i.out(e),t)&&(i.hover({element:t,gfx:n}),e.hover=t,e.hoverGfx=n))}),n&&t.on("contextPad.create",function(e){e=Ba(e.pad.html);e.on("panstart",function(e){n.trigger("dragstart",e,!0)}),e.on("press",function(e){n.trigger("dragstart",e,!0)}),e.on("tap",function(e){n.trigger("click",e)})}),o&&t.on("palette.create",function(e){e=Ba(e.container);e.on("panstart",function(e){o.trigger("dragstart",e,!0)}),e.on("press",function(e){o.trigger("dragstart",e,!0)}),e.on("tap",function(e){o.trigger("click",e)})}),t.on("canvas.init",function(e){p(e.svg)})}function Va(e,t){var n=this;t.on("canvas.init",function(e){n.addBBoxMarker(e.svg)})}La.$inject=["injector","canvas","eventBus","elementRegistry","interactionEvents","touchFix"],Va.$inject=["canvas","eventBus"],Va.prototype.addBBoxMarker=function(e){var t={fill:"none",class:"outer-bound-marker"},n=O("rect"),n=(S(n,{x:-1e4,y:1e4,width:10,height:10}),S(n,t),w(e,n),O("rect"));S(n,{x:1e4,y:1e4,width:10,height:10}),S(n,t),w(e,n)};var $a={__depends__:[{__depends__:[e],__init__:["touchInteractionEvents"],touchInteractionEvents:["type",La],touchFix:["type",Va]}]};function za(e){va.call(this,e)}function Fa(e){return e&&e[e.length-1]}function Ua(e){return e.y}function Ha(e){return e.x}Yn(za,va),za.prototype._modules=[].concat(za.prototype._modules,za.prototype._navigationModules=[Wr,ca,$a]);var Wa={left:Ha,center:Ha,right:function(e){return e.x+e.width},top:Ua,middle:Ua,bottom:function(e){return e.y+e.height}};function qa(e,t){this._modeling=e,this._rules=t}qa.$inject=["modeling","rules"],qa.prototype._getOrientationDetails=function(e){var t="x",n="width";return-1!==["top","bottom","middle"].indexOf(e)&&(t="y",n="height"),{axis:t,dimension:n}},qa.prototype._isType=function(e,t){return-1!==t.indexOf(e)},qa.prototype._alignmentPosition=function(e,t){var n,i,r=this._getOrientationDetails(e),o=r.axis,a=r.dimension,r={},s={},c=!1;if(this._isType(e,["left","top"]))r[e]=t[0][o];else if(this._isType(e,["right","bottom"]))i=Fa(t),r[e]=i[o]+i[a];else if(this._isType(e,["center","middle"])){if(y(t,function(e){var t=e[o]+Math.round(e[a]/2);s[t]?s[t].elements.push(e):s[t]={elements:[e],center:t}}),n=pe(s,function(e){return 1<e.elements.length&&(c=!0),e.elements.length}),c)return r[e]=Fa(n).center,r;n=t[0],i=Fa(t=pe(t,function(e){return e[o]+e[a]})),r[e]=(t=i,Math.round((n[o]+t[o]+t[a])/2))}return r},qa.prototype.trigger=function(e,t){var n=this._modeling,e=re(e,function(e){return!(e.waypoints||e.host||e.labelTarget)}),i=this._rules.allowed("elements.align",{elements:e});(e=m(i)?i:e).length<2||!i||(i=pe(e,Wa[t]),e=this._alignmentPosition(t,i),n.alignElements(i,e))};var Wr={__init__:["alignElements"],alignElements:["type",qa]},Ga=10,Ka=50;function Xa(e,t,n,i){for(var r;r=function(e,t,n){var i={x:t.x-n.width/2,y:t.y-n.height/2,width:n.width,height:n.height};return ie(function(e){var t=Za(e);e.host&&(t=t.concat(Za(e.host)));e.attachers&&(t=t.concat(e.attachers.reduce(function(e,t){return e.concat(Za(t))},[])));return t}(e),function(e){return e!==n&&"intersect"===Mr(e,i,Ga)})}(e,n,t);)n=i(t,n,r);return n}function Ya(i,e){var t=(e=e||{}).defaultDistance||Ka,n=e.direction||"e",r=e.filter,o=e.getWeight||function(e){return e.source===i?1:-1},a=e.maxDistance||250,s=e.reference||"start";function c(e,t){return"n"===n?"start"===s?P(e).top-P(t).bottom:"center"===s?P(e).top-D(t).y:P(e).top-P(t).top:"w"===n?"start"===s?P(e).left-P(t).right:"center"===s?P(e).left-D(t).x:P(e).left-P(t).left:"s"===n?"start"===s?P(t).top-P(e).bottom:"center"===s?D(t).y-P(e).bottom:P(t).bottom-P(e).bottom:"start"===s?P(t).left-P(e).right:"center"===s?D(t).x-P(e).right:P(t).right-P(e).right}r=r||Qa,e=i.incoming.filter(r).map(function(e){var t=o(e),n=t<0?c(e.source,i):c(i,e.source);return{id:e.source.id,distance:n,weight:t}}),r=i.outgoing.filter(r).map(function(e){var t=o(e),n=0<t?c(i,e.target):c(e.target,i);return{id:e.target.id,distance:n,weight:t}});return oe(e.concat(r).reduce(function(e,t){return e[t.id+"__weight_"+t.weight]=t,e},{}),function(e,t){var n=t.distance,t=t.weight;return n<0||a<n||(e[String(n)]||(e[String(n)]=0),e[String(n)]+=+t,(!e.distance||e[e.distance]<e[String(n)])&&(e.distance=n)),e},{}).distance||t}function Za(e){return e.outgoing.map(function(e){return e.target}).concat(e.incoming.map(function(e){return e.source}))}function Qa(){return!0}function Ja(r,o,t){r.on("autoPlace",100,function(e){var t,n,i=e.shape,e=e.source;return i=i,t=(t=t||{}).defaultDistance||Ka,n=D(e=e),{x:P(e).right+t+i.width/2,y:n.y}}),r.on("autoPlace.end",function(e){t.scrollToElement(e.shape)}),this.append=function(e,t,n){r.fire("autoPlace.start",{source:e,shape:t});var i=r.fire("autoPlace",{source:e,shape:t}),t=o.appendShape(e,t,i,e.parent,n);return r.fire("autoPlace.end",{source:e,shape:t}),t}}function es(e,t){e.on("autoPlace.end",500,function(e){t.select(e.shape)})}Ja.$inject=["eventBus","modeling","canvas"],es.$inject=["eventBus","selection"];var ca={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",Ja],autoPlaceSelectionBehavior:["type",es]},ts={width:135,height:46},ns={width:180,height:80},is={width:125,height:45},rs={width:100,height:63};function os(e){io.call(this),this._drdFactory=e}Yn(os,io),os.$inject=["drdFactory"],os.prototype.baseCreate=io.prototype.create,os.prototype.create=function(e,t){return this.createDrdElement(e,t)},os.prototype.createDrdElement=function(e,t){var n=this._drdFactory,i=(t=t||{}).businessObject;if(!i){if(!t.type)throw new Error("no shape type specified");i=n.create(t.type)}return i.di||("connection"===e?i.di=n.createDiEdge(i,[]):"shape"===e&&(i.di=n.createDiShape(i,{}))),n=this._getDefaultSize(i),t=C({businessObject:i,id:i.id},n,t),this.baseCreate(e,t)},os.prototype._getDefaultSize=function(e){return k(e,"dmn:BusinessKnowledgeModel")?ts:k(e,"dmn:Decision")?ns:k(e,"dmn:InputData")?is:k(e,"dmn:KnowledgeSource")?rs:{width:100,height:80}};var as="left",ss="right",cs=60,us=ns.width;function ls(e,t){var n,i,r;return k(t,"dmn:TextAnnotation")?(i={x:(i=P(e)).right+t.width/2,y:i.top-50-t.height/2},Xa(e,t,i,function(c){return function(r,o,a){var s={x:o.x,y:o.y};return["x","y"].forEach(function(e){var t,n,i=c[e];i&&(t="x"===e?"width":"height",n=i.margin,i=i.minDistance,s[e]=n<0?Math.min(a[e]+n-r[t]/2,o[e]-i+n):Math.max(a[e]+a[t]+n+r[t]/2,o[e]+i+n))}),s}}({y:{margin:-30,minDistance:20}}))):k(t,"dmn:DRGElement")?(i=t,t=P(n=e),e=D(n),r=Ya(n,{defaultDistance:180,direction:"s",getWeight:function(e){return e.target===n?1:-1},filter:ds,reference:"center"}),e={x:e.x,y:t.bottom+r},Xa(n,i,e,function(e){var i,r,o=D(e);return function(e,t,n){n=i?(t.x<o.x?i=n:r=n,ps(o,D(i))<ps(o,D(r))?as:ss):0<D(r=i=n).x-o.x?as:ss;return n===as?{x:Math.min(D(i).x-us-cs,P(i).left-cs-e.width/2),y:t.y}:{x:Math.max(D(r).x+us+cs,P(r).right+cs+e.width/2),y:t.y}}}(n))):void 0}function ds(e){return!k(e,"dmn:Association")}function ps(e,t){return Math.abs(t.x-e.x)}function hs(e){e.on("autoPlace",function(e){var t=e.shape;return ls(e.source,t)})}hs.$inject=["eventBus"];$a={__depends__:[ca],__init__:["dmnAutoPlace"],dmnAutoPlace:["type",hs]};function fs(r,t,e){var n,i,o=this,a=e.get("dragging",!1);a&&t.on("drag.start",function(e){t.once("drag.move",1500,function(e){var t,n,i;(e=e).hover||(t=e.originalEvent,i=(n=o._findTargetGfx(t))&&r.get(n),n&&i&&(e.stopPropagation(),a.hover({element:i,gfx:n}),a.move(t)))})}),t.on("element.hover",function(e){n=e.gfx,i=e.element}),t.on("element.hover",1500,function(e){i&&t.fire("element.out",{element:i,gfx:n})}),t.on("element.out",function(){i=n=null}),this._findTargetGfx=function(e){if(e instanceof MouseEvent)return e=Ao(e),Cn(document.elementFromPoint(e.x,e.y),"svg, .djs-element",!0)}}fs.$inject=["elementRegistry","eventBus","injector"];var ca={__init__:["hoverFix"],hoverFix:["type",fs]},ms=["c","C","KeyC"],gs=["v","V","KeyV"],vs=["y","Y","KeyY"],ys=["z","Z","KeyZ"];function _s(e){return!e.altKey&&(e.ctrlKey||e.metaKey)}function bs(e,t){return-1!==(e=m(e)?e:[e]).indexOf(t.key)||-1!==e.indexOf(t.code)}function xs(e){return e.shiftKey}var ws=Math.round,Cs="djs-drag-active";function Es(e){e.preventDefault()}function ks(l,c,u,n){var d,p={threshold:5,trapClick:!0};function h(e){var t=c.viewbox(),n=c._container.getBoundingClientRect();return{x:t.x+(e.x-n.left)/t.scale,y:t.y+(e.y-n.top)/t.scale}}function f(e,t){t=t||d;var n=l.createEvent(C({},t.payload,t.data,{isTouch:t.isTouch}));return!1!==l.fire("drag."+e,n)&&l.fire(t.prefix+"."+e,n)}function m(e,t){var n=d.payload,i=d.displacement,r=d.globalStart,o=Ao(e),r=_a(o,r),a=d.localStart,o=h(o),s=_a(o,a);if(!d.active&&(t||(t=r,Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))>d.threshold))){if(C(n,{x:ws(a.x+i.x),y:ws(a.y+i.y),dx:0,dy:0},{originalEvent:e}),!1===f("start"))return w();d.active=!0,d.keepSelection||(n.previousSelection=u.get(),u.select(null)),d.cursor&&Sa(d.cursor),c.addMarker(c.getRootElement(),Cs)}Io(e),d.active&&(C(n,{x:ws(o.x+i.x),y:ws(o.y+i.y),dx:ws(s.x),dy:ws(s.y)},{originalEvent:e}),f("move"))}function g(e){var t=!0;d.active&&(e&&Io(d.payload.originalEvent=e),t=f("end")),!1===t&&f("rejected"),f("ended",i(!0!==t))}function v(e){bs("Escape",e)&&(Es(e),w())}function y(e){var t;d.active&&(t=Pa(l),setTimeout(t,400),Es(e)),g(e)}function _(e){m(e)}function b(e){var t=d.payload;t.hoverGfx=e.gfx,t.hover=e.element,f("hover")}function x(e){f("out");var t=d.payload;t.hoverGfx=null,t.hover=null}function w(e){var t;d&&((t=d.active)&&f("cancel"),e=i(e),t)&&f("canceled",e)}function i(e){f("cleanup"),ja(),t=d.trapClick?y:g,E.unbind(document,"mousemove",m),E.unbind(document,"dragstart",Es),E.unbind(document,"selectstart",Es),E.unbind(document,"mousedown",t,!0),E.unbind(document,"mouseup",t,!0),E.unbind(document,"keyup",v),E.unbind(document,"touchstart",_,!0),E.unbind(document,"touchcancel",w,!0),E.unbind(document,"touchmove",m,!0),E.unbind(document,"touchend",g,!0),l.off("element.hover",b),l.off("element.out",x),c.removeMarker(c.getRootElement(),Cs);var t=d.payload.previousSelection;return!1!==e&&t&&!u.get().length&&(e=(e=t).filter(function(e){return n.get(e.id)})).length&&u.select(e),t=d,d=null,t}l.on("diagram.destroy",w),this.init=function(e,t,n,i){d&&w(!1),"string"==typeof t&&(i=n,n=t,t=null);var r,o,a,s,c=(i=C({},p,i||{})).data||{},u=i.trapClick?y:g;e?(s=Mo(e)||e,r=Ao(e),Io(e),"dragstart"===s.type&&Es(s)):(s=null,r={x:0,y:0}),o=h(r),t=t||o,s=s,a="undefined"!=typeof TouchEvent&&s instanceof TouchEvent,d=C({prefix:n,data:c,payload:{},globalStart:r,displacement:_a(t,o),localStart:o,isTouch:a},i),i.manual||(a?(E.bind(document,"touchstart",_,!0),E.bind(document,"touchcancel",w,!0),E.bind(document,"touchmove",m,!0),E.bind(document,"touchend",g,!0)):(E.bind(document,"mousemove",m),E.bind(document,"dragstart",Es),E.bind(document,"selectstart",Es),E.bind(document,"mousedown",u,!0),E.bind(document,"mouseup",u,!0)),E.bind(document,"keyup",v),l.on("element.hover",b),l.on("element.out",x)),f("init"),i.autoActivate&&m(e,!0)},this.move=m,this.hover=b,this.out=x,this.end=g,this.cancel=w,this.context=function(){return d},this.setOptions=function(e){C(p,e)}}ks.$inject=["eventBus","canvas","selection","elementRegistry"];ca={__depends__:[ca,Yo],dragging:["type",ks]};function Ss(e,t,n){this._canvas=n,this._opts=C({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var i=this;t.on("drag.move",function(e){e=i._toBorderPoint(e);i.startScroll(e)}),t.on(["drag.cleanup"],function(){i.stopScroll()})}Ss.$inject=["config.autoScroll","eventBus","canvas"],Ss.prototype.startScroll=function(e){for(var t=this._canvas,n=this._opts,i=this,r=t.getContainer().getBoundingClientRect(),o=[e.x,e.y,r.width-e.x,r.height-e.y],a=(this.stopScroll(),0),s=0,c=0;c<4;c++)!function(e,t,n){if(t<e&&e<n)return 1;return}(o[c],n.scrollThresholdOut[c],n.scrollThresholdIn[c])||(0===c?a=n.scrollStep:1==c?s=n.scrollStep:2==c?a=-n.scrollStep:3==c&&(s=-n.scrollStep));0===a&&0===s||(t.scroll({dx:a,dy:s}),this._scrolling=setTimeout(function(){i.startScroll(e)},n.scrollRepeatTimeout))},Ss.prototype.stopScroll=function(){clearTimeout(this._scrolling)},Ss.prototype.setOptions=function(e){this._opts=C({},this._opts,e)},Ss.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),e=Ao(e.originalEvent);return{x:e.x-t.left,y:e.y-t.top}};var js={__depends__:[ca],__init__:["autoScroll"],autoScroll:["type",Ss]};function Os(e){this._commandStack=e.get("commandStack",!1)}Os.$inject=["injector"],Os.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return void 0===(n=i?i.canExecute(e,t):n)||n};var Ps={__init__:["rules"],rules:["type",Os]},Ds=Math.round,Rs=Math.max;function Ts(e,t){return function(e,t){for(var n,i=0;n=e[i];i++)if(Gi(n,t)<=10)return{point:e[i],bendpoint:!0,index:i};return null}(e,t)||(e=e,i=(t=Pr((i=10,[["M",(t=t).x,t.y],["m",0,-i],["a",i,i,0,1,1,0,2*i],["a",i,i,0,1,1,0,-2*i],["z"]]),(n=[],e.forEach(function(e,t){n.push([0===t?"M":"L",e.x,e.y])}),n)))[0],t=t[t.length-1],i?i!==t?i.segment2!==t.segment2?{point:e[e=Rs(i.segment2,t.segment2)-1],bendpoint:!0,index:e}:{point:{x:Ds(i.x+t.x)/2,y:Ds(i.y+t.y)/2},index:i.segment2}:{point:{x:Ds(i.x),y:Ds(i.y)},index:i.segment2}:null);var n,i}function Ms(e,t){var n,i,r=t[0],t=t[1],t={x:t.x-r.x,y:t.y-r.y},e=(n=[r.x,r.y],i=[t.x,t.y],e=[e.x,e.y],-((n=[{n:n[0]-e[0],lambda:i[0]},{n:n[1]-e[1],lambda:i[1]}])[0].n*i[0]+n[1].n*i[1])/(n[0].lambda*i[0]+n[1].lambda*i[1]));return{x:r.x+e*t.x,y:r.y+e*t.y}}function Is(e,t){t=Ms(e,t),t={x:t.x-e.x,y:t.y-e.y};return e=t,Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}var As="djs-bendpoint",Ns="djs-segment-dragger";function Bs(e,t,n){var i;return e=e,n=Ao(n=n),i={x:(i=e._container.getBoundingClientRect()).left,y:i.top},Ts(t,{x:(e=e.viewbox()).x+(n.x-i.x)/e.scale,y:e.y+(n.y-i.y)/e.scale})}function Ls(e,t){var n=O("g"),e=(j(n).add(As),w(e,n),O("circle")),e=(S(e,{cx:0,cy:0,r:4}),j(e).add("djs-visual"),w(n,e),O("circle"));return S(e,{cx:0,cy:0,r:10}),j(e).add("djs-hit"),w(n,e),t&&j(n).add(t),n}function Vs(e,t,n,i){var r=O("g"),n=(w(e,r),o=(e=n).x-t.x,e=n.y-t.y,zs("h"===i?o:e)),t=O("rect"),o=(S(t,{x:-9,y:-3,width:18,height:6}),j(t).add("djs-visual"),w(r,t),O("rect"));S(o,{x:-n/2,y:-8.5,width:n,height:17}),j(o).add("djs-hit"),w(r,o),e=r,t="v"===i?90:0,(n=wi()).setRotate(t,0,0),Di(e,n)}function $s(e,t,n){var i=O("g"),r=Zi(t,n),o=Yi(t,n);return w(e,i),Vs(i,t,n,o),j(i).add(Ns),j(i).add("h"===o?"horizontal":"vertical"),oo(i,r.x,r.y),i}function zs(e){return Math.abs(Math.round(2*e/3))}function Fs(e,t){return Ms(e,function(e,t){for(var n,i=t.waypoints,r=1/0,o=0;o<i.length-1;o++){var a=i[o],s=i[o+1],a=Is(e,[a,s]);a<r&&(r=a,n=o)}return[i[n],i[n+1]]}(e,t))}var Us=Ta(function(e,t){e.exports=function(e){if(e.CSS&&e.CSS.escape)return e.CSS.escape;var t=function e(t){if(arguments.length==0)throw new TypeError("`CSS.escape` requires an argument.");var n=String(t);var i=n.length;var r=-1;var o;var a="";var s=n.charCodeAt(0);while(++r<i){o=n.charCodeAt(r);if(o==0){a+="";continue}if(o>=1&&o<=31||o==127||r==0&&o>=48&&o<=57||r==1&&o>=48&&o<=57&&s==45){a+="\\"+o.toString(16)+" ";continue}if(r==0&&i==1&&o==45){a+="\\"+n.charAt(r);continue}if(o>=128||o==45||o==95||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122){a+=n.charAt(r);continue}a+="\\"+n.charAt(r)}return a};if(!e.CSS)e.CSS={};return e.CSS.escape=t}(typeof Ra!="undefined"?Ra:Ra)});function Hs(e,c,i,u,l){function n(e,t){var n,i,r,o,a=t.waypoints,s=Bs(c,a,e);if(s)return n=s,i=(i=t).waypoints,n=!(n.index<=0||n.bendpoint)&&(n=Yi((i={start:i[n.index-1],end:i[n.index]}).start,i.end))?zs("h"===n?i.end.x-i.start.x:i.end.y-i.start.y)/2:null,i=a,a=n,r=(n=s).index,o=n.point,!(r<=0||n.bendpoint)&&(r=Zi(n=i[r-1],i=i[r]),n=Yi(n,i),i=Math.abs(o.x-r.x),o=Math.abs(o.y-r.y),n)&&i<=a&&o<=a?l.start(e,t,s.index):u.start(e,t,s.index,!s.bendpoint),!0}function a(e,t,n){E.bind(e,t,function(e){i.triggerMouseEvent(t,e,n),e.stopPropagation()})}function o(e,t){var n=c.getLayer("overlays"),i=b('.djs-bendpoints[data-element-id="'+Us(e.id)+'"]',n);return!i&&t&&(S(i=O("g"),{"data-element-id":e.id}),j(i).add("djs-bendpoints"),w(n,i),a(i,"mousedown",e),a(i,"click",e),a(i,"dblclick",e)),i}function s(e,t){return b('.djs-segment-dragger[data-segment-idx="'+e+'"]',t)}function r(i,e){e.waypoints.forEach(function(e,t){var n=Ls(i);w(i,n),oo(n,e.x,e.y)}),Ls(i,"floating")}function d(e,t){for(var n,i,r=t.waypoints,o=1;o<r.length;o++)Yi(i=r[o-1],n=r[o])&&(S(i=$s(e,i,n),{"data-segment-idx":o}),a(i,"mousemove",t))}function p(e){var t=o(e);return t||(r(t=o(e,!0),e),d(t,e)),t}function t(e){var t=o(e);t&&(y(Rn("."+Ns,t),function(e){hi(e)}),y(Rn("."+As,t),function(e){hi(e)}),d(t,e),r(t,e))}function h(e,t,n){var e=s(t.index,e),i=n[t.index-1],n=n[t.index],t=t.point,r=Zi(i,n),i=Yi(i,n);e&&(n=b(".djs-visual",e),e={x:t.x-r.x,y:t.y-r.y},oo(n,(e="v"===i?{x:e.y,y:e.x}:e).x,e.y))}e.on("connection.changed",function(e){t(e.element)}),e.on("connection.remove",function(e){e=o(e.element);e&&hi(e)}),e.on("element.marker.update",function(e){var t=e.element;t.waypoints&&(t=p(t),e.add?j(t).add(e.marker):j(t).remove(e.marker))}),e.on("element.mousemove",function(e){var t,n,i=e.element,r=i.waypoints;r&&(i=o(i,!0),e=Bs(c,r,e.originalEvent))&&(n=e,t=b(".floating",t=i),n=n.point,t&&oo(t,n.x,n.y),e.bendpoint||h(i,e,r))}),e.on("element.mousedown",function(e){if(Bo(e)){var t=e.originalEvent,e=e.element;if(e.waypoints)return n(t,e)}}),e.on("selection.changed",function(e){e=e.newSelection[0];e&&e.waypoints&&p(e)}),e.on("element.hover",function(e){var t=e.element;t.waypoints&&(p(t),i.registerEvent(e.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(e){i.unregisterEvent(e.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(e){var t=e.element,e=e.newId;t.waypoints&&(t=o(t))&&S(t,{"data-element-id":e})}),this.addHandles=p,this.updateHandles=t,this.getBendpointsContainer=o,this.getSegmentDragger=s}Hs.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];var Ws=Math.round,qs="reconnectStart",Gs="reconnectEnd",Ks="updateWaypoints";function Xs(e,t,l,d,p,h){this._injector=e,this.start=function(e,t,n,i){var r=l.getGraphics(t),o=t.source,a=t.target,s=t.waypoints,s=i||0!==n?i||n!==s.length-1?Ks:Gs:qs,c=s===Ks?"connection.updateWaypoints":"connection.reconnect",u=p.allowed(c,{connection:t,source:o,target:a});!1!==(u=!1===u?p.allowed(c,{connection:t,source:a,target:o}):u)&&d.init(e,"bendpoint.move",{data:{connection:t,connectionGfx:r,context:{allowed:u,bendpointIndex:n,connection:t,source:o,target:a,insert:i,type:s}}})},t.on("bendpoint.move.hover",function(e){var t,n,i=e.context,r=i.connection,o=r.source,a=r.target,e=e.hover,s=i.type;(i.hover=e)&&((n=i.allowed=p.allowed(t=s===Ks?"connection.updateWaypoints":"connection.reconnect",{connection:r,source:s===qs?e:o,target:s===Gs?e:a}))?(i.source=s===qs?e:o,i.target=s===Gs?e:a):(n=!1===n?i.allowed=p.allowed(t,{connection:r,source:s===Gs?e:a,target:s===qs?e:o}):n)&&(i.source=s===Gs?e:a,i.target=s===qs?e:o))}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(e){var e=e.context,t=e.type;e.hover=null,e.source=null,e.target=null,t!==Ks&&(e.allowed=!1)}),t.on("bendpoint.move.end",function(e){var t=e.context,n=t.allowed,i=t.bendpointIndex,r=t.connection,o=t.insert,a=r.waypoints.slice(),s=t.source,c=t.target,u=t.type,l=t.hints||{},e={x:Ws(e.x),y:Ws(e.y)};if(!n)return!1;u===Ks?(o?a.splice(i,0,e):a[i]=e,l.bendpointMove={insert:o,bendpointIndex:i},a=this.cropWaypoints(r,a),h.updateWaypoints(r,function(e){e=e.slice();for(var t,n,i,r=0;e[r];)t=e[r],n=e[r-1],0===Gi(t,i=e[r+1])||Ki(n,i,t)?e.splice(r,1):r++;return e}(a),l)):(u===qs?(l.docking="source",Ys(t)&&(l.docking="target",l.newWaypoints=a.reverse())):u===Gs&&(l.docking="target",Ys(t))&&(l.docking="source",l.newWaypoints=a.reverse()),h.reconnect(r,s,c,e,l))},this)}function Ys(e){var t=e.hover,n=e.source,i=e.target,e=e.type;return e===qs?t&&i&&t===i&&n!==i:e===Gs&&t&&n&&t===n&&n!==i}Xs.$inject=["injector","eventBus","canvas","dragging","rules","modeling"],Xs.prototype.cropWaypoints=function(e,t){var n,i=this._injector.get("connectionDocking",!1);return i&&(n=e.waypoints,e.waypoints=t,e.waypoints=i.getCroppedWaypoints(e),t=e.waypoints,e.waypoints=n),t};var Zs="updateWaypoints",Qs="connect-ok",Js="connect-not-ok",ec="connect-hover",tc="djs-updating",nc="djs-element-hidden";function ic(f,e,t,s){var m=(this._injector=e).get("connectionPreview",!1);t.on("bendpoint.move.start",function(e){var t=e.context,n=t.bendpointIndex,i=t.connection,r=t.insert,o=i.waypoints,a=o.slice();t.waypoints=o,r&&a.splice(n,0,{x:e.x,y:e.y}),i.waypoints=a,j(t.draggerGfx=Ls(s.getLayer("overlays"))).add("djs-dragging"),s.addMarker(i,nc),s.addMarker(i,tc)}),t.on("bendpoint.move.hover",function(e){var e=e.context,t=e.allowed,n=e.hover,e=e.type;n&&(s.addMarker(n,ec),e!==Zs)&&(t?(s.removeMarker(n,Js),s.addMarker(n,Qs)):!1===t&&(s.removeMarker(n,Qs),s.addMarker(n,Js)))}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],1100,function(e){var e=e.context,t=e.hover,e=e.target;t&&(s.removeMarker(t,ec),s.removeMarker(t,e?Qs:Js))}),t.on("bendpoint.move.move",function(e){var t=e.context,n=t.allowed,i=t.bendpointIndex,r=t.draggerGfx,o=t.hover,a=t.type,s=t.connection,c=s.source,u=s.target,l=s.waypoints.slice(),d={x:e.x,y:e.y},p=t.hints||{},h={};m&&(p.connectionStart&&(h.connectionStart=p.connectionStart),p.connectionEnd&&(h.connectionEnd=p.connectionEnd),"reconnectStart"===a?Ys(t)?(h.connectionEnd=h.connectionEnd||d,h.source=u,h.target=o||c,l=l.reverse()):(h.connectionStart=h.connectionStart||d,h.source=o||c,h.target=u):"reconnectEnd"===a?Ys(t)?(h.connectionStart=h.connectionStart||d,h.source=o||u,h.target=c,l=l.reverse()):(h.connectionEnd=h.connectionEnd||d,h.source=c,h.target=o||u):(h.noCropping=!0,h.noLayout=!0,l[i]=d),a===Zs&&(l=f.cropWaypoints(s,l)),h.waypoints=l,m.drawPreview(t,n,h)),oo(r,e.x,e.y)},this),t.on(["bendpoint.move.end","bendpoint.move.cancel"],1100,function(e){var e=e.context,t=e.connection,n=e.draggerGfx,i=e.hover,r=e.target,o=e.waypoints;t.waypoints=o,hi(n),s.removeMarker(t,tc),s.removeMarker(t,nc),i&&(s.removeMarker(i,Qs),s.removeMarker(i,r?Qs:Js)),m&&m.cleanUp(e)})}ic.$inject=["bendpointMove","injector","eventBus","canvas"];var rc="connect-hover",oc="djs-updating";function ac(e,t,n){return sc(e,t,e[t]+n)}function sc(e,t,n){return{x:"x"===t?n:e.x,y:"y"===t?n:e.y}}function cc(e){return"x"===e?"y":"x"}function uc(e,t,n){return e.original||(t=D(t),sc(e,e=cc(n),t[e]))}function lc(e,t,l,d,n,c){var r=e.get("connectionDocking",!1);function h(e,t){var n,i;return r?(n=e.waypoints,e.waypoints=t,i=r.getCroppedWaypoints(e),e.waypoints=n,i):t}function f(e){n.update("connection",e.connection,e.connectionGfx)}function m(e,t,n){var i,r=e.newWaypoints,o=r[e.segmentStartIndex+t],r=r[e.segmentEndIndex+t],t=cc(e.axis),o=(n=n,o=o,r=r,t=t,i=Math.max(o[t],r[t]),r=Math.min(o[t],r[t]),sc(o,t,Math.min(Math.max(r+20,n[t]),i-20)));oo(e.draggerGfx,o.x,o.y)}this.start=function(e,t,n){var i=l.getGraphics(t),r=n-1,o=t.waypoints,a=o[r],s=o[n],c=Bs(l,o,e),u=Yi(a,s);u&&(u="v"===u?"x":"y",0==r&&(a=uc(a,t.source,u)),n===o.length-1&&(s=uc(s,t.target,u)),o=c?c.point:{x:(a.x+s.x)/2,y:(a.y+s.y)/2},d.init(e,o,"connectionSegment.move",{cursor:"x"==u?"resize-ew":"resize-ns",data:{connection:t,connectionGfx:i,context:{connection:t,segmentStartIndex:r,segmentEndIndex:n,segmentStart:a,segmentEnd:s,axis:u,dragPosition:o}}}))},t.on("connectionSegment.move.start",function(e){var t=e.context,e=e.connection,n=l.getLayer("overlays");t.originalWaypoints=e.waypoints.slice(),t.draggerGfx=$s(n,t.segmentStart,t.segmentEnd),j(t.draggerGfx).add("djs-dragging"),l.addMarker(e,oc)}),t.on("connectionSegment.move.move",function(e){var t,n=e.context,i=n.connection,r=n.segmentStartIndex,o=n.segmentEndIndex,a=n.segmentStart,s=n.segmentEnd,c=n.axis,u=n.originalWaypoints.slice(),l=ac(a,c,e["d"+c]),c=ac(s,c,e["d"+c]),d=u.length,p=0;u[r]=l,u[o]=c,r<2&&(t=Mr(i.source,l),1===r?"intersect"===t&&(u.shift(),u[0]=l,p--):"intersect"!==t&&(u.unshift(a),p++)),d-3<o&&(l=Mr(i.target,c),o===d-2?"intersect"===l&&(u.pop(),u[u.length-1]=c):"intersect"!==l&&u.push(s)),n.newWaypoints=i.waypoints=h(i,u),m(n,p,e),n.newSegmentStartIndex=r+p,f(e)}),t.on("connectionSegment.move.hover",function(e){e.context.hover=e.hover,l.addMarker(e.hover,rc)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(e){e=e.context.hover;e&&l.removeMarker(e,rc)}),t.on("connectionSegment.move.cleanup",function(e){var e=e.context,t=e.connection;e.draggerGfx&&hi(e.draggerGfx),l.removeMarker(t,oc)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(e){var t=e.context;t.connection.waypoints=t.originalWaypoints,f(e)}),t.on("connectionSegment.move.end",function(e){var n,i,r,e=e.context,t=e.connection,o=e.newWaypoints,a=e.newSegmentStartIndex,o=o.map(function(e){return{original:e.original,x:Math.round(e.x),y:Math.round(e.y)}}),o=(i=a,r=0,{waypoints:(n=o).filter(function(e,t){return!Ki(n[t-1],n[t+1],e)||(r=t<=i?r-1:r,!1)}),segmentOffset:r}),s=h(t,o.waypoints),e={segmentMove:{segmentStartIndex:e.segmentStartIndex,newSegmentStartIndex:a+o.segmentOffset}};c.updateWaypoints(t,s,e)})}lc.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var dc=Math.abs,pc=Math.round;function hc(e,t){return!e||isNaN(e.x)||isNaN(e.y)?t:{x:pc(e.x+e.width/2),y:pc(e.y+e.height/2)}}function fc(e,t){e=e.snapped;return!!e&&("string"==typeof t?e[t]:e.x&&e.y)}function mc(e,t,n){if("string"!=typeof t)throw new Error("axis must be in [x, y]");if("number"!=typeof n&&!1!==n)throw new Error("value must be Number or false");var i=e[t],r=e.snapped=e.snapped||{};!1===n?r[t]=!1:(r[t]=!0,e[t]+=r=n-i,e["d"+t]+=r)}function gc(e){return e.children||[]}var vc=Math.abs,yc=Math.round;function _c(e){function d(e,t){if(m(e)){for(var n=e.length;n--;)if(vc(e[n]-t)<=10)return e[n]}else{var i=t%(e=+e);if(i<10)return t-i;if(e-10<i)return t-i+e}return t}function p(e,t){return e.waypoints?Fs(t,e):e.width?{x:yc(e.width/2+e.x),y:yc(e.height/2+e.y)}:void 0}e.on("connectionSegment.move.move",1500,function(e){s=(o=e).context,t=s.snapPoints,a=s.connection,r=a.waypoints,n=s.segmentStart,u=s.segmentStartIndex,c=s.segmentEnd,l=s.segmentEndIndex,i=s.axis,t||(n=[r[u-1],n,c,r[l+1]],u<2&&n.unshift(p(a.source,o)),l>r.length-3&&n.unshift(p(a.target,o)),s.snapPoints=t={horizontal:[],vertical:[]},y(n,function(e){e&&(e=e.original||e,"y"===i&&t.horizontal.push(e.y),"x"===i)&&t.vertical.push(e.x)}));var t,n,i,r,o,a,s,c=t,u=e.x,l=e.y;c&&(a=u-(r=d(c.vertical,u)),s=l-(o=d(c.horizontal,l)),C(e,{dx:e.dx-a,dy:e.dy-s,x:r,y:o}),!a&&-1===c.vertical.indexOf(u)||mc(e,"x",r),!s&&-1===c.horizontal.indexOf(l)||mc(e,"y",o))}),e.on(["connect.hover","connect.move","connect.end"],1500,function(e){var t=e.context.hover,n=t&&p(t,e);(t=t)&&t.waypoints&&n&&n.x&&n.y&&(mc(e,"x",n.x),mc(e,"y",n.y))}),e.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(e){var t,n,i,r,o=e.context,a=(t=(s=o).snapPoints,c=s.connection.waypoints,a=s.bendpointIndex,t||(c=[c[a-1],c[a+1]],s.snapPoints=t={horizontal:[],vertical:[]},y(c,function(e){e&&(e=e.original||e,t.horizontal.push(e.y),t.vertical.push(e.x))})),t),s=o.hover,c=s&&p(s,e),o=e.x,s=e.y;a&&(i=o-(n=d(c?a.vertical.concat([c.x]):a.vertical,o)),r=s-(c=d(c?a.horizontal.concat([c.y]):a.horizontal,s)),C(e,{dx:e.dx-i,dy:e.dy-r,x:e.x-i,y:e.y-r}),!i&&-1===a.vertical.indexOf(o)||mc(e,"x",n),!r&&-1===a.horizontal.indexOf(s)||mc(e,"y",c))})}_c.$inject=["eventBus"];var bc={__depends__:[ca,Ps],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",Hs],bendpointMove:["type",Xs],bendpointMovePreview:["type",ic],connectionSegmentMove:["type",lc],bendpointSnapping:["type",_c]};function xc(e,t,n,i){this._canvas=e,this._eventBus=n,this._overlays=i;e=Q(t&&t.scale)?t.scale:{min:1,max:1.5};this._overlaysConfig={scale:e},this._current=null,this._init()}function wc(e,t){return-1!==e.indexOf(t)}xc.$inject=["canvas","config.contextPad","eventBus","overlays"],xc.prototype._init=function(){var n=this;this._eventBus.on("selection.changed",function(e){e=e.newSelection,e=e.length?1===e.length?e[0]:e:null;e?n.open(e,!0):n.close()}),this._eventBus.on("elements.changed",function(e){var t=e.elements,e=n._current;e&&se(m(e=e.target)?e:[e],function(e){return wc(t,e)})&&n.open(e,!0)})},xc.prototype.registerProvider=function(e,t){t||(t=e,e=1e3),this._eventBus.on("contextPad.getProviders",e,function(e){e.providers.push(t)})},xc.prototype.getEntries=function(t){var e=this._getProviders(),n=m(t)?"getMultiElementContextPadEntries":"getContextPadEntries",i={};return y(e,function(e){te(e[n])&&(te(e=e[n](t))?i=e(i):y(e,function(e,t){i[t]=e}))}),i},xc.prototype.trigger=function(e,t,n){var i,r=t.delegateTarget||t.target;return r?(r=yn(r,"data-action"),i=t.originalEvent||t,this.triggerEntry(r,e,i,n)):t.preventDefault()},xc.prototype.triggerEntry=function(e,t,n,i){if(this.isShown()){var r=this._current.target,e=this._current.entries[e];if(e){e=e.action;if(te(e)){if("click"===t)return e(n,r,i)}else if(e[t])return e[t](n,r,i);n.preventDefault()}}},xc.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))},xc.prototype._getProviders=function(){var e=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(e),e.providers},xc.prototype._updateAndOpen=function(e){var o,t=this.getEntries(e),n=this.getPad(e),a=n.html;y(t,function(e,t){var n,i=e.group||"default",r=_(e.html||'<div class="entry" draggable="true"></div>');yn(r,"data-action",t),(t=b("[data-group="+Us(i)+"]",a))||(yn(t=_('<div class="group"></div>'),"data-group",i),a.appendChild(t)),t.appendChild(r),e.className&&(i=e.className,n=v(r),(i=m(i)?i:i.split(/\s+/g)).forEach(function(e){n.add(e)})),e.title&&yn(r,"title",e.title),e.imageUrl&&(yn(o=_("<img>"),"src",e.imageUrl),o.style.width="100%",o.style.height="100%",r.appendChild(o))}),v(a).add("open"),this._current={target:e,entries:t,pad:n},this._eventBus.fire("contextPad.open",{current:this._current})},xc.prototype.getPad=function(e){var t,n,i,r;return this.isOpen()?this._current.pad:(n=(t=this)._overlays,r=_('<div class="djs-context-pad"></div>'),i=this._getPosition(e),i=C({html:r},this._overlaysConfig,i),Pn.bind(r,".entry","click",function(e){t.trigger("click",e)}),Pn.bind(r,".entry","dragstart",function(e){t.trigger("dragstart",e)}),E.bind(r,"mousedown",function(e){e.stopPropagation()}),r=this._canvas.getRootElement(),this._overlayId=n.add(r,"context-pad",i),r=n.get(this._overlayId),this._eventBus.fire("contextPad.create",{target:e,pad:r}),r)},xc.prototype.close=function(){this.isOpen()&&(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)},xc.prototype.isOpen=function(e){var t,n=this._current;return!!n&&(!e||(t=n.target,m(e)===m(t)&&(m(e)?e.length===t.length&&ae(e,function(e){return wc(t,e)}):t===e)))},xc.prototype.isShown=function(){return this.isOpen()&&this._overlays.isShown()},xc.prototype._getPosition=function(e){e=Vi(m(e)?e:[e]);return{position:{left:e.x+e.width+12,top:e.y-6}}};ia={__depends__:[e,ia],contextPad:["type",xc]};function Cc(e,r,s,n){function o(e,t){return n.allowed("connection.create",{source:e,target:t})}e.on("connect.hover",function(e){var t,n=e.context,i=n.start,e=e.hover;n.hover=e,J(t=n.canExecute=o(i,e))||(!1!==t?(n.source=i,n.target=e):J(t=n.canExecute=o(e,i))||!1!==t&&(n.source=e,n.target=i))}),e.on(["connect.out","connect.cleanup"],function(e){e=e.context;e.hover=null,e.source=null,e.target=null,e.canExecute=!1}),e.on("connect.end",function(e){var t=e.context,n=t.canExecute,i=t.connectionStart,e={x:e.x,y:e.y},r=t.source,o=t.target;if(!n)return!1;var a=null,i={connectionStart:Ec(t)?e:i,connectionEnd:Ec(t)?i:e};ee(n)&&(a=n),t.connection=s.connect(r,o,a,i)}),this.start=function(e,t,n,i){ee(n)||(i=n,n=D(t)),r.init(e,"connect",{autoActivate:i,data:{shape:t,context:{start:t,connectionStart:n}}})}}function Ec(e){var t=e.hover,n=e.source,e=e.target;return t&&n&&t===n&&n!==e}Cc.$inject=["eventBus","dragging","modeling","rules"];var kc="connect-ok",Sc="connect-not-ok";function jc(e,t,n){var l=e.get("connectionPreview",!1);l&&t.on("connect.move",function(e){var t=e.context,n=t.canExecute,i=t.hover,r=t.source,o=t.start,a=t.startPosition,s=t.target,a=t.connectionStart||a,e=t.connectionEnd||{x:e.x,y:e.y},c=a,u=e;Ec(t)&&(c=e,u=a),l.drawPreview(t,n,{source:r||o,target:s||i,connectionStart:c,connectionEnd:u})}),t.on("connect.hover",900,function(e){var t=e.context,e=e.hover,t=t.canExecute;null!==t&&n.addMarker(e,t?kc:Sc)}),t.on(["connect.out","connect.cleanup"],1100,function(e){e=e.hover;e&&(n.removeMarker(e,kc),n.removeMarker(e,Sc))}),l&&t.on("connect.cleanup",function(e){l.cleanUp(e.context)})}jc.$inject=["injector","eventBus","canvas"];var Oc={__depends__:[Yo,Ps,ca],__init__:["connectPreview"],connect:["type",Cc],connectPreview:["type",jc]},Pc=["marker-start","marker-mid","marker-end"],Dc=["circle","ellipse","line","path","polygon","polyline","rect"];function Rc(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._styles=i,this._clonedMarkers={};var r=this;t.on("drag.cleanup",function(){y(r._clonedMarkers,function(e){hi(e)}),r._clonedMarkers={}})}Rc.$inject=["elementRegistry","eventBus","canvas","styles"],Rc.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)},Rc.prototype.addDragger=function(e,t,n){e=mi(n=n||this.getGfx(e)),n=n.getBoundingClientRect();return this._cloneMarkers(ro(e)),S(e,this._styles.cls("djs-dragger",[],{x:n.top,y:n.left})),w(t,e),e},Rc.prototype.addFrame=function(e,t){e=O("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return w(t,e),e},Rc.prototype._cloneMarkers=function(r){var o=this;if(r.childNodes)for(var e=0;e<r.childNodes.length;e++)o._cloneMarkers(r.childNodes[e]);-1!==Dc.indexOf(r.nodeName)&&Pc.forEach(function(e){var t,n,i;S(r,e)&&(t=r,n=e,i=o._canvas.getContainer(),t=b("marker#"+S(t,n).match(/url\(['"]?#([^'"]*)['"]?\)/)[1],i||document),o._cloneMarker(r,t,e))})},Rc.prototype._cloneMarker=function(e,t,n){var i=t.id,r=this._clonedMarkers[i];r||((r=mi(t)).id=i+"-clone",j(r).add("djs-dragger").add("djs-dragger-marker"),this._clonedMarkers[i]=r,(t=b("defs",this._canvas._svg))||(t=O("defs"),w(this._canvas._svg,t)),w(t,r)),S(e,n,"url(#"+this._clonedMarkers[i].id+")")};var Tc={__init__:["previewSupport"],previewSupport:["type",Rc]},Mc="drop-not-ok",Ic="attach-ok",Ac="new-parent";function Nc(i,o,e,l,d){function p(t,n){[Ic,"drop-ok",Mc,Ac].forEach(function(e){e===n?i.addMarker(t,e):i.removeMarker(t,e)})}function t(){var e=o.context();e&&"create"===e.prefix&&o.cancel()}e.on(["create.move","create.hover"],function(e){var n,t,i,r,o,a=e.context,s=a.elements,c=e.hover,u=a.source,l=a.hints||{};c?(Bc(e),e={x:e.x,y:e.y},u=a.canExecute=c&&(n=s,s=e,e=u,u=l,!!(l=c))&&(t=ie(n=re(n,function(e){var t=e.labelTarget;return!(e.parent||e.labelTarget&&-1!==n.indexOf(t))}),function(e){return!Lc(e)}),o=r=i=!1,(i=Vc(n)?d.allowed("shape.attach",{position:s,shape:t,target:l}):i)||(o=Vc(n)?d.allowed("shape.create",{position:s,shape:t,source:e,target:l}):d.allowed("elements.create",{elements:n,position:s,target:l})),s=u.connectionTarget,o||i?{attach:i,connect:r=t&&e?d.allowed("connection.create",{source:s===e?t:e,target:s===e?e:t,hints:{targetParent:l,targetAttach:i}}):r}:(null===o||null===i)&&null),c&&null!==u&&(a.target=c,u&&u.attach?p(c,Ic):p(c,u?Ac:Mc))):(a.canExecute=!1,a.target=null)}),e.on(["create.end","create.out","create.cleanup"],function(e){e=e.hover;e&&p(e,null)}),e.on("create.end",function(e){var t=e.context,n=t.source,i=t.shape,r=t.elements,o=t.target,a=t.canExecute,s=a&&a.attach,c=a&&a.connect,u=t.hints||{};if(!1===a||!o)return!1;Bc(e);a={x:e.x,y:e.y},i=c?l.appendShape(n,i,a,o,{attach:s,connection:!0===c?{}:c,connectionTarget:u.connectionTarget}):ie(r=l.createElements(r,a,o,C({},u,{attach:s})),function(e){return!Lc(e)});C(t,{elements:r,shape:i}),C(e,{elements:r,shape:i})}),e.on("create.init",function(){e.on("elements.changed",t),e.once(["create.cancel","create.end"],2e3,function(){e.off("elements.changed",t)})}),this.start=function(e,t,n){var i,r=ie(t=m(t)?t:[t],function(e){return!Lc(e)});r&&(n=C({elements:t,hints:{},shape:r},n||{}),y(t,function(e){g(e.x)||(e.x=0),g(e.y)||(e.y=0)}),i=Vi(re(t,function(e){return!e.hidden})),y(t,function(e){Lc(e)&&(e.waypoints=ce(e.waypoints,function(e){return{x:e.x-i.x-i.width/2,y:e.y-i.y-i.height/2}})),C(e,{x:e.x-i.x-i.width/2,y:e.y-i.y-i.height/2})}),o.init(e,"create",{cursor:"grabbing",autoActivate:!0,data:{shape:r,elements:t,context:n}}))}}function Bc(e){var t=e.context.createConstraints;t&&(t.left&&(e.x=Math.max(e.x,t.left)),t.right&&(e.x=Math.min(e.x,t.right)),t.top&&(e.y=Math.max(e.y,t.top)),t.bottom)&&(e.y=Math.min(e.y,t.bottom))}function Lc(e){return e.waypoints}function Vc(e){return e&&1===e.length&&!Lc(e[0])}Nc.$inject=["canvas","dragging","eventBus","modeling","rules"];function $c(s,e,c,u,l){e.on("create.move",750,function(e){var n,i,t=e.hover,r=e.context,o=r.elements,a=(a=r.dragGroup)||(r.dragGroup=(r=o,S(n=O("g"),l.cls("djs-drag-group",["no-events"])),i=O("g"),r.forEach(function(e){var t;e.hidden||(e.waypoints?(t=c._createContainer("connection",i),c.drawConnection(ro(t),e)):(t=c._createContainer("shape",i),c.drawShape(ro(t),e),oo(t,e.x,e.y)),u.addDragger(e,n,t))}),n));t?(a.parentNode||w(s.getActiveLayer(),a),oo(a,e.x,e.y)):hi(a)}),e.on("create.cleanup",function(e){e=e.context.dragGroup;e&&hi(e)})}$c.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];var zc,R,Fc,Uc,Hc,Wc={__depends__:[ca,Tc,Ps,Yo],__init__:["create","createPreview"],create:["type",Nc],createPreview:["type",$c]},qc={},Gc=[],Kc=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Xc(e,t){for(var n in t)e[n]=t[n];return e}function Yc(e){var t=e.parentNode;t&&t.removeChild(e)}function Zc(e,t,n){var i,r,o,a={};for(o in t)"key"==o?i=t[o]:"ref"==o?r=t[o]:a[o]=t[o];if(2<arguments.length&&(a.children=3<arguments.length?zc.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(o in e.defaultProps)void 0===a[o]&&(a[o]=e.defaultProps[o]);return Qc(e,a,i,r,null)}function Qc(e,t,n,i,r){e={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==r?++Fc:r};return null==r&&null!=R.vnode&&R.vnode(e),e}function Jc(e){return e.children}function eu(e,t){this.props=e,this.context=t}function tu(e,t){if(null==t)return e.__?tu(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?tu(e):null}function nu(e){(e.__d||(e.__d=!0,!Uc.push(e))||iu.__r++)&&Hc===R.debounceRendering||((Hc=R.debounceRendering)||setTimeout)(iu)}function iu(){for(var e;iu.__r=Uc.length;)e=Uc.sort(function(e,t){return e.__v.__b-t.__v.__b}),Uc=[],e.some(function(e){var t,n,i,r,o;e.__d&&(r=(i=(e=e).__v).__e,o=e.__P)&&(t=[],(n=Xc({},i)).__v=i.__v+1,lu(o,i,n,e.__n,void 0!==o.ownerSVGElement,null!=i.__h?[r]:null,t,null==r?tu(i):r,i.__h),du(t,i),i.__e!=r)&&function e(t){var n,i;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,n=0;n<t.__k.length;n++)if(null!=(i=t.__k[n])&&null!=i.__e){t.__e=t.__c.base=i.__e;break}return e(t)}}(i)})}function ru(e,t,n,i,r,o,a,s,c,u){var l,d,p,h,f,m,g,v=i&&i.__k||Gc,y=v.length;for(n.__k=[],l=0;l<t.length;l++)if(null!=(h=n.__k[l]=null==(h=t[l])||"boolean"==typeof h?null:"string"==typeof h||"number"==typeof h||"bigint"==typeof h?Qc(null,h,null,null,h):Array.isArray(h)?Qc(Jc,{children:h},null,null,null):0<h.__b?Qc(h.type,h.props,h.key,h.ref||null,h.__v):h)){if(h.__=n,h.__b=n.__b+1,null===(p=v[l])||p&&h.key==p.key&&h.type===p.type)v[l]=void 0;else for(d=0;d<y;d++){if((p=v[d])&&h.key==p.key&&h.type===p.type){v[d]=void 0;break}p=null}lu(e,h,p=p||qc,r,o,a,s,c,u),f=h.__e,(d=h.ref)&&p.ref!=d&&(g=g||[],p.ref&&g.push(p.ref,null,h),g.push(d,h.__c||f,h)),null!=f?(null==m&&(m=f),"function"==typeof h.type&&h.__k===p.__k?h.__d=c=function e(t,n,i){for(var r,o=t.__k,a=0;o&&a<o.length;a++)(r=o[a])&&(r.__=t,n="function"==typeof r.type?e(r,n,i):ou(i,r,r,o,r.__e,n));return n}(h,c,e):c=ou(e,h,p,v,f,c),"function"==typeof n.type&&(n.__d=c)):c&&p.__e==c&&c.parentNode!=e&&(c=tu(p))}for(n.__e=m,l=y;l--;)null!=v[l]&&function e(t,n,i){var r,o;if(R.unmount&&R.unmount(t),!(r=t.ref)||r.current&&r.current!==t.__e||pu(r,null,n),null!=(r=t.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(t){R.__e(t,n)}r.base=r.__P=null,t.__c=void 0}if(r=t.__k)for(o=0;o<r.length;o++)r[o]&&e(r[o],n,i||"function"!=typeof t.type);i||null==t.__e||Yc(t.__e),t.__=t.__e=t.__d=void 0}(v[l],v[l]);if(g)for(l=0;l<g.length;l++)pu(g[l],g[++l],g[++l])}function ou(e,t,n,i,r,o){var a,s,c;if(void 0!==t.__d)a=t.__d,t.__d=void 0;else if(null==n||r!=o||null==r.parentNode)e:if(null==o||o.parentNode!==e)e.appendChild(r),a=null;else{for(s=o,c=0;(s=s.nextSibling)&&c<i.length;c+=1)if(s==r)break e;e.insertBefore(r,o),a=o}return void 0!==a?a:r.nextSibling}function au(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||Kc.test(t)?n:n+"px"}function su(e,t,n,i,r){var o;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||au(e.style,t,"");if(n)for(t in n)i&&n[t]===i[t]||au(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])o=t!==(t=t.replace(/Capture$/,"")),t=(t.toLowerCase()in e?t.toLowerCase():t).slice(2),e.l||(e.l={}),(e.l[t+o]=n)?i||e.addEventListener(t,o?uu:cu,o):e.removeEventListener(t,o?uu:cu,o);else if("dangerouslySetInnerHTML"!==t){if(r)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"!=typeof n&&(null==n||!1===n&&-1==t.indexOf("-")?e.removeAttribute(t):e.setAttribute(t,n))}}function cu(e){this.l[e.type+!1](R.event?R.event(e):e)}function uu(e){this.l[e.type+!0](R.event?R.event(e):e)}function lu(e,t,n,i,r,o,a,s,c){var u,l,d,p,h,f,m,g,v,y,_,b,x,w,C,E=t.type;if(void 0===t.constructor){null!=n.__h&&(c=n.__h,s=t.__e=n.__e,t.__h=null,o=[s]),(u=R.__b)&&u(t);try{e:if("function"==typeof E){if(g=t.props,v=(u=E.contextType)&&i[u.__c],y=u?v?v.props.value:u.__:i,n.__c?m=(l=t.__c=n.__c).__=l.__E:("prototype"in E&&E.prototype.render?t.__c=l=new E(g,y):(t.__c=l=new eu(g,y),l.constructor=E,l.render=hu),v&&v.sub(l),l.props=g,l.state||(l.state={}),l.context=y,l.__n=i,d=l.__d=!0,l.__h=[],l._sb=[]),null==l.__s&&(l.__s=l.state),null!=E.getDerivedStateFromProps&&(l.__s==l.state&&(l.__s=Xc({},l.__s)),Xc(l.__s,E.getDerivedStateFromProps(g,l.__s))),p=l.props,h=l.state,d)null==E.getDerivedStateFromProps&&null!=l.componentWillMount&&l.componentWillMount(),null!=l.componentDidMount&&l.__h.push(l.componentDidMount);else{if(null==E.getDerivedStateFromProps&&g!==p&&null!=l.componentWillReceiveProps&&l.componentWillReceiveProps(g,y),!l.__e&&null!=l.shouldComponentUpdate&&!1===l.shouldComponentUpdate(g,l.__s,y)||t.__v===n.__v){for(l.props=g,l.state=l.__s,t.__v!==n.__v&&(l.__d=!1),(l.__v=t).__e=n.__e,t.__k=n.__k,t.__k.forEach(function(e){e&&(e.__=t)}),_=0;_<l._sb.length;_++)l.__h.push(l._sb[_]);l._sb=[],l.__h.length&&a.push(l);break e}null!=l.componentWillUpdate&&l.componentWillUpdate(g,l.__s,y),null!=l.componentDidUpdate&&l.__h.push(function(){l.componentDidUpdate(p,h,f)})}if(l.context=y,l.props=g,l.__v=t,l.__P=e,b=R.__r,x=0,"prototype"in E&&E.prototype.render){for(l.state=l.__s,l.__d=!1,b&&b(t),u=l.render(l.props,l.state,l.context),w=0;w<l._sb.length;w++)l.__h.push(l._sb[w]);l._sb=[]}else for(;l.__d=!1,b&&b(t),u=l.render(l.props,l.state,l.context),l.state=l.__s,l.__d&&++x<25;);l.state=l.__s,null!=l.getChildContext&&(i=Xc(Xc({},i),l.getChildContext())),d||null==l.getSnapshotBeforeUpdate||(f=l.getSnapshotBeforeUpdate(p,h)),C=null!=u&&u.type===Jc&&null==u.key?u.props.children:u,ru(e,Array.isArray(C)?C:[C],t,n,i,r,o,a,s,c),l.base=t.__e,t.__h=null,l.__h.length&&a.push(l),m&&(l.__E=l.__=null),l.__e=!1}else null==o&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=function(e,t,n,i,r,o,a,s){var c,u,l,d=n.props,p=t.props,h=t.type,f=0;if("svg"===h&&(r=!0),null!=o)for(;f<o.length;f++)if((c=o[f])&&"setAttribute"in c==!!h&&(h?c.localName===h:3===c.nodeType)){e=c,o[f]=null;break}if(null==e){if(null===h)return document.createTextNode(p);e=r?document.createElementNS("http://www.w3.org/2000/svg",h):document.createElement(h,p.is&&p),o=null,s=!1}if(null===h)d===p||s&&e.data===p||(e.data=p);else{if(o=o&&zc.call(e.childNodes),u=(d=n.props||qc).dangerouslySetInnerHTML,l=p.dangerouslySetInnerHTML,!s){if(null!=o)for(d={},f=0;f<e.attributes.length;f++)d[e.attributes[f].name]=e.attributes[f].value;!l&&!u||l&&(u&&l.__html==u.__html||l.__html===e.innerHTML)||(e.innerHTML=l&&l.__html||"")}if(function(e,t,n,i,r){for(var o in n)"children"===o||"key"===o||o in t||su(e,o,null,n[o],i);for(o in t)r&&"function"!=typeof t[o]||"children"===o||"key"===o||"value"===o||"checked"===o||n[o]===t[o]||su(e,o,t[o],n[o],i)}(e,p,d,r,s),l)t.__k=[];else if(f=t.props.children,ru(e,Array.isArray(f)?f:[f],t,n,i,r&&"foreignObject"!==h,o,a,o?o[0]:n.__k&&tu(n,0),s),null!=o)for(f=o.length;f--;)null!=o[f]&&Yc(o[f]);s||("value"in p&&void 0!==(f=p.value)&&(f!==e.value||"progress"===h&&!f||"option"===h&&f!==d.value)&&su(e,"value",f,d.value,!1),"checked"in p&&void 0!==(f=p.checked)&&f!==e.checked&&su(e,"checked",f,d.checked,!1))}return e}(n.__e,t,n,i,r,o,a,c);(u=R.diffed)&&u(t)}catch(e){t.__v=null,!c&&null==o||(t.__e=s,t.__h=!!c,o[o.indexOf(s)]=null),R.__e(e,t,n)}}}function du(e,t){R.__c&&R.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){R.__e(e,t.__v)}})}function pu(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){R.__e(e,n)}}function hu(e,t,n){return this.constructor(e,n)}function fu(e,t,n){var i,r,o;R.__&&R.__(e,t),r=(i="function"==typeof n)?null:n&&n.__k||t.__k,o=[],lu(t,e=(!i&&n||t).__k=Zc(Jc,null,[e]),r||qc,qc,void 0!==t.ownerSVGElement,!i&&n?[n]:!r&&t.firstChild?zc.call(t.childNodes):null,o,!i&&n?n:r?r.__e:t.firstChild,i),du(o,e)}zc=Gc.slice,R={__e:function(e,t,n,i){for(var r,o,a;t=t.__;)if((r=t.__c)&&!r.__)try{if((o=r.constructor)&&null!=o.getDerivedStateFromError&&(r.setState(o.getDerivedStateFromError(e)),a=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(e,i||{}),a=r.__d),a)return r.__E=r}catch(t){e=t}throw e}},Fc=0,eu.prototype.setState=function(e,t){var n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=Xc({},this.state);(e="function"==typeof e?e(Xc({},n),this.props):e)&&Xc(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),nu(this))},eu.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),nu(this))},eu.prototype.render=Jc,Uc=[],iu.__r=0;function mu(e,t,n,i){t[0]=0;for(var r=1;r<t.length;r++){var o=t[r++],a=t[r]?(t[0]|=o?1:2,n[t[r++]]):t[++r];3===o?i[0]=a:4===o?i[1]=Object.assign(i[1]||{},a):5===o?(i[1]=i[1]||{})[t[++r]]=a:6===o?i[1][t[++r]]+=a+"":o?(o=e.apply(a,mu(e,a,n,["",null])),i.push(o),a[0]?t[0]|=2:(t[r-2]=0,t[r]=o)):i.push(a)}return i}var gu=new Map;var vu,yu,_u,bu,xu=function(e){var t=gu.get(this);return t||(t=new Map,gu.set(this,t)),1<(t=mu(this,t.get(e)||(t.set(e,t=function(e){for(var t,n,i=1,r="",o="",a=[0],s=function(e){1===i&&(e||(r=r.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?a.push(0,e,r):3===i&&(e||r)?(a.push(3,e,r),i=2):2===i&&"..."===r&&e?a.push(4,e,0):2===i&&r&&!e?a.push(5,0,!0,r):5<=i&&((r||!e&&5===i)&&(a.push(i,0,r,n),i=6),e)&&(a.push(i,e,0,n),i=6),r=""},c=0;c<e.length;c++){c&&(1===i&&s(),s(c));for(var u=0;u<e[c].length;u++)t=e[c][u],1===i?"<"===t?(s(),a=[a],i=3):r+=t:4===i?r="--"===r&&">"===t?(i=1,""):t+r[0]:o?t===o?o="":r+=t:'"'===t||"'"===t?o=t:">"===t?(s(),i=1):i&&("="===t?(i=5,n=r,r=""):"/"===t&&(i<5||">"===e[c][u+1])?(s(),3===i&&(a=a[0]),(a=(i=a)[0]).push(2,0,i),i=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(s(),i=2):r+=t),3===i&&"!--"===r&&(i=4,a=a[0])}return s(),a}(e)),t),arguments,[])).length?t:t[0]}.bind(Zc),wu=0,Cu=[],Eu=[],ku=R.__b,Su=R.__r,ju=R.diffed,Ou=R.__c,Pu=R.unmount;function Du(e,t){R.__h&&R.__h(yu,e,wu||t),wu=0;t=yu.__H||(yu.__H={__:[],__h:[]});return e>=t.__.length&&t.__.push({__V:Eu}),t.__[e]}function Ru(e){wu=1;var o,t=sl,n=void 0,a=Du(vu++,2);return a.t=t,a.__c||(a.__=[n?n(e):sl(void 0,e),function(e){var t=(a.__N||a.__)[0],e=a.t(t,e);t!==e&&(a.__N=[e,a.__[1]],a.__c.setState({}))}],(a.__c=yu).u)||(yu.u=!0,o=yu.shouldComponentUpdate,yu.shouldComponentUpdate=function(e,t,n){var i,r;return!a.__c.__H||((i=a.__c.__H.__.filter(function(e){return e.__c})).every(function(e){return!e.__N})||(r=!1,i.forEach(function(e){var t;e.__N&&(t=e.__[0],e.__=e.__N,e.__N=void 0,t!==e.__[0])&&(r=!0)}),!(!r&&a.__c.props===e)))&&(!o||o.call(this,e,t,n))}),a.__N||a.__}function Tu(e,t){var n=Du(vu++,3);!R.__s&&al(n.__H,t)&&(n.__=e,n.i=t,yu.__H.__h.push(n))}function Mu(e,t){var n=Du(vu++,4);!R.__s&&al(n.__H,t)&&(n.__=e,n.i=t,yu.__h.push(n))}function Iu(e){return wu=5,Au(function(){return{current:e}},[])}function Au(e,t){var n=Du(vu++,7);return al(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function Nu(e,t){return wu=8,Au(function(){return e},t)}function Bu(){for(var t;t=Cu.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(rl),t.__H.__h.forEach(ol),t.__H.__h=[]}catch(e){t.__H.__h=[],R.__e(e,t.__v)}}R.__b=function(e){yu=null,ku&&ku(e)},R.__r=function(e){Su&&Su(e),vu=0;e=(yu=e.__c).__H;e&&(_u===yu?(e.__h=[],yu.__h=[],e.__.forEach(function(e){e.__N&&(e.__=e.__N),e.__V=Eu,e.__N=e.i=void 0})):(e.__h.forEach(rl),e.__h.forEach(ol),e.__h=[])),_u=yu},R.diffed=function(e){ju&&ju(e);e=e.__c;e&&e.__H&&(!e.__H.__h.length||1!==Cu.push(e)&&bu===R.requestAnimationFrame||((bu=R.requestAnimationFrame)||function(e){function t(){clearTimeout(i),il&&cancelAnimationFrame(n),setTimeout(e)}var n,i=setTimeout(t,100);il&&(n=requestAnimationFrame(t))})(Bu),e.__H.__.forEach(function(e){e.i&&(e.__H=e.i),e.__V!==Eu&&(e.__=e.__V),e.i=void 0,e.__V=Eu})),_u=yu=null},R.__c=function(e,n){n.some(function(t){try{t.__h.forEach(rl),t.__h=t.__h.filter(function(e){return!e.__||ol(e)})}catch(e){n.some(function(e){e.__h&&(e.__h=[])}),n=[],R.__e(e,t.__v)}}),Ou&&Ou(e,n)},R.unmount=function(e){Pu&&Pu(e);var t,e=e.__c;e&&e.__H&&(e.__H.__.forEach(function(e){try{rl(e)}catch(e){t=e}}),e.__H=void 0,t)&&R.__e(t,e.__v)};var Lu,Vu,$u,zu,Fu,Uu,Hu,Wu,qu,Gu,Ku,Xu,Yu,Zu,Qu,Ju,el,tl,nl,il="function"==typeof requestAnimationFrame;function rl(e){var t=yu,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),yu=t}function ol(e){var t=yu;e.__c=e.__(),yu=t}function al(n,e){return!n||n.length!==e.length||e.some(function(e,t){return e!==n[t]})}function sl(e,t){return"function"==typeof t?t(e):t}function cl(){for(var e,t=0,n="";t<arguments.length;)(e=arguments[t++])&&(e=function e(t){var n,i,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==Fe(t))if(Array.isArray(t))for(n=0;n<t.length;n++)t[n]&&(i=e(t[n]))&&(r&&(r+=" "),r+=i);else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}(e))&&(n&&(n+=" "),n+=e);return n}function ul(e){var t=e.entry,n=e.selected,i=e.onMouseEnter,r=e.onMouseLeave,e=e.onClick;return xu(Lu=Lu||U(["\n    <li\n      class=","\n      data-id=","\n      title=","\n      onClick=","\n      onMouseEnter=","\n      onMouseLeave=",'\n    >\n      <div class="djs-popup-entry-content">\n        <span\n          class=',"\n        >\n          ","\n\n          ","\n        </span>\n        ","\n      </div>\n      ","\n    </li>\n  "]),cl("entry",{selected:n}),t.id,t.title||t.label,e,i,r,cl("djs-popup-entry-name",t.className),t.imageUrl?xu(Vu=Vu||U(['\n            <img class="djs-popup-entry-icon" src='," />\n          "]),t.imageUrl):null,t.label?xu($u=$u||U(['\n            <span class="djs-popup-label">\n              ',"\n            </span>\n          "]),t.label):null,t.description&&xu(zu=zu||U(['\n          <span\n            class="djs-popup-entry-description"\n            title=',"\n          >\n            ","\n          </span>\n        "]),t.description,t.description),t.documentationRef&&xu(Fu=Fu||U(['\n        <div class="djs-popup-entry-docs">\n          <a\n            href="','"\n            onClick=','\n            title="Open element documentation"\n            target="_blank"\n            rel="noopener"\n          >\n            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path fill-rule="evenodd" clip-rule="evenodd" d="M10.6368 10.6375V5.91761H11.9995V10.6382C11.9995 10.9973 11.8623 11.3141 11.5878 11.5885C11.3134 11.863 10.9966 12.0002 10.6375 12.0002H1.36266C0.982345 12.0002 0.660159 11.8681 0.396102 11.6041C0.132044 11.34 1.52588e-05 11.0178 1.52588e-05 10.6375V1.36267C1.52588e-05 0.98236 0.132044 0.660173 0.396102 0.396116C0.660159 0.132058 0.982345 2.95639e-05 1.36266 2.95639e-05H5.91624V1.36267H1.36266V10.6375H10.6368ZM12 0H7.2794L7.27873 1.36197H9.68701L3.06507 7.98391L4.01541 8.93425L10.6373 2.31231V4.72059H12V0Z" fill="#818798"/>\n            </svg>\n          </a>\n        </div>\n      ']),t.documentationRef,function(e){return e.stopPropagation()}))}function ll(e){var t=e.selectedEntry,n=e.setSelectedEntry,i=e.onClick,r=e.entries,o=Iu(),e=Au(function(){return i=[],r.forEach(function(e){var t=e.group?"string"==typeof(t=e.group)?{id:t}:t:{id:"default"};n(t)?n(t).entries.push(e):i.push(L(L({},t),{},{entries:[e]}))}),i;function n(t){return i.find(function(e){return t.id===e.id})}var i},[r]);return Mu(function(){var e=o.current;e&&(e=e.querySelector(".selected"))&&("function"==typeof(e=e).scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.scrollIntoView({scrollMode:"if-needed",block:"nearest"}))},[t]),xu(Uu=Uu||U(['\n    <div class="djs-popup-results" ref=',">\n      ","\n    </div>\n  "]),o,e.map(function(e){return xu(Hu=Hu||U(["\n        ",'\n        <ul class="djs-popup-group" data-group=',">\n          ","\n        </ul>\n      "]),e.name&&xu(Wu=Wu||U(["\n          <div key=",' class="entry-header" title=',">\n            ","\n          </div>\n        "]),e.id,e.name,e.name),e.id,e.entries.map(function(e){return xu(qu=qu||U(["\n            <","\n              key=","\n              entry=","\n              selected=","\n              onMouseEnter=","\n              onMouseLeave=","\n              onClick=","\n            />\n          "]),ul,e.id,e,e===t,function(){return n(e)},function(){return n(null)},i)}))}))}function dl(e){var t=e.onClose,n=e.onSelect,i=e.className,r=e.headerEntries,o=e.position,a=e.title,s=e.width,c=e.scale,u=e.search,l=e.entries,d=e.onOpened,p=e.onClosed,h=Au(function(){return!!Q(u)&&5<l.length},[u,l]),f=Iu(),e=H(Ru(""),2),m=e[0],g=e[1],e=H(Ru(l),2),v=e[0],y=e[1],e=H(Ru(v[0]),2),_=e[0],b=e[1],x=(Tu(function(){return d(),function(){p()}},[]),Nu(function(e){_&&e.includes(_)||b(e[0]),y(e)},[_,y,b])),w=(Tu(function(){var e;h&&(e=l.filter(function(e){var t;return!m||(t=[e.description||"",e.label||""].join("---").toLowerCase(),m.toLowerCase().split(/\s/g).every(function(e){return t.includes(e)}))}),x(e))},[m,l,h]),Tu(function(){function e(e){if("Escape"===e.key)return e.preventDefault(),t()}return document.documentElement.addEventListener("keydown",e),function(){document.documentElement.removeEventListener("keydown",e)}},[]),Mu(function(){f.current&&f.current.focus()},[]),Nu(function(e){e=v.indexOf(_)+e;(e=e<0?v.length-1:e)>=v.length&&(e=0),b(v[e])},[v,_,b])),e=Nu(function(e){return"Enter"===e.key&&_?n(e,_):"Escape"===e.key?t():"ArrowUp"===e.key||"Tab"===e.key&&e.shiftKey?(w(-1),e.preventDefault()):"ArrowDown"===e.key||"Tab"===e.key?(w(1),e.preventDefault()):void 0},[n,t,_,w]),C=Nu(function(e){wn(e.target,"input")&&g(function(){return e.target.value})},[g]),E=Au(function(){return a||0<r.length},[a,r]);return xu(Gu=Gu||U(["\n    <","\n      onClose=","\n      onKeyup=","\n      onKeydown=","\n      className=","\n      position=","\n      width=","\n      scale=","\n    >\n      ","\n      ","\n    </",">\n  "]),pl,t,C,e,i,o,s,c,E&&xu(Ku=Ku||U(['\n        <div class="djs-popup-header">\n          <h3 class="djs-popup-title" title=',">","</h3>\n          ","\n        </div>\n      "]),a,a,r.map(function(t){return xu(Xu=Xu||U(["\n            <span\n              class=","\n              onClick=","\n              title=","\n              data-id=","\n              onMouseEnter=","\n              onMouseLeave=","\n            >\n              ","\n\n              ","\n            </span>\n          "]),(e=t===_,cl("entry",t.className,t.active?"active":"",t.disabled?"disabled":"",e?"selected":"")),function(e){return n(e,t)},t.title||t.label,t.id,function(){return b(t)},function(){return b(null)},t.imageUrl?xu(Yu=Yu||U(['\n                <img class="djs-popup-entry-icon" src='," />\n              "]),t.imageUrl):null,t.label?xu(Zu=Zu||U(['\n                <span class="djs-popup-label">',"</span>\n              "]),t.label):null);var e})),0<l.length&&xu(Qu=Qu||U(['\n        <div class="djs-popup-body">\n\n          ',"\n\n          <","\n            entries=","\n            selectedEntry=","\n            setSelectedEntry=","\n            onClick=","\n          />\n        </div>\n        ","\n      "]),h&&xu(Ju=Ju||U(['\n          <div class="djs-popup-search">\n            <svg class="djs-popup-search-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path fill-rule="evenodd" clip-rule="evenodd" d="M9.0325 8.5H9.625L13.3675 12.25L12.25 13.3675L8.5 9.625V9.0325L8.2975 8.8225C7.4425 9.5575 6.3325 10 5.125 10C2.4325 10 0.25 7.8175 0.25 5.125C0.25 2.4325 2.4325 0.25 5.125 0.25C7.8175 0.25 10 2.4325 10 5.125C10 6.3325 9.5575 7.4425 8.8225 8.2975L9.0325 8.5ZM1.75 5.125C1.75 6.9925 3.2575 8.5 5.125 8.5C6.9925 8.5 8.5 6.9925 8.5 5.125C8.5 3.2575 6.9925 1.75 5.125 1.75C3.2575 1.75 1.75 3.2575 1.75 5.125Z" fill="#22242A"/>\n            </svg>\n            <input\n                ref=','\n                type="text"\n              />\n          </div>\n          ']),f),ll,v,_,b,n,0===v.length&&xu(el=el||U(['\n          <div class="djs-popup-no-results">No matching entries found.</div>\n        ']))),pl)}function pl(e){var t=e.onClose,n=e.onKeydown,i=e.onKeyup,r=e.className,o=e.children,a=e.position,s=Iu(),c=Nu(function(e){Cn(e.target,".djs-popup",!0)||t()},[t]);return Mu(function(){var e,t;"function"==typeof a&&(e=s.current,t=a(e),e.style.left="".concat(t.x,"px"),e.style.top="".concat(t.y,"px"))},[s.current,a]),Mu(function(){s.current&&s.current.focus()},[]),xu(tl=tl||U(['\n    <div\n      class="djs-popup-backdrop"\n      onClick=',"\n    >\n      <div\n        class=","\n        style=","\n        onKeydown=","\n        onKeyup=","\n        ref=",'\n        tabIndex="-1"\n      >\n        ',"\n      </div>\n    </div>\n  "]),c,cl("djs-popup",r),{transform:"scale(".concat((c=e).scale,")"),width:"".concat(c.width,"px")},n,i,s,o)}var hl=["contextPad.close","canvas.viewbox.changing","commandStack.changed"];function fl(e,t,n){var i=this,n=(this._eventBus=t,this._canvas=n,this._current=null,Q(e&&e.scale)?e.scale:{min:1,max:1.5});this._config={scale:n},t.on("diagram.destroy",function(){i.close()}),t.on("element.changed",function(e){var t=i.isOpen()&&i._current.element;e.element===t&&i._render()})}fl.$inject=["config.popupMenu","eventBus","canvas"],fl.prototype._render=function(){var n=this,e=this._current,t=e.position,i=e.className,r=e.entries,o=e.headerEntries,e=e.options,r=f(Object.entries(r).map(function(e){e=H(e,2);return L({id:e[0]},e[1])})),o=f(Object.entries(o).map(function(e){e=H(e,2);return L({id:e[0]},e[1])})),a=t&&function(e){return n._ensureVisible(e,t)},s=this._updateScale(this._current.container);fu(xu(nl=nl||U(["\n      <","\n        onClose=","\n        onSelect=","\n        position=","\n        className=","\n        entries=","\n        headerEntries=","\n        scale=","\n        onOpened=","\n        onClosed=","\n        ...","\n      />\n    "]),dl,function(e){return n.close(e)},function(e,t){return n.trigger(e,t)},a,i,r,o,s,this._onOpened.bind(this),this._onClosed.bind(this),L({},e)),this._current.container)},fl.prototype.open=function(e,t,n,i){if(!e)throw new Error("Element is missing");if(!t)throw new Error("No registered providers for: "+t);if(!n)throw new Error("the position argument is missing");this.isOpen()&&this.close();var r=this._getContext(e,t),o=r.entries,r=r.headerEntries;this._current={position:n,className:t,element:e,entries:o,headerEntries:r,container:this._createContainer({provider:t}),options:i},this._emit("open"),this._bindAutoClose(),this._render()},fl.prototype._getContext=function(e,t){var n,i=this._getProviders(t);if(i&&i.length)return{entries:n=this._getEntries(e,i),headerEntries:e=this._getHeaderEntries(e,i),empty:!(Object.keys(n).length||Object.keys(e).length)};throw new Error("No registered providers for: "+t)},fl.prototype.close=function(){this.isOpen()&&(this._emit("close"),this.reset(),this._current=null)},fl.prototype.reset=function(){var e=this._current.container;fu(null,e),Tn(e)},fl.prototype._emit=function(e,t){this._eventBus.fire("popupMenu.".concat(e),t)},fl.prototype._onOpened=function(){this._emit("opened")},fl.prototype._onClosed=function(){this._emit("closed")},fl.prototype._createContainer=function(e){var t=e&&e.parent||"body",e=("string"==typeof t&&(t=document.querySelector(t)),_('<div class="djs-popup-parent djs-parent" data-popup='.concat(e.provider,"></div>")));return t.appendChild(e),e},fl.prototype._bindAutoClose=function(){this._eventBus.once(hl,this.close,this)},fl.prototype._unbindAutoClose=function(){this._eventBus.off(hl,this.close,this)},fl.prototype._updateScale=function(e){var t,n=this._canvas.zoom(),i=this._config.scale,r=n;return r=!0!==i&&(i=!1===i?t=1:(t=i.min,i.max),Q(t)&&n<t&&(r=t),Q(i))&&i<n?i:r},fl.prototype._ensureVisible=function(e,t){var n=document.documentElement.getBoundingClientRect(),e=e.getBoundingClientRect(),i={},r=t.x,o=t.y;return t.x+e.width>n.width&&(i.x=!0),t.y+e.height>n.height&&(i.y=!0),i.x&&i.y?(r=t.x-e.width,o=t.y-e.height):i.x?(r=t.x-e.width,o=t.y):i.y&&t.y<e.height?(r=t.x,o=10):i.y&&(r=t.x,o=t.y-e.height),{x:r,y:o}},fl.prototype.isEmpty=function(e,t){if(!e)throw new Error("element parameter is missing");var n;if(t)return!(n=this._getProviders(t))||!n.length||this._getContext(e,t).empty;throw new Error("providerId parameter is missing")},fl.prototype.registerProvider=function(e,t,n){n||(n=t,t=1e3),this._eventBus.on("popupMenu.getProviders."+e,t,function(e){e.providers.push(n)})},fl.prototype._getProviders=function(e){e=this._eventBus.createEvent({type:"popupMenu.getProviders."+e,providers:[]});return this._eventBus.fire(e),e.providers},fl.prototype._getEntries=function(n,e){var i={};return y(e,function(e){var t;e.getPopupMenuEntries?te(t=e.getPopupMenuEntries(n))?i=t(i):y(t,function(e,t){i[t]=e}):y(e.getEntries(n),function(e){var t=e.id;if(!t)throw new Error("every entry must have the id property set");i[t]=be(e,["id"])})}),i},fl.prototype._getHeaderEntries=function(t,e){var n={};return y(e,function(e){if(!e.getPopupMenuHeaderEntries)return e.getHeaderEntries?void y(e.getHeaderEntries(t),function(e){var t=e.id;if(!t)throw new Error("every entry must have the id property set");n[t]=be(e,["id"])}):void 0;e=e.getPopupMenuHeaderEntries(t);te(e)?n=e(n):y(e,function(e,t){n[t]=e})}),n},fl.prototype.isOpen=function(){return!!this._current},fl.prototype.trigger=function(e,t){var n;if(e.preventDefault(),t||(n=yn(Cn(e.delegateTarget||e.target,".entry",!0),"data-id"),t=this._getEntry(n)),t.action)return t.action.call(null,e,t)},fl.prototype._getEntry=function(e){e=this._current.entries[e]||this._current.headerEntries[e];if(e)return e;throw new Error("entry not found")};var ml={__init__:["popupMenu"],popupMenu:["type",fl]},gl=Math.round;function vl(e){this._modeling=e}vl.$inject=["modeling"],vl.prototype.replaceElement=function(e,t,n){var i,r,o,a,s;return e.waypoints?null:(i=this._modeling,r=t.width||e.width,o=t.height||e.height,a=t.x||e.x,s=t.y||e.y,a=gl(a+r/2),s=gl(s+o/2),i.replaceShape(e,C({},t,{x:a,y:s,width:r,height:o}),n))};var yl={__init__:["replace"],replace:["type",vl]};function _l(c,u,e,t){this.replaceElement=function(e,t,n){n=n||{};var i,r,o=t.type,a=e.businessObject,s=c.create(o);return(o={type:o,businessObject:s}).width=e.width,o.height=e.height,s.name=a.name,t.table&&(a=c.create("dmn:DecisionTable"),(s.decisionLogic=a).$parent=s,(i=c.create("dmn:OutputClause")).typeRef="string",(i.$parent=a).output=[i],(i=c.create("dmn:InputClause")).$parent=a,r=c.create("dmn:LiteralExpression",{typeRef:"string"}),(i.inputExpression=r).$parent=i,a.input=[i]),t.expression&&(s.decisionLogic=c.create("dmn:LiteralExpression"),s.variable=c.create("dmn:InformationItem")),u.replaceElement(e,o,n)}}_l.$inject=["drdFactory","replace","selection","modeling"];var yl={__depends__:[yl,Yo],drdReplace:["type",_l]},bl=[{label:"Empty",actionName:"replace-with-empty-decision",className:"dmn-icon-clear",target:{type:"dmn:Decision",table:!1,expression:!1}},{label:"Decision Table",actionName:"replace-with-decision-table",className:"dmn-icon-decision-table",target:{type:"dmn:Decision",table:!0,expression:!1}},{label:"Literal Expression",actionName:"replace-with-literal-expression",className:"dmn-icon-literal-expression",target:{type:"dmn:Decision",table:!1,expression:!0}}];function xl(e,t,n,i,r,o){this._popupMenu=e,this._modeling=t,this._moddle=n,this._drdReplace=i,this._rules=r,this._translate=o,this.register()}xl.$inject=["popupMenu","modeling","moddle","drdReplace","rules","translate"],xl.prototype.register=function(){this._popupMenu.registerProvider("dmn-replace",this)},xl.prototype.getEntries=function(e){var t,i=e.businessObject;return this._rules.allowed("shape.replace",{element:e})&&k(i,"dmn:Decision")?(t=re(bl,function(e){var t="replace-with-empty-decision"===e.actionName&&i.decisionLogic,n="replace-with-decision-table"===e.actionName&&!k(i.decisionLogic,"dmn:DecisionTable"),e="replace-with-literal-expression"===e.actionName&&!k(i.decisionLogic,"dmn:LiteralExpression");return t||n||e}),this._createEntries(e,t)):[]},xl.prototype._createEntries=function(t,e){var n=[],i=this;return y(e,function(e){e=i._createMenuEntry(e,t);n.push(e)}),n},xl.prototype._createMenuEntry=function(e,t,n){var i=this._drdReplace.replaceElement;return n=n||function(){return i(t,e.target)},{label:(0,this._translate)(e.label),className:e.className,id:e.actionName,action:n}},xl.prototype.getHeaderEntries=function(e){return[]};ml={__depends__:[Ro,ml,yl],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",xl]};function wl(e,i,t,n,r,o,a,s,c,u,l,d){l=l||{},i.registerProvider(this),this._contextPad=i,this._modeling=t,this._elementFactory=n,this._connect=r,this._create=o,this._rules=a,this._popupMenu=s,this._canvas=c,this._translate=u,!1!==l.autoPlace&&(this._autoPlace=d.get("autoPlace",!1)),e.on("create.end",250,function(e){var t,n=e.context.shape;Lo(e)&&(t=i.getEntries(n)).replace&&t.replace.action.click(e,n)})}wl.$inject=["eventBus","contextPad","modeling","elementFactory","connect","create","rules","popupMenu","canvas","translate","config.contextPad","injector"],wl.prototype.getContextPadEntries=function(t){var e,n=this._modeling,o=this._elementFactory,i=this._connect,a=this._create,s=this._popupMenu,c=this._canvas,u=this._contextPad,r=this._rules,l=this._translate,d=this._autoPlace,p={};return"label"!==t.type&&(k(e=t.businessObject,"dmn:Decision")&&C(p,{"append.decision":f("dmn:Decision","dmn-icon-decision")}),Kn(e,["dmn:BusinessKnowledgeModel","dmn:Decision","dmn:KnowledgeSource"])&&C(p,{"append.knowledge-source":f("dmn:KnowledgeSource","dmn-icon-knowledge-source")}),Kn(e,["dmn:BusinessKnowledgeModel","dmn:Decision"])&&C(p,{"append.business-knowledge-model":f("dmn:BusinessKnowledgeModel","dmn-icon-business-knowledge")}),Kn(e,["dmn:Decision","dmn:KnowledgeSource"])&&C(p,{"append.input-data":f("dmn:InputData","dmn-icon-input-data")}),k(e,"dmn:DRGElement")&&C(p,{"append.text-annotation":f("dmn:TextAnnotation","dmn-icon-text-annotation"),connect:{group:"connect",className:"dmn-icon-connection-multi",title:l("Connect using Information/Knowledge/Authority Requirement or Association"),action:{click:h,dragstart:h}}}),k(e,"dmn:TextAnnotation")&&C(p,{connect:{group:"connect",className:"dmn-icon-connection-multi",title:l("Connect using association"),action:{click:h,dragstart:h}}}),s.isEmpty(t,"dmn-replace")||C(p,{replace:{group:"edit",className:"dmn-icon-screw-wrench",title:l("Change type"),action:{click:function(e,t){var n,i,r=C((n=t,r=c.getContainer(),n=u.getPad(n).html,r=r.getBoundingClientRect(),i=(n=n.getBoundingClientRect()).top-r.top,{x:n.left-r.left,y:i+n.height+5}),{cursor:{x:e.x,y:e.y}});s.open(t,"dmn-replace",r)}}}}),e=m(e=r.allowed("elements.delete",{elements:[t]}))?e[0]===t:e)&&C(p,{delete:{group:"edit",className:"dmn-icon-trash",title:l("Remove"),action:{click:function(e){n.removeElements([t])}}}}),p;function h(e,t,n){i.start(e,t,n)}function f(i,e,t,r){function n(e,t){var n=o.createShape(C({type:i},r));a.start(e,n,{source:t,hints:{connectionTarget:t}})}return"string"!=typeof t&&(r=t,t=l("Append {type}",{type:i.replace(/^dmn:/,"")})),{group:"model",className:e,title:t,action:{dragstart:n,click:d?function(e,t){var n=o.createShape(C({type:i},r));d.append(t,n,{connectionTarget:t})}:n}}}};yl={__depends__:[Ro,ia,Yo,Oc,Wc,ml],__init__:["contextPadProvider"],contextPadProvider:["type",wl]};function Cl(e,t,n,i){this._canvas=t,this._graphicsFactory=n,this._elementFactory=i,this._connectionDocking=e.get("connectionDocking",!1),this._layouter=e.get("layouter",!1)}Cl.$inject=["injector","canvas","graphicsFactory","elementFactory"],Cl.prototype.drawPreview=function(e,t,n){var i,r,o,a=e.connectionPreviewGfx,s=e.getConnection,c=(n=n||{}).source,u=n.target,l=n.waypoints,d=n.connectionStart,p=n.connectionEnd,h=n.noLayout,f=n.noCropping,m=n.noNoop,g=this;fi(a=a||(e.connectionPreviewGfx=this.createConnectionPreviewGfx())),s=s||(e.getConnection=(r=function(e,t,n){return g.getConnection(e,t,n)},o={},function(e){e=JSON.stringify(e);return o[e]||(o[e]=r.apply(null,arguments))})),(i=t?s(t,c,u):i)?(i.waypoints=l||[],this._layouter&&!h&&(i.waypoints=this._layouter.layoutConnection(i,{source:c,target:u,connectionStart:d,connectionEnd:p,waypoints:n.waypoints||i.waypoints})),i.waypoints&&i.waypoints.length||(i.waypoints=[c?D(c):d,u?D(u):p]),this._connectionDocking&&(c||u)&&!f&&(i.waypoints=this._connectionDocking.getCroppedWaypoints(i,c,u)),this._graphicsFactory.drawConnection(a,i)):m||this.drawNoopPreview(a,n)},Cl.prototype.drawNoopPreview=function(e,t){var n=t.source,i=t.target,r=t.connectionStart||D(n),t=t.connectionEnd||D(i),r=this.cropWaypoints(r,t,n,i);w(e,this.createNoopConnection(r[0],r[1]))},Cl.prototype.cropWaypoints=function(e,t,n,i){var r=this._graphicsFactory,o=n&&r.getShapePath(n),a=i&&r.getShapePath(i),r=r.getConnectionPath({waypoints:[e,t]});return[e=n&&Ir(o,r,!0)||e,t=i&&Ir(a,r,!1)||t]},Cl.prototype.cleanUp=function(e){e&&e.connectionPreviewGfx&&hi(e.connectionPreviewGfx)},Cl.prototype.getConnection=function(e){e=ee(e=e)?e:{};return this._elementFactory.createConnection(e)},Cl.prototype.createConnectionPreviewGfx=function(){var e=O("g");return S(e,{pointerEvents:"none"}),j(e).add("djs-connection-preview"),w(this._canvas.getActiveLayer(),e),e},Cl.prototype.createNoopConnection=function(e,t){var n=O("polyline");return S(n,{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"}),S(n,{points:[e.x,e.y,t.x,t.y]}),n};var ia={__init__:["connectionPreview"],connectionPreview:["type",Cl]},El=/\s/,kl=/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i,Sl=/^[a-z_][\w-.]*$/i,jl=/\$\{([^}]*)\}/g;function Ol(e,t){var n=e.$model.ids.assigned(t);return t?n&&n!==e?"Element must have unique ID.":function(e){return El.test(e)}(n=function(e){return e.replace(jl,"$1")}(n=t))?"Id must not contain spaces.":Sl.test(n)?void 0:kl.test(n)?"Id must not contain prefix.":"Id must be a valid QName.":"Element must have ID."}function Pl(e,t,n,i,r){this._eventBus=e,this._modeling=t,this._canvas=n,this._definitionPropertiesView=i,this._translate=r,e.on("definitionIdView.create",function(e){this._container=e.html;var e=b(".dmn-definitions-name",this._container),t=b(".dmn-definitions-id",this._container);this._setup(e,"name"),this._setup(t,"id")},this)}Pl.$inject=["eventBus","modeling","canvas","definitionPropertiesView","translate"],Pl.prototype.update=function(e,t){var n=this._canvas.getRootElement(),i={};if(i[e]=t,"id"===e){e=Ol(Gn(n),t);if(e)return void this._addErrorMessage(e);this._clearErrorMessage()}this._modeling.updateProperties(n,i)},Pl.prototype._setup=function(t,n){var i=this;t.setAttribute("contenteditable",!0),t.addEventListener("input",ve(function(e){e=e.target.value||e.target.textContent;i.update(n,e.trim())},300)),t.addEventListener("keydown",function(e){13===e.keyCode&&(t.blur(),window.getSelection().removeAllRanges())}),t.addEventListener("blur",function(){i._clearErrorMessage(),i._definitionPropertiesView.update()})},Pl.prototype._addErrorMessage=function(e){var e='<span class="dmn-definitions-error-message">'+this._translate(e)+"</span>",t=b(".dmn-definitions-id",this._container);this._clearErrorMessage(),v(t).add("dmn-definitions-error"),t.parentElement.appendChild(_(e))},Pl.prototype._clearErrorMessage=function(){var e,t=b(".dmn-definitions-id",this._container);v(t).has("dmn-definitions-error")&&(v(t).remove("dmn-definitions-error"),e=b(".dmn-definitions-error-message",this._container),t.parentNode.removeChild(e))};var Oc={__depends__:[aa],__init__:["definitionPropertiesEdit","definitionPropertiesPaletteAdapter"],definitionPropertiesEdit:["type",Pl],definitionPropertiesPaletteAdapter:["type",oa]},Dl={horizontal:["x","width"],vertical:["y","height"]};function Rl(e,n){this._modeling=e,this._filters=[],this.registerFilter(function(e){var t=n.allowed("elements.distribute",{elements:e});return m(t)?t:t?e:[]})}Rl.$inject=["modeling","rules"],Rl.prototype.registerFilter=function(e){if("function"!=typeof e)throw new Error("the filter has to be a function");this._filters.push(e)},Rl.prototype.trigger=function(e,t){var n=this._modeling;if(!(e.length<3||(this._setOrientation(t),t=this._filterElements(e),(e=this._createGroups(t)).length<=2)))return n.distributeElements(e,this._axis,this._dimension),e},Rl.prototype._filterElements=function(e){var t=this._filters,n=this._axis,i=this._dimension,r=[].concat(e);return t.length?(y(t,function(e){r=e(r,n,i)}),r):e},Rl.prototype._createGroups=function(e){var r=[],o=this,a=this._axis,s=this._dimension;if(a)return y(pe(e,a),function(e,t){var n=o._findRange(e,a,s),i=r[r.length-1];i&&o._hasIntersection(i.range,n)?r[r.length-1].elements.push(e):r.push({range:n,elements:[e]})}),r;throw new Error('must have a defined "axis" and "dimension"')},Rl.prototype._setOrientation=function(e){e=Dl[e];this._axis=e[0],this._dimension=e[1]},Rl.prototype._hasIntersection=function(e,t){return Math.max(e.min,e.max)>=Math.min(t.min,t.max)&&Math.min(e.min,e.max)<=Math.max(t.min,t.max)},Rl.prototype._findRange=function(e){var t=e[this._axis];return{min:t+5,max:t+e[this._dimension]-5}};ml={__init__:["distributeElements"],distributeElements:["type",Rl]};function Tl(e){e.registerFilter(function(e){return re(e,function(e){var t=Kn(e,["dmn:AuthorityRequirement","dmn:InformationRequirement","dmn:KnowledgeRequirement","dmn:Association","dmn:TextAnnotation"]);return!e.labelTarget&&!t})})}Tl.$inject=["distributeElements"];var ml={__depends__:[ml],__init__:["drdDistributeElements"],drdDistributeElements:["type",Tl]},Ml="is not a registered action";function Il(e,t){this._actions={};var n=this;e.on("diagram.init",function(){n._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:n})})}function Al(e,t){return new Error(e+" "+t)}Il.$inject=["eventBus","injector"],Il.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),n=e.get("modeling",!1),i=e.get("selection",!1),r=e.get("zoomScroll",!1),o=e.get("copyPaste",!1),a=e.get("canvas",!1),s=e.get("rules",!1),c=e.get("keyboardMove",!1),u=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",function(){t.undo()}),this.register("redo",function(){t.redo()})),o&&i&&this.register("copy",function(){var e=i.get();if(e.length)return o.copy(e)}),o&&this.register("paste",function(){o.paste()}),r&&this.register("stepZoom",function(e){r.stepZoom(e.value)}),a&&this.register("zoom",function(e){a.zoom(e.value)}),n&&i&&s&&this.register("removeSelection",function(){var e,t=i.get();t.length&&!1!==(e=s.allowed("elements.delete",{elements:t}))&&(e=m(e)?e:t).length&&n.removeElements(e.slice())}),c&&this.register("moveCanvas",function(e){c.moveCanvas(e)}),u&&this.register("moveSelection",function(e){u.moveSelection(e.direction,e.accelerated)})},Il.prototype.trigger=function(e,t){if(this._actions[e])return this._actions[e](t);throw Al(e,Ml)},Il.prototype.register=function(e,t){var n=this;if("string"==typeof e)return this._registerAction(e,t);y(e,function(e,t){n._registerAction(t,e)})},Il.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw Al(e,"is already registered");this._actions[e]=t},Il.prototype.unregister=function(e){if(!this.isRegistered(e))throw Al(e,Ml);this._actions[e]=void 0},Il.prototype.getActions=function(){return Object.keys(this._actions)},Il.prototype.isRegistered=function(e){return!!this._actions[e]};var Nl={__init__:["editorActions"],editorActions:["type",Il]};function Bl(e){e.invoke(Il,this)}Yn(Bl,Il),Bl.$inject=["injector"],Bl.prototype._registerDefaultActions=function(e){Il.prototype._registerDefaultActions.call(this,e);var n=e.get("canvas",!1),i=e.get("elementRegistry",!1),r=e.get("selection",!1),t=e.get("lassoTool",!1),o=e.get("handTool",!1),a=e.get("directEditing",!1),s=e.get("distributeElements",!1),c=e.get("alignElements",!1);n&&i&&r&&this._registerAction("selectElements",function(){var t=n.getRootElement(),e=i.filter(function(e){return e!==t});return r.select(e),e}),r&&s&&this._registerAction("distributeElements",function(e){var t=r.get(),e=e.type;2<t.length&&s.trigger(t,e)}),r&&c&&this._registerAction("alignElements",function(e){var t=r.get(),e=e.type;1<t.length&&c.trigger(t,e)}),t&&this._registerAction("lassoTool",function(){t.toggle()}),o&&this._registerAction("handTool",function(){o.toggle()}),r&&a&&this._registerAction("directEditing",function(){var e=r.get();e.length&&a.activate(e[0])})};Nl={__depends__:[Nl],editorActions:["type",Bl]};function Ll(e){return e.dmnDI&&e.dmnDI.diagrams&&e.dmnDI.diagrams[0]}function Vl(r,o,e,a){e.on("import.start",function(e){var t,n,i,e=e.definitions;Ll(e)||((t=(e=e).dmnDI)||(t=r.create("dmndi:DMNDI"),e.set("dmnDI",t)),n=r.create("dmndi:DMNDiagram"),t.set("diagrams",[n]),i=0,y(e.get("drgElement"),function(e){var t;k(e,"dmn:Decision")&&(t=o._getDefaultSize(e),e=r.createDiShape(e,{x:150+30*i,y:150+30*i,width:t.width,height:t.height}),a.updateDiParent(e,n),i++)}))})}Vl.$inject=["drdFactory","elementFactory","eventBus","drdUpdater"];var $l={__init__:["diGenerator"],diGenerator:["type",Vl]};function zl(e,t,n){return n=n||"round",Math[n](e/t)*t}function Fl(u,e,t){var n=!t||!1!==t.active,l=(this._eventBus=e,this);e.on("diagram.init",800,function(){l.setActive(n)}),e.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],1200,function(c){var e=c.originalEvent;!l.active||e&&_s(e)||((e=c.context).gridSnappingContext||(e.gridSnappingContext={}),["x","y"].forEach(function(e){var t,n,i,r,o={},a=(r=e,n=u,a=(i=c).context,i=i.shape,a=a.gridSnappingContext,t=a.snapLocation,(s=a.snapOffset)&&g(s[r])||(g((s=s||(a.snapOffset={}))[r])||(s[r]=0),i&&(n.get(i.id)||(Ul(r)?s[r]+=i[r]+i.width/2:s[r]+=i[r]+i.height/2),t)&&("x"===r?/left/.test(t)?s[r]-=i.width/2:/right/.test(t)&&(s[r]+=i.width/2):/top/.test(t)?s[r]-=i.height/2:/bottom/.test(t)&&(s[r]+=i.height/2))),s[r]),s=(a&&(o.offset=a),n=e,t=(t=c).context,i=t.createConstraints,s=t.resizeConstraints||{},r=t.gridSnappingContext,(a=r.snapConstraints)&&a[n]||((a=a||(r.snapConstraints={}))[n]||(a[n]={}),r=t.direction,i&&(Ul(n)?(a.x.min=i.left,a.x.max=i.right):(a.y.min=i.top,a.y.max=i.bottom)),t=s.min,i=s.max,t&&(Ul(n)?Wl(r)?a.x.max=t.left:a.x.min=t.right:Hl(r)?a.y.max=t.top:a.y.min=t.bottom),i&&(Ul(n)?Wl(r)?a.x.min=i.left:a.x.max=i.right:Hl(r)?a.y.min=i.top:a.y.max=i.bottom)),a[n]);s&&C(o,s),fc(c,e)||l.snapEvent(c,e,o)}))})}function Ul(e){return"x"===e}function Hl(e){return-1!==e.indexOf("n")}function Wl(e){return-1!==e.indexOf("w")}Fl.prototype.snapEvent=function(e,t,n){mc(e,t,this.snapValue(e[t],n))},Fl.prototype.getGridSpacing=function(){return 10},Fl.prototype.snapValue=function(e,t){var n,i=0;return e=zl(e+=i=t&&t.offset?t.offset:i,10),t&&t.min&&g(n=t.min)&&(n=zl(n+i,10,"ceil"),e=Math.max(e,n)),t&&t.max&&g(n=t.max)&&(n=zl(n+i,10,"floor"),e=Math.min(e,n)),e-=i},Fl.prototype.isActive=function(){return this.active},Fl.prototype.setActive=function(e){this.active=e,this._eventBus.fire("gridSnapping.toggle",{active:e})},Fl.prototype.toggleActive=function(){this.setActive(!this.active)},Fl.$inject=["elementRegistry","eventBus","config.gridSnapping"];function ql(e){this._eventBus=e}ql.$inject=["eventBus"],ql.prototype.on=function(e,i,r,o,a,s){if((te(i)||g(i))&&(s=a,a=o,o=r,r=i,i=null),te(r)&&(s=a,a=o,o=r,r=1e3),ee(a)&&(s=a,a=!1),!te(o))throw new Error("handlerFn must be a function");m(e)||(e=[e]);var c=this._eventBus;y(e,function(e){var t,n,e=["commandStack",e,i].filter(function(e){return e}).join(".");c.on(e,r,a?(t=o,n=s,function(e){return t.call(n||null,e.context,e.command,e)}):o,s)})};function Gl(e,t){ql.call(this,e),this._gridSnapping=t;var r=this;this.preExecute("shape.resize",function(e){var t,n,e=e.context,i=(e.hints||{}).autoResize;i&&(t=e.shape,n=e.newBounds,ne(i)?e.newBounds=r.snapComplex(n,i):e.newBounds=r.snapSimple(t,n))})}y(["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"],function(o){ql.prototype[o]=function(e,t,n,i,r){(te(e)||g(e))&&(r=i,i=n,n=t,t=e,e=null),this.on(e,o,t,n,i,r)}}),Gl.$inject=["eventBus","gridSnapping","modeling"],Yn(Gl,ql),Gl.prototype.snapSimple=function(e,t){var n=this._gridSnapping;return t.width=n.snapValue(t.width,{min:t.width}),t.height=n.snapValue(t.height,{min:t.height}),t.x=e.x+e.width/2-t.width/2,t.y=e.y+e.height/2-t.height/2,t},Gl.prototype.snapComplex=function(e,t){return/w|e/.test(t)&&(e=this.snapHorizontally(e,t)),e=/n|s/.test(t)?this.snapVertically(e,t):e},Gl.prototype.snapHorizontally=function(e,t){var n=this._gridSnapping,i=/w/.test(t),t=/e/.test(t),r={};return r.width=n.snapValue(e.width,{min:e.width}),t&&(i?(r.x=n.snapValue(e.x,{max:e.x}),r.width+=n.snapValue(e.x-r.x,{min:e.x-r.x})):e.x=e.x+e.width-r.width),C(e,r),e},Gl.prototype.snapVertically=function(e,t){var n=this._gridSnapping,i=/n/.test(t),t=/s/.test(t),r={};return r.height=n.snapValue(e.height,{min:e.height}),i&&(t?(r.y=n.snapValue(e.y,{max:e.y}),r.height+=n.snapValue(e.y-r.y,{min:e.y-r.y})):e.y=e.y+e.height-r.height),C(e,r),e};function Kl(e,i){e.on(["spaceTool.move","spaceTool.end"],2e3,function(e){var t,n=e.context;n.initialized&&("x"===n.axis?(t=i.snapValue(e.dx),e.x=e.x+t-e.dx,e.dx=t):(t=i.snapValue(e.dy),e.y=e.y+t-e.dy,e.dy=t))})}Kl.$inject=["eventBus","gridSnapping"];var Xl={__depends__:[{__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",Gl],gridSnappingSpaceToolBehavior:["type",Kl]}],__init__:["gridSnapping"],gridSnapping:["type",Fl]},Yl="keyboard.keydown",Zl="input-handle-modified-keys";function Ql(e,t){var n=this;this._config=e||{},this._eventBus=t,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),t.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),t.on("diagram.init",function(){n._fire("init")}),t.on("attach",function(){e&&e.bindTo&&n.bind(e.bindTo)}),t.on("detach",function(){n.unbind()})}Ql.$inject=["config.keyboard","eventBus"],Ql.prototype._keydownHandler=function(e){this._keyHandler(e,Yl)},Ql.prototype._keyupHandler=function(e){this._keyHandler(e,"keyboard.keyup")},Ql.prototype._keyHandler=function(e,t){this._isEventIgnored(e)||this._eventBus.fire(t||Yl,{keyEvent:e})&&e.preventDefault()},Ql.prototype._isEventIgnored=function(e){return!!e.defaultPrevented||(t=e.target)&&(wn(t,"input, textarea")||"true"===t.contentEditable)&&this._isModifiedKeyIgnored(e);var t},Ql.prototype._isModifiedKeyIgnored=function(e){return!_s(e)||-1===this._getAllowedModifiers(e.target).indexOf(e.key)},Ql.prototype._getAllowedModifiers=function(e){e=Cn(e,"["+Zl+"]",!0);return!e||this._node&&!this._node.contains(e)?[]:e.getAttribute(Zl).split(",")},Ql.prototype.bind=function(e){this.unbind(),this._node=e,E.bind(e,"keydown",this._keydownHandler),E.bind(e,"keyup",this._keyupHandler),this._fire("bind")},Ql.prototype.getBinding=function(){return this._node},Ql.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),E.unbind(e,"keydown",this._keydownHandler),E.unbind(e,"keyup",this._keyupHandler)),this._node=null},Ql.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})},Ql.prototype.addListener=function(e,t,n){te(e)&&(n=t,t=e,e=1e3),this._eventBus.on(n||Yl,e,t)},Ql.prototype.removeListener=function(e,t){this._eventBus.off(t||Yl,e)},Ql.prototype.hasModifier=function(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey},Ql.prototype.isCmd=_s,Ql.prototype.isShift=xs,Ql.prototype.isKey=bs;function Jl(e,t){var n=this;e.on("editorActions.init",500,function(e){e=e.editorActions;n.registerBindings(t,e)})}Jl.$inject=["eventBus","keyboard"],Jl.prototype.registerBindings=function(n,i){function e(e,t){i.isRegistered(e)&&n.addListener(t)}e("undo",function(e){var e=e.keyEvent;if(_s(e=e)&&!xs(e)&&bs(ys,e))return i.trigger("undo"),!0}),e("redo",function(e){var e=e.keyEvent;if(_s(e=e)&&(bs(vs,e)||bs(ys,e)&&xs(e)))return i.trigger("redo"),!0}),e("copy",function(e){var e=e.keyEvent;if(_s(e=e)&&bs(ms,e))return i.trigger("copy"),!0}),e("paste",function(e){var e=e.keyEvent;if(_s(e=e)&&bs(gs,e))return i.trigger("paste"),!0}),e("stepZoom",function(e){e=e.keyEvent;if(bs(["+","Add","="],e)&&_s(e))return i.trigger("stepZoom",{value:1}),!0}),e("stepZoom",function(e){e=e.keyEvent;if(bs(["-","Subtract"],e)&&_s(e))return i.trigger("stepZoom",{value:-1}),!0}),e("zoom",function(e){e=e.keyEvent;if(bs("0",e)&&_s(e))return i.trigger("zoom",{value:1}),!0}),e("removeSelection",function(e){if(bs(["Backspace","Delete","Del"],e.keyEvent))return i.trigger("removeSelection"),!0})};var ed={__init__:["keyboard","keyboardBindings"],keyboard:["type",Ql],keyboardBindings:["type",Jl]};function td(e){e.invoke(Jl,this)}Yn(td,Jl),td.$inject=["injector"],td.prototype.registerBindings=function(n,i){function e(e,t){i.isRegistered(e)&&n.addListener(t)}Jl.prototype.registerBindings.call(this,n,i),e("selectElements",function(e){e=e.keyEvent;if(n.isKey(["a","A"],e)&&n.isCmd(e))return i.trigger("selectElements"),!0}),e("lassoTool",function(e){e=e.keyEvent;return!n.hasModifier(e)&&n.isKey(["l","L"],e)?(i.trigger("lassoTool"),!0):void 0}),e("handTool",function(e){e=e.keyEvent;return!n.hasModifier(e)&&n.isKey(["h","H"],e)?(i.trigger("handTool"),!0):void 0}),e("directEditing",function(e){e=e.keyEvent;return!n.hasModifier(e)&&n.isKey(["e","E"],e)?(i.trigger("directEditing"),!0):void 0})};var nd={__depends__:[ed],__init__:["keyboardBindings"],keyboardBindings:["type",td]},id={moveSpeed:50,moveSpeedAccelerated:200};function rd(e,i,r){var o=this;this._config=C({},id,e||{}),i.addListener(function(e){var e=e.keyEvent,t=o._config;if(i.isCmd(e)&&i.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],e)){var n,t=i.isShift(e)?t.moveSpeedAccelerated:t.moveSpeed;switch(e.key){case"ArrowLeft":case"Left":n="left";break;case"ArrowUp":case"Up":n="up";break;case"ArrowRight":case"Right":n="right";break;case"ArrowDown":case"Down":n="down"}return o.moveCanvas({speed:t,direction:n}),!0}}),this.moveCanvas=function(e){var t=0,n=0,i=e.speed/Math.min(Math.sqrt(r.viewbox().scale),1);switch(e.direction){case"left":t=i;break;case"up":n=i;break;case"right":t=-i;break;case"down":n=-i}r.scroll({dx:t,dy:n})}}rd.$inject=["config.keyboardMove","keyboard","canvas"];var od={__depends__:[ed],__init__:["keyboardMove"],keyboardMove:["type",rd]},ad={moveSpeed:1,moveSpeedAccelerated:10},sd={ArrowLeft:"left",Left:"left",ArrowUp:"up",Up:"up",ArrowRight:"right",Right:"right",ArrowDown:"down",Down:"down"},cd={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function ud(e,n,i,r,o){var a=this;this._config=C({},ad,e||{}),n.addListener(1500,function(e){var e=e.keyEvent,t=sd[e.key];if(t&&!n.isCmd(e))return e=n.isShift(e),a.moveSelection(t,e),!0}),this.moveSelection=function(e,t){var n=o.get();n.length&&(t=this._config[t?"moveSpeedAccelerated":"moveSpeed"],e=cd[e](t),r.allowed("elements.move",{shapes:n}))&&i.moveElements(n,e)}}ud.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"];ed={__depends__:[ed,Yo],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",ud]};function n(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}n.$inject=["eventBus","injector"],n.prototype.execute=function(e,t){if(!e)throw new Error("command required");this._currentExecution.trigger="execute";e={command:e,context:t};this._pushAction(e),this._internalExecute(e),this._popAction(e)},n.prototype.canExecute=function(e,t){var n={command:e,context:t},i=this._getHandler(e),e=this._fire(e,"canExecute",n);if(void 0===e){if(!i)return!1;i.canExecute&&(e=i.canExecute(t))}return e},n.prototype.clear=function(e){this._stack.length=0,!(this._stackIdx=-1)!==e&&this._fire("changed",{trigger:"clear"})},n.prototype.undo=function(){var e,t=this._getUndoAction();if(t){for(this._currentExecution.trigger="undo",this._pushAction(t);t&&(this._internalUndo(t),e=this._getUndoAction())&&e.id===t.id;)t=e;this._popAction()}},n.prototype.redo=function(){var e,t=this._getRedoAction();if(t){for(this._currentExecution.trigger="redo",this._pushAction(t);t&&(this._internalExecute(t,!0),e=this._getRedoAction())&&e.id===t.id;)t=e;this._popAction()}},n.prototype.register=function(e,t){this._setHandler(e,t)},n.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");t=this._injector.instantiate(t);this.register(e,t)},n.prototype.canUndo=function(){return!!this._getUndoAction()},n.prototype.canRedo=function(){return!!this._getRedoAction()},n.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]},n.prototype._getUndoAction=function(){return this._stack[this._stackIdx]},n.prototype._internalUndo=function(e){var t=this,n=e.command,i=e.context,r=this._getHandler(n);this._atomicDo(function(){t._fire(n,"revert",e),r.revert&&t._markDirty(r.revert(i)),t._revertedAction(e),t._fire(n,"reverted",e)})},n.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);t=t?[e+"."+t,t]:[e];n=this._eventBus.createEvent(n);for(var i=0,r=t;i<r.length;i++){var o=this._eventBus.fire("commandStack."+r[i],n);if(n.cancelBubble)break}return o},n.prototype._createId=function(){return this._uid++},n.prototype._atomicDo=function(e){var t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}},n.prototype._internalExecute=function(e,t){var n=this,i=e.command,r=e.context,o=this._getHandler(i);if(!o)throw new Error("no command handler registered for <"+i+">");this._pushAction(e),t||(this._fire(i,"preExecute",e),o.preExecute&&o.preExecute(r),this._fire(i,"preExecuted",e)),this._atomicDo(function(){n._fire(i,"execute",e),o.execute&&n._markDirty(o.execute(r)),n._executedAction(e,t),n._fire(i,"executed",e)}),t||(this._fire(i,"postExecute",e),o.postExecute&&o.postExecute(r),this._fire(i,"postExecuted",e)),this._popAction(e)},n.prototype._pushAction=function(e){var t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)},n.prototype._popAction=function(){var e=this._currentExecution,t=e.trigger,n=e.actions,i=e.dirty;n.pop(),n.length||(this._eventBus.fire("elements.changed",{elements:function(t){t=fe(t);for(var n={},e=arguments.length,i=new Array(1<e?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return y(i,function(e){return de(e,t,n)}),ce(n,function(e,t){return e[0]})}("id",i.reverse())}),i.length=0,this._fire("changed",{trigger:t}),e.trigger=null)},n.prototype._markDirty=function(e){var t=this._currentExecution;e&&(e=m(e)?e:[e],t.dirty=t.dirty.concat(e))},n.prototype._executedAction=function(e,t){var n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)},n.prototype._revertedAction=function(e){this._stackIdx--},n.prototype._getHandler=function(e){return this._handlerMap[e]},n.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};var ld={commandStack:["type",n]};function dd(n,i,r,t){n.on("element.changed",function(e){var t=e.element;!t.parent&&t!==i.getRootElement()||(e.gfx=r.getGraphics(t)),e.gfx&&n.fire($i(t)+".changed",e)}),n.on("elements.changed",function(e){e=e.elements;e.forEach(function(e){n.fire("element.changed",{element:e})}),t.updateContainments(e)}),n.on("shape.changed",function(e){t.update("shape",e.element,e.gfx)}),n.on("connection.changed",function(e){t.update("connection",e.element,e.gfx)})}dd.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];var pd={__init__:["changeSupport"],changeSupport:["type",dd]},hd=Math.min,fd=Math.max;function md(e){e.preventDefault()}function gd(e){e.stopPropagation()}function vd(e){this.container=e.container,this.parent=_('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=b("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=ye(this.autoResize,this),this.handlePaste=ye(this.handlePaste,this)}function yd(e,t){this._eventBus=e,this._providers=[],this._textbox=new vd({container:t.getContainer(),keyHandler:ye(this._handleKey,this),resizeHandler:ye(this._handleResize,this)})}vd.prototype.create=function(e,t,n,i){var r=this.parent,o=this.content,a=this.container,s=(i=this.options=i||{},_e(t=this.style=t||{},["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"])),e=(C(r.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},s),_e(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]));return C(o.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},e),i.centerVertically&&C(o.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},e),o.innerText=n,E.bind(o,"keydown",this.keyHandler),E.bind(o,"mousedown",gd),E.bind(o,"paste",this.handlePaste),i.autoResize&&E.bind(o,"input",this.autoResize),i.resizable&&this.resizable(t),a.appendChild(r),this.setSelection(o.lastChild,o.lastChild&&o.lastChild.length),r},vd.prototype.handlePaste=function(e){var t=this.options,n=this.style;e.preventDefault(),e=e.clipboardData?e.clipboardData.getData("text/plain"):window.clipboardData.getData("Text"),this.insertText(e),t.autoResize&&(e=this.autoResize(n))&&this.resizeHandler(e)},vd.prototype.insertText=function(e){e=e.replace(/\r\n|\r|\n/g,"\n"),document.execCommand("insertText",!1,e)||this._insertTextIE(e)},vd.prototype._insertTextIE=function(n){var e,i,r,t=this.getSelection(),o=t.startContainer,a=t.endContainer,s=t.startOffset,c=t.endOffset,t=t.commonAncestorContainer,u=(u=t.childNodes,[].slice.call(u)),l=t.nodeType===Node.TEXT_NODE?(t=o.textContent,o.textContent=t.substring(0,s)+n+t.substring(c),e=o,s+n.length):o===this.content&&a===this.content?(t=document.createTextNode(n),this.content.insertBefore(t,u[s]),(e=t).textContent.length):(i=u.indexOf(o),r=u.indexOf(a),u.forEach(function(e,t){t===i?e.textContent=o.textContent.substring(0,s)+n+a.textContent.substring(c):i<t&&t<=r&&Tn(e)}),e=o,s+n.length);e&&void 0!==l&&setTimeout(function(){self.setSelection(e,l)})},vd.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n)&&(n=e.getBoundingClientRect(),t=t.scrollHeight,e.style.height=t+"px",this.resizeHandler({width:n.width,height:n.height,dx:0,dy:t-n.height}))},vd.prototype.resizable=function(){var i,r,o,a,n,t,s=this,c=this.parent,e=this.resizeHandle,u=parseInt(this.style.minWidth)||0,l=parseInt(this.style.minHeight)||0,d=parseInt(this.style.maxWidth)||1/0,p=parseInt(this.style.maxHeight)||1/0;e||(e=this.resizeHandle=_('<div class="djs-direct-editing-resize-handle"></div>'),n=function(e){md(e),gd(e);var t=hd(fd(o+e.clientX-i,u),d),n=hd(fd(a+e.clientY-r,l),p);c.style.width=t+"px",c.style.height=n+"px",s.resizeHandler({width:o,height:a,dx:e.clientX-i,dy:e.clientY-r})},t=function e(t){md(t),gd(t),E.unbind(document,"mousemove",n,!1),E.unbind(document,"mouseup",e,!1)},E.bind(e,"mousedown",function(e){md(e),gd(e),i=e.clientX,r=e.clientY;e=c.getBoundingClientRect();o=e.width,a=e.height,E.bind(document,"mousemove",n),E.bind(document,"mouseup",t)})),C(e.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),c.appendChild(e)},vd.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),E.unbind(t,"keydown",this.keyHandler),E.unbind(t,"mousedown",gd),E.unbind(t,"input",this.autoResize),E.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),Tn(n)),Tn(e)},vd.prototype.getValue=function(){return this.content.innerText.trim()},vd.prototype.getSelection=function(){return window.getSelection().getRangeAt(0)},vd.prototype.setSelection=function(e,t){var n=document.createRange(),e=(null===e?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t)),window.getSelection());e.removeAllRanges(),e.addRange(n)},yd.$inject=["eventBus","canvas"],yd.prototype.registerProvider=function(e){this._providers.push(e)},yd.prototype.isActive=function(e){return!(!this._active||e&&this._active.element!==e)},yd.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())},yd.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})},yd.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0},yd.prototype.complete=function(){var e,t,n,i=this._active;i&&(e=i.context.bounds,t=this.$textbox.getBoundingClientRect(),(n=this.getValue())===i.context.text&&t.height===e.height&&t.width===e.width||(e=this._textbox.container.getBoundingClientRect(),i.provider.update(i.element,n,i.context.text,{x:t.left-e.left,y:t.top-e.top,width:t.width,height:t.height})),this._fire("complete"),this.close())},yd.prototype.getValue=function(){return this._textbox.getValue()},yd.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;return 27===t?(e.preventDefault(),this.cancel()):13!==t||e.shiftKey?void 0:(e.preventDefault(),this.complete())},yd.prototype._handleResize=function(e){this._fire("resize",e)},yd.prototype.activate=function(t){this.isActive()&&this.cancel();var n,e=ie(this._providers,function(e){return(n=e.activate(t))?e:null});return n&&(this.$textbox=this._textbox.create(n.bounds,n.style,n.text,n.options),this._active={element:t,context:n,provider:e},n.options&&n.options.resizable&&(this.resizable=!0),this._fire("activate")),!!n};var _d={__depends__:[e],__init__:["directEditing"],directEditing:["type",yd]};function bd(e){return k(e,"dmn:Decision")||k(e,"dmn:BusinessKnowledgeModel")||k(e,"dmn:InputData")||k(e,"dmn:KnowledgeSource")?"name":k(e,"dmn:TextAnnotation")?"text":void 0}function xd(e){var e=e.businessObject,t=bd(e);if(t)return e[t]||""}function wd(e,t,n,i,r){this._canvas=e,this._modeling=i,this._textRenderer=r,t.registerProvider(this),n.on("element.dblclick",function(e){t.activate(e.element)}),n.on(["autoPlace.start","canvas.viewbox.changing","drag.init","drillDown.click","element.mousedown","popupMenu.open","selection.changed"],function(){t.complete()}),n.on(["commandStack.changed"],function(){t.cancel()}),n.on("create.end",500,function(e){e=e.shape;(k(e,"dmn:Decision")||k(e,"dmn:InputData")||k(e,"dmn:BusinessKnowledgeModel")||k(e,"dmn:KnowledgeSource")||k(e,"dmn:TextAnnotation"))&&t.activate(e)}),n.on("autoPlace.end",500,function(e){t.activate(e.shape)})}wd.$inject=["canvas","directEditing","eventBus","modeling","textRenderer"],wd.prototype.activate=function(e){var t,n=xd(e);if(Q(n))return C(n={text:n},this.getEditingBBox(e)),t={},k(e,"dmn:DRGElement")&&C(t,{centerVertically:!0}),k(e,"dmn:TextAnnotation")&&C(t,{resizable:!0}),C(n,{options:t}),n},wd.prototype.getEditingBBox=function(e){var t=this._canvas,n=e.label||e,n=t.getAbsoluteBBox(n),i={x:n.x,y:n.y},t=t.zoom(),r=this._textRenderer.getDefaultStyle(),o=r.fontSize*t,r=r.lineHeight,a={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};return k(e,"dmn:DRGElement")&&(C(i,{width:n.width,height:n.height}),C(a,{fontSize:o+"px",lineHeight:r,paddingTop:7*t+"px",paddingBottom:7*t+"px",paddingLeft:5*t+"px",paddingRight:5*t+"px"})),k(e,"dmn:TextAnnotation")&&(C(i,{width:n.width,height:n.height,minWidth:30*t,minHeight:10*t}),C(a,{textAlign:"left",paddingTop:5*t+"px",paddingBottom:7*t+"px",paddingLeft:7*t+"px",paddingRight:5*t+"px",fontSize:o+"px",lineHeight:r})),{bounds:i,style:a}},wd.prototype.update=function(e,t,n,i){var r;k(e,"dmn:TextAnnotation")&&(r=this._canvas.getAbsoluteBBox(e),r={x:e.x,y:e.y,width:e.width/r.width*i.width,height:e.height/r.height*i.height}),(i=t)&&i.trim()||(t=null),this._modeling.updateLabel(e,t,r)};_d={__depends__:[ld,pd,_d],__init__:["labelEditingProvider"],labelEditingProvider:["type",wd]};function Cd(r,e){e.invoke(ql,this),this.preExecute("connection.create",function(e){var t=e.connection,n=t.businessObject,i=e.source,e=e.target;k(t,"dmn:Association")?(((n.sourceRef=r.create("dmn:DMNElementReference",{href:"#"+i.id})).$parent=n).targetRef=r.create("dmn:DMNElementReference",{href:"#"+e.id})).$parent=n:(n["required"+(k(t=i,"dmn:BusinessKnowledgeModel")?"Knowledge":k(t,"dmn:Decision")?"Decision":k(t,"dmn:InputData")?"Input":k(t,"dmn:KnowledgeSource")?"Authority":void 0)]=r.create("dmn:DMNElementReference",{href:"#"+i.id})).$parent=n},!0)}Cd.$inject=["drdFactory","injector"],Yn(Cd,ql);function Ed(e,c,u,r){function o(n,e,t){e=e||n.incoming.filter(function(e){return k(e,"dmn:InformationRequirement")});var i,r,o={};t?o[t]=e:(i=n,r={},e.forEach(function(e){var t=Mr(e.source,i).split("-").shift();r[t]||(r[t]=[]),r[t].push(e)}),o=r),y(o,function(e,t){e=function(e,t){var n;n=t.includes("top")||t.includes("bottom")?"x":"y";return e.sort(function(e,t){return D(e.source)[n]-D(t.source)[n]})}(e,t);a=n,s=t;var o,a,s,i=(o=e).map(function(e,t){var e=e.source,n=D(e),e=P(e),i=P(a),r=o.length;return s.includes("bottom")?{start:{x:n.x,y:e.top},end:{x:i.left+a.width/(r+1)*(t+1),y:i.bottom}}:s.includes("top")?{start:{x:n.x,y:e.bottom},end:{x:i.left+a.width/(r+1)*(t+1),y:i.top}}:s.includes("right")?{start:{x:e.left,y:n.y},end:{x:i.right,y:i.top+a.height/(r+1)*(t+1)}}:{start:{x:e.right,y:n.y},end:{x:i.left,y:i.top+a.height/(r+1)*(t+1)}}});e.forEach(function(e,t){var n=i[t].start,t=i[t].end,n=c.layoutConnection(e,{connectionStart:n,connectionEnd:t});u.updateWaypoints(e,n)})})}e.invoke(ql,this),this.preExecute(["connection.create","connection.reconnect"],function(e){var t=e.connection,n=e.newSource||e.source,i=e.newTarget||e.target;k(t,"dmn:InformationRequirement")&&!r.allowed("connection.connect",{connection:t,source:n,target:i})||k(t,"dmn:InformationRequirement")&&(t=Mr(n,i),e.hints||(e.hints={}),C(e.hints,function(e,t,n){var i=D(e),r=D(t);n.includes("bottom")?(i.y=e.y,r.y=t.y+t.height):n.includes("top")?(i.y=e.y+e.height,r.y=t.y):n.includes("right")?(i.x=e.x,r.x=t.x+t.width):(i.x=e.x+e.width,r.x=t.x);return{connectionStart:i,connectionEnd:r}}(n,i,t)))},!0),this.postExecuted(["connection.create","connection.delete","connection.reconnect"],function(e){var n,t=e.connection,i=t.source||e.source,e=t.target||e.target;k(t,"dmn:InformationRequirement")&&(n=Mr(i,e),(t=e.incoming.filter(function(e){var t=Mr(e.source,e.target);return k(e,"dmn:InformationRequirement")&&kd(t,n)})).length)&&o(e,t,n)},!0),this.preExecute("connection.reconnect",function(e){var n,i=e.connection,e=i.source,t=i.target;k(i,"dmn:InformationRequirement")&&(n=Mr(e,t),(e=t.incoming.filter(function(e){var t=Mr(e.source,e.target);return e!==i&&k(e,"dmn:InformationRequirement")&&kd(t,n)})).length)&&o(t,e,n)},!0),this.postExecuted("elements.move",500,function(e){var t=e.shapes,n=e.closure.enclosedConnections;t.forEach(function(e){var t;Kn(e,["dmn:Decision","dmn:InputData"])&&((t=e.incoming.filter(function(e){return k(e,"dmn:InformationRequirement")&&!n[e.id]})).length&&o(e,t),e.outgoing.forEach(function(e){k(e,"dmn:InformationRequirement")&&!n[e.id]&&o(e.target)}))})},!0)}function kd(e,t){return e&&t&&e.split("-").shift()===t.split("-").shift()}function Sd(e,a,s){e.invoke(ql,this),this.preExecute("connection.reconnect",function(e){var t=e.connection,n=e.newSource||t.source,i=e.newTarget||t.target,r=t.waypoints.slice(),o=s.allowed("connection.reconnect",{connection:t,source:n,target:i});o&&o.type!==t.type&&(e.connection=a.connect(n,i,{type:o.type,waypoints:r}),a.removeConnection(t))},!0)}function jd(e,n,i){ql.call(this,e),this._modeling=n,this.postExecuted(["shape.replace"],1500,function(e){var e=e.context,t=e.oldShape,e=e.newShape;n.unclaimId(t.businessObject.id,t.businessObject),n.updateProperties(e,{id:t.id}),i.select(e)})}Ed.$inject=["injector","layouter","modeling","rules"],Yn(Ed,ql),Yn(Sd,ql),Sd.$inject=["injector","modeling","rules"],Yn(jd,ql),jd.$inject=["eventBus","modeling","selection"];var Od=function(){l(n,ql);var t=p(n);function n(e){return h(this,n),(e=t.call(this,e)).executed("element.updateProperties",e.updateIds.bind(d(e))),e}return u(n,[{key:"updateIds",value:function(e){var e=e.context,t=e.element,o=e.oldProperties,a=e.properties,e=Gn(t);this.shouldSkipUpdate(e,o,a)||((t=function(e){var t=e;for(;!k(t,"dmn:Definitions");)t=t.$parent;return t}(e)).get("drgElement").forEach(function(e){var n,i,r;n=e,i=o.id,r=a.id,y({authorityRequirement:function(){n.authorityRequirement.forEach(function(e){var t=e.requiredAuthority,n=e.requiredDecision,e=e.requiredInput;t&&t.href==="#".concat(i)&&(t.href="#".concat(r)),n&&n.href==="#".concat(i)&&(n.href="#".concat(r)),e&&e.href==="#".concat(i)&&(e.href="#".concat(r))})},informationRequirement:function(){n.informationRequirement.forEach(function(e){var t=e.requiredDecision,e=e.requiredInput;t&&t.href==="#".concat(i)&&(t.href="#".concat(r)),e&&e.href==="#".concat(i)&&(e.href="#".concat(r))})},knowledgeRequirement:function(){n.knowledgeRequirement.forEach(function(e){e=e.requiredKnowledge;e&&e.href==="#".concat(i)&&(e.href="#".concat(r))})}},function(e,t){n[t]&&e()})}),t.get("artifact").forEach(function(e){var n,t,i;n=e,t=o.id,i=a.id,y({sourceRef:function(){var e;(e=n.sourceRef).href==="#".concat(t)&&(e.href="#".concat(i))},targetRef:function(){var e;(e=n.targetRef).href==="#".concat(t)&&(e.href="#".concat(i))}},function(e,t){n[t]&&e()})}))}},{key:"shouldSkipUpdate",value:function(e,t,n){return n=n,!("id"in t&&"id"in n)||!k(e,"dmn:DRGElement")&&!k(e,"dmn:TextAnnotation")}}]),n}();Od.$inject=["eventBus"];var Pd={__init__:["createConnectionBehavior","idChangeBehavior","layoutConnectionBehavior","replaceConnectionBehavior","replaceElementBehavior"],createConnectionBehavior:["type",Cd],idChangeBehavior:["type",Od],layoutConnectionBehavior:["type",Ed],replaceConnectionBehavior:["type",Sd],replaceElementBehavior:["type",jd]};function Dd(e){ql.call(this,e),this.init()}function Rd(e){e.invoke(Dd,this)}function Td(e,t){if(!e||Ad(e)||!t||Ad(t))return null;if(e===t)return!1;if(k(e,"dmn:BusinessKnowledgeModel")&&Kn(t,["dmn:BusinessKnowledgeModel","dmn:Decision"]))return{type:"dmn:KnowledgeRequirement"};if(k(e,"dmn:Decision")){if(k(t,"dmn:Decision"))return{type:"dmn:InformationRequirement"};if(k(t,"dmn:KnowledgeSource"))return{type:"dmn:AuthorityRequirement"}}if(k(e,"dmn:Definitions")||k(t,"dmn:Definitions"))return!1;if(k(e,"dmn:InputData")){if(k(t,"dmn:Decision"))return{type:"dmn:InformationRequirement"};if(k(t,"dmn:KnowledgeSource"))return{type:"dmn:AuthorityRequirement"}}return k(e,"dmn:KnowledgeSource")&&Kn(t,["dmn:BusinessKnowledgeModel","dmn:Decision","dmn:KnowledgeSource"])?{type:"dmn:AuthorityRequirement"}:!!(k(e,"dmn:TextAnnotation")&&!k(t,"dmn:TextAnnotation")||!k(e,"dmn:TextAnnotation")&&k(t,"dmn:TextAnnotation"))&&{type:"dmn:Association"}}function Md(e,t){return Kn(e,["dmn:BusinessKnowledgeModel","dmn:Decision","dmn:InputData","dmn:KnowledgeSource","dmn:TextAnnotation"])&&k(t,"dmn:Definitions")}function Id(e,t){return m(e)||(e=[e]),!t||!(!ae(e,function(e){return Kn(e,["dmn:BusinessKnowledgeModel","dmn:Decision","dmn:InputData","dmn:KnowledgeSource","dmn:TextAnnotation","dmn:InformationRequirement","dmn:AuthorityRequirement","dmn:KnowledgeRequirement","dmn:Association"])})||!k(t,"dmn:Definitions"))}function Ad(e){return e.labelTarget}Dd.$inject=["eventBus"],Yn(Dd,ql),Dd.prototype.addRule=function(e,t,i){var n=this;(e="string"==typeof e?[e]:e).forEach(function(e){n.canExecute(e,t,function(e,t,n){return i(e)},!0)})},Dd.prototype.init=function(){},Yn(Rd,Dd),Rd.$inject=["injector"],Rd.prototype.init=function(){this.addRule("connection.create",function(e){return Td(e.source,e.target)}),this.addRule("connection.reconnect",function(e){e.connection;return Td(e.source,e.target)}),this.addRule("connection.updateWaypoints",function(e){e=e.connection;return{type:e.type,businessObject:e.businessObject}}),this.addRule("elements.move",function(e){var t=e.target,n=e.shapes;e.position;return Id(n,t)}),this.addRule("shape.create",function(e){return Md(e.shape,e.target)}),this.addRule("shape.resize",function(e){return k(e.shape,"dmn:TextAnnotation")})},Rd.prototype.canConnect=Td,Rd.prototype.canCreate=Md,Rd.prototype.canMove=Id;var Nd={__depends__:[Ps],__init__:["drdRules"],drdRules:["type",Rd]};function Bd(e){this._model=e}function Ld(n,t,e,i,r){r.invoke(ql,this),this._definitionPropertiesView=t,this._drdFactory=e,this._drdRules=i;var o=this;function a(e){var t=e.connection,n=e.parent,e=e.shape;t&&!k(t,"dmn:Association")&&(n=t.target),o.updateParent(e||t,n)}function s(e){var t=e.connection,n=e.shape,e=e.parent||e.newParent;t&&!k(t,"dmn:Association")&&(e=t.target),o.updateParent(n||t,e)}function c(e){e=e.shape;(k(e,"dmn:DRGElement")||k(e,"dmn:TextAnnotation"))&&o.updateBounds(e)}function u(e){o.updateConnectionWaypoints(e)}this.executed(["connection.create","connection.layout"],function(e){var t=e.connection;e.cropped||(t.waypoints=n.getCroppedWaypoints(t),e.cropped=!0)},!0),this.reverted(["connection.layout"],function(e){delete e.cropped},!0),this.executed(["connection.create","connection.delete","connection.move","shape.create","shape.delete"],a,!0),this.reverted(["connection.create","connection.delete","connection.move","shape.create","shape.delete"],s,!0),this.executed(["shape.create","shape.move","shape.resize"],c,!0),this.reverted(["shape.create","shape.move","shape.resize"],c,!0),this.executed(["connection.create","connection.layout","connection.move","connection.updateWaypoints"],u,!0),this.reverted(["connection.create","connection.layout","connection.move","connection.updateWaypoints"],u,!0),this.executed("connection.create",function(e){var t=e.connection,n=t.businessObject,i=e.target.businessObject;k(t,"dmn:Association")?a(e):o.updateSemanticParent(n,i)},!0),this.reverted("connection.create",function(e){s(e)},!0),this.executed("connection.reconnect",function(e){var t=e.connection.businessObject,e=e.newTarget.businessObject;k(t,"dmn:Association")||o.updateSemanticParent(t,e)},!0),this.reverted("connection.reconnect",function(e){var t=e.connection.businessObject,e=e.oldTarget.businessObject;k(t,"dmn:Association")||o.updateSemanticParent(t,e)},!0),this.executed("element.updateProperties",function(e){t.update()},!0),this.reverted("element.updateProperties",function(e){t.update()},!0)}function Vd(e,t){this._modeling=e,this._canvas=t}function $d(e){this._modeling=e}function zd(e,t){this._canvas=e,this._layouter=t}Bd.$inject=["moddle"],Bd.prototype._needsId=function(e){return Kn(e,["dmn:Artifact","dmn:DMNElement","dmn:DRGElement","dmndi:DMNDiagram","dmndi:DMNDiagramElement"])},Bd.prototype._ensureId=function(e){var t=(e.$type||"").replace(/^[^:]*:/g,"")+"_";!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))},Bd.prototype.create=function(e,t){e=this._model.create(e,t||{});return this._ensureId(e),e},Bd.prototype.createDiShape=function(e,t,n){return this.create("dmndi:DMNShape",C({dmnElementRef:e,bounds:this.createDiBounds(t)},n))},Bd.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)},Bd.prototype.createDiEdge=function(e,t,n){return this.create("dmndi:DMNEdge",{dmnElementRef:e,waypoint:this.createDiWaypoints(t)},n)},Bd.prototype.createDiWaypoints=function(e){var t=this;return e.map(function(e){return t.createDiWaypoint(e)})},Bd.prototype.createDiWaypoint=function(e){return this.create("dc:Point",_e(e,["x","y"]))},Bd.prototype.createExtensionElements=function(){return this.create("dmn:ExtensionElements",{values:[]})},Yn(Ld,ql),Ld.$inject=["connectionDocking","definitionPropertiesView","drdFactory","drdRules","injector"],Ld.prototype.updateBounds=function(e){C(e.businessObject.di.bounds,{x:e.x,y:e.y,width:e.width,height:e.height})},Ld.prototype.updateConnectionWaypoints=function(e){var t=this._drdFactory,e=e.connection,n=e.businessObject.di;n.waypoint=t.createDiWaypoints(e.waypoints).map(function(e){return e.$parent=n,e})},Ld.prototype.updateParent=function(e,t){var n=e.parent,t=(k(e,"dmn:DRGElement")||k(e,"dmn:Artifact")||(n=t),e.businessObject),e=n&&n.businessObject;this.updateSemanticParent(t,e),this.updateDiParent(t.di,e&&e.di)},Ld.prototype.updateSemanticParent=function(e,t){var n,i;e.$parent!==t&&(k(e,"dmn:DRGElement")?i="drgElement":k(e,"dmn:Artifact")?i="artifact":k(e,"dmn:InformationRequirement")?i="informationRequirement":k(e,"dmn:AuthorityRequirement")?i="authorityRequirement":k(e,"dmn:KnowledgeRequirement")&&(i="knowledgeRequirement"),e.$parent&&Hi(n=e.$parent.get(i),e),t?(n=t.get(i))&&(n.push(e),e.$parent=t):e.$parent=null)},Ld.prototype.updateDiParent=function(e,t){if(e.$parent!==t){if(!Kn(e,["dmndi:DMNEdge","dmndi:DMNShape"]))throw new Error("unsupported");for(var n=t||e;!k(n,"dmndi:DMNDiagram");)n=n.$parent;var i=n.get("diagramElements");(t?(e.$parent=n,Wi):(e.$parent=null,Hi))(i,e)}},Vd.$inject=["modeling","canvas"],Vd.prototype.preExecute=function(e){var n=this._modeling,t=e.elements,i=e.alignment;y(t,function(e){var t={x:0,y:0};i.left?t.x=i.left-e.x:i.right?t.x=i.right-e.width-e.x:i.center?t.x=i.center-Math.round(e.width/2)-e.x:i.top?t.y=i.top-e.y:i.bottom?t.y=i.bottom-e.height-e.y:i.middle&&(t.y=i.middle-Math.round(e.height/2)-e.y),n.moveElements([e],t,e.parent)})},Vd.prototype.postExecute=function(e){},$d.$inject=["modeling"],$d.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var t=e.target||t.parent,n=e.shape,i=e.hints||{},n=e.shape=this._modeling.createShape(n,e.position,t,{attach:i.attach});e.shape=n},$d.prototype.postExecute=function(e){var t,n,i=e.hints||{};t=e.source,n=e.shape,se(t.outgoing,function(e){return e.target===n})||(i.connectionTarget===e.source?this._modeling.connect(e.shape,e.source,e.connection):this._modeling.connect(e.source,e.shape,e.connection))},zd.$inject=["canvas","layouter"],zd.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,r=e.parent,o=e.parentIndex,e=e.hints;if(!n||!i)throw new Error("source and target required");if(r)return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,e)),this._canvas.addConnection(t,r,o),t;throw new Error("parent required")},zd.prototype.revert=function(e){e=e.connection;return this._canvas.removeConnection(e),e.source=null,e.target=null,e};var Fd=Math.round;function Ud(e){this._modeling=e}function Hd(e){return e.waypoints}Ud.$inject=["modeling"],Ud.prototype.preExecute=function(e){var t=e.elements,n=e.parent,i=e.parentIndex,r=e.position,o=e.hints,a=this._modeling;y(t,function(e){g(e.x)||(e.x=0),g(e.y)||(e.y=0)});var s=Vi(re(t,function(e){return!e.hidden})),c=(y(t,function(e){Hd(e)&&(e.waypoints=ce(e.waypoints,function(e){return{x:Fd(e.x-s.x-s.width/2+r.x),y:Fd(e.y-s.y-s.height/2+r.y)}})),C(e,{x:Fd(e.x-s.x-s.width/2+r.x),y:Fd(e.y-s.y-s.height/2+r.y)})}),Ii(t)),u={};y(t,function(e){var t;Hd(e)?u[e.id]=g(i)?a.createConnection(u[e.source.id],u[e.target.id],i,e,e.parent||n,o):a.createConnection(u[e.source.id],u[e.target.id],e,e.parent||n,o):(t=C({},o),-1===c.indexOf(e)&&(t.autoResize=!1),u[e.id]=g(i)?a.createShape(e,_e(e,["x","y","width","height"]),e.parent||n,i,t):a.createShape(e,_e(e,["x","y","width","height"]),e.parent||n,t))}),e.elements=le(u)};var Wd=Math.round;function qd(e){this._canvas=e}function Gd(e){qd.call(this,e)}qd.$inject=["canvas"],qd.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,e=e.parentIndex;if(!i)throw new Error("parent required");if(n)return void 0!==n.width?C(t,n):C(t,{x:n.x-Wd(t.width/2),y:n.y-Wd(t.height/2)}),this._canvas.addShape(t,i,e),t;throw new Error("position required")},qd.prototype.revert=function(e){e=e.shape;return this._canvas.removeShape(e),e},Yn(Gd,qd),Gd.$inject=["canvas"];var Kd=qd.prototype.execute,Xd=(Gd.prototype.execute=function(e){var t,n=e.shape;return t=n,["width","height"].forEach(function(e){void 0===t[e]&&(t[e]=0)}),n.labelTarget=e.labelTarget,Kd.call(this,e)},qd.prototype.revert);function Yd(e,t){if("function"!=typeof t)throw new Error("removeFn iterator must be a function");if(e)for(var n;n=e[0];)t(n)}function Zd(e,t){this._canvas=e,this._modeling=t}function Qd(e,t){this._modeling=e,this._elementRegistry=t}function Jd(e,t){this._canvas=e,this._modeling=t}function ep(e){this._modeling=e}Gd.prototype.revert=function(e){return e.shape.labelTarget=null,Xd.call(this,e)},Zd.$inject=["canvas","modeling"],Zd.prototype.preExecute=function(e){var t=this._modeling,e=e.connection;Yd(e.incoming,function(e){t.removeConnection(e,{nested:!0})}),Yd(e.outgoing,function(e){t.removeConnection(e,{nested:!0})})},Zd.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=qi(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t},Zd.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,Wi(n.children,t,i),this._canvas.addConnection(t,n),t},Qd.$inject=["modeling","elementRegistry"],Qd.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry;y(e.elements,function(e){n.get(e.id)&&(e.waypoints?t.removeConnection(e):t.removeShape(e))})},Jd.$inject=["canvas","modeling"],Jd.prototype.preExecute=function(e){var t=this._modeling,e=e.shape;Yd(e.incoming,function(e){t.removeConnection(e,{nested:!0})}),Yd(e.outgoing,function(e){t.removeConnection(e,{nested:!0})}),Yd(e.children,function(e){e.waypoints?t.removeConnection(e,{nested:!0}):t.removeShape(e,{nested:!0})})},Jd.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=qi(i.children,n),t.removeShape(n),n},Jd.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,e=e.oldParentIndex;return Wi(i.children,n,e),t.addShape(n,i),n},ep.$inject=["modeling"];var tp={x:"y",y:"x"};function np(e,t){this._layouter=e,this._canvas=t}function ip(){}function rp(e,t,n){var i=ya(t),r=ya(n),e=_a(e,i),i=e.x*(n.width/t.width),e=e.y*(n.height/t.height);return Dr({x:r.x+i,y:r.y+e})}function op(e,t,n){var e=lp(e),i=dp(e,t),e=e[0];return i.length?i[i.length-1]:rp(e.original||e,n,t)}function ap(e,t,n){var e=lp(e),i=dp(e,t),e=e[e.length-1];return i.length?i[0]:rp(e.original||e,n,t)}function sp(e,t,n){e=lp(e),n=up(t,n),e=e[0];return rp(e.original||e,n,t)}function cp(e,t,n){e=lp(e),n=up(t,n),e=e[e.length-1];return rp(e.original||e,n,t)}function up(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function lp(e){var t=e.waypoints;if(t.length)return t;throw new Error("connection#"+e.id+": no waypoints")}function dp(e,t){return re(ce(e,pp),function(e){return"intersect"===Mr(t,e,1)})}function pp(e){return e.original||e}function hp(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}function fp(e){this._modeling=e}function mp(e){this._helper=new fp(e)}function gp(e){this._modeling=e,this._helper=new fp(e)}function vp(e){this._modeling=e}function yp(e){return e.original||e}function _p(e,t){this._modeling=e,this._rules=t}function bp(e){this._modeling=e}function xp(e,t){return-1!==e.indexOf(t)}function wp(e){this._modeling=e}function Cp(e){return C({},e)}function Ep(e){switch(e){case"n":return"y";case"w":return"x";case"s":return"y";case"e":return"x"}}function kp(e,t,n){var i=Ep(n);return/e|s/.test(n)?e[i]>t:/n|w/.test(n)&&e[i]<t}function Sp(e,t){return-1!==e.indexOf(t)}function jp(e){this._modeling=e}function Op(e){this._modeling=e}function Pp(e,t){return Hi(e&&e.attachers,t)}function Dp(e,t,n){var i;e&&((i=e.attachers)||(e.attachers=i=[]),Wi(i,t,n))}function Rp(){}function i(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",function(){i.registerHandlers(n)})}function Tp(e){this._moddle=e}function Mp(){function t(e,t){var n,i,r,o,a=e.label||e,e=e.labelTarget||e;return t=t,i=e!==(n=a),r=n.businessObject,(o=bd(r))&&(r[o]=t),i&&(n.hidden=!t),[a,e]}this.execute=function(e){return e.oldLabel=xd(e.element),t(e.element,e.newLabel)},this.revert=function(e){return t(e.element,e.oldLabel)}}ep.prototype.preExecute=function(e){var o=this._modeling,a=e.groups,s=e.axis,c=e.dimension;function u(e,t){e.range.min=Math.min(t[s],e.range.min),e.range.max=Math.max(t[s]+t[c],e.range.max)}function l(e){return e[s]+e[c]/2}function d(e){return e.length-1}function p(e){return e.max-e.min}var h,t=a[0],f=d(a),m=a[f],g=0;y(a,function(i,e){var t,n,r;i.elements.length<2?e&&e!==a.length-1&&(u(i,i.elements[0]),g+=p(i.range)):(n=(t=pe(i.elements,s))[0],e===f&&(n=t[d(t)]),r=l(n),i.range=null,y(t,function(e){var t,n;(n={y:0})[s]=r-l(t=e),n[s]&&(n[tp[s]]=0,o.moveElements([t],n,t.parent)),null===i.range?i.range={min:e[s],max:e[s]+e[c]}:u(i,e)}),e&&e!==a.length-1&&(g+=p(i.range)))}),e=Math.abs(m.range.min-t.range.max),(h=Math.round((e-g)/(a.length-1)))<a.length-1||y(a,function(n,e){var i,r={};n!==t&&n!==m&&(i=a[e-1],n.range.max=0,y(n.elements,function(e,t){r[tp[s]]=0,r[s]=i.range.max-e[s]+h,n.range.min!==e[s]&&(r[s]+=e[s]-n.range.min),r[s]&&o.moveElements([e],r,e.parent),n.range.max=Math.max(e[s]+e[c],t?n.range.max:0)}))})},ep.prototype.postExecute=function(e){},np.$inject=["layouter","canvas"],np.prototype.execute=function(e){var t=e.connection;return C(e,{oldWaypoints:t.waypoints}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t},np.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t},ip.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldParent=o,e.oldParentIndex=Hi(o.children,t),Wi(i.children,t,r),t.parent=i,y(t.waypoints,function(e){e.x+=n.x,e.y+=n.y,e.original&&(e.original.x+=n.x,e.original.y+=n.y)}),t},ip.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,r=e.oldParentIndex,o=e.delta;return Hi(n.children,t),Wi(i.children,t,r),t.parent=i,y(t.waypoints,function(e){e.x-=o.x,e.y-=o.y,e.original&&(e.original.x-=o.x,e.original.y-=o.y)}),t},hp.prototype.add=function(e,t){return this.addAll([e],t)},hp.prototype.addAll=function(e,t){return C(this,Li(e,!!t,this)),this},fp.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]},fp.prototype.moveClosure=function(e,i,r,t,n){var o=this._modeling,a=e.allShapes,s=e.allConnections,c=e.enclosedConnections,u=e.topLevel,l=!1;n&&n.parent===r&&(l=!0),y(a,function(e){o.moveShape(e,i,u[e.id]&&!l&&r,{recurse:!1,layout:!1})}),y(s,function(e){var t=!!a[e.source.id],n=!!a[e.target.id];c[e.id]&&t&&n?o.moveConnection(e,i,u[e.id]&&!l&&r):o.layoutConnection(e,{connectionStart:t&&sp(e,e.source,i),connectionEnd:n&&cp(e,e.target,i)})})},fp.prototype.getClosure=function(e){return(new hp).addAll(e,!0)},mp.$inject=["modeling"],mp.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)},mp.prototype.postExecute=function(e){var t,n=e.hints;n&&n.primaryShape&&(t=n.primaryShape,n.oldParent=t.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,t)},gp.$inject=["modeling"],gp.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldBounds=_e(t,["x","y","width","height"]),e.oldParent=o,e.oldParentIndex=Hi(o.children,t),Wi(i.children,t,r),C(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t},gp.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,r=this._modeling;!1!==i.layout&&(y(t.incoming,function(e){r.layoutConnection(e,{connectionEnd:cp(e,t,n)})}),y(t.outgoing,function(e){r.layoutConnection(e,{connectionStart:sp(e,t,n)})})),!1!==i.recurse&&this.moveChildren(e)},gp.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,e=e.delta;return Wi(n.children,t,i),C(t,{parent:n,x:t.x-e.x,y:t.y-e.y}),t},gp.prototype.moveChildren=function(e){var t=e.delta,e=e.shape;this._helper.moveRecursive(e.children,t,null)},gp.prototype.getNewParent=function(e){return e.newParent||e.shape.parent},vp.$inject=["modeling"],vp.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,r=e.dockingOrPoints;if(t||n)return m(r)&&(e.oldWaypoints=i.waypoints,i.waypoints=r),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i;throw new Error("newSource or newTarget required")},vp.prototype.postExecute=function(e){var t=e.connection,n=e.newSource,i=e.newTarget,r=e.dockingOrPoints,e=e.hints||{},o={};e.connectionStart&&(o.connectionStart=e.connectionStart),e.connectionEnd&&(o.connectionEnd=e.connectionEnd),!1!==e.layoutConnection&&(!n||i&&"source"!==e.docking||(o.connectionStart=o.connectionStart||yp(m(r)?r[0]:r)),!i||n&&"target"!==e.docking||(o.connectionEnd=o.connectionEnd||yp(m(r)?r[r.length-1]:r)),e.newWaypoints&&(o.waypoints=e.newWaypoints),this._modeling.layoutConnection(t,o))},vp.prototype.revert=function(e){var t=e.oldSource,n=e.oldTarget,i=e.oldWaypoints,e=e.connection;return t&&(e.source=t),n&&(e.target=n),i&&(e.waypoints=i),e},_p.$inject=["modeling","rules"],_p.prototype.preExecute=function(e){var n=this,t=this._modeling,i=this._rules,r=e.oldShape,o=e.newData,a=e.hints||{};function s(e,t,n){return i.allowed("connection.reconnect",{connection:n,source:e,target:t})}var c={x:o.x,y:o.y},u={x:r.x,y:r.y,width:r.width,height:r.height},l=e.newShape=e.newShape||n.createShape(o,c,r.parent,a),o=(r.host&&t.updateAttachment(l,r.host),!1!==a.moveChildren&&(e=r.children.slice(),t.moveElements(e,{x:0,y:0},l,a)),r.incoming.slice()),c=r.outgoing.slice();y(o,function(e){s(e.source,l,e)&&n.reconnectEnd(e,l,ap(e,l,u),a)}),y(c,function(e){var t=e.target;s(l,t,e)&&n.reconnectStart(e,l,op(e,l,u),a)})},_p.prototype.postExecute=function(e){e=e.oldShape;this._modeling.removeShape(e)},_p.prototype.execute=function(e){},_p.prototype.revert=function(e){},_p.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)},_p.prototype.reconnectStart=function(e,t,n,i){this._modeling.reconnectStart(e,t,n,i)},_p.prototype.reconnectEnd=function(e,t,n,i){this._modeling.reconnectEnd(e,t,n,i)},bp.$inject=["modeling"],bp.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(void 0===n.x||void 0===n.y||void 0===n.width||void 0===n.height)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},C(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t},bp.prototype.postExecute=function(e){var t=this._modeling,n=e.shape,i=e.oldBounds;!1!==(e.hints||{}).layout&&(y(n.incoming,function(e){t.layoutConnection(e,{connectionEnd:ap(e,n,i)})}),y(n.outgoing,function(e){t.layoutConnection(e,{connectionStart:op(e,n,i)})}))},bp.prototype.revert=function(e){var t=e.shape,e=e.oldBounds;return C(t,{width:e.width,height:e.height,x:e.x,y:e.y}),t},wp.$inject=["modeling"],wp.prototype.preExecute=function(e){var i,r,o,t=e.delta,n=e.direction,a=e.movingShapes,s=e.resizingShapes,e=e.start,c={};this.moveShapes(a,t),y(s,function(e){c[e.id]={x:e.x,y:e.y,height:e.height,width:e.width}}),this.resizeShapes(s,t,n),this.updateConnectionWaypoints((r=s,o=[],y((i=a).concat(r),function(e){var t=e.incoming,e=e.outgoing;y(t.concat(e),function(e){var t=e.source,n=e.target;(xp(i,t)||xp(i,n)||xp(r,t)||xp(r,n))&&!xp(o,e)&&o.push(e)})}),o),t,n,e,a,s,c)},wp.prototype.execute=function(){},wp.prototype.revert=function(){},wp.prototype.moveShapes=function(e,t){var n=this;y(e,function(e){n._modeling.moveShape(e,t,null,{autoResize:!1,layout:!1,recurse:!1})})},wp.prototype.resizeShapes=function(e,n,i){var r=this;y(e,function(e){var t=function(e,t,n){var i=e.x,r=e.y,o=e.width,a=e.height,s=n.x,c=n.y;switch(t){case"n":return{x:i,y:r+c,width:o,height:a-c};case"s":return{x:i,y:r,width:o,height:a+c};case"w":return{x:i+s,y:r,width:o-s,height:a};case"e":return{x:i,y:r,width:o+s,height:a};default:throw new Error("unknown direction: "+t)}}(e,i,n);r._modeling.resizeShape(e,t,null,{attachSupport:!1,autoResize:!1,layout:!1})})},wp.prototype.updateConnectionWaypoints=function(e,a,s,c,u,l,d){var p=this,h=u.concat(l);y(e,function(e){var t=e.source,n=e.target,i=ce(e.waypoints,function(e){return(e=Cp(e)).original&&(e.original=Cp(e.original)),e}),r=Ep(s),o={};Sp(h,t)&&Sp(h,n)?(i=ce(i,function(e){return kp(e,c,s)&&(e[r]=e[r]+a[r]),e.original&&kp(e.original,c,s)&&(e.original[r]=e.original[r]+a[r]),e}),p._modeling.updateWaypoints(e,i,{labelBehavior:!1})):(Sp(h,t)||Sp(h,n))&&(Sp(u,t)?o.connectionStart=sp(e,t,a):Sp(u,n)?o.connectionEnd=cp(e,n,a):Sp(l,t)?o.connectionStart=op(e,t,d[t.id]):Sp(l,n)&&(o.connectionEnd=ap(e,n,d[n.id])),p._modeling.layoutConnection(e,o))})},jp.$inject=["modeling"],jp.prototype.execute=function(e){var t=e.shape,n=t.children,e=(e.oldChildrenVisibility=function t(e){var n={};y(e,function(e){n[e.id]=e.hidden,e.children&&(n=C({},n,t(e.children)))});return n}(n),t.collapsed=!t.collapsed,function t(e,n){var i=[];y(e,function(e){e.hidden=n,i=i.concat(e),e.children&&(i=i.concat(t(e.children,e.collapsed||n)))});return i}(n,t.collapsed));return[t].concat(e)},jp.prototype.revert=function(e){var t=e.shape,e=e.oldChildrenVisibility,e=function t(e,n){var i=[];y(e,function(e){e.hidden=n[e.id],i=i.concat(e),e.children&&(i=i.concat(t(e.children,n)))});return i}(t.children,e);return t.collapsed=!t.collapsed,[t].concat(e)},Op.$inject=["modeling"],Op.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=Pp(i,t),Dp(n,t),t.host=n,t},Op.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,e=e.attacherIdx;return t.host=i,Pp(n,t),Dp(i,t,e),t},Rp.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t},Rp.prototype.revert=function(e){var t=e.connection,e=e.oldWaypoints;return t.waypoints=e,t},i.$inject=["eventBus","elementFactory","commandStack"],i.prototype.getHandlers=function(){return{"shape.append":$d,"shape.create":qd,"shape.delete":Jd,"shape.move":gp,"shape.resize":bp,"shape.replace":_p,"shape.toggleCollapse":jp,spaceTool:wp,"label.create":Gd,"connection.create":zd,"connection.delete":Zd,"connection.move":ip,"connection.layout":np,"connection.updateWaypoints":Rp,"connection.reconnect":vp,"elements.create":Ud,"elements.move":mp,"elements.delete":Qd,"elements.distribute":ep,"elements.align":Vd,"element.updateAttachment":Op}},i.prototype.registerHandlers=function(n){y(this.getHandlers(),function(e,t){n.registerHandler(t,e)})},i.prototype.moveShape=function(e,t,n,i,r){"object"===Fe(i)&&(r=i,i=null),this._commandStack.execute("shape.move",{shape:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}})},i.prototype.updateAttachment=function(e,t){this._commandStack.execute("element.updateAttachment",{shape:e,newHost:t})},i.prototype.moveElements=function(e,t,n,i){var r,o=(i=i||{}).attach,a=n;!0===o?a=(r=n).parent:!1===o&&(r=null),this._commandStack.execute("elements.move",{shapes:e,delta:t,newParent:a,newHost:r,hints:i})},i.prototype.moveConnection=function(e,t,n,i,r){"object"===Fe(i)&&(r=i,i=void 0),this._commandStack.execute("connection.move",{connection:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}})},i.prototype.layoutConnection=function(e,t){this._commandStack.execute("connection.layout",{connection:e,hints:t||{}})},i.prototype.createConnection=function(e,t,n,i,r,o){"object"===Fe(n)&&(o=r,r=i,i=n,n=void 0);e={source:e,target:t,parent:r,parentIndex:n,connection:i=this._create("connection",i),hints:o};return this._commandStack.execute("connection.create",e),e.connection},i.prototype.createShape=function(e,t,n,i,r){"number"!=typeof i&&(r=i,i=void 0);var o,a,s=(r=r||{}).attach,s=(e=this._create("shape",e),s?(o=n.parent,a=n):o=n,{position:t,shape:e,parent:o,parentIndex:i,host:a,hints:r});return this._commandStack.execute("shape.create",s),s.shape},i.prototype.createElements=function(e,t,n,i,r){"number"!=typeof i&&(r=i,i=void 0);t={position:t,elements:e=m(e)?e:[e],parent:n,parentIndex:i,hints:r=r||{}};return this._commandStack.execute("elements.create",t),t.elements},i.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);t={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",t),t.shape},i.prototype.appendShape=function(e,t,n,i,r){r=r||{};e={source:e,position:n,target:i,shape:t=this._create("shape",t),connection:r.connection,connectionParent:r.connectionParent,hints:r};return this._commandStack.execute("shape.append",e),e.shape},i.prototype.removeElements=function(e){this._commandStack.execute("elements.delete",{elements:e})},i.prototype.distributeElements=function(e,t,n){this._commandStack.execute("elements.distribute",{groups:e,axis:t,dimension:n})},i.prototype.removeShape=function(e,t){this._commandStack.execute("shape.delete",{shape:e,hints:t||{}})},i.prototype.removeConnection=function(e,t){this._commandStack.execute("connection.delete",{connection:e,hints:t||{}})},i.prototype.replaceShape=function(e,t,n){e={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",e),e.newShape},i.prototype.alignElements=function(e,t){this._commandStack.execute("elements.align",{elements:e,alignment:t})},i.prototype.resizeShape=function(e,t,n,i){this._commandStack.execute("shape.resize",{shape:e,newBounds:t,minBounds:n,hints:i})},i.prototype.createSpace=function(e,t,n,i,r){this._commandStack.execute("spaceTool",{delta:n,direction:i,movingShapes:e,resizingShapes:t,start:r})},i.prototype.updateWaypoints=function(e,t,n){this._commandStack.execute("connection.updateWaypoints",{connection:e,newWaypoints:t,hints:n||{}})},i.prototype.reconnect=function(e,t,n,i,r){this._commandStack.execute("connection.reconnect",{connection:e,newSource:t,newTarget:n,dockingOrPoints:i,hints:r||{}})},i.prototype.reconnectStart=function(e,t,n,i){this.reconnect(e,t,e.target,n,C(i=i||{},{docking:"source"}))},i.prototype.reconnectEnd=function(e,t,n,i){this.reconnect(e,e.source,t,n,C(i=i||{},{docking:"target"}))},i.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)},i.prototype._create=function(e,t){return t instanceof Zr?t:this._elementFactory.create(e,t)},i.prototype.toggleCollapse=function(e,t){this._commandStack.execute("shape.toggleCollapse",{shape:e,hints:t||{}})},Tp.$inject=["moddle"],Tp.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element;e.claiming?t.claim(n,i):t.unclaim(n)},Tp.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element;e.claiming?t.unclaim(n):t.claim(n,i)};var Ip="id";function Ap(e,t){this._elementRegistry=e,this._moddle=t}function Np(e,t){return Ip in e&&e.id!==t.id}function Bp(n,e){y(e,function(e,t){n.set(t,e)})}function Lp(e,t,n){this._canvas=e,this._drdRules=t,n.invoke(i,this)}function Vp(){}Ap.$inject=["elementRegistry","moddle"],Ap.prototype.execute=function(e){var t,n,i,r,o,a,s=e.element,c=[s];if(s)return t=this._elementRegistry,n=this._moddle.ids,i=s.businessObject,r=e.properties,o=e.oldProperties||(a=i,oe(ue(r),function(e,t){return e[t]=a.get(t),e},{})),Np(r,i)&&(n.unclaim(i.id),t.updateId(s,r.id),n.claim(r.id,i)),"name"in r&&s.label&&c.push(s.label),Bp(i,r),e.oldProperties=o,e.changed=c;throw new Error("element required")},Ap.prototype.revert=function(e){var t=e.element,n=e.properties,i=e.oldProperties,r=t.businessObject,o=this._elementRegistry,a=this._moddle.ids;return Bp(r,i),Np(n,r)&&(a.unclaim(n.id),o.updateId(t,i.id),a.claim(i.id,r)),e.changed},Yn(Lp,i),Lp.$inject=["canvas","drdRules","injector"],Lp.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})},Lp.prototype.connect=function(e,t,n,i){var r=this._drdRules,o=this._canvas.getRootElement();return n=n||r.canConnect(e,t)||{type:"dmn:Association"},this.createConnection(e,t,n,o,i)},Lp.prototype.getHandlers=function(){var e=i.prototype.getHandlers.call(this);return e["id.updateClaim"]=Tp,e["element.updateLabel"]=Mp,e["element.updateProperties"]=Ap,e},Lp.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})},Lp.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})},Lp.prototype.updateLabel=function(e,t,n,i){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:n,hints:i||{}})},Vp.prototype.layoutConnection=function(e,t){return[(t=t||{}).connectionStart||D(t.source||e.source),t.connectionEnd||D(t.target||e.target)]};function $p(e){this._connectionDocking=e}function zp(e,t){return e?e.original||e:D(t)}function Fp(e){return C({original:e.point.original||e.point},e.actual)}function Up(e,t){this._elementRegistry=e,this._graphicsFactory=t}Yn($p,Vp),$p.$inject=["connectionDocking"],$p.prototype.layoutConnection=function(e,t){var n=this._connectionDocking,i=(t=t||{}).source||e.source,r=t.target||e.target,o=t.waypoints||e.waypoints||[],a=t.connectionStart,t=t.connectionEnd,s=Mr(i,r),a=a||zp(o[0],i);return t=t||zp(o[o.length-1],r),k(e,"dmn:InformationRequirement")?(e={x:(t=(n=n.getCroppedWaypoints(C({},e,{waypoints:o=[a,t]}),i,r)).pop()).x,y:t.y},s.includes("bottom")?e.y+=20:s.includes("top")?e.y-=20:s.includes("right")?e.x+=20:e.x-=20,n.concat([e,t])):[a,t]},Up.$inject=["elementRegistry","graphicsFactory"],Up.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;t=this.getDockingPoint(e,t,!0),n=this.getDockingPoint(e,n),e=e.waypoints.slice(t.idx+1,n.idx);return e.unshift(Fp(t)),e.push(Fp(n)),e},Up.prototype.getDockingPoint=function(e,t,n){var i=e.waypoints,r=n?0:i.length-1,i=i[r];return{point:i,actual:this._getIntersection(t,e,n)||i,idx:r}},Up.prototype._getIntersection=function(e,t,n){return Ir(this._getShapePath(e),this._getConnectionPath(t),n)},Up.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)},Up.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)},Up.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};var Pd={__init__:["modeling","drdUpdater"],__depends__:[Pd,Nd,aa,ld,Yo,pd],drdFactory:["type",Bd],drdUpdater:["type",Ld],elementFactory:["type",os],modeling:["type",Lp],layouter:["type",$p],connectionDocking:["type",Up]},Hp=Math.round;function Wp(e,o,a,s,r){function c(e,t,n,i){return r.allowed("elements.move",{shapes:e,delta:t,position:n,target:i})}function n(e,t,n,i){var r;if((ee(n)&&(i=n,n=!1),!t.waypoints&&t.parent)&&!j(e.target).has("djs-hit-no-move"))return r={x:(r=t).x+Hp(r.width/2),y:r.y+Hp(r.height/2)},o.init(e,r,"shape.move",{cursor:"grabbing",autoActivate:n,data:{shape:t,context:i||{}}}),!0}e.on("shape.move.start",1500,function(e){var t,n,i=e.context,e=e.shape,r=s.get().slice();-1===r.indexOf(e)&&(r=[e]),n=de(t=r,"id"),C(i,{shapes:r=re(t,function(e){for(;e=e.parent;)if(n[e.id])return;return 1}),validatedShapes:r,shape:e})}),e.on("shape.move.start",1250,function(e){var e=e.context,t=e.validatedShapes;if(!(e.canExecute=c(t)))return!1}),e.on("shape.move.move",500,function(e){var t=e.context,n=t.validatedShapes,i=e.hover,r={x:e.dx,y:e.dy},n=c(n,r,{x:e.x,y:e.y},i);t.delta=r,null===(t.canExecute=n)?t.target=null:t.target=i}),e.on("shape.move.end",function(e){var e=e.context,t=e.delta,n=e.canExecute,i="attach"===n,r=e.shapes;if(!1===n)return!1;t.x=Hp(t.x),t.y=Hp(t.y),0===t.x&&0===t.y||a.moveElements(r,t,e.target,{primaryShape:e.shape,attach:i})}),e.on("element.mousedown",function(e){if(Bo(e)){var t=Mo(e);if(t)return n(t,e.element);throw new Error("must supply DOM mousedown event")}}),this.start=n}Wp.$inject=["eventBus","dragging","modeling","selection","rules"];var qp="djs-dragging",Gp="drop-ok",Kp="drop-not-ok",Xp="new-parent",Yp="attach-ok";function Zp(e,o,a,s){function c(e){var t,e=u(e);return re(t=e,function(e){return!e.waypoints||ie(t,he({id:e.source.id}))&&ie(t,he({id:e.target.id}))})}function u(e){var e=Bi(e,!0),t=ce(e,function(e){return(e.incoming||[]).concat(e.outgoing||[])});return K(e.concat(t))}function l(t,n){[Yp,Gp,Kp,Xp].forEach(function(e){e===n?o.addMarker(t,e):o.removeMarker(t,e)})}e.on("shape.move.start",499,function(e){var t,n=e.context,e=n.shapes,i=n.allDraggedElements,r=c(e);n.dragGroup||(S(t=O("g"),a.cls("djs-drag-group",["no-events"])),w(o.getActiveLayer(),t),n.dragGroup=t),r.forEach(function(e){s.addDragger(e,n.dragGroup)}),y(i=i?K([i,u(e)]):u(e),function(e){o.addMarker(e,qp)}),n.allDraggedElements=i,n.differentParents=1!==function(e){return ue(e).length}(de(e,function(e){return e.parent&&e.parent.id}))}),e.on("shape.move.move",499,function(e){var t=e.context,n=t.dragGroup,i=t.target,r=t.shape.parent,o=t.canExecute;i&&("attach"===o?l(i,Yp):t.canExecute&&i&&i.id!==r.id?l(i,Xp):l(i,t.canExecute?Gp:Kp)),oo(n,e.dx,e.dy)}),e.on(["shape.move.out","shape.move.cleanup"],function(e){e=e.context.target;e&&l(e,null)}),e.on("shape.move.cleanup",function(e){var e=e.context,t=e.allDraggedElements,e=e.dragGroup;y(t,function(e){o.removeMarker(e,qp)}),e&&hi(e)}),this.makeDraggable=function(e,t,n){s.addDragger(t,e.dragGroup),n&&o.addMarker(t,qp),e.allDraggedElements?e.allDraggedElements.push(t):e.allDraggedElements=[t]}}Zp.$inject=["eventBus","canvas","styles","previewSupport"];var Nd={__depends__:[e,Yo,Ho,Ps,ca,Tc],__init__:["move","movePreview"],move:["type",Wp],movePreview:["type",Zp]},Qp=".djs-palette-toggle",Jp="djs-palette-",eh="open",th="two-column";function nh(e,t){this._eventBus=e,this._canvas=t;var n=this;e.on("tool-manager.update",function(e){e=e.tool;n.updateToolHighlight(e)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._rebuild()})}function ih(n,e){e=e.getPaletteEntries();return te(e)?e(n):(y(e,function(e,t){n[t]=e}),n)}nh.$inject=["eventBus","canvas"],nh.prototype.registerProvider=function(e,t){t||(t=e,e=1e3),this._eventBus.on("palette.getProviders",e,function(e){e.providers.push(t)}),this._rebuild()},nh.prototype.getEntries=function(){return this._getProviders().reduce(ih,{})},nh.prototype._rebuild=function(){this._diagramInitialized&&this._getProviders().length&&(this._container||this._init(),this._update())},nh.prototype._init=function(){var t=this,e=this._eventBus,n=this._getParentContainer(),i=this._container=_(nh.HTML_MARKUP);n.appendChild(i),v(n).add(Jp+"shown"),Pn.bind(i,".djs-palette-toggle, .entry","click",function(e){if(wn(e.delegateTarget,Qp))return t.toggle();t.trigger("click",e)}),E.bind(i,"mousedown",function(e){e.stopPropagation()}),Pn.bind(i,".entry","dragstart",function(e){t.trigger("dragstart",e)}),e.on("canvas.resized",this._layoutChanged,this),e.fire("palette.create",{container:i})},nh.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(t),t.providers},nh.prototype._toggleState=function(e){e=e||{};var t=this._getParentContainer(),n=this._container,i=this._eventBus,n=v(n),r=v(t),t="twoColumn"in e?e.twoColumn:this._needsCollapse(t.clientHeight,this._entries||{});n.toggle(th,t),r.toggle(Jp+th,t),"open"in e&&(n.toggle(eh,e.open),r.toggle(Jp+eh,e.open)),i.fire("palette.changed",{twoColumn:t,open:this.isOpen()})},nh.prototype._update=function(){var o=b(".djs-palette-entries",this._container),e=this._entries=this.getEntries();xn(o),y(e,function(e,t){var n,i=e.group||"default",r=b("[data-group="+Us(i)+"]",o),i=(r||(yn(r=_('<div class="group"></div>'),"data-group",i),o.appendChild(r)),e.html||(e.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>')),i=_(i);r.appendChild(i),e.separator||(yn(i,"data-action",t),e.title&&yn(i,"title",e.title),e.className&&(r=e.className,n=v(i),(m(r)?r:r.split(/\s+/g)).forEach(function(e){n.add(e)})),e.imageUrl&&(yn(t=_("<img>"),"src",e.imageUrl),i.appendChild(t)))}),this.open()},nh.prototype.trigger=function(e,t,n){var i=this._entries,r=t.delegateTarget||t.target;if(!r)return t.preventDefault();(i=i[yn(r,"data-action")])&&(r=i.action,i=t.originalEvent||t,te(r)?"click"===e&&r(i,n):r[e]&&r[e](i,n),t.preventDefault())},nh.prototype._layoutChanged=function(){this._toggleState({})},nh.prototype._needsCollapse=function(e,t){return e<50+46*Object.keys(t).length},nh.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})},nh.prototype.open=function(){this._toggleState({open:!0})},nh.prototype.toggle=function(e){this.isOpen()?this.close():this.open()},nh.prototype.isActiveTool=function(e){return e&&this._activeTool===e},nh.prototype.updateToolHighlight=function(n){var e;this._toolsContainer||(e=b(".djs-palette-entries",this._container),this._toolsContainer=b("[data-group=tools]",e)),y(this._toolsContainer.children,function(e){var t=e.getAttribute("data-action");t&&(e=v(e),t=t.replace("-tool",""),e.contains("entry")&&t===n?e.add("highlighted-entry"):e.remove("highlighted-entry"))})},nh.prototype.isOpen=function(){return v(this._container).has(eh)},nh.prototype._getParentContainer=function(){return this._canvas.getContainer()},nh.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';aa={__init__:["palette"],palette:["type",nh]};function rh(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}rh.$inject=["eventBus","dragging"],rh.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error('A tool has to be registered with it\'s "events"');n.push(e),this.bindEvents(e,t)},rh.prototype.isActive=function(e){return e&&this._active===e},rh.prototype.length=function(e){return this._tools.length},rh.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))},rh.prototype.bindEvents=function(t,e){var n=this._eventBus,i=this._dragging,r=[];n.on(e.tool+".init",function(e){!e.context.reactivate&&this.isActive(t)?(this.setActive(null),i.cancel()):this.setActive(t)},this),y(e,function(e){r.push(e+".ended"),r.push(e+".canceled")}),n.on(r,250,function(e){this._active&&!function(e){e=e.originalEvent&&e.originalEvent.target;return e&&Cn(e,'.group[data-group="tools"]')}(e)&&this.setActive(null)},this)};pd={__depends__:[ca],__init__:["toolManager"],toolManager:["type",rh]};function oh(e){var t=this;function n(e){t._lastMoveEvent=e}this._lastMoveEvent=null,e.on("canvas.init",function(e){(t._svg=e.svg).addEventListener("mousemove",n)}),e.on("canvas.destroy",function(){t._lastMouseEvent=null,t._svg.removeEventListener("mousemove",n)})}oh.$inject=["eventBus"],oh.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||function(e,t){var n=document.createEvent("MouseEvent"),i=e,r=t;n.initMouseEvent&&n.initMouseEvent("mousemove",!0,!0,window,0,i,r,e,t,!1,!1,!1,!1,0,null);return n}(0,0)};var e={__init__:["mouse"],mouse:["type",oh]},ah="crosshair";function sh(n,i,e,r,t,o,a){this._selection=t,this._dragging=e,this._mouse=a;var s=this,c=function(e){var t=i.getActiveLayer(),e=e.frame=O("rect");S(e,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),w(t,e)},u=function(e){var t=e.frame,e=e.bbox;S(t,{x:e.x,y:e.y,width:e.width,height:e.height})},l=function(e){e.frame&&hi(e.frame)};o.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),n.on("lasso.selection.end",function(e){var t=e.originalEvent.target;(e.hover||t instanceof SVGElement)&&n.once("lasso.selection.ended",function(){s.activateLasso(e.originalEvent,!0)})}),n.on("lasso.end",function(e){var e=ch(e),t=r.filter(function(e){return e});s.select(t,e)}),n.on("lasso.start",function(e){var t=e.context;t.bbox=ch(e),c(t)}),n.on("lasso.move",function(e){var t=e.context;t.bbox=ch(e),u(t)}),n.on("lasso.cleanup",function(e){e=e.context;l(e)}),n.on("element.mousedown",1500,function(e){if(Vo(e))return s.activateLasso(e.originalEvent),!0})}function ch(e){var t={x:e.x-e.dx,y:e.y-e.dy},e={x:e.x,y:e.y},t=t.x<=e.x&&t.y<e.y||t.x<e.x&&t.y<=e.y?{x:t.x,y:t.y,width:e.x-t.x,height:e.y-t.y}:e.x<=t.x&&t.y<e.y||e.x<t.x&&t.y<=e.y?{x:e.x,y:t.y,width:t.x-e.x,height:e.y-t.y}:t.x<=e.x&&e.y<t.y||t.x<e.x&&e.y<=t.y?{x:t.x,y:e.y,width:e.x-t.x,height:t.y-e.y}:e.x<=t.x&&e.y<t.y||e.x<t.x&&e.y<=t.y?{x:e.x,y:e.y,width:t.x-e.x,height:t.y-e.y}:{x:e.x,y:e.y,width:0,height:0};return t}sh.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager","mouse"],sh.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:ah,data:{context:{}}})},sh.prototype.activateSelection=function(e,t){this._dragging.init(e,"lasso.selection",{trapClick:!1,autoActivate:t,cursor:ah,data:{context:{}}})},sh.prototype.select=function(e,t){n=t,i={},y(e,function(e){var t=e;t.waypoints&&(t=Vi(t)),!g(n.y)&&t.x>n.x&&(i[e.id]=e),!g(n.x)&&t.y>n.y&&(i[e.id]=e),t.x>n.x&&t.y>n.y&&(!(g(n.width)&&g(n.height)&&t.width+t.x<n.width+n.x&&t.height+t.y<n.height+n.y)&&g(n.width)&&g(n.height)||(i[e.id]=e))});var n,i,t=i;this._selection.select(le(t))},sh.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)},sh.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};Yo={__depends__:[pd,e],__init__:["lassoTool"],lassoTool:["type",sh]};function uh(n,i,e,t,r,o){this._dragging=e,this._mouse=o;var a=this,e=t.get("keyboard",!1);r.registerTool("hand",{tool:"hand",dragging:"hand.move"}),n.on("element.mousedown",1500,function(e){if(Lo(e))return a.activateMove(e.originalEvent,!0),!1}),e&&e.addListener(1500,function(e){lh(e.keyEvent)&&!a.isActive()&&(e=a._mouse.getLastMoveEvent(),a.activateMove(e,!!e))},"keyboard.keydown"),e&&e.addListener(1500,function(e){lh(e.keyEvent)&&a.isActive()&&a.toggle()},"keyboard.keyup"),n.on("hand.end",function(e){var t=e.originalEvent.target;if(!(e.hover||t instanceof SVGElement))return!1;n.once("hand.ended",function(){a.activateMove(e.originalEvent,{reactivate:!0})})}),n.on("hand.move.move",function(e){var t=i.viewbox().scale;i.scroll({dx:e.dx*t,dy:e.dy*t})}),n.on("hand.move.end",function(e){var t=e.context.reactivate;return!Lo(e)&&t&&n.once("hand.move.ended",function(e){a.activateHand(e.originalEvent,!0,!0)}),!1})}function lh(e){return bs("Space",e)}uh.$inject=["eventBus","canvas","dragging","injector","toolManager","mouse"],uh.prototype.activateMove=function(e,t,n){"object"===Fe(t)&&(n=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:"grab",data:{context:n||{}}})},uh.prototype.activateHand=function(e,t,n){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:"grab",data:{context:{reactivate:n}}})},uh.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateHand(e,!!e)},uh.prototype.isActive=function(){var e=this._dragging.context();return!!e&&/^(hand|hand\.move)$/.test(e.prefix)};Ho={__depends__:[pd,e],__init__:["handTool"],handTool:["type",uh]};function dh(e,t,n,i,r,o){this._palette=e,this._create=t,this._elementFactory=n,this._handTool=i,this._lassoTool=r,this._translate=o,e.registerProvider(this)}dh.$inject=["palette","create","elementFactory","handTool","lassoTool","translate"],dh.prototype.getPaletteEntries=function(e){var t={},a=this._create,s=this._elementFactory,n=this._handTool,i=this._lassoTool,r=this._translate;function o(n,e,t,i,r){function o(e){var t=s.createShape(C({type:n},r));a.start(e,t)}return{group:e,className:t,title:i,action:{dragstart:o,click:o}}}return C(t,{"hand-tool":{group:"tools",className:"dmn-icon-hand-tool",title:r("Activate the hand tool"),action:{click:function(e){n.activateHand(e)}}},"lasso-tool":{group:"tools",className:"dmn-icon-lasso-tool",title:r("Activate the lasso tool"),action:{click:function(e){i.activateSelection(e)}}},"tool-separator":{group:"tools",separator:!0},"create.decision":o("dmn:Decision","drd","dmn-icon-decision",r("Create Decision")),"create.input-data":o("dmn:InputData","drd","dmn-icon-input-data",r("Create Input Data")),"create.knowledge-source":o("dmn:KnowledgeSource","drd","dmn-icon-knowledge-source",r("Create Knowledge Source")),"create.business-knowledge-model":o("dmn:BusinessKnowledgeModel","drd","dmn-icon-business-knowledge",r("Create Knowledge Model"))}),t};var pd={__depends__:[Ro,aa,Wc,Yo,Ho],__init__:["paletteProvider"],paletteProvider:["type",dh]},ph=Math.max,hh=Math.min,fh=20;function mh(e,t,n){var t=t[e],i=n.min&&n.min[e],n=n.max&&n.max[e];return g(i)&&(t=(/top|left/.test(e)?hh:ph)(t,i)),t=g(n)?(/top|left/.test(e)?ph:hh)(t,n):t}function gh(e){return void 0!==e?e:fh}function vh(e){return!e.waypoints&&"label"!==e.type}function yh(e,t){var n,i,r,o,e=void 0===e.length?re(e.children,vh):e;if(e.length)return e=Vi(e),"object"===Fe(t=t)?(n=gh(t.left),i=gh(t.right),r=gh(t.top),o=gh(t.bottom)):n=i=r=o=gh(t),{x:e.x-n,y:e.y-r,width:e.width+n+i,height:e.height+r+o}}function _h(e,t,r,n){this._dragging=n,this._rules=t;var s=this;function i(e,t){var n,i,r=e.shape,o=e.direction,a=e.resizeConstraints;e.delta=t,r=r,o=o,i=(t=t).x,t=t.y,n={x:r.x,y:r.y,width:r.width,height:r.height},-1!==o.indexOf("n")?(n.y=r.y+t,n.height=r.height-t):-1!==o.indexOf("s")&&(n.height=r.height+t),-1!==o.indexOf("e")?n.width=r.width+i:-1!==o.indexOf("w")&&(n.x=r.x+i,n.width=r.width-i),t=n,e.newBounds=(o=t,(r=a)?Rr({top:mh("top",i=P(o),r),right:mh("right",i,r),bottom:mh("bottom",i,r),left:mh("left",i,r)}):o),e.canExecute=s.canResize(e)}function o(e){var t,n=e.shape,i=e.canExecute,e=e.newBounds;i&&(i=e,e={x:Math.round(i.x),y:Math.round(i.y),width:Math.round(i.width),height:Math.round(i.height)},i=e,(t=n).x===i.x&&t.y===i.y&&t.width===i.width&&t.height===i.height||r.resizeShape(n,e))}e.on("resize.start",function(e){var t,n;e=e.context,t=e.resizeConstraints,n=e.minBounds,void 0===t&&(void 0===n&&(n=s.computeMinResizeBox(e)),e.resizeConstraints={min:P(n)})}),e.on("resize.move",function(e){var t={x:e.dx,y:e.dy};i(e.context,t)}),e.on("resize.end",function(e){o(e.context)})}function bh(e,t){var n=D(e),e=P(e),n={x:n.x,y:n.y};return-1!==t.indexOf("n")?n.y=e.top:-1!==t.indexOf("s")&&(n.y=e.bottom),-1!==t.indexOf("e")?n.x=e.right:-1!==t.indexOf("w")&&(n.x=e.left),n}_h.prototype.canResize=function(e){var t=this._rules,e=_e(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",e)},_h.prototype.activate=function(e,t,n){var i,r=this._dragging,n=C({shape:t},n="string"==typeof n?{direction:n}:n);if(!(i=n.direction))throw new Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");r.init(e,bh(t,i),"resize",{autoActivate:!0,cursor:(r="resize-","n"===(e=i)||"s"===e?r+"ns":"e"===e||"w"===e?r+"ew":"nw"===e||"se"===e?r+"nwse":r+"nesw"),data:{shape:t,context:n}})},_h.prototype.computeMinResizeBox=function(e){var t=e.shape,n=e.direction,i=e.minDimensions||{width:10,height:10},e=yh(t,e.childrenBoxPadding);return n=n,i=i,e=e,t=P(t=t),n={top:/n/.test(n)?t.bottom-i.height:t.top,left:/w/.test(n)?t.right-i.width:t.left,bottom:/s/.test(n)?t.top+i.height:t.bottom,right:/e/.test(n)?t.left+i.width:t.right},i=e?P(e):n,Rr({top:hh(n.top,i.top),left:hh(n.left,i.left),bottom:ph(n.bottom,i.bottom),right:ph(n.right,i.right)})},_h.$inject=["eventBus","rules","modeling","dragging"];var xh="djs-resizing",wh="resize-not-ok";function Ch(e,r,o){e.on("resize.move",500,function(e){var t,n,i;e=e.context,t=e.shape,n=e.newBounds,(i=e.frame)||(i=e.frame=o.addFrame(t,r.getActiveLayer()),r.addMarker(t,xh)),5<n.width&&S(i,{x:n.x,width:n.width}),5<n.height&&S(i,{y:n.y,height:n.height}),e.canExecute?j(i).remove(wh):j(i).add(wh)}),e.on("resize.cleanup",function(e){var t;e=e.context,t=e.shape,e.frame&&hi(e.frame),r.removeMarker(t,xh)})}Ch.$inject=["eventBus","canvas","previewSupport"];var Eh="djs-resizer",kh=["n","w","s","e","nw","ne","se","sw"];function Sh(e,t,n,i){this._resize=i,this._canvas=t;var r=this;e.on("selection.changed",function(e){e=e.newSelection;r.removeResizers(),1===e.length&&y(e,ye(r.addResizer,r))}),e.on("shape.changed",function(e){e=e.element;n.isSelected(e)&&(r.removeResizers(),r.addResizer(e))})}Sh.prototype.makeDraggable=function(t,e,n){var i=this._resize;function r(e){Bo(e)&&i.activate(e,t,n)}E.bind(e,"mousedown",r),E.bind(e,"touchstart",r)},Sh.prototype._createResizer=function(e,t,n,i){var r,o,a=this._getResizersParent(),s=function(e){var t={x:0,y:0};-1!==e.indexOf("e")?t.x=6:-1!==e.indexOf("w")&&(t.x=-6);-1!==e.indexOf("s")?t.y=6:-1!==e.indexOf("n")&&(t.y=-6);return t}(i),c=O("g"),e=(j(c).add(Eh),j(c).add(Eh+"-"+e.id),j(c).add(Eh+"-"+i),w(a,c),O("rect")),i=(S(e,{x:-4+s.x,y:-4+s.y,width:8,height:8}),j(e).add(Eh+"-visual"),w(c,e),O("rect"));return S(i,{x:-10+s.x,y:-10+s.y,width:20,height:20}),j(i).add(Eh+"-hit"),w(c,i),a=c,e=t,s=n,(i=wi()).setTranslate(e,s),(e=wi()).setRotate(r||0,0,0),(s=wi()).setScale(o||1,o||1),Di(a,[i,e,s]),c},Sh.prototype.createResizer=function(e,t){var n=bh(e,t),n=this._createResizer(e,n.x,n.y,t);this.makeDraggable(e,n,t)},Sh.prototype.addResizer=function(t){var n=this;!t.waypoints&&this._resize.canResize({shape:t})&&y(kh,function(e){n.createResizer(t,e)})},Sh.prototype.removeResizers=function(){fi(this._getResizersParent())},Sh.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")},Sh.$inject=["eventBus","canvas","selection","resize"];e={__depends__:[Ps,ca,Tc],__init__:["resize","resizePreview","resizeHandles"],resize:["type",_h],resizePreview:["type",Ch],resizeHandles:["type",Sh]};function jh(e){e.on(["bendpoint.move.move","bendpoint.move.end"],2e3,function(e){var t,n,i,r=e.context,o=r.allowed,a=r.hover,s=r.source,c=r.target,u=r.type;r.hints||(r.hints={}),delete r.hints.connectionStart,delete r.hints.connectionEnd,o&&"dmn:InformationRequirement"!==o.type||a&&Kn(a,["dmn:Decision","dmn:InputData"])&&s!==c&&(o="reconnectStart"===u||"reconnectEnd"===u,u=Mr(s,c),o&&a===s?(n=u,n=Oh((t=e).context.source,n),i=t.x-n.x,n=t.y-n.y,t.x-=i,t.y-=n,t.dx-=i,t.dy-=n,r.hints.connectionEnd=Ph(c,u)):o&&a===c&&(r.hints.connectionStart=Oh(s,u),i=u,n=Ph((t=e).context.target,i),a=o=0,i.includes("top")||i.includes("bottom")?a=t.y-n.y:o=t.x-n.x,t.x-=o,t.y-=a,t.dx-=o,t.dy-=a))})}function Oh(e,t){var n=P(e),e=D(e);return t.includes("bottom")?e.y=n.top:t.includes("top")?e.y=n.bottom:t.includes("right")?e.x=n.left:e.x=n.right,e}function Ph(e,t){var n=P(e),e=D(e);return t.includes("bottom")?e.y=n.bottom:t.includes("top")?e.y=n.top:t.includes("right")?e.x=n.right:e.x=n.left,e}jh.$inject=["eventBus"];function Dh(e){e.on(["connect.hover","connect.move","connect.end"],250,function(e){var t=e.context,n=t.canExecute,i=t.hover,r=t.source,o=t.target;n&&"dmn:InformationRequirement"===n.type?(n=Mr(r,o),t.connectionStart=D(r),t.connectionEnd=i===r?D(o):{x:e.x,y:e.y},n.includes("bottom")?(t.connectionStart.y=P(r).top,t.connectionEnd.y=P(o).bottom):n.includes("top")?(t.connectionStart.y=P(r).bottom,t.connectionEnd.y=P(o).top):n.includes("right")?(t.connectionStart.x=P(r).left,t.connectionEnd.x=P(o).right):(t.connectionStart.x=P(r).right,t.connectionEnd.x=P(o).left)):(delete t.connectionStart,delete t.connectionEnd)})}function Rh(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}function Th(e){this._snapValues={}}Dh.$inject=["eventBus"],Rh.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]},Rh.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,-1===this._snapLocations.indexOf(e)&&this._snapLocations.push(e)},Rh.prototype.addDefaultSnap=function(e,t){(this._defaultSnaps[e]||(this._defaultSnaps[e]=[])).push(t)},Rh.prototype.getSnapLocations=function(){return this._snapLocations},Rh.prototype.setSnapLocations=function(e){this._snapLocations=e},Rh.prototype.pointsForTarget=function(e){var e=e.id||e,t=this._targets[e];return t||(t=this._targets[e]=new Th).initDefaults(this._defaultSnaps),t},Th.prototype.add=function(e,t){var n=this._snapValues[e];-1===(n=n||(this._snapValues[e]={x:[],y:[]})).x.indexOf(t.x)&&n.x.push(t.x),-1===n.y.indexOf(t.y)&&n.y.push(t.y)},Th.prototype.snap=function(e,t,n,i){t=this._snapValues[t];return t&&function(e,t,n){var i,r;for(n=void 0===n?10:n,i=0;i<t.length;i++)if(r=t[i],dc(r-e)<=n)return r}(e[n],t[n],i)},Th.prototype.initDefaults=function(e){var n=this;y(e||{},function(e,t){y(e,function(e){n.add(t,e)})})};function Mh(e,t,r){var o=this;this._elementRegistry=e,t.on(["create.start","shape.move.start"],function(e){o.initSnap(e)}),t.on(["create.move","create.end","shape.move.move","shape.move.end"],1250,function(e){var t=e.context,n=t.shape,i=t.snapContext,t=t.target;e.originalEvent&&_s(e.originalEvent)||!fc(e)&&t&&((i=i.pointsForTarget(t)).initialized||((i=o.addSnapTargetPoints(i,n,t)).initialized=!0),r.snap(e,i))}),t.on(["create.cleanup","shape.move.cleanup"],function(){r.hide()})}function Ih(e){return e.labelTarget}Mh.$inject=["elementRegistry","eventBus","snapping"],Mh.prototype.initSnap=function(e){var t=this._elementRegistry,n=e.context,i=n.shape,r=(r=n.snapContext)||(n.snapContext=new Rh),n=t.get(i.id)?hc(i,e):{x:e.x+hc(i).x,y:e.y+hc(i).y},t=n.x-i.width/2,o=n.y-i.height/2,a=n.x+i.width/2,s=n.y+i.height/2;return r.setSnapOrigin("mid",{x:n.x-e.x,y:n.y-e.y}),Ih(i)||(r.setSnapOrigin("top-left",{x:t-e.x,y:o-e.y}),r.setSnapOrigin("bottom-right",{x:a-e.x,y:s-e.y})),r},Mh.prototype.addSnapTargetPoints=function(t,n,e){return y(this.getSnapTargets(n,e),function(e){if(!Ih(e))return e.waypoints?e.waypoints.length<3?void 0:void y(e.waypoints.slice(1,-1),function(e){t.add("mid",e)}):void t.add("mid",hc(e));Ih(n)&&t.add("mid",hc(e))}),g(n.x)&&g(n.y)&&this._elementRegistry.get(n.id)&&t.add("mid",hc(n)),t},Mh.prototype.getSnapTargets=function(e,t){return gc(t).filter(function(e){return!e.hidden})};function Ah(e,o){var a=this;e.on(["resize.start"],function(e){a.initSnap(e)}),e.on(["resize.move","resize.end"],1250,function(e){var t=e.context,n=t.shape,i=n.parent,r=t.direction,t=t.snapContext;e.originalEvent&&_s(e.originalEvent)||fc(e)||((t=t.pointsForTarget(i)).initialized||((t=a.addSnapTargetPoints(t,n,i,r)).initialized=!0),"n"!==(n=r)&&"s"!==n||mc(e,"x",e.x),"e"!==(i=r)&&"w"!==i||mc(e,"y",e.y),o.snap(e,t))}),e.on(["resize.cleanup"],function(){o.hide()})}function Nh(e,t){var n=D(e),e=P(e),n={x:n.x,y:n.y};return-1!==t.indexOf("n")?n.y=e.top:-1!==t.indexOf("s")&&(n.y=e.bottom),-1!==t.indexOf("e")?n.x=e.right:-1!==t.indexOf("w")&&(n.x=e.left),n}Ah.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.direction,r=(r=t.snapContext)||(t.snapContext=new Rh),t=Nh(n,i);return r.setSnapOrigin("corner",{x:t.x-e.x,y:t.y-e.y}),r},Ah.prototype.addSnapTargetPoints=function(t,e,n,i){return y(this.getSnapTargets(e,n),function(e){t.add("corner",{x:e.x+e.width,y:e.y+e.height}),t.add("corner",{x:e.x,y:e.y})}),t.add("corner",Nh(e,i)),t},Ah.$inject=["eventBus","snapping"],Ah.prototype.getSnapTargets=function(t,e){return gc(e).filter(function(e){return!(e.host===t||e.waypoints||e.hidden||e.labelTarget)})};function Bh(e){this._canvas=e,this._asyncHide=ve(ye(this.hide,this),1e3)}Bh.$inject=["canvas"],Bh.prototype.snap=function(o,a){var e=o.context.snapContext,t=e.getSnapLocations(),s={x:fc(o,"x"),y:fc(o,"y")};y(t,function(n){var i=e.getSnapOrigin(n),r={x:o.x+i.x,y:o.y+i.y};if(y(["x","y"],function(e){var t;s[e]||void 0!==(t=a.snap(r,n,e,7))&&(s[e]={value:t,originValue:t-i[e]})}),s.x&&s.y)return!1}),this.showSnapLine("vertical",s.x&&s.x.value),this.showSnapLine("horizontal",s.y&&s.y.value),y(["x","y"],function(e){var t=s[e];ee(t)&&mc(o,e,t.originValue)})},Bh.prototype._createLine=function(t){var e=this._canvas.getLayer("snap"),n=O("path");return S(n,{d:"M0,0 L0,0"}),j(n).add("djs-snap-line"),w(e,n),{update:function(e){g(e)?S(n,"horizontal"===t?{d:"M-100000,"+e+" L+100000,"+e,display:""}:{d:"M "+e+",-100000 L "+e+", +100000",display:""}):S(n,{display:"none"})}}},Bh.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}},Bh.prototype.showSnapLine=function(e,t){e=this.getSnapLine(e);e&&e.update(t),this._asyncHide()},Bh.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]},Bh.prototype.hide=function(){y(this._snapLines,function(e){e.update()})};aa={__depends__:[{__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",Mh],resizeSnapping:["type",Ah],snapping:["type",Bh]}],__init__:["bendpointSnapping","connectSnapping"],bendpointSnapping:["type",jh],connectSnapping:["type",Dh]};function Lh(e){za.call(this,e)}Yn(Lh,za),Lh.prototype._modules=[].concat(Lh.prototype._modules,Lh.prototype._modelingModules=[Wr,$a,js,bc,yl,ia,Oc,ml,Nl,$l,Xl,nd,od,ed,_d,Pd,Nd,pd,e,aa]);var Vh=u(function e(t){h(this,e),C(this,t),Hh(this,"businessObject",{writable:!0})}),Wc=function(){l(n,Vh);var t=p(n);function n(e){return h(this,n),Hh(d(e=t.call(this,e)),"rows",{enumerable:!0,value:e.rows||[]}),Hh(d(e),"cols",{enumerable:!0,value:e.cols||[]}),e}return u(n)}(),$h=function(){l(n,Vh);var t=p(n);function n(e){return h(this,n),Hh(d(e=t.call(this,e)),"root",{writable:!0}),Hh(d(e),"cells",{enumerable:!0,value:e.cells||[]}),e}return u(n)}(),zh=function(){l(n,Vh);var t=p(n);function n(e){return h(this,n),Hh(d(e=t.call(this,e)),"root",{writable:!0}),Hh(d(e),"cells",{enumerable:!0,value:e.cells||[]}),e}return u(n)}(),Fh=function(){l(n,Vh);var t=p(n);function n(e){return h(this,n),Hh(d(e=t.call(this,e)),"row",{writable:!0}),Hh(d(e),"col",{writable:!0}),e}return u(n)}(),Uh={root:Wc,row:$h,col:zh,cell:Fh};function Hh(e,t,n){Object.defineProperty(e,t,n)}var Wh=function(){function e(){h(this,e),this._uid=12}return u(e,[{key:"create",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=(t.id||(t.id=e+"_"+this._uid++),Uh[e]);if(n)return new n(t);throw new Error("unknown type "+e)}},{key:"createRoot",value:function(e){return this.create("root",e)}},{key:"createRow",value:function(e){return this.create("row",e)}},{key:"createCol",value:function(e){return this.create("col",e)}},{key:"createCell",value:function(e){return this.create("cell",e)}}]),e}(),Yo=function(){function t(e){h(this,t),this._eventBus=e,this._elements={},e.on("table.clear",this.clear.bind(this))}return u(t,[{key:"add",value:function(e,t){var n=e.id;this._elements[n]=e}},{key:"remove",value:function(e){e=e.id||e;delete this._elements[e]}},{key:"get",value:function(e){return this._elements[e]}},{key:"getAll",value:function(){return qh(this._elements)}},{key:"forEach",value:function(t){qh(this._elements).forEach(function(e){return t(e)})}},{key:"filter",value:function(t){return qh(this._elements).filter(function(e){return t(e)})}},{key:"clear",value:function(){this._elements={}}},{key:"updateId",value:function(e,t){this._validateId(t),"string"==typeof e&&(e=this.get(e)),this._eventBus.fire("element.updateId",{element:e,newId:t}),this.remove(e),e.id=t,this.add(e)}},{key:"_validateId",value:function(e){if(!e)throw new Error("element must have an id");if(this._elements[e])throw new Error("element with id "+e+" already added")}}]),t}();function qh(t){return Object.keys(t).map(function(e){return t[e]})}Yo.$inject=["eventBus"];var Ho=function(){function e(n){var i=this;h(this,e),this._listeners={},n.on("elements.changed",function(e){e=e.elements;i.elementsChanged(e)}),n.on("root.remove",function(e){var t=e.root.id;i._listeners[t]&&n.once("root.add",function(e){e=e.root.id;i.updateId(t,e)})}),n.on("element.updateId",function(e){var t=e.element,e=e.newId;i.updateId(t.id,e)})}return u(e,[{key:"elementsChanged",value:function(e){for(var t={},n=e.length,i=0;i<n;i++){var r=e[i].id;if(t[r])return;t[r]=!0;var o=this._listeners[r]&&this._listeners[r].length;if(o)for(var a=0;a<o;a++)this._listeners[r][a]&&this._listeners[r][a]()}}},{key:"onElementsChanged",value:function(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e][this._listeners[e].length]=t}},{key:"offElementsChanged",value:function(e,t){this._listeners[e]&&(t?-1!==(t=this._listeners[e].indexOf(t))&&this._listeners[e].splice(t,1):this._listeners[e].length=0)}},{key:"updateId",value:function(e,t){this._listeners[e]&&(this._listeners[t]=this._listeners[e],delete this._listeners[e])}}]),e}(),ca=(Ho.$inject=["eventBus"],function(){function e(){h(this,e),this._listeners={}}return u(e,[{key:"getComponent",value:function(e,t){var n=this._listeners[e];if(n){for(var i,r=0;r<n.length&&!(i=n[r].callback(t));r++);return i}}},{key:"getComponents",value:function(e,t){var n=this._listeners[e],i=[];if(n)for(var r=0;r<n.length;r++){var o=n[r].callback(t);o&&i.push(o)}return i}},{key:"onGetComponent",value:function(e,t,n){if(te(t)&&(n=t,t=1e3),!g(t))throw new Error("priority must be a number");for(var i,r=this._getListeners(e),o={priority:t,callback:n},a=0;i=r[a];a++)if(i.priority<t)return void r.splice(a,0,o);r.push(o)}},{key:"offGetComponent",value:function(e,t){var n,i,r=this._getListeners(e);if(t)for(i=r.length-1;n=r[i];i--)n.callback===t&&r.splice(i,1);else r.length=0}},{key:"_getListeners",value:function(e){var t=this._listeners[e];return t||(this._listeners[e]=t=[]),t}}]),e}()),Gh="$NO_OP",Kh="a runtime error occured! Use Inferno in development environment to find the error.",Tc=!("undefined"==typeof window||!window.document),Xh=Array.isArray;function Yh(e){e=Fe(e);return"string"===e||"number"===e}function T(e){return tf(e)||ef(e)}function Zh(e){return ef(e)||!1===e||!0===e||tf(e)}function M(e){return"function"==typeof e}function Qh(e){return"string"==typeof e}function Jh(e){return"number"==typeof e}function ef(e){return null===e}function tf(e){return void 0===e}function nf(e){throw e=e||Kh,new Error("Inferno Error: "+e)}function rf(e){console.error(e)}function of(e,t){var n={};if(e)for(var i in e)n[i]=e[i];if(t)for(var r in t)n[r]=t[r];return n}function af(e){var t;return">> "+(Xh(e)?"Array("+(3<e.length?e.slice(0,3).toString()+",...":e.toString())+")":Yh(e)?"Text("+e+")":Zh(e)?"InvalidVNode("+e+")":481&(t=e.flags)?"<"+e.type+(e.className?' class="'+e.className+'"':"")+">":16&t?"Text("+e.children+")":1024&t?"Portal*":"<"+((t=e.type).name||t.displayName||t.constructor.name||(t.toString().match(/^function\s*([^\s(]+)/)||[])[1])+" />")+"\n"}function sf(e){var t;1&e.childFlags||(64&e.flags&&nf("input elements can't have children."),128&e.flags&&nf("textarea elements can't have children."),481&e.flags&&(t=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],"media"===(e=e.type.toLowerCase())&&nf("media elements can't have children."),-1!==(e=t.indexOf(e)))&&nf(t[e]+" elements can't have children."))}function cf(e){var t;!1===e.isValidated&&e.children&&481&e.flags&&(t=function e(t,n){for(var i={},r=0,o=t.length;r<o;r++){var a=t[r];if(Xh(a))return"Encountered ARRAY in mount, array must be flattened, or normalize used. Location: \n"+af(a);if(Zh(a)){if(n)return"Encountered invalid node when preparing to keyed algorithm. Location: \n"+af(a);if(0!==Object.keys(i).length)return"Encountered invalid node with mixed keys. Location: \n"+af(a)}else{"object"===Fe(a)&&(a.isValidated=!0);var s=a.key;if(!T(s)&&!Yh(s))return"Encountered child vNode where key property is not string or number. Location: \n"+af(a);var c=a.children,u=a.childFlags;if(!Zh(c)){var l=void 0;if(12&u?l=e(c,8&a.childFlags):2===u&&(l=e([c],8&a.childFlags)),l)return l+=af(a)}if(n&&T(s))return"Encountered child without key during keyed algorithm. If this error points to Array make sure children is flat list. Location: \n"+af(a);if(!n&&T(s)){if(0!==Object.keys(i).length)return"Encountered children with key missing. Location: \n"+af(a)}else{if(i[s])return"Encountered two children with same key: {"+s+"}. Location: \n"+af(a);i[s]=!0}}}}(Array.isArray(e.children)?e.children:[e.children],0<(8&e.childFlags)))&&nf(t+af(e)),e.isValidated=!0}var uf="$";function lf(e,t,n,i,r,o,a,s){return{childFlags:e,children:t,className:n,dom:null,flags:i,isValidated:!1,key:void 0===r?null:r,parentVNode:null,props:void 0===o?null:o,ref:void 0===a?null:a,type:s}}function I(e,t,n,i,r,o,a,s){14&e&&nf("Creating Component vNodes using createVNode is not allowed. Use Inferno.createComponentVNode method.");r=void 0===r?1:r,i=lf(r,i,n,e,a,o,s,t),n=mf.createVNode;return"function"==typeof n&&n(i),0===r&&ff(i,i.children),sf(i),i}function A(e,t,n,i,r){1&e&&nf("Creating element vNodes using createComponentVNode is not allowed. Use Inferno.createVNode method."),0<(2&e)&&(e=t.prototype&&M(t.prototype.render)?4:8);var o=t.defaultProps;if(!T(o))for(var a in n=n||{},o)tf(n[a])&&(n[a]=o[a]);if(0<(8&e)){var s=t.defaultHooks;if(!T(s))if(r)for(var c in s)tf(r[c])&&(r[c]=s[c]);else r=s}e=lf(1,null,null,e,i,n,r,t),i=mf.createVNode;return M(i)&&i(e),e}function N(e,t){return lf(1,T(e)?"":e,null,16,t,null,null,null)}function df(e){var t,n=e.props;return n&&(481&(t=e.flags)&&(void 0!==n.children&&T(e.children)&&ff(e,n.children),void 0!==n.className)&&(e.className=n.className||null,n.className=void 0),void 0!==n.key&&(e.key=n.key,n.key=void 0),void 0!==n.ref)&&(e.ref=8&t?of(e.ref,n.ref):n.ref,n.ref=void 0),e}function pf(e){var t,n=e.flags;if(14&n){var i,r=e.props;if(!ef(r))for(var o in i={},r)i[o]=r[o];t=A(n,e.type,i,e.key,e.ref)}else 481&n?t=I(n,e.type,e.className,e.children,e.childFlags,e.props,e.key,e.ref):16&n?t=N(e.children,e.key):1024&n&&(t=e);return t}function hf(){return N("",null)}function ff(e,t){var n,i=1;if(Zh(t))n=t;else if(Qh(t))i=2,n=N(t);else if(Jh(t))i=2,n=N(t+"");else if(Xh(t)){var r=t.length;if(0===r)n=null,i=1;else{!Object.isFrozen(t)&&!0!==t.$||(t=t.slice());for(var i=8,o=0;o<r;o++){var a,s,c,u=t[o];if(Zh(u)||Xh(u)){n=n||t.slice(0,o),!function e(t,n,i,r){for(var o=t.length;i<o;i++){var a,s,c,u=t[i];Zh(u)||(a=r+uf+i,Xh(u)?e(u,n,0,a):(Yh(u)?u=N(u,a):(c=Qh(s=u.key)&&s[0]===uf,ef(u.dom)&&!c||(u=pf(u)),ef(s)||c?u.key=a:u.key=r+s),n.push(u)))}}(t,n,o,"");break}Yh(u)?(n=n||t.slice(0,o)).push(N(u,uf+o)):(c=u.key,a=ef(u.dom),c=!(s=ef(c))&&Qh(c)&&c[0]===uf,!a||s||c?(n=n||t.slice(0,o),a&&!c||(u=pf(u)),(s||c)&&(u.key=uf+o),n.push(u)):n&&n.push(u))}(n=n||t).$=!0}}else ef((n=t).dom)||(n=pf(t)),i=2;e.children=n,e.childFlags=i,sf(e)}var mf={afterRender:null,beforeRender:null,createVNode:null,renderComplete:null},Wr="http://www.w3.org/1999/xlink",$a="http://www.w3.org/XML/1998/namespace",gf="http://www.w3.org/2000/svg",vf={"xlink:actuate":Wr,"xlink:arcrole":Wr,"xlink:href":Wr,"xlink:role":Wr,"xlink:show":Wr,"xlink:title":Wr,"xlink:type":Wr,"xml:base":$a,"xml:lang":$a,"xml:space":$a},yf={},_f=[];function bf(e,t){e.appendChild(t)}function xf(e,t,n){T(n)?bf(e,t):e.insertBefore(t,n)}function wf(e,t,n){e.replaceChild(t,n)}function Cf(e){for(var t;void 0!==(t=e.shift());)t()}Object.freeze(yf);var Ef={},kf={};function Sf(e,t,n){var u,i=Ef[e],r=n.$EV;function o(e){var t=e.type;if((t="click"===t||"dblclick"===t)&&0!==e.button)return e.stopPropagation(),!1;e.stopPropagation=Of;for(var n={dom:document},i=(Object.defineProperty(e,"currentTarget",{configurable:!0,get:function(){return n.dom}}),e),e=e.target,r=t,o=u,a=n,s=e;!ef(s);){if(r&&s.disabled)return;var c=s.$EV;if(c){c=c[o];if(c&&(a.dom=s,c.event?c.event(c.data,i):c(i),i.cancelBubble))return}s=s.parentNode}}t?(i||(kf[e]=(u=e,document.addEventListener(jf(u),o),o),Ef[e]=0),(r=r||(n.$EV={}))[e]||Ef[e]++,r[e]=t):r&&r[e]&&(Ef[e]--,1===i&&(document.removeEventListener(jf(e),kf[e]),kf[e]=null),r[e]=t)}function jf(e){return e.substr(2).toLowerCase()}function Of(){this.cancelBubble=!0,this.immediatePropagationStopped||this.stopImmediatePropagation()}function Pf(e,t){var n=document.createElement("i");return n.innerHTML=t,n.innerHTML===e.innerHTML}function Df(e,t,n){var i;e[t]?(i=e[t]).event?i.event(i.data,n):i(n):e[i=t.toLowerCase()]&&e[i](n)}function Rf(a,s){function e(e){if(e.stopPropagation(),r=this.$V){var t,n,i=r.props||yf,r=r.dom;if(Qh(a))Df(i,a,e);else for(var o=0;o<a.length;o++)Df(i,a[o],e);M(s)&&(n=(t=this.$V).props||yf,s(n,r,!1,t))}}return Object.defineProperty(e,"wrapped",{configurable:!1,enumerable:!1,value:!0,writable:!1}),e}function Tf(e){return"checkbox"===e||"radio"===e}var Mf=Rf("onInput",Nf),If=Rf(["onClick","onChange"],Nf);function Af(e){e.stopPropagation()}function Nf(e,t){var n=e.type,i=e.value,r=e.checked,o=e.multiple,e=e.defaultValue,a=!T(i);n&&n!==t.type&&t.setAttribute("type",n),T(o)||o===t.multiple||(t.multiple=o),T(e)||a||(t.defaultValue=e+""),Tf(n)?(a&&(t.value=i),T(r)||(t.checked=r)):a&&t.value!==i?(t.defaultValue=i,t.value=i):T(r)||(t.checked=r)}function Bf(e,t){if("optgroup"===e.type){var n=e.children,i=e.childFlags;if(12&i)for(var r=0,o=n.length;r<o;r++)Lf(n[r],t);else 2===i&&Lf(n,t)}else Lf(e,t)}function Lf(e,t){var n=e.props||yf,e=e.dom;e.value=n.value,Xh(t)&&-1!==t.indexOf(n.value)||n.value===t?e.selected=!0:T(t)&&T(n.selected)||(e.selected=n.selected||!1)}Af.wrapped=!0;var Vf=Rf("onChange",$f);function $f(e,t,n,i){var r=Boolean(e.multiple),t=(T(e.multiple)||r===t.multiple||(t.multiple=r),i.childFlags);if(0==(1&t)){var o=i.children,a=e.value;if(n&&T(a)&&(a=e.defaultValue),12&t)for(var s=0,c=o.length;s<c;s++)Bf(o[s],a);else 2===t&&Bf(o,a)}}var zf=Rf("onInput",Uf),Ff=Rf("onChange");function Uf(e,t,n){var i=e.value,r=t.value;T(i)?n&&!T(n=e.defaultValue)&&n!==r&&(t.defaultValue=n,t.value=n):r!==i&&(t.defaultValue=i,t.value=i)}function Hf(e,t,n,i,r,o){64&e?Nf(i,n):256&e?$f(i,n,r,t):128&e&&Uf(i,n,r),o&&(n.$V=t)}function Wf(e,t,n){var i;64&e?(i=t,Tf(n.type)?(i.onchange=If,i.onclick=Af):i.oninput=Mf):256&e?t.onchange=Vf:128&e&&(i=n,(e=t).oninput=zf,i.onChange)&&(e.onchange=Ff)}function qf(e){return e.type&&Tf(e.type)?!T(e.checked):!T(e.value)}function Gf(e,t){var n;Kf(e),t&&e.dom&&(n=e.dom,t.removeChild(n),e.dom=null)}function Kf(e){var t=e.flags;if(481&t){var n=e.ref,i=e.props,n=(M(n)&&n(null),e.children),r=e.childFlags;if(12&r?Xf(n):2===r&&Kf(n),!ef(i))for(var o in i)switch(o){case"onClick":case"onDblClick":case"onFocusIn":case"onFocusOut":case"onKeyDown":case"onKeyPress":case"onKeyUp":case"onMouseDown":case"onMouseMove":case"onMouseUp":case"onSubmit":case"onTouchEnd":case"onTouchMove":case"onTouchStart":Sf(o,null,e.dom)}}else{r=e.children;r&&(14&t?(n=e.ref,4&t?(M(r.componentWillUnmount)&&r.componentWillUnmount(),M(n)&&n(null),r.$UN=!0,r.$LI&&Kf(r.$LI)):(!T(n)&&M(n.onComponentWillUnmount)&&n.onComponentWillUnmount(e.dom,e.props||yf),Kf(r))):1024&t&&Gf(r,e.type))}}function Xf(e){for(var t=0,n=e.length;t<n;t++)Kf(e[t])}function Yf(e,t){Xf(t),e.textContent=""}function Zf(e,t){switch(e){case"animationIterationCount":case"borderImageOutset":case"borderImageSlice":case"borderImageWidth":case"boxFlex":case"boxFlexGroup":case"boxOrdinalGroup":case"columnCount":case"fillOpacity":case"flex":case"flexGrow":case"flexNegative":case"flexOrder":case"flexPositive":case"flexShrink":case"floodOpacity":case"fontWeight":case"gridColumn":case"gridRow":case"lineClamp":case"lineHeight":case"opacity":case"order":case"orphans":case"stopOpacity":case"strokeDasharray":case"strokeDashoffset":case"strokeMiterlimit":case"strokeOpacity":case"strokeWidth":case"tabSize":case"widows":case"zIndex":case"zoom":return t;default:return t+"px"}}function Qf(e,t,n,i,r,o,a){switch(e){case"onClick":case"onDblClick":case"onFocusIn":case"onFocusOut":case"onKeyDown":case"onKeyPress":case"onKeyUp":case"onMouseDown":case"onMouseMove":case"onMouseUp":case"onSubmit":case"onTouchEnd":case"onTouchMove":case"onTouchStart":Sf(e,n,i);break;case"children":case"childrenType":case"className":case"defaultValue":case"key":case"multiple":case"ref":break;case"autoFocus":i.autofocus=!!n;break;case"allowfullscreen":case"autoplay":case"capture":case"checked":case"controls":case"default":case"disabled":case"hidden":case"indeterminate":case"loop":case"muted":case"novalidate":case"open":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"selected":i[e]=!!n;break;case"defaultChecked":case"value":case"volume":o&&"value"===e||(s=T(n)?"":n,i[e]!==s&&(i[e]=s));break;case"dangerouslySetInnerHTML":var s=t&&t.__html||"",c=n&&n.__html||"";s===c||T(c)||Pf(i,c)||(ef(a)||(12&a.childFlags?Xf(a.children):2===a.childFlags&&Kf(a.children),a.children=null,a.childFlags=1),i.innerHTML=c);break;default:if("o"===e[0]&&"n"===e[1])s=n,c=i,y=(f=e).toLowerCase(),M(s)||T(s)?(m=c[y])&&m.wrapped||(c[y]=s):(m=s.event)&&M(m)?c[y]=(g=m,v=s,function(e){g(v.data,e)}):nf('an event on a VNode "'+f+'". was not a function or a valid linkEvent.');else if(T(n))i.removeAttribute(e);else if("style"===e){var u,l,d=t,p=n,h=i.style;if(Qh(p))h.cssText=p;else if(T(d)||Qh(d))for(u in p)l=p[u],h[u]=Jh(l)?Zf(u,l):l;else{for(u in p)(l=p[u])!==d[u]&&(h[u]=Jh(l)?Zf(u,l):l);for(u in d)T(p[u])&&(h[u]="")}}else r&&vf[e]?i.setAttributeNS(vf[e],e,n):i.setAttribute(e,n)}var f,m,g,v,y}function Jf(e,t,n,i,r){var o,a=!1,s=0<(448&t);for(o in s&&(a=qf(n))&&Wf(t,i,n),n)Qf(o,null,n[o],i,r,a,null);s&&Hf(t,e,i,n,!0,a)}function em(e,t,n,i){t=new t(n,i);if((e.children=t).$V=e,t.$BS=!1,t.context=i,t.props===yf&&(t.props=n),t.$UN=!1,M(t.componentWillMount)){if(t.$BR=!0,t.componentWillMount(),t.$PSS){var r=t.state,o=t.$PS;if(ef(r))t.state=o;else for(var a in o)r[a]=o[a];t.$PSS=!1,t.$PS=null}t.$BR=!1}M(mf.beforeRender)&&mf.beforeRender(t);var s,n=tm(t.render(n,t.state,i),e);return T(s=M(t.getChildContext)?t.getChildContext():s)?t.$CX=i:t.$CX=of(i,s),M(mf.afterRender)&&mf.afterRender(t),t.$LI=n,t}function tm(e,t){return Xh(e)&&nf("a valid Inferno VNode (or null) must be returned from a component render. You may have returned an array or an invalid object."),Zh(e)?e=hf():Yh(e)?e=N(e,null):14&(e=e.dom?pf(e):e).flags&&(e.parentVNode=t),e}function nm(e,t,n,i){var r,o,a,s,c,u,l,d,p=e.flags;return 481&p?rm(e,t,n,i):14&p?(o=t,a=n,i=i,s=0<(4&p),u=(r=e).type,l=r.props||yf,d=r.ref,s?(s=em(r,u,l,a),r.dom=c=nm(s.$LI,null,s.$CX,i),am(r,d,s),s.$UPD=!1):(s=tm(u(l,a),r),r.children=s,r.dom=c=nm(s,null,a,i),sm(l,d,c)),ef(o)||bf(o,c),c):512&p||16&p?im(e,t):1024&p?(nm(e.children,e.type,n,!1),e.dom=im(hf(),t)):void("object"===Fe(e)?nf("mount() received an object that's not a valid VNode, you should stringify it first, fix createVNode flags or call normalizeChildren. Object: \""+JSON.stringify(e)+'".'):nf('mount() expects a valid VNode, instead it received an object with the type "'+Fe(e)+'".'))}function im(e,t){e=e.dom=document.createTextNode(e.children);return ef(t)||bf(t,e),e}function rm(e,t,n,i){var r=e.flags,o=e.children,a=e.props,s=e.className,c=e.ref,u=e.childFlags,l=(i=i||0<(32&r),l=e.type,i?document.createElementNS(gf,l):document.createElement(l));return e.dom=l,T(s)||""===s||(i?l.setAttribute("class",s):l.className=s),cf(e),ef(t)||bf(t,l),0==(1&u)&&(s=!0===i&&"foreignObject"!==e.type,2===u?nm(o,l,n,s):12&u&&om(o,l,n,s)),ef(a)||Jf(e,r,a,l,i),Qh(c)&&nf('string "refs" are not supported in Inferno 1.0. Use callback "refs" instead.'),M(c)&&cm(l,c),l}function om(e,t,n,i){for(var r=0,o=e.length;r<o;r++){var a=e[r];ef(a.dom)||(e[r]=a=pf(a)),nm(a,t,n,i)}}function am(e,t,n){var i;M(t)?t(n):Yh(t)?nf('string "refs" are not supported in Inferno 1.0. Use callback "refs" instead.'):!T(t)&&"object"===Fe(t)&&4&e.flags&&nf("functional component lifecycle events are not supported on ES2015 class components."),M(n.componentDidMount)&&_f.push((i=n,function(){i.$UPD=!0,i.componentDidMount(),i.$UPD=!1}))}function sm(e,t,n){var i,r,o;T(t)||(M(t.onComponentWillMount)&&t.onComponentWillMount(e),M(t.onComponentDidMount)&&_f.push((i=t,r=n,o=e,function(){return i.onComponentDidMount(r,o)})))}function cm(e,t){_f.push(function(){return t(e)})}function um(e,t,n,i){var r,o=e.children,a=e.props,s=e.className,c=e.flags,u=e.ref;if(i=i||0<(32&c),1!==t.nodeType||t.tagName.toLowerCase()!==e.type){rf("Inferno hydration: Server-side markup doesn't match client-side markup or Initial render target is not empty");var l=rm(e,null,n,i);e.dom=l,wf(t.parentNode,l,t)}else{var d=(e.dom=t).firstChild,l=e.childFlags;if(0==(1&l)){for(var p=null;d;)p=d.nextSibling,8===d.nodeType&&("!"===d.data?t.replaceChild(document.createTextNode(""),d):t.removeChild(d)),d=p;if(d=t.firstChild,2===l)ef(d)?nm(o,t,n,i):(p=d.nextSibling,lm(o,d,n,i),d=p);else if(12&l)for(var h=0,f=o.length;h<f;h++){var m=o[h];ef(d)?nm(m,t,n,i):(p=d.nextSibling,lm(m,d,n,i),d=p)}for(;d;)p=d.nextSibling,t.removeChild(d),d=p}else ef(t.firstChild)||(l=t,r=a,Boolean(r&&r.dangerouslySetInnerHTML&&r.dangerouslySetInnerHTML.__html&&Pf(l,r.dangerouslySetInnerHTML.__html)))||(t.textContent="",448&c&&(t.defaultValue=""));ef(a)||Jf(e,c,a,t,i),T(s)?""!==t.className&&t.removeAttribute("class"):i?t.setAttribute("class",s):t.className=s,M(u)?cm(t,u):Qh(u)&&nf('string "refs" are not supported in Inferno 1.0. Use callback "refs" instead.')}}function lm(e,t,n,i){var r,o,a,s,c,u,l,d,p,h,f=e.flags;14&f?(a=t,s=n,c=i,u=0<(4&f),d=(o=e).type,p=o.ref,h=o.props||yf,u?(lm(l=(u=em(o,d,h,s)).$LI,a,u.$CX,c),o.dom=l.dom,am(o,p,u),u.$UPD=!1):(lm(l=tm(d(h,s),o),a,s,c),o.children=l,o.dom=l.dom,sm(h,p,a))):481&f?um(e,t,n,i):16&f?(u=e,3!==(d=t).nodeType?(r=im(u,null),u.dom=r,wf(d.parentNode,r,d)):(r=u.children,d.nodeValue!==r&&(d.nodeValue=r),u.dom=d)):512&f?e.dom=t:(nf('hydrate() expects a valid VNode, instead it received an object with the type "'+Fe(e)+'".'),nf())}function dm(e,t,n,i,r){Kf(e),wf(n,nm(t,null,i,r),e.dom)}function pm(e,t,n,i,r){var o,a=0|t.flags;if(e.flags!==a||2048&a)dm(e,t,n,i,r);else if(481&a){var s,c=e,u=t,l=n,d=i,p=r,h=a,f=u.type;if(c.type!==f)dm(c,u,l,d,p);else{var m=c.dom,l=c.props,g=u.props,v=!1,y=!1;if(u.dom=m,p=p||0<(32&h),l!==g){var _=l||yf;if((s=g||yf)!==yf)for(var b in(v=0<(448&h))&&(y=qf(s)),s){var x=_[b],w=s[b];x!==w&&Qf(b,x,w,m,p,y,c)}if(_!==yf)for(var C in _)s.hasOwnProperty(C)||T(_[C])||Qf(C,_[C],null,m,p,y,c)}var l=c.children,g=u.children,E=u.ref,k=c.className,S=u.className;cf(u),4096&h?function(e,t){e.textContent!==t.children&&(e.textContent=t.children)}(m,g):hm(c.childFlags,u.childFlags,l,g,m,d,p&&"foreignObject"!==f),v&&Hf(h,u,m,s,!1,y),k!==S&&(T(S)?m.removeAttribute("class"):p?m.setAttribute("class",S):m.className=S),M(E)&&c.ref!==E?cm(m,E):Qh(E)&&nf('string "refs" are not supported in Inferno 1.0. Use callback "refs" instead.')}}else 14&a?(l=e,g=n,d=i,f=r,v=0<(4&a),u=(h=t).type,k=l.key,S=h.key,l.type!==u||k!==S?dm(l,h,g,d,f):(k=h.props||yf,v?((S=l.children).$UPD=!0,S.$V=h,fm(S,S.state,h,k,g,d,f,!1,!1),S.$UPD=!1):(v=!0,S=l.props,E=h.ref,n=!T(E),r=l.children,h.dom=l.dom,h.children=r,!1!==(v=n&&M(E.onComponentShouldUpdate)?E.onComponentShouldUpdate(S,k):v)?(n&&M(E.onComponentWillUpdate)&&E.onComponentWillUpdate(S,k),(l=u(k,d))!==Gh&&(l=tm(l,h),pm(r,l,g,d,f),h.children=l,h.dom=l.dom,n)&&M(E.onComponentDidUpdate)&&E.onComponentDidUpdate(S,k)):14&r.flags&&(r.parentVNode=h)))):16&a?(r=(n=t).children,o=e.dom,r!==e.children&&(o.nodeValue=r),n.dom=o):512&a?t.dom=e.dom:(r=t,n=i,a=(o=e).type,t=r.type,i=r.children,hm(o.childFlags,r.childFlags,o.children,i,a,n,!1),r.dom=o.dom,a===t||Zh(i)||(n=i.dom,a.removeChild(n),t.appendChild(n)))}function hm(N,e,t,n,i,r,o){switch(N){case 2:switch(e){case 2:pm(t,n,i,r,o);break;case 1:Gf(t,i);break;default:Gf(t,i),om(n,i,r,o)}break;case 1:switch(e){case 2:nm(n,i,r,o);break;case 1:break;default:om(n,i,r,o)}break;default:if(12&e){var a=t.length,s=n.length;if(0===a)0<s&&om(n,i,r,o);else if(0===s)Yf(i,t);else if(8===e&&8===N){var c,u,l=t,d=n,p=i,h=r,f=o,B=a,m=s,g=B-1,v=m-1,y=0,_=l[y],b=d[y];e:{for(;_.key===b.key;){if(b.dom&&(d[y]=b=pf(b)),pm(_,b,p,h,f),l[y]=b,g<++y||v<y)break e;_=l[y],b=d[y]}for(_=l[g],b=d[v];_.key===b.key;){if(b.dom&&(d[v]=b=pf(b)),pm(_,b,p,h,f),l[g]=b,v--,--g<y||v<y)break e;_=l[g],b=d[v]}}if(g<y){if(y<=v)for(var L=(u=v+1)<m?d[u].dom:null;y<=v;)(b=d[y]).dom&&(d[y]=b=pf(b)),y++,xf(p,nm(b,null,h,f),L)}else if(v<y)for(;y<=g;)Gf(l[y++],p);else{var x=y,w=y,V=g-y+1,C=v-y+1,E=[];for(c=0;c<C;c++)E.push(0);var k=V===B,S=!1,j=0,O=0;if(m<4||(V|C)<32)for(c=x;c<=g;c++)if(_=l[c],O<C){for(y=w;y<=v;y++)if(b=d[y],_.key===b.key){if(E[y-w]=c+1,k)for(k=!1;x<c;)Gf(l[x++],p);y<j?S=!0:j=y,b.dom&&(d[y]=b=pf(b)),pm(_,b,p,h,f),O++;break}!k&&v<y&&Gf(_,p)}else k||Gf(_,p);else{var $={};for(c=w;c<=v;c++)$[d[c].key]=c;for(c=x;c<=g;c++)if(_=l[c],O<C)if(void 0!==(y=$[_.key])){if(k)for(k=!1;x<c;)Gf(l[x++],p);b=d[y],E[y-w]=c+1,y<j?S=!0:j=y,b.dom&&(d[y]=b=pf(b)),pm(_,b,p,h,f),O++}else k||Gf(_,p);else k||Gf(_,p)}if(k)Yf(p,l),om(d,p,h,f);else if(S){var z=function(e){var t,n,i,r,o,a=e.slice(),s=[0],c=e.length;for(t=0;t<c;t++){var u=e[t];if(0!==u)if(n=s[s.length-1],e[n]<u)a[t]=n,s.push(t);else{for(i=0,r=s.length-1;i<r;)e[s[o=(i+r)/2|0]]<u?i=1+o:r=o;u<e[s[i]]&&(0<i&&(a[t]=s[i-1]),s[i]=t)}}i=s.length,r=s[i-1];for(;0<i--;)s[i]=r,r=a[r];return s}(E);for(y=z.length-1,c=C-1;0<=c;c--)0===E[c]?((b=d[j=c+w]).dom&&(d[j]=b=pf(b)),u=j+1,xf(p,nm(b,null,h,f),u<m?d[u].dom:null)):y<0||c!==z[y]?(b=d[j=c+w],u=j+1,xf(p,b.dom,u<m?d[u].dom:null)):y--}else if(O!==C)for(c=C-1;0<=c;c--)0===E[c]&&((b=d[j=c+w]).dom&&(d[j]=b=pf(b)),u=j+1,xf(p,nm(b,null,h,f),u<m?d[u].dom:null))}}else{for(var P,F,D=t,R=n,T=i,U=r,H=o,M=a,I=s,W=I<M?I:M,A=0;A<W;A++)P=R[A],F=D[A],P.dom&&(P=R[A]=pf(P)),pm(F,P,T,U,H),D[A]=P;if(M<I)for(A=W;A<I;A++)nm(P=(P=R[A]).dom?R[A]=pf(P):P,T,U,H);else if(I<M)for(A=W;A<M;A++)Gf(D[A],T)}}else 1===e?Yf(i,t):2===e&&(Yf(i,t),nm(n,i,r,o))}}function fm(e,t,n,i,r,o,a,s,c){var u=e.state,l=e.props;if((n.children=e).$UN)rf("Inferno Error: Can only update a mounted or mounting component. This usually means you called setState() or forceUpdate() on an unmounted component. This is a no-op.");else{if(l!==i||i===yf){if(!c&&M(e.componentWillReceiveProps)){if(e.$BR=!0,e.componentWillReceiveProps(i,o),e.$UN)return;e.$BR=!1}e.$PSS&&(t=of(t,e.$PS),e.$PSS=!1,e.$PS=null)}var d,c=Boolean(e.shouldComponentUpdate);s||!c||c&&e.shouldComponentUpdate(i,t,o)?(M(e.componentWillUpdate)&&(e.$BS=!0,e.componentWillUpdate(i,t,o),e.$BS=!1),e.props=i,e.state=t,e.context=o,M(mf.beforeRender)&&mf.beforeRender(e),s=e.render(i,t,o),M(mf.afterRender)&&mf.afterRender(e),c=s!==Gh,d=T(d=M(e.getChildContext)?e.getChildContext():d)?o:of(o,d),e.$CX=d,c&&(pm(e.$LI,c=tm(s,n),r,d,a),e.$LI=c,M(e.componentDidUpdate))&&e.componentDidUpdate(l,u)):(e.props=i,e.state=t,e.context=o),n.dom=e.$LI.dom}}Tc&&null===document.body&&rf('Inferno warning: you cannot initialize inferno without "document.body". Wait on "DOMContentLoaded" event, add script to bottom of body, or use async/defer attributes on script tag.');var mm=Tc?document.body:null;function gm(e,t,n){if(mm===t&&nf('you cannot render() to the "document.body". Use an empty element as a container instead.'),e!==Gh){var i=t.$V;if(T(i)){if(!Zh(e)){if(e.dom&&(e=pf(e)),ef(t.firstChild))nm(e,t,yf,!1),t.$V=e;else{var r=e,o=t,a=void 0,s=o.firstChild;if(!ef(s))for(Zh(r)||lm(r,s,yf,!1),s=o.firstChild;s=s.nextSibling;)o.removeChild(s);0<_f.length&&Cf(_f),o.$V=r,M(a)&&a()}i=e}}else T(e)?(Gf(i,t),t.$V=null):(pm(i,e=e.dom?pf(e):e,t,yf,!1),i=t.$V=e);0<_f.length&&Cf(_f),M(n)&&n(),M(mf.renderComplete)&&mf.renderComplete(i),i&&14&i.flags&&i.children}}var vm="undefined"==typeof Promise?null:Promise.resolve(),ym="undefined"==typeof requestAnimationFrame?setTimeout:requestAnimationFrame.bind(window);function _m(e,t,n,i){M(t)&&(t=t(e.state,e.props,e.context));var r,o,a,s=e.$PS;if(T(s))e.$PS=t;else for(var c in t)s[c]=t[c];e.$PSS||e.$BR?(e.$PSS=!0,e.$BR&&M(n)&&_f.push(n.bind(e))):e.$UPD?(ef(r=e.$QU)&&(r=e.$QU=[],function(e){if(vm)return vm.then(e);ym(e)}((o=e,a=r,function(){o.$QU=null,o.$UPD=!0,bm(o,!1,function(){for(var e=0,t=a.length;e<t;e++)a[e].call(o)}),o.$UPD=!1}))),M(n)&&r.push(n)):(e.$PSS=!0,e.$UPD=!0,bm(e,i,n),e.$UPD=!1)}function bm(e,t,n){if(!e.$UN){if(t||!e.$BR){e.$PSS=!1;var i=e.$PS,i=of(e.state,i),r=e.props,o=e.context,a=(e.$PS=null,e.$V),s=e.$LI;if(fm(e,i,a,r,s.dom&&s.dom.parentNode,o,0<(32&a.flags),t,!0),e.$UN)return;if(0==(1024&e.$LI.flags))for(var c=e.$LI.dom;!ef(a=a.parentVNode);)0<(14&a.flags)&&(a.dom=c);0<_f.length&&Cf(_f)}else e.state=e.$PS,e.$PS=null;M(n)&&n.call(e)}}function a(e,t){this.state=null,this.$BR=!1,this.$BS=!0,this.$PSS=!1,this.$PS=null,this.$LI=null,this.$V=null,this.$UN=!1,this.$CX=null,this.$UPD=!0,this.$QU=null,this.props=e||yf,this.context=t||yf}function xm(){}a.prototype.forceUpdate=function(e){this.$UN||_m(this,{},e,!0)},a.prototype.setState=function(e,t){this.$UN||(this.$BS?nf("cannot update state via setState() in componentWillUpdate() or constructor."):_m(this,e,t,!1))},a.prototype.render=function(e,t,n){};console.info("Inferno is in development mode."),-1===(xm.name||xm.toString()).indexOf("testFn")&&rf("It looks like you're using a minified copy of the development build of Inferno. When deploying Inferno apps to production, make sure to use the production build which skips development warnings and is faster. See http://infernojs.org for more details.");var wm=function(){l(i,a);var n=p(i);function i(e){h(this,i);var t,e=(t=n.call(this,e))._injector=e.injector,e=(t._sheet=e.get("sheet"),t._changeSupport=e.get("changeSupport"),t._components=e.get("components"),t._eventBus=e.get("eventBus"),e.get("throttle"));return t.onElementsChanged=t.onElementsChanged.bind(d(t)),t.onScroll=e(t.onScroll.bind(d(t))),t}return u(i,[{key:"onElementsChanged",value:function(){this.forceUpdate()}},{key:"onScroll",value:function(){this._eventBus.fire("sheet.scroll")}},{key:"getChildContext",value:function(){return{changeSupport:this._changeSupport,components:this._components,injector:this._injector}}},{key:"componentWillMount",value:function(){var e=this._sheet.getRoot().id;this._changeSupport.onElementsChanged(e,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this._sheet.getRoot().id;this._changeSupport.offElementsChanged(e,this.onElementsChanged)}},{key:"render",value:function(){var e=this._sheet.getRoot(),t=e.rows,e=e.cols,n=this._components.getComponents("table.before"),i=this._components.getComponents("table.after"),r=this._components.getComponent("table.head"),o=this._components.getComponent("table.body"),a=this._components.getComponent("table.foot");return I(1,"div","tjs-container",[n&&n.map(function(e,t){return A(2,e,null,t)}),I(1,"div","tjs-table-container",I(1,"table","tjs-table",[r&&A(2,r,{rows:t,cols:e}),o&&A(2,o,{rows:t,cols:e}),a&&A(2,a,{rows:t,cols:e})],0),2,{onScroll:this.onScroll}),i&&i.map(function(e,t){return A(2,e,null,t)})],0)}}]),i}(),js=function(){function a(e,t,n,i,r){h(this,a);var o=n.container;this._container=o,i.on("root.added",function(){gm(A(2,wm,{injector:r}),o)}),i.on("root.remove",function(){gm(null,o)})}return u(a,[{key:"getContainer",value:function(){return this._container}}]),a}(),bc=(js.$inject=["changeSupport","components","config.renderer","eventBus","injector"],{__init__:["changeSupport","components","renderer"],changeSupport:["type",Ho],components:["type",ca],renderer:["type",js]}),yl=function(){function i(e,t){var n=this;h(this,i),this._elementRegistry=e,this._eventBus=t,this._root=null,t.on("table.clear",function(){n.setRoot(null)})}return u(i,[{key:"setRoot",value:function(e){var t;this._root&&(t=this._root,this._eventBus.fire("root.remove",{root:t}),this._root=null,this._eventBus.fire("root.removed",{root:t})),e&&this._eventBus.fire("root.add",{root:e}),(this._root=e)&&this._eventBus.fire("root.added",{root:e})}},{key:"getRoot",value:function(){return this._root||this.setRoot({id:"__implicitroot",rows:[],cols:[]}),this._root}},{key:"addRow",value:function(n,i){var r=this,o=this.getRoot();if(o.cols.length!=n.cells.length)throw new Error("number of cells is not equal to number of cols");return Cm(i=void 0===i?o.rows.length:i,o.rows,n),n.root=o,this._elementRegistry.add(n),n.cells.forEach(function(e,t){r._elementRegistry.add(e),e.row=n,e.col=o.cols[t],Cm(i,o.cols[t].cells,e)}),this._eventBus.fire("row.add",{row:n}),n}},{key:"removeRow",value:function(e){var n=this,i=this.getRoot(),r=("string"==typeof e&&(e=this._elementRegistry.get(e)),i.rows.indexOf(e));-1!==r&&(Em(r,i.rows),e.root=void 0,this._elementRegistry.remove(e),e.cells.forEach(function(e,t){n._elementRegistry.remove(e),e.col=void 0,Em(r,i.cols[t].cells)}),this._eventBus.fire("row.remove",{row:e}))}},{key:"addCol",value:function(n,i){var r=this,o=this.getRoot();if(this._elementRegistry.add(n),o.rows.length!=n.cells.length)throw new Error("number of cells is not equal to number of rows");return Cm(i=void 0===i?o.cols.length:i,o.cols,n),n.root=o,n.cells.forEach(function(e,t){r._elementRegistry.add(e),e.col=n,e.row=o.rows[t],Cm(i,o.rows[t].cells,e)}),this._eventBus.fire("col.add",{col:n}),n}},{key:"removeCol",value:function(e){var n=this,i=this.getRoot(),r=("string"==typeof e&&(e=this._elementRegistry.get(e)),i.cols.indexOf(e));-1!==r&&(Em(r,i.cols),e.root=void 0,this._elementRegistry.remove(e),e.cells.forEach(function(e,t){n._elementRegistry.remove(e),e.row=void 0,Em(r,i.rows[t].cells)}),this._eventBus.fire("col.remove",{col:e}))}},{key:"resized",value:function(){this._eventBus.fire("sheet.resized")}}]),i}();function Cm(e,t,n){t.splice(e,0,n)}function Em(e,t){t.splice(e,1)}function km(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],r="number"==typeof e?e:e?300:0;return r?function(e){return t=e,n=r,i=!1,function(){i||(t.apply(void 0,arguments),i=!0,setTimeout(function(){i=!1},n))};var t,n,i}:function(e){return e}}yl.$inject=["elementRegistry","eventBus"],km.$inject=["config.throttle"];var Sm={__depends__:[bc],__init__:["elementFactory","sheet"],elementFactory:["type",Wh],elementRegistry:["type",Yo],eventBus:["type",Ce],sheet:["type",yl],throttle:["factory",km]},jm=["modules"],Om=function(){function i(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=(h(this,i),t.injector);n||(e=(t=this._init(t)).modules,n=function(e,t){e=new oi([{config:["value",e]},Sm].concat(t||[]));return e.init(),e}(t.config,e)),this.get=n.get,this.invoke=n.invoke,this.get("eventBus").fire("table.init"),this.get("eventBus").fire("diagram.init")}return u(i,[{key:"_init",value:function(e){return{modules:e.modules,config:z(e,jm)}}},{key:"destroy",value:function(){var e=this.get("eventBus");e.fire("table.destroy"),e.fire("diagram.destroy")}},{key:"clear",value:function(){var e=this.get("eventBus");e.fire("table.clear"),e.fire("diagram.clear")}}]),i}();function Pm(e){var t;return e?(t=e.id?' id="'.concat(e.id,'"'):"","<".concat(e.$type).concat(t," />")):"<null>"}function Dm(o,e){function a(e,t,n){if(e.gfx)throw new Error("already rendered ".concat(Pm(e)));o.element(e,t,n)}function s(e,t,n){y(e,function(e){a(e,t,n)})}function c(e,t,n){y(e,function(e){a(e,t,n)})}return{handleDecision:function(e){e.id||(e.id="decision");var t=e.decisionLogic;if(!t)throw new Error("no table for ".concat(Pm(e)));if(!t.output)throw new Error("missing output for ".concat(Pm(t)));var n,i,r,e=o.table(t);t.input&&s(t.input,e,t),s(t.output,e,t),n=t.rule,i=e,r=t,y(n,function(e){a(e,i,r),c(e.inputEntry,e),c(e.outputEntry,e)})}}}function Rm(e,t,n){var i,r=e.get("tableImporter"),o=e.get("eventBus"),a=e.get("sheet"),s=(e.get("modeling",!1),[]);o.fire("import.render.start",{decision:t});try{new Dm({create:function(e,t,n,i){return r.create(e,t,n,i)},table:function(e){return r.add(e)},element:function(e,t,n){return r.add(e,t,n)},error:function(e,t){s.push({message:e,context:t})}}).handleDecision(t)}catch(e){i=e}o.fire("import.render.complete",{error:i,warnings:s}),o.fire("elements.changed",{elements:[a.getRoot()]}),n(i,s)}function Tm(e,t){var n=e.elements,i=e.index;return i[t]?e:{elements:[].concat(f(n),[t]),index:L(L({},i),{},V({},t,!0))}}function Mm(){for(var e,n={elements:[],index:{}},t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return i.forEach(function(t){var e=Fe(t);"string"===e&&0<t.length?n=Tm(n,t):"object"===e&&null!==t&&Object.keys(t).forEach(function(e){t[e]&&(n=Tm(n,e))})}),e=" ",n.elements.join(e)}function Im(e){Am(e.constructor,e)}function Am(e,a){var t,s=e.$inject;s&&(e=a.context.injector,t=[].concat(f(s),[function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(e in n){var r=s[e],o=n[e];a[r]=o}}]),e.invoke(t))}function Nm(i,r){Object.keys(r).forEach(function(e){if("$inject"!==e&&"__init"!==e){var t=r[e],n=("constructor"===e&&t.call(i,i.props,i.context),i[e]);if(void 0!==n){if("function"!=typeof n)throw new Error("failed to mixin <".concat(e,">: cannot combine with non-fn component value"));i[e]=function(r){for(var e=arguments.length,o=new Array(1<e?e-1:0),t=1;t<e;t++)o[t-1]=arguments[t];return function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return o.forEach(function(e){if(void 0!==(t=e.call.apply(e,[r].concat(n))))return!1}),t}.bind(r)}(i,n,t)}else i[e]=t.bind(i)}}),"$inject"in r&&Am(r,i),"__init"in r&&r.__init.call(i,i.props,i.context)}var Bm={getSelectionClasses:function(){var e=this.state;return Mm({selected:e.selected,"selected-secondary":e.selectedSecondary,focussed:e.focussed})},selectionChanged:function(e){this.setState(e)},componentWillUpdate:function(e){e.elementId!==this.props.elementId&&this.updateSelectionSubscription(!1)},componentDidUpdate:function(e){e.elementId!==this.props.elementId&&this.updateSelectionSubscription(!0)},componentDidMount:function(){this.updateSelectionSubscription(!0)},componentWillUnmount:function(){this.updateSelectionSubscription(!1)},updateSelectionSubscription:function(e){var t=this.props.elementId;t&&this.eventBus[e?"on":"off"]("selection.".concat(t,".changed"),this.selectionChanged)},$inject:["eventBus"]},Lm=["className","elementId","coords"],Vm=function(){l(i,a);var n=p(i);function i(e,t){return h(this,i),Nm(d(e=n.call(this,e,t)),Bm),Im(d(e)),e}return u(i,[{key:"getRenderProps",value:function(){for(var e=this.props,t=e.className,n=e.elementId,i=e.coords,e=z(e,Lm),r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];t={className:Mm.apply(void 0,o.concat([this.getSelectionClasses(),t]))};return n&&(t["data-element-id"]=n),i&&(t["data-coords"]=i),L(L({},t),e)}}]),i}(),$m=function(){l(i,Vm);var n=p(i);function i(e,t){return h(this,i),(e=n.call(this,e,t)).state={},e}return u(i,[{key:"render",value:function(){return df(I(1,"td",null,this.props.children,0,L({},this.getRenderProps("cell"))))}}]),i}(),zm=["type","context"],Fm=["type","context"];function Um(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function Hm(i){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Um(Object(r),!0).forEach(function(e){var t,n;t=i,n=r[e=e],(e=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):Um(Object(r)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(r,e))})}return i}function Wm(e,t){if(null==e)return{};var n,i=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);return i}var qm={slotFill:function(e,t){var n=e.type,i=e.context,e=Wm(e,zm),n=this.components.getComponent(n,i)||t;return n?df(A(2,n,Hm(Hm({},i),e))):null},slotFills:function(e){var t=e.type,n=e.context,i=Wm(e,Fm);return this.components.getComponents(t,n).map(function(e){return df(A(2,e,Hm(Hm({},n),i)))})}};function Gm(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}qm.$inject=["components"];var Km=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),Gm(d(n=i.call(this,e,t)),"onElementsChanged",function(){n.forceUpdate()}),Nm(d(n),qm),Im(d(n)),n}return u(r,[{key:"componentDidMount",value:function(){this.changeSupport.onElementsChanged(this.getRoot(),this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){this.changeSupport.offElementsChanged(this.getRoot(),this.onElementsChanged)}},{key:"getRoot",value:function(){return this.sheet.getRoot()}},{key:"render",value:function(){var e=(this.getRoot().businessObject.get("annotationsWidth")||400)+"px";return I(1,"th","annotation header",[this.slotFills({type:"cell-inner",context:{cellType:"annotations",col:this.sheet.getRoot(),minWidth:400}}),this.translate("Annotations")],0,{style:{width:e}})}}]),r}();function Xm(e){var e=e.row.businessObject,t=e.id,e=e.description;return A(2,$m,{className:"annotation",elementId:t,children:e||"-"})}function Ym(e){e.onGetComponent("cell",function(e){e=e.cellType;return"after-label-cells"===e?Km:"after-rule-cells"===e?Xm:void 0})}Km.$inject=["changeSupport","sheet","translate"],Ym.$inject=["components"];var Zm={__init__:["annotationsProvider"],annotationsProvider:["type",Ym]};function Qm(e,t){return C({id:e.id,type:e.$type,businessObject:e},t)}ia=function(){function i(e,t,n){h(this,i),this._elementFactory=e,this._eventBus=t,this._sheet=n}return u(i,[{key:"add",value:function(e){var t,n,i=this;return k(e,"dmn:DecisionTable")?(n=this._elementFactory.createRoot(Qm(e)),this._sheet.setRoot(n)):k(e,"dmn:InputClause")||k(e,"dmn:OutputClause")?(n=this._elementFactory.createCol(Qm(e)),this._sheet.addCol(n)):k(e,"dmn:DecisionRule")&&(e.inputEntry||(e.inputEntry=[]),e.outputEntry||(e.outputEntry=[]),t=[].concat(f(e.inputEntry),f(e.outputEntry)).map(function(e){return i._elementFactory.createCell(Qm(e))}),n=this._elementFactory.createRow(C(Qm(e),{cells:t})),this._sheet.addRow(n)),this._eventBus.fire("dmnElement.added",{element:n}),n}}]),i}();ia.$inject=["elementFactory","eventBus","sheet"];var Jm={__depends__:[{__depends__:[Ro],tableImporter:["type",ia]},bc]};function eg(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var tg=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),eg(d(n=i.call(this,e,t)),"onElementsChanged",function(){n.forceUpdate()}),Nm(d(n),qm),n._sheet=t.injector.get("sheet"),n._changeSupport=t.changeSupport,n}return u(r,[{key:"componentWillMount",value:function(){var e=this._sheet.getRoot();this._changeSupport.onElementsChanged(e.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this._sheet.getRoot();this._changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"render",value:function(){var i,n,r=this,e=this._sheet.getRoot();return k(e,"dmn:DMNElement")?(e=Gn(e),i=e.input,n=e.output,I(1,"thead",null,I(1,"tr",null,[I(1,"th","index-column"),this.slotFills({type:"cell",context:{cellType:"before-label-cells"}}),i&&i.map(function(e,t){var n=e.width||"192px";return r.slotFill({type:"cell",context:{cellType:"input-header",input:e,index:t,inputsLength:i.length,width:n},key:e.id},ng)}),n.map(function(e,t){return r.slotFill({type:"cell",context:{cellType:"output-header",output:e,index:t,outputsLength:n.length},key:e.id},ig)}),this.slotFills({type:"cell",context:{cellType:"after-label-cells"}})],0),2)):null}}]),r}();function ng(e,t){var n=e.input,i=e.className,e=e.index,r=n.label,o=n.inputExpression,a=n.inputValues,t=t.injector.get("translate");return I(1,"th",(i||"")+" input-cell",[I(1,"div","clause",t(0===e?"When":"And"),0),r?I(1,"div","input-label",r,0,{title:t("Input Label: ")+r}):I(1,"div","input-expression",o.text,0,{title:t("Input Expression: ")+o.text}),I(1,"div","input-variable",a&&a.text||o.typeRef,0,{title:a&&a.text?t("Input Values"):t("Input Type")})],0,{"data-col-id":n.id},n.id)}function ig(e,t){var n=e.output,i=e.className,e=e.index,r=n.label,o=n.name,a=n.outputValues,s=n.typeRef,t=t.injector.get("translate");return I(1,"th",(i||"")+" output-cell",[I(1,"div","clause",t(0===e?"Then":"And"),0),r?I(1,"div","output-label",r,0,{title:t("Output Label")}):I(1,"div","output-name",o,0,{title:t("Output Name")}),I(1,"div","output-variable",a&&a.text||s,0,{title:a&&a.text?t("Output Values"):t("Output Type")})],0,null,n.id)}function rg(e){e.onGetComponent("table.head",function(){return tg})}rg.$inject=["components"];var og={__init__:["decisionTableHeadProvider"],decisionTableHeadProvider:["type",rg]},ag=function(){l(i,a);var n=p(i);function i(e,t){return h(this,i),(e=n.call(this,e,t))._translate=t.injector.get("translate"),Im(d(e)),e}return u(i,[{key:"render",value:function(){var e,t=this.sheet.getRoot();return k(t,"dmn:DMNElement")?(t=t.businessObject.$parent.name,e=this.components.getComponent("hit-policy")||sg,I(1,"div","decision-table-properties",[I(1,"div","decision-table-name",t,0,{title:this._translate("Decision Name: ")+t}),I(1,"div","decision-table-header-separator"),A(2,e)],4)):null}}]),i}();function sg(){return null}ag.$inject=["sheet","components"];var Oc=u(function e(t){h(this,e),t.onGetComponent("table.before",500,function(){return ag})}),cg=(Oc.$inject=["components"],{__init__:["decisionTableProperties"],decisionTableProperties:["type",Oc]}),ug=function(){l(t,a);var e=p(t);function t(){return h(this,t),e.apply(this,arguments)}return u(t,[{key:"render",value:function(){var e=this.props,t=e.row,n=e.rowIndex,e=this.context.components.getComponents("cell-inner",{cellType:"rule-index",row:t,rowIndex:n});return I(1,"td","rule-index",[e&&e.map(function(e){return A(2,e,{row:t,rowIndex:n})}),n+1],0,{"data-element-id":t.id,"data-row-id":t.id})}}]),t}(),ml=u(function e(t){h(this,e),t.onGetComponent("cell",function(e){if("before-rule-cells"===e.cellType)return ug})}),lg=(ml.$inject=["components"],{__init__:["decisionRuleIndices"],decisionRuleIndices:["type",ml]}),dg=[{label:"FEEL",value:"feel"}],Nl=function(){function n(e){h(this,n);var e=(this._injector=e).get("config.expressionLanguages")||{},t=(this._config={options:dg,defaults:{editor:"feel"}},e.options&&(this._config.options=e.options),this._getLegacyDefaults());C(this._config.defaults,t,e.defaults)}return u(n,[{key:"getDefault",value:function(e){var t=this._config.defaults,e=t[e]||t.editor;return this._getLanguageByValue(e)||this.getAll()[0]}},{key:"getLabel",value:function(e){var t=this._getLanguageByValue(e);return t?t.label:e}},{key:"getAll",value:function(){return this._config.options}},{key:"_getLegacyDefaults",value:function(){var e={},t=this._injector,n=t.get("config.defaultInputExpressionLanguage"),t=t.get("config.defaultOutputExpressionLanguage");return n&&(e.inputCell=n),t&&(e.outputCell=t),e}},{key:"_getLanguageByValue",value:function(t){return ie(this.getAll(),function(e){return t===e.value})}}]),n}(),pg=(Nl.$inject=["injector"],{__init__:["expressionLanguages"],expressionLanguages:["type",Nl]}),hg=function(){l(t,a);var e=p(t);function t(){return h(this,t),e.apply(this,arguments)}return u(t,[{key:"render",value:function(e){var t=e.rows,i=e.cols,r=this.context.components;return I(1,"tbody",null,t.map(function(e,t){var n=r.getComponent("row",{rowType:"rule"});return n&&A(2,n,{row:e,rowIndex:t,cols:i},e.id)}),0)}}]),t}(),fg=function(){l(i,a);var n=p(i);function i(e,t){return h(this,i),Nm(d(e=n.call(this,e,t)),qm),e}return u(i,[{key:"render",value:function(){var n=this,e=this.props,i=e.row,r=e.rowIndex,o=e.cols,e=i.cells;return I(1,"tr",null,[this.slotFills({type:"cell",context:{cellType:"before-rule-cells",row:i,rowIndex:r}}),e.map(function(e,t){return n.slotFill({type:"cell",context:{cellType:"rule",cell:e,rowIndex:r,colIndex:t},key:e.id,row:i,col:o[t]})}),this.slotFills({type:"cell",context:{cellType:"after-rule-cells",row:i,rowIndex:r}})],0)}}]),i}(),mg=function(){l(t,a);var e=p(t);function t(){return h(this,t),e.apply(this,arguments)}return u(t,[{key:"render",value:function(){var e=this.props,t=e.cell,n=e.row,e=e.col;return k(t,"dmn:UnaryTests")?A(2,$m,{className:"input-cell",elementId:t.id,"data-row-id":n.id,"data-col-id":e.id,children:t.businessObject.text}):A(2,$m,{className:"output-cell",elementId:t.id,"data-row-id":n.id,"data-col-id":e.id,children:t.businessObject.text})}}]),t}(),$l=u(function e(t){h(this,e),t.onGetComponent("table.body",function(){return hg}),t.onGetComponent("row",function(e){if("rule"===e.rowType)return fg}),t.onGetComponent("cell",function(e){if("rule"===e.cellType)return mg})}),gg=($l.$inject=["components"],{__depends__:[pg],__init__:["decisionRules"],decisionRules:["type",$l]}),vg=[{label:"Unique",value:{hitPolicy:"UNIQUE",aggregation:void 0},explanation:"No overlap is possible and all rules are disjoint. Only a single rule can be matched"},{label:"First",value:{hitPolicy:"FIRST",aggregation:void 0},explanation:"Rules may overlap. The first matching rule will be chosen"},{label:"Priority",value:{hitPolicy:"PRIORITY",aggregation:void 0},explanation:"Rules may overlap. The one with the highest priority will be chosen"},{label:"Any",value:{hitPolicy:"ANY",aggregation:void 0},explanation:"Rules may overlap. Their output have to match"},{label:"Collect",value:{hitPolicy:"COLLECT",aggregation:void 0},explanation:"Collects the values of all matching rules"},{label:"Collect (Sum)",value:{hitPolicy:"COLLECT",aggregation:"SUM"},explanation:"Collects the values of all matching rules and sums up to a single value"},{label:"Collect (Min)",value:{hitPolicy:"COLLECT",aggregation:"MIN"},explanation:"Collects the values of all matching rules and uses the lowest value"},{label:"Collect (Max)",value:{hitPolicy:"COLLECT",aggregation:"MAX"},explanation:"Collects the values of all matching rules and uses the highest value"},{label:"Collect (Count)",value:{hitPolicy:"COLLECT",aggregation:"COUNT"},explanation:"Collects the values of all matching rules and counts the number of them"},{label:"Rule order",value:{hitPolicy:"RULE ORDER",aggregation:void 0},explanation:"Collects the values of all matching rules in rule order"},{label:"Output order",value:{hitPolicy:"OUTPUT ORDER",aggregation:void 0},explanation:"Collects the values of all matching rules in decreasing output priority order"}],yg=function(){l(i,a);var n=p(i);function i(e,t){return h(this,i),(e=n.call(this,e,t))._translate=t.injector.get("translate"),Im(d(e)),e}return u(i,[{key:"getRoot",value:function(){return this.sheet.getRoot()}},{key:"render",value:function(){var e=this.getRoot().businessObject,n=e.aggregation,i=e.hitPolicy,e=ie(vg,function(e){return e=e.value,t={aggregation:n,hitPolicy:i},e.hitPolicy===t.hitPolicy&&e.aggregation===t.aggregation;var t});return I(1,"div","hit-policy header",[I(1,"label","dms-label",this._translate("Hit Policy:"),0),I(1,"span","hit-policy-value",this._translate(e.label),0)],4,{title:this._translate(e.explanation)})}}]),i}();function _g(e){e.onGetComponent("hit-policy",function(){return yg})}yg.$inject=["sheet"],_g.$inject=["components"];var bg={__init__:["hitPolicyProvider"],hitPolicyProvider:["type",_g]};function xg(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var wg=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),xg(d(n=i.call(this,e,t)),"onClick",function(){n._eventBus.fire("showDrd")});var n,e=t.injector;return n._translate=e.get("translate"),n._eventBus=e.get("eventBus"),n}return u(r,[{key:"render",value:function(){var t=this;return I(1,"div","view-drd",I(1,"button","view-drd-button",this._translate("View DRD"),0,{type:"button",onClick:this.onClick}),2,null,null,function(e){return t.node=e})}}]),r}(),Xl=function(){function o(e,t,n,i){var r=this;h(this,o),this._injector=n,this._sheet=i,e.onGetComponent("table.before",function(){if(r.canViewDrd())return wg}),t.on("showDrd",function(){var e=n.get("_parent",!1),t=Cg(i.getRoot());t&&(t=e.getView(t),e.open(t))})}return u(o,[{key:"canViewDrd",value:function(){var e,t=this._injector.get("_parent",!1);return!!t&&(e=Cg(this._sheet.getRoot()),!!t.getView(e))}}]),o}();function Cg(e){e=e.businessObject;if(e)return e.$parent.$parent}Xl.$inject=["components","eventBus","injector","sheet"];var Eg={__init__:["viewDrd"],viewDrd:["type",Xl]};function kg(){return I(32,"svg",null,[I(1,"path",null,null,1,{fill:"#000000",d:"M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"}),I(1,"path",null,null,1,{fill:"#000000",d:"M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"})],4,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 14.02 5.57",width:"53",height:"21",style:"vertical-align:middle"})}function Sg(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var jg=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),Sg(d(n=i.call(this,e,t)),"onClick",function(){n._eventBus.fire("poweredBy.show")});var n,e=t.injector;return n._eventBus=e.get("eventBus"),n}return u(r,[{key:"render",value:function(){var t=this;return I(1,"div","powered-by",I(1,"div","powered-by__logo",A(2,kg),2,{title:"Powered by bpmn.io",onClick:this.onClick},null,function(e){return t.node=e}),2)}}]),r}(),Og=function(){l(n,a);var t=p(n);function n(e){return h(this,n),(e=t.call(this,e)).state={show:!1},e.onClick=e.onClick.bind(d(e)),e.onShow=e.onShow.bind(d(e)),e}return u(n,[{key:"onClick",value:function(){this.setState({show:!1})}},{key:"onShow",value:function(){this.setState({show:!0})}},{key:"componentWillMount",value:function(){(this._eventBus=this.context.injector.get("eventBus")).on("poweredBy.show",this.onShow)}},{key:"componentWillUnmount",value:function(){this._eventBus.off("poweredBy.show",this.onShow)}},{key:"render",value:function(){return this.state.show&&I(1,"div","powered-by-overlay",I(1,"div","powered-by-overlay-content",[I(1,"a","logo",A(2,kg),2,{href:"https://bpmn.io",target:"_blank",rel:"noopener"}),I(1,"span",null,[N("Web-based tooling for BPMN, DMN and CMMN diagrams powered by "),I(1,"a",null,N("bpmn.io"),2,{href:"http://bpmn.io",target:"_blank"}),N(".")],4)],4,{onClick:function(e){return e.stopPropagation()}}),2,{onClick:this.onClick})}}]),n}(),nd=u(function e(t,n){h(this,e),t.onGetComponent("table.before",function(){return jg}),t.onGetComponent("table.before",function(){return Og})}),Pg=(nd.$inject=["components","eventBus"],{__init__:["poweredBy"],poweredBy:["type",nd]}),Dg=["modules","additionalModules"];function Rg(e,t){if(null==e)return{};var n,i=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);return i}var Tg=function(){l(i,Om);var n=p(i);function i(){h(this,i);var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=i._createContainer(),e=n.call(this,C(e,{renderer:{container:t}}));return e._container=t,e}return u(i,[{key:"open",value:function(e){var r=this;return new Promise(function(n,i){var t;try{return r._decision&&r.clear(),r._decision=e,Rm(r,e,function(e,t){e?(e.warnings=t||[],i(e)):n({warnings:t||[]})})}catch(e){t=e}t?(t.warnings=t.warnings||[],i(t)):n({warnings:[]})})}},{key:"_init",value:function(e){var t=e.modules,n=e.additionalModules,e=Rg(e,Dg),t=t||this.getModules(),n=n||[],i=[{decisionTable:["value",this]}];return{modules:[Pg].concat(f(t),f(n),i),config:e}}},{key:"on",value:function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)}},{key:"off",value:function(e,t){this.get("eventBus").off(e,t)}},{key:"_emit",value:function(e,t){return this.get("eventBus").fire(e,t)}},{key:"attachTo",value:function(e){if(!e)throw new Error("parentNode required");this.detach();var t=this._container;e.appendChild(t),this._emit("attach",{})}},{key:"detach",value:function(){var e=this._container;e.parentNode&&(this._emit("detach",{}),Tn(e))}},{key:"destroy",value:function(){F(s(i.prototype),"destroy",this).call(this),this.detach()}},{key:"getModules",value:function(){return i._getModules()}}],[{key:"_getModules",value:function(){return[Zm,Jm,Ro,og,cg,lg,gg,bg,Eg]}},{key:"_createContainer",value:function(){return _('<div class="dmn-decision-table-container"></div>')}}]),i}();function Mg(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var Ig=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),Mg(d(n=i.call(this,e,t)),"handleClick",function(e){e.stopPropagation(),n.addRule(e.target.dataset.colIndex)}),Im(d(n)),n.addRule=n.addRule.bind(d(n)),n}return u(r,[{key:"componentWillMount",value:function(){this._eventBus=this.context.injector.get("eventBus")}},{key:"addRule",value:function(e){this._eventBus.fire("addRule",{colIndex:e})}},{key:"render",value:function(){var e=this.props.cols,t=[I(1,"td","add-rule-add",I(1,"span","dmn-icon-plus action-icon",null,1,{title:"Add Rule"}),2)],n=this.sheet.getRoot().businessObject;n.input&&n.input.length||t.push(I(1,"td","input-cell",N("-"),2));for(var i=0;i<e.length+1;i++){var r="add-rule",o=e[i]&&e[i].businessObject,a="";o?(o.$instanceOf("dmn:InputClause")&&(r+=" input-cell",a="-"),o.$instanceOf("dmn:OutputClause")&&(r+=" output-cell")):r+=" annotation",t.push(I(1,"td",r,a,0,{"data-col-index":i}))}return I(1,"tfoot","actionable add-rule",I(1,"tr",null,t,0),2,{onClick:this.handleClick})}}]),r}(),od=(Ig.$inject=["sheet"],u(function e(t,i,n,r){h(this,e),t.onGetComponent("table.foot",function(){return Ig}),n.on("addRule",function(e,t){var n=i.trigger("addRule"),t=t.colIndex;n.cells[t]?r.select(n.cells[t]):r.select(n.cells[0])})})),ed=(od.$inject=["components","editorActions","eventBus","selection"],function(){function r(e,t,n){var i=this;h(this,r),this._elementRegistry=e,this._eventBus=t,this._renderer=n,this._selection=void 0,t.on("diagram.clear",function(){i._selection=void 0})}return u(r,[{key:"select",value:function(e){ne(e)&&(e=this._elementRegistry.get(e));var t=this._selection;t!==e&&(this._selection=e,this._eventBus.fire("selection.changed",{oldSelection:t,selection:e}))}},{key:"deselect",value:function(){var e=this._selection;this._selection=void 0,this._eventBus.fire("selection.changed",{oldSelection:e,selection:this._selection})}},{key:"get",value:function(){return this._selection}},{key:"hasSelection",value:function(){return!!this._selection}}]),r}()),_d=(ed.$inject=["elementRegistry","eventBus","renderer"],u(function e(t,n,i,r){h(this,e),this._elementRegistry=t,this._renderer=i,this._selection=r,n.on(["cell.click","cell.contextmenu"],function(e){e=e.id,e=t.get(e);e&&r.select(e)}),n.on("row.remove",function(e){var e=e.row,t=r.get();t&&e===t.row&&r.deselect()}),n.on("col.remove",function(e){var e=e.col,t=r.get();t&&e===t.col&&r.deselect()})})),Ag=(_d.$inject=["elementRegistry","eventBus","renderer","selection"],{__init__:["selection","selectionBehavior"],selection:["type",ed],selectionBehavior:["type",_d]});var Ng=["click","dblclick","contextmenu","mousedown","mouseup","mouseenter","mouseleave","mouseout","mouseover","mousemove","focusin","focusout","drag","dragstart","dragend","dragover","dragenter","dragleave","drop"],Pd=function(){function a(e,t){var n,i,r,o=this;h(this,a),r=function(e){var t,n=e.target,i=e.type,n=Cn(n,"[data-element-id]",!0);n&&(t=n.getAttribute("data-element-id"))&&(t=o._eventBus.createEvent({id:t,event:e,node:n,target:n}),o._eventBus.fire("cell.".concat(i),t),t.defaultPrevented&&e.preventDefault(),t.cancelBubble)&&e.stopPropagation()},(i="_handleEvent")in(n=this)?Object.defineProperty(n,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[i]=r,this._eventBus=t,this._container=e.container,t.on("table.init",function(){o._addEventListeners(Ng)}),t.on("table.destroy",function(){o._removeEventListeners(Ng)})}return u(a,[{key:"_addEventListeners",value:function(e){var t=this,n=this._container;e.forEach(function(e){n.addEventListener(e,t._handleEvent)})}},{key:"_removeEventListeners",value:function(e){var t=this,n=this._container;e.forEach(function(e){n.removeEventListener(e,t._handleEvent)})}}]),a}();Pd.$inject=["config.renderer","eventBus"];var Bg={__init__:["interactionEvents"],interactionEvents:["type",Pd]},Lg=function(e,t){return e^t};function Vg(e,t){var n,i,r,o=function(e){for(var t=[],n=0;n<e.length;n++)~t.indexOf(e[n])||t.push(e[n]);return t}(e.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\//g,"").replace($g,"").match(/[a-zA-Z_]\w*/g)||[]);return t&&"string"==typeof t&&(n=t,t=function(e){return n+e}),t?(i=o,r=t,e.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\/|[a-zA-Z_]\w*/g,function(e){return"("==e[e.length-1]||~i.indexOf(e)?r(e):e})):o}var $g=/\b(Array|Date|Object|Math|JSON)\b/g;var zg=Fg;function Fg(e,t){if(!(this instanceof Fg))return new Fg(e,t);if(this.node=this.start=this.peeked=e,this.root=t,this.closingTag=!1,this._revisit=!0,this._selects=[],this._rejects=[],e&&this.higher(e))throw new Error("root must be a parent or ancestor to node")}function Ug(a,s){var c="nextSibling"==a;return function(e,t,n){e=this.compile(e),t=t&&0<t?t:1;for(var i=this.node,r=this.closingTag,o=this._revisit;i;){if(Lg(c,r)&&i[s])i=i[s],r=!c;else if(1==i.nodeType&&!i[s]&&Lg(c,r)){if(r=c,!o)continue}else if(i[a])i=i[a],r=!c;else if(i=i.parentNode,r=c,!o)continue;if(!i||this.higher(i,this.root))break;if(e(i)&&this.selects(i,n)&&this.rejects(i,n)&&!--t)return n||(this.node=i),this.closingTag=r,i}return null}}Fg.prototype.reset=function(e){return this.node=e||this.start,this},Fg.prototype.revisit=function(e){return this._revisit=null==e||e,this},Fg.prototype.opening=function(){return 1==this.node.nodeType&&(this.closingTag=!1),this},Fg.prototype.atOpening=function(){return!this.closingTag},Fg.prototype.closing=function(){return 1==this.node.nodeType&&(this.closingTag=!0),this},Fg.prototype.atClosing=function(){return this.closingTag},Fg.prototype.next=Ug("nextSibling","firstChild"),Fg.prototype.previous=Fg.prototype.prev=Ug("previousSibling","lastChild"),Fg.prototype.select=function(e){return e=this.compile(e),this._selects.push(e),this},Fg.prototype.selects=function(e,t){var n=this._selects,i=n.length;if(!i)return!0;for(var r=0;r<i;r++)if(n[r].call(this,e,t))return!0;return!1},Fg.prototype.reject=function(e){return e=this.compile(e),this._rejects.push(e),this},Fg.prototype.rejects=function(e,t){var n=this._rejects,i=n.length;if(i)for(var r=0;r<i;r++)if(n[r].call(this,e,t))return!1;return!0},Fg.prototype.higher=function(e){var t=this.root;if(!t)return!1;for(e=e.parentNode;e&&e!=t;)e=e.parentNode;return e!=t},Fg.prototype.compile=function(t){switch(Fe(t)){case"number":return function(e){return t==e.nodeType};case"string":return new Function("node","return "+Vg(t,"node."));case"function":return t;default:return function(){return!0}}},Fg.prototype.peak=Fg.prototype.peek=function(e,t){return 1==arguments.length&&(t=e,e=!0),(t=null==t?1:t)?0<t?this.next(e,t,!0):this.prev(e,Math.abs(t),!0):this.node},Fg.prototype.use=function(e){return e(this),this};var Hg=window.getSelection();function Wg(e){Hg.removeAllRanges(),Hg.addRange(e)}function qg(e,t){Wg(function(e,t){var n,i=t.start,r=t.end,o=document.createRange(),a=zg(e.firstChild,e),s=a.node,c=!1,u=0;for(;s;){if(u===i&&(c?o.setStartAfter(s):o.setStartBefore(s)),u===r)return c?o.setEndAfter(s):o.setEndBefore(s),o;if(c||(Xg(s)||s.previousSibling&&(Yg(s)||Zg(s)))&&u++,Kg(s)){if(n=s.textContent.length,u<=i&&i<u+n&&o.setStart(s,i-u),r<u+n)return o.setEnd(s,r-u),o;u+=n}s=a.next(),c=a.closingTag}u<=i&&(e.lastChild?o.setStartAfter(e.lastChild):o.setStart(e,0));e.lastChild?o.setEndAfter(e.lastChild):o.setEnd(e,0);return o}(e,t))}function Gg(e){if(!function(e){var t;if(Hg.rangeCount)return e==(t=Kg(t=Hg.focusNode)?t.parentNode:t)||e.contains(t)}(e))return null;var t,n,i=Hg.getRangeAt(0),r=i.startContainer,o=i.endContainer,a=i.startOffset,s=i.endOffset,c=zg(e.firstChild,e),u=c.node,l=!1,d=0;function p(e,t){return 1===arguments.length&&(t=e),e.parentNode===o&&t==o.childNodes[s]}function h(e,t){return 1===arguments.length&&(t=e),e.parentNode===r&&t==r.childNodes[a]}for(;u&&(h(u)&&(n=d),!p(u));){if(l||(Xg(u)||t&&t.nextSibling==u&&(Yg(u)||Zg(u)))&&d++,Kg(u)){if(r===u&&(n=d+a),o===u){d+=s;break}d+=u.textContent.length}if((Kg(u)||l)&&(h(u,u.nextSibling)&&(n=d),p(u,u.nextSibling)))break;t=u,u=c.next(),l=c.closingTag}return{start:void 0===n?d:n,end:d}}function Kg(e){return 3===e.nodeType}function Xg(e){return 1===e.nodeType&&"BR"===e.nodeName}function Yg(e){return 1===e.nodeType&&"DIV"===e.nodeName}function Zg(e){return 1===e.nodeType&&"P"===e.nodeName}function Qg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=o.call(n)).done)&&(s.push(i.value),s.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return s}}(e,t)||function(e,t){var n;if(e)return"string"==typeof e?Jg(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jg(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ev="[contenteditable]",tv="[data-element-id]";function nv(e){return e.getAttribute("data-element-id")}function iv(e,t){return b('[data-element-id="'.concat(Us(e),'"]'),t)}function rv(e){return Cn(e,tv,!0)}function ov(e){var t=ev;return wn(e,t)?e:b(t,e)}var av={above:!0,below:!0,right:!0,left:!0};function sv(e,n,t,i,r){var o=e.container,a=null;function s(e,t){n.fire("selection."+e+".changed",t),n.fire("cellSelection.changed",{elementId:e,selection:t})}function c(e,t){t=!(1<arguments.length&&void 0!==t)||t;a!==e&&s(a,{selected:!1,focussed:!1}),(a=e)&&s(e,{selected:!0,focussed:t}),e?i.select(e):i.deselect()}n.on("cell.click",500,function(e){var t=e.target;Cn(t,".no-deselect",!0)||c((t=rv(t))&&nv(t),!e.defaultPrevented)}),n.on("cell.focusin",500,function(e){var t=nv(e.target),n=!e.defaultPrevented;return e.stopPropagation(),c(t,n)}),n.on("cell.focusout",500,function(e){s(nv(e.target),{focussed:!1})}),n.on("cellSelection.changed",function(e){var t=e.elementId,e=e.selection,t=iv(t,o);e.focussed&&t&&(e=ov(e=t))&&document.body.contains(e)&&document.activeElement!==e&&(e.focus(),!(t=Gg(e))||0===t.end)&&qg(e,{start:5e3,end:5e3})}),n.on("selection.changed",function(e){var t=e.selection,e=e.oldSelection,n=t&&t.id,e=e&&e.id;n&&n!==a?c(t.id):e&&e===a&&c()}),this.isCellSelected=function(){return!!a},this.getCellSelection=function(){return a},this.selectCell=function(e){if(a){var t;if(e in av)return t=iv(a,o),!!(t=(t=(t=t).getAttribute("data-coords"))?{row:(t=Qg(t.split(":"),2))[0],col:t[1]}:null)&&(t=function(e,t){var n=e.row,i=e.col;if("above"===t||"below"===t)return r=parseInt(n,10),isNaN(r)?e:{col:i,row:"above"===t?r-1:r+1};if("left"!==t&&"right"!==t)throw new Error("invalid direction <"+t+">");var r=parseInt(i,10);if(isNaN(r))return e;return{row:n,col:"left"===t?r-1:r+1}}(t,e),e=o,t="".concat((t=t).row,":").concat(t.col),!!(t=b('[data-coords="'.concat(Us(t),'"]'),e)))&&((e=nv(t))&&c(e,{focussed:!0,selected:!0}),!0);throw new Error("direction must be any of { above, below, left, right }")}},n.on("contextMenu.close",function(){if(a)return c(a)})}sv.$inject=["config.renderer","eventBus","sheet","selection","elementRegistry"];var cv={__depends__:[Bg,Ag],__init__:["cellSelection"],cellSelection:["type",sv]};function uv(){}uv.prototype.get=function(){return this._data},uv.prototype.set=function(e){this._data=e},uv.prototype.clear=function(){var e=this._data;return delete this._data,e},uv.prototype.isEmpty=function(){return!this._data};Nd={clipboard:["type",uv]},pd=function(){l(i,Dd);var n=p(i);function i(e,t){return h(this,i),(e=n.call(this,e))._sheet=t,e}return u(i,[{key:"init",value:function(){var i=this;this.addRule("col.move",2e3,function(e){var t=e.col,e=e.index,n=i._sheet.getRoot().businessObject.input;return x(t)?e<n.length:e>=n.length}),this.addRule("col.remove",2e3,function(e){var e=e.col,t=i._sheet.getRoot().cols;return!qn(e)||1<t.filter(qn).length}),this.addRule("paste",2e3,function(e){var t=e.data,e=e.target;return!(!t||!e)&&(t=t.root,e instanceof $h?i.canPasteRows(t):e instanceof zh&&i.canPasteCols(t,e))})}},{key:"canPasteRows",value:function(e){var n=this._sheet.getRoot().cols;return ae(e,function(e){return"row"===e.type&&e.cells.length===n.length&&ae(e.cells,function(e,t){return x(n[t])?"dmn:UnaryTests"===e.businessObject.$type:"dmn:LiteralExpression"===e.businessObject.$type})})}},{key:"canPasteCols",value:function(e,t){var n=this._sheet.getRoot().rows;return ae(e,function(e){return"col"===e.type&&e.cells.length===n.length&&(x(t)?"dmn:InputClause"===e.businessObject.$type:"dmn:OutputClause"===e.businessObject.$type)})}}]),i}();pd.$inject=["eventBus","sheet"];var e={__depends__:[{__depends__:[Ps]}],__init__:["decisionTableModelingRules"],decisionTableModelingRules:["type",pd]},lv=function(){function i(e,t,n){h(this,i),this._clipboard=e,this._modeling=t,this._sheet=n}return u(i,[{key:"execute",value:function(e){var t=e.data;return e.oldData=this._clipboard.get(),this._clipboard.set(t),this._sheet.getRoot()}},{key:"postExecute",value:function(e){var t=this;e.elements.forEach(function(e){e instanceof $h?t._modeling.removeRow(e):e instanceof zh&&t._modeling.removeCol(e)})}},{key:"revert",value:function(e){e=e.oldData;return this._clipboard.set(e),this._sheet.getRoot()}}]),i}();function dv(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function B(i){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?dv(Object(r),!0).forEach(function(e){var t,n;t=i,n=r[e=e],(e=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):dv(Object(r)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(r,e))})}return i}lv.$inject=["clipboard","modeling","sheet"];var pv=[function(e,t,n,i){t=B(B({},t),{},{type:function(e){if(e instanceof $h)return"row";if(e instanceof zh)return"col";if(e instanceof Fh)return"cell";throw new Error("cannot deduce element type: #"+e.id)}(e)});(e instanceof $h||e instanceof zh)&&(i=i(e.cells,n),t.cells=i.root,n=i.descriptorCache);return{root:t,descriptorCache:n}},function(e,t,n){var e=e.businessObject;return e?(e=function i(r,o){var e,t;var n=r.id;if(n&&(e=o.boCache||{},t=e[n]))return{root:t,descriptorCache:o};var a={$type:r.$type};n&&(a.id=n,e=B(B({},e),{},V({},n,a)),o=B(B({},o),{},{boCache:e}));r.$descriptor.properties.forEach(function(e){var t,n=r[e.name];n&&((n=m(n)?n.map(function(e){e=i(e,o);return o=e.descriptorCache,e.root}):n).$type&&(t=i(n,o),o=t.descriptorCache,n=t.root),a[e.name]=n)});return{root:a,descriptorCache:o}}(e,n),{root:B(B({},t),{},{businessObject:e.root}),descriptorCache:e.descriptorCache}):{root:t,descriptorCache:n}}],hv=[function(e,t,n){var i=e.root.businessObject;return i?(i=function i(e,r){var o=e.root;e=o.id;var a;if(e&&(a=r.boCache||{},t=a[e]))return{root:t,reviveCache:r};var s={};ue(o).forEach(function(e){var t,n;o[e].$type?(n=i({root:o[e]},r),t=n.root,r=n.reviveCache,a=r.boCache||{}):t=m(o[e])?o[e].map(function(e){return n=i({root:e},r),r=n.reviveCache,a=r.boCache||{},n.root}):o[e],s[e]=t});var t=s.$type;delete s.$type;r._keepIds&&!r._model.ids.assigned(s.id)||delete s.id;var n=r._dmnFactory.create(t,s);y(s,function(e){e.$type&&(e.$parent=n),m(e)&&e.forEach(function(e){return e.$parent=n})});e&&(a=B(B({},a),{},V({},e,n)),r=B(B({},r),{},{boCache:a}));return{root:n,reviveCache:r}}({root:i,descriptorCache:e.descriptorCache},n),{root:B(B({},t),{},{businessObject:i.root}),reviveCache:i.reviveCache}):{root:t,reviveCache:n}},function(e,t,n,i){var r=e.root,e=e.descriptorCache,o=B({},t);t.businessObject&&t.businessObject.id&&(o.id=t.businessObject.id);"row"!==r.type&&"col"!==r.type||(t=i({root:r.cells,descriptorCache:e},n),o.cells=t.root,n=t.reviveCache);var a=new(function(e){switch(e.type){case"row":return $h;case"cell":return Fh;case"col":return zh;default:throw new Error("unknown element type: #"+e.type)}}(r))(o);a instanceof $h?a.cells.forEach(function(e){e.row=a}):a instanceof zh&&a.cells.forEach(function(e){e.col=a});return{root:a,reviveCache:n}}];function fv(e,t,n){return n=n||pv,t=t||{},m(e)?(r=n,oe(e,function(e,t){var n=e.descriptorCache,e=e.root,t=mv(t,n,r),i=t.root,t=t.descriptorCache;return{root:[].concat(f(e),[i]),descriptorCache:B(B({},n),t)}},{root:[],descriptorCache:t})):mv(e,t,n);var r}function mv(e,t,n){var i,r,o=e.id,a=t.elements||{},s=a[o];return s?{root:s,descriptorCache:t}:(i=e,s={id:o},r=n,e=B(B({},t),{},{elements:a}),{root:(n=oe(r,function(e,t){return t(i,e.root,e.descriptorCache,c)},{root:s,descriptorCache:e})).root,descriptorCache:B(B({},n.descriptorCache),{},{elements:B(B({},n.descriptorCache.elements),{},V({},o,n.root))})});function c(e,t){return fv(e,t,r)}}function gv(e,t,n){return n=n||hv,t=t||{},m(e.root)?(i=t,r=n,o=e.root,a=e.descriptorCache,oe(o,function(e,t){var n=e.reviveCache,e=e.root,t=vv({root:t,descriptorCache:a},n,r),n=t.root,t=t.reviveCache;return{root:[].concat(f(e),[n]),reviveCache:t}},{root:[],reviveCache:i})):vv(e,t,n);var i,r,o,a}function vv(e,t,n){var i,r,o=e.root.id,a=t.elements||{},s=a[o];return s?{root:s,reviveCache:t}:(i=e,s={id:o},r=n,e=B(B({},t),{},{elements:a}),{root:(n=oe(r,function(e,t){return t(i,e.root,e.reviveCache,c)},{root:s,reviveCache:e})).root,reviveCache:B(B({},n.reviveCache),{},{elements:B(B({},n.reviveCache.elements),{},V({},o,n.root))})});function c(e,t){return gv(e,t,r)}}var yv=function(){function c(e,t,n,i,r,o,a,s){h(this,c),this._clipboard=e,this._dmnFactory=t,this._elementFactory=n,this._elementRegistry=i,this._eventBus=r,this._model=o,this._modeling=a,this._sheet=s}return u(c,[{key:"postExecute",value:function(e){var t=this,n=e.element,i=e.after,r=this._clipboard.get();if(!r)throw new Error("missing clipboard data");var o=this._sheet.getRoot(),r=gv(r.elements,{_dmnFactory:this._dmnFactory,_keepIds:r.keepIds,_model:this._model}).root;if(n instanceof $h){var a=o.rows.indexOf(n);if(-1===a)return;r.forEach(function(e){i&&a++,t._modeling.addRow(e,a)})}else if(n instanceof zh){var s=o.cols.indexOf(n);if(-1===s)return;r.forEach(function(e){i&&s++,t._modeling.addCol(e,s)})}return e.oldElements=this._clipboard.get(),this._sheet.getRoot()}},{key:"revert",value:function(e){}}]),c}();function _v(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function bv(i){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?_v(Object(r),!0).forEach(function(e){var t,n;t=i,n=r[e=e],(e=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):_v(Object(r)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(r,e))})}return i}yv.$inject=["clipboard","dmnFactory","elementFactory","elementRegistry","eventBus","moddle","modeling","sheet"];var aa=function(){function a(e,t,n,i,r,o){h(this,a),this._clipboard=e,this._commandStack=t,this._eventBus=n,this._modeling=i,this._sheet=r,this._rules=o,t.registerHandler("cut",lv),t.registerHandler("paste",yv)}return u(a,[{key:"copy",value:function(e){e={elements:fv(e=m(e)?e:[e])};this._eventBus.fire("copyCutPaste.copy",{data:e}),this._clipboard.set(e)}},{key:"cut",value:function(e){var t={elements:fv(e=m(e)?e:[e]),keepIds:!0},e={elements:e,data:t};this._eventBus.fire("copyCutPaste.cut",{data:t}),this._commandStack.execute("cut",e)}},{key:"pasteBefore",value:function(e){return this._paste(e,{before:!0})}},{key:"pasteAfter",value:function(e){return this._paste(e,{after:!0})}},{key:"_paste",value:function(e,t){var n=this._clipboard.get();if(n)return!!this._rules.allowed("paste",{data:n.elements,target:e})&&(this._commandStack.execute("paste",bv({element:e},t)),this._clipboard.clear(),!0)}},{key:"pasteAt",value:function(e){}}]),a}(),xv=(aa.$inject=["clipboard","commandStack","eventBus","modeling","sheet","rules"],{__depends__:[Nd,e],__init__:["copyCutPaste"],copyCutPaste:["type",aa]}),Wc=u(function e(t,n,i,r,o,a){h(this,e);var s={addRule:function(){return i.addRow({type:"dmn:DecisionRule"})},addRuleAbove:function(e){if((e=e&&e.rule)||r.hasSelection()){e=e||r.get().row,e=a.getRoot().rows.indexOf(e);if(-1!==e)return i.addRow({type:"dmn:DecisionRule"},e)}},addRuleBelow:function(e){if((e=e&&e.rule)||r.hasSelection()){e=e||r.get().row,e=a.getRoot().rows.indexOf(e);if(-1!==e)return i.addRow({type:"dmn:DecisionRule"},e+1)}},removeRule:function(e){e=e&&e.rule;(e||r.hasSelection())&&(e=e||r.get().row,i.removeRow(e))},addInput:function(){var e=a.getRoot().businessObject.input;return i.addCol({type:"dmn:InputClause"},e?e.length:0)},addInputLeft:function(e){if((e=e&&e.input)||r.hasSelection()){e=e||r.get().col,e=a.getRoot().cols.indexOf(e);if(-1!==e)return i.addCol({type:"dmn:InputClause"},e)}},addInputRight:function(e){if((e=e&&e.input)||r.hasSelection()){e=e||r.get().col,e=a.getRoot().cols.indexOf(e);if(-1!==e)return i.addCol({type:"dmn:InputClause"},e+1)}},removeInput:function(e){e=e&&e.input;(e||r.hasSelection())&&(e=e||r.get().col,i.removeCol(e))},addOutput:function(){var e=a.getRoot().businessObject,t=e.get("input"),e=e.get("output");return i.addCol({type:"dmn:OutputClause"},t.length+e.length)},addOutputLeft:function(e){if((e=e&&e.output)||r.hasSelection()){e=e||r.get().col,e=a.getRoot().cols.indexOf(e);if(-1!==e)return i.addCol({type:"dmn:OutputClause"},e)}},addOutputRight:function(e){if((e=e&&e.output)||r.hasSelection()){e=e||r.get().col,e=a.getRoot().cols.indexOf(e);if(-1!==e)return i.addCol({type:"dmn:OutputClause"},e+1)}},removeOutput:function(e){e=e&&e.output;(e||r.hasSelection())&&(e=e||r.get().col,i.removeCol(e))},addClause:function(){var e;if(r.hasSelection())return k(e=r.get().col,"dmn:InputClause")?s.addInput({input:e}):k(e,"dmn:OutputClause")?s.addOutput({output:e}):void 0},addClauseLeft:function(){var e;if(r.hasSelection())return k(e=r.get().col,"dmn:InputClause")?s.addInputLeft({input:e}):k(e,"dmn:OutputClause")?s.addOutputLeft({output:e}):void 0},addClauseRight:function(){var e;if(r.hasSelection())return k(e=r.get().col,"dmn:InputClause")?s.addInputRight({input:e}):k(e,"dmn:OutputClause")?s.addOutputRight({output:e}):void 0},removeClause:function(){var e;if(r.hasSelection())return k(e=r.get().col,"dmn:InputClause")?s.removeInput({input:e}):k(e,"dmn:OutputClause")?s.removeOutput({output:e}):void 0},selectCellAbove:function(){return o.selectCell("above")},selectCellBelow:function(){return o.selectCell("below")},copy:function(e){e=e.element;t.copy(e)},cut:function(e){e=e.element;t.cut(e)},pasteBefore:function(e){e=e.element;return t.pasteBefore(e)},pasteAfter:function(e){e=e.element;return t.pasteAfter(e)}};n.register(s)}),wv=(Wc.$inject=["copyCutPaste","editorActions","modeling","selection","cellSelection","sheet"],"is not a registered action"),Wr=function(){function r(e,t,n,i){h(this,r),this._actions={undo:function(){e.undo()},redo:function(){e.redo()},select:function(e){e=e.cell;i.select(e)},deselect:function(){i.deselect()},addRow:function(e){var t=e.attrs,e=e.index;n.addRow(t,e)},removeRow:function(e){e=e.row;n.removeRow(e)},moveRow:function(e){var t=e.row,e=e.index;n.moveRow(t,e)},addCol:function(e){var t=e.attrs,e=e.index;n.addCol(t,e)},removeCol:function(e){e=e.col;n.removeCol(e)},moveCol:function(e){var t=e.col,e=e.index;n.moveCol(t,e)}}}return u(r,[{key:"trigger",value:function(e,t){if(this._actions[e])return this._actions[e](t);throw Cv(e,wv)}},{key:"register",value:function(e,t){var n=this;if("string"==typeof e)return this._registerAction(e,t);y(e,function(e,t){n._registerAction(t,e)})}},{key:"_registerAction",value:function(e,t){if(this.isRegistered(e))throw Cv(e,"is already registered");this._actions[e]=t}},{key:"unregister",value:function(e){if(!this.isRegistered(e))throw Cv(e,wv);this._actions[e]=void 0}},{key:"isRegistered",value:function(e){return!!this._actions[e]}}]),r}();function Cv(e,t){return new Error(e+" "+t)}Wr.$inject=["commandStack","eventBus","modeling","selection"];var Ev={__depends__:[Ag],__init__:["editorActions"],editorActions:["type",Wr]},kv={__depends__:[cv,xv,Ev,Ag],__init__:["decisionTableEditorActions"],decisionTableEditorActions:["type",Wc]},Sv={__depends__:[kv],__init__:["addRule"],addRule:["type",od]},jv=/["'&<>]/,Ov=function(e){var t,n=""+e,e=jv.exec(n);if(!e)return n;var i="",r=0,o=0;for(r=e.index;r<n.length;r++){switch(n.charCodeAt(r)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}o!==r&&(i+=n.substring(o,r)),o=r+1,i+=t}return o!==r?i+n.substring(o,r):i};var Pv=function(e,t,n){var i=e=e.start,r=n.length-t.length,e=(n.length,t.length,t.substring(e));return n.lastIndexOf(e)===n.length-e.length&&(t=t.substring(0,t.length-e.length),n=n.substring(0,n.length-e.length)),Dv(i=(r=function(e,t){var n,i,r,o,a,s=0,c=0;o=t.length>e.length?(i=t,e):(i=e,t);for(;s<i.length;)r=i.charAt(s),a=o.charAt(c),r!==a?n=n||{l_start:s,s_start:c}:(n&&!n.complete&&(n.l_end=s,n.s_end=c,n.complete=!0),c++),s++;n&&!n.complete&&(n.complete=!0,n.s_end=o.length,n.l_end=i.length);if(n)return t.length>e.length?{newStart:n.l_start,newEnd:n.l_end,type:"add"}:{newStart:n.s_start,newEnd:n.s_end,type:t.length<e.length?"remove":"replace"}}(t,n))?"remove"===r.type?r.newStart:r.newEnd:i)};function Dv(e,t){return{start:e,end:void 0===t?e:t}}function Rv(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}Pv.range=Dv;var Tv=function(){l(r,a);var n=p(r);function r(e,t){var i;return h(this,r),Rv(d(i=n.call(this,e,t)),"onFocus",function(e){var t=i.props.onFocus;i.setState({focussed:!0}),"function"==typeof t&&t(e)}),Rv(d(i),"onBlur",function(e){var t=i.props.onBlur;i.setState({focussed:!1}),"function"==typeof t&&t(e)}),Rv(d(i),"onKeydown",function(e){var t,n;13===e.which&&(e.preventDefault(),i.props.ctrlForNewline&&!(n=e).metaKey&&!n.ctrlKey||i.props.singleLine||(e.stopPropagation(),(n=Hg.getRangeAt(0))&&(n=n.cloneRange(),t=document.createElement("br"),n.deleteContents(),n.insertNode(t),n.setStartAfter(t),n.setEndAfter(t),Wg(n)),i.onInput(e)))}),Rv(d(i),"onInput",function(e){var t=i.props.onInput;"function"==typeof t&&t(Mv(i.node))}),Rv(d(i),"onKeyPress",function(e){i.onInputIEPolyfill&&i.onInputIEPolyfill(e)}),Rv(d(i),"onPaste",function(e){var t;i.onInputIEPolyfill&&i.onInputIEPolyfill(e),i.props.singleLine&&(t=(e.clipboardData||window.clipboardData).getData("text"),document.execCommand("insertText",!1,t.replace(/\n/g," ")),e.preventDefault())}),i.state={},(0<(e=window.navigator.userAgent).indexOf("MSIE ")||0<e.indexOf("Trident/"))&&(i.onInputIEPolyfill=function(t){var n=i.node.innerHTML;setTimeout(function(){var e=i.node.innerHTML;n!==e&&i.onInput(t)},0)}),i}return u(r,[{key:"componentWillUpdate",value:function(e,t){var n=this.node,t=t.focussed&&Gg(n);this.selected=t&&{range:t,text:Mv(n)}}},{key:"componentDidUpdate",value:function(){var e,t,n=this.selected;n&&(e=n.range,n=n.text,qg(t=this.node,(t=Mv(t))!==n?Pv(e,n,t):e))}},{key:"getClassName",value:function(){var e=this.props,t=e.className,n=e.placeholder;return[t||"","content-editable",!e.value&&n?"content-editable--with-placeholder":""].join(" ")}},{key:"render",value:function(e){var t=this,n=e.value,e=e.placeholder,n=Ov(n).replace(/\r?\n/g,"<br/>")+"<br/>";return I(1,"div",this.getClassName(),null,1,{contentEditable:"true",spellcheck:"false","data-placeholder":e||"",onInput:this.onInput,onKeypress:this.onKeypress,onPaste:this.onPaste,onFocus:this.onFocus,onBlur:this.onBlur,onKeydown:this.onKeydown,dangerouslySetInnerHTML:{__html:n}},null,function(e){return t.node=e})}}]),r}();function Mv(e){return e.innerText.replace(/\n$/,"")}function Iv(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var Av=function(){l(r,a);var i=p(r);function r(e,t){var n;h(this,r),Iv(d(n=i.call(this,e,t)),"onFocus",function(e){n.setState({focussed:!0});var t=n.props.onFocus;"function"==typeof t&&t(e)}),Iv(d(n),"onBlur",function(e){n.setState({focussed:!1});n.state.invalid&&n.setState({changing:!1,invalid:!1});var t=n.props.onBlur;"function"==typeof t&&t(e)}),n.state={changing:!1,focussed:!1};e=t.injector.get("debounceInput");return n.inputChanged=e(function(e){var t=n.props.onChange,t=("function"==typeof t&&t(e),n.state.changing);n.setState({changing:t!==e&&t})}),n.onInput=function(e){var t=(n.props.validate||function(){})(e);n.setState({changing:e,invalid:t}),t||n.inputChanged(e)},n}return u(r,[{key:"getClassName",value:function(){var e=this.props,t=e.className,e=e.value,n=this.state,i=n.changing;return t+=" editable",n.focussed&&(t+=" focussed"),n.invalid&&(t+=" invalid"),e||i||(t+=" empty"),t}},{key:"getDisplayValue",value:function(){var e=this.props,t=e.value,e=e.placeholder,n=this.state,i=n.focussed,n=n.changing;return t=(t="string"==typeof n?n:t)||!i&&e||""}},{key:"getEditor",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return A(2,Tv,{className:e.className,ctrlForNewline:e.ctrlForNewline,onFocus:this.onFocus,onBlur:this.onBlur,onInput:this.onInput,value:this.getDisplayValue()})}}]),r}();function Nv(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var Bv=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),Nv(d(n=i.call(this,e,t)),"onElementsChanged",function(){n.forceUpdate()}),Nv(d(n),"setAnnotationValue",function(e){var t=n.props.row;n.modeling.editAnnotation(t.businessObject,e)}),Im(d(n)),n}return u(r,[{key:"componentWillMount",value:function(){var e=this.props.row;this.changeSupport.onElementsChanged(e.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.props.row;this.changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"render",value:function(){var e=this.props,t=e.row,e=e.rowIndex,n=t.businessObject,i=n.description,n=n.id;return A(2,$m,{className:"annotation",onChange:this.setAnnotationValue,coords:"".concat(e,":annotation"),value:i,elementId:n,"data-row-id":t.id,children:A(2,Lv,{ctrlForNewline:!0,className:"annotation-editor",onChange:this.setAnnotationValue,value:i})})}}]),r}(),Lv=(Bv.$inject=["changeSupport","modeling"],function(){l(t,Av);var e=p(t);function t(){return h(this,t),e.apply(this,arguments)}return u(t,[{key:"render",value:function(){return I(1,"div",this.getClassName(),this.getEditor(),0)}}]),t}());function Vv(e){e.onGetComponent("cell",function(e){e=e.cellType;return"after-label-cells"===e?Km:"after-rule-cells"===e?Bv:void 0})}Vv.$inject=["components"];function $v(t){return function(e){return!1!==t?ve(e,g(t)?t:300):e}}$v.$inject=["config.debounceInput"];var $a={debounceInput:["factory",$v]},zv={__depends__:[$a],__init__:["annotationsProvider"],annotationsProvider:["type",Vv]};function Fv(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var Uv={position:"absolute"},Hv=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),Fv(d(n=i.call(this,e,t)),"open",function(e){var t=e.position,e=e.context;n.close(),n.setState({isOpen:!0,position:t||{x:0,y:0},context:e||{}})}),Fv(d(n),"close",function(){n.state.isOpen&&n.setState({context:void 0,isOpen:!1,position:{x:0,y:0}})}),Fv(d(n),"triggerClose",function(){n.eventBus.fire("contextMenu.close")}),n.state={isOpen:!1,position:{x:0,y:0}},Im(d(n)),n}return u(r,[{key:"componentDidMount",value:function(){this.eventBus.on("contextMenu.open",this.open),this.eventBus.on("contextMenu.close",this.close)}},{key:"componentWillUnmount",value:function(){this.eventBus.off("contextMenu.open",this.open),this.eventBus.off("contextMenu.close",this.close)}},{key:"render",value:function(){var e=this.state,t=e.isOpen,n=e.context,e=e.position;return t&&(t=this.components.getComponents("context-menu",n)).length?A(2,Wv,{className:"context-menu no-deselect",context:n,position:e,offset:n.offset||{x:0,y:0},autoFocus:!1!==n.autoFocus,autoClose:!1!==n.autoClose,components:t,onClose:this.triggerClose}):null}}]),r}(),Wv=(Hv.$inject=["eventBus","components"],function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),Fv(d(n=i.call(this,e,t)),"onGlobalMouseDown",function(e){n.checkClose(e.target)}),Fv(d(n),"onGlobalKey",function(e){var t=e.which;13!==t&&27!==t||(e.stopPropagation(),e.preventDefault(),n.close())}),Fv(d(n),"onFocusChanged",function(e){n.checkClose(e.target)}),Fv(d(n),"setNode",function(e){n.node=e;var t=n.props.autoFocus;e&&(n.updatePosition(),t)&&(t=b(Gv,t=e))&&(t.focus(),t.selectionStart&&"text"===t.type?t.selectionStart=1e5:"contentEditable"in t&&qg(t,{start:1e5,end:1e5}))}),Im(d(n)),n}return u(r,[{key:"close",value:function(){var e=this.props.onClose;te(e)&&e()}},{key:"checkClose",value:function(e){var t;this.props.autoClose&&(t=this.node)&&t!==e&&!t.contains(e)&&this.close()}},{key:"componentDidMount",value:function(){document.addEventListener("focusin",this.onFocusChanged),document.addEventListener("keydown",this.onGlobalKey),document.addEventListener("mousedown",this.onGlobalMouseDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("focusin",this.onFocusChanged),document.removeEventListener("keydown",this.onGlobalKey),document.removeEventListener("mousedown",this.onGlobalMouseDown)}},{key:"updatePosition",value:function(){var e=this.props,t=e.position,e=e.offset,n=this.node,i=n.getBoundingClientRect();t.width||(t.width=0),t.height||(t.height=0);var r,o,a,s=this.renderer.getContainer().getBoundingClientRect(),c=(s.width>s.height?(this.node.classList.add("horizontal"),this.node.classList.remove("vertical")):(this.node.classList.add("vertical"),this.node.classList.remove("horizontal")),(c=Cn(c=n,".tjs-container"))?(u=c.scrollLeft,{scrollTop:c.scrollTop,scrollLeft:u}):{scrollTop:0,scrollLeft:0}),u=c.scrollLeft,c=c.scrollTop,l={};"left"===((r=t.align?t.align.split("-"):r)&&r[1]||(t.x+t.width/2>s.width/2?"left":"right"))?(o=t.x-s.left-i.width+e.x+u,n.classList.remove("right"),n.classList.add("left")):(o=-s.left+t.x+t.width-e.x+u,n.classList.remove("left"),n.classList.add("right")),o=r?o:qv(o,0+u,s.width-i.width+u),l.left=o+"px","top"===(r&&r[0]||(t.y+t.height/2>s.height/2?"top":"bottom"))?(a=t.y-s.top-i.height+e.y+c,n.classList.remove("bottom"),n.classList.add("top")):(a=-s.top+t.y-e.y+c,n.classList.remove("top"),n.classList.add("bottom")),a=r?a:qv(a,0+c,s.height-i.height+c),l.top=a+"px",l.overflowY="auto",l.maxHeight=s.height-a+c+"px",C(this.node.style,Uv,l)}},{key:"render",value:function(){var e=this.props,n=e.context,t=e.components;return I(1,"div",e.className,t.map(function(e,t){return A(2,e,{context:n},t)}),0,{onContextMenu:function(e){return e.preventDefault()}},null,this.setNode)}}]),r}());function qv(e,t,n){return Math.max(t,Math.min(n,e))}Wv.$inject=["renderer"];var Gv="\n  input[type=text],\n  input[type=number],\n  input[type=button],\n  input[type=submit],\n  [contenteditable],\n  [tabindex],\n  a[href],\n  textarea,\n  button\n";var Tc=function(){function i(e,t,n){h(this,i),this._eventBus=t,e.onGetComponent("table.before",function(){return Hv})}return u(i,[{key:"open",value:function(e,t){this._eventBus.fire("contextMenu.open",{position:e,context:t})}},{key:"close",value:function(){this._eventBus.fire("contextMenu.close")}}]),i}(),Kv=(Tc.$inject=["components","eventBus","renderer"],{__init__:["contextMenu"],contextMenu:["type",Tc]});function Xv(e){return!e.altKey&&(e.ctrlKey||e.metaKey)}function Yv(e){return e.shiftKey}function Zv(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var Ho=function(){function c(e,t,n,i,r,o,a){var s=this;h(this,c),Zv(this,"_clearClipboard",function(){s._clipboard.clear()}),Zv(this,"_registerBindings",function(){[function(e,t){if(Xv(t)&&67===e){e=s._getSelectedCell();if(e)return Yv(t)?s._editorActions.trigger("copy",{element:e.col}):s._editorActions.trigger("copy",{element:e.row}),!0}},function(e,t){if(Xv(t)&&88===e){e=s._getSelectedCell();if(e)return Yv(t)?s._editorActions.trigger("cut",{element:e.col}):s._editorActions.trigger("cut",{element:e.row}),!0}},function(e,t){var n;if(Xv(t)&&86===e){e=s._getSelectedCell();if(!e)return;Yv(t)?(n=s._editorActions.trigger("pasteAfter",{element:e.col}))&&s._cellSelection.selectCell("right"):(n=s._editorActions.trigger("pasteAfter",{element:e.row}))&&s._cellSelection.selectCell("below")}return void 0!==n}].forEach(function(e){s._keyboard.addListener(e)})}),this._clipboard=n,this._cellSelection=i,this._elementRegistry=r,this._editorActions=o,this._keyboard=e.get("keyboard",!1),this._renderer=a,this._keyboard&&(t.on("keyboard.init",this._registerBindings),t.on("keyboard.bind",function(){E.bind(document,"copy",s._clearClipboard,!0),E.bind(document,"cut",s._clearClipboard,!0)}),t.on("keyboard.unbind",function(){E.unbind(document,"copy",s._clearClipboard,!0),E.unbind(document,"cut",s._clearClipboard,!0)}))}return u(c,[{key:"_getSelectedCell",value:function(){var e=this._cellSelection.getCellSelection();if(e){var t=this._elementRegistry.get(e);if(t){var e=iv(e,this._renderer.getContainer()),n=ov(e);if(document.activeElement===n){n=Gg(e);if(!n||n.start===n.end)return t}}}}}]),c}(),Qv=(Ho.$inject=["injector","eventBus","clipboard","cellSelection","elementRegistry","editorActions","renderer"],{__depends__:[Nd,cv],__init__:["copyCutPasteKeyBindings"],copyCutPasteKeyBindings:["type",Ho]});function Jv(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var ey=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),Jv(d(n=i.call(this,e,t)),"onClick",function(e){n.editorActions.trigger("addInput")}),Im(d(n)),n}return u(r,[{key:"render",value:function(){return I(1,"th","input-cell create-inputs header actionable",[this.translate("Input"),N(" "),I(1,"span","add-input dmn-icon-plus action-icon",null,1,{title:this.translate("Add Input")})],0,{onClick:this.onClick,title:this.translate("Add Input")})}}]),r}();function ty(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}ey.$inject=["editorActions","translate"];var ny=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),ty(d(n=i.call(this,e,t)),"onClick",function(e){n.editorActions.trigger("addInput")}),Im(d(n)),n}return u(r,[{key:"render",value:function(){return I(1,"td","input-cell create-inputs",N("-"),2,{onClick:this.onClick,title:this.translate("Add Input")})}}]),r}(),ca=(ny.$inject=["editorActions","translate"],u(function e(t,n){h(this,e),t.onGetComponent("cell",500,function(e){var e=e.cellType,t=n.getRoot().businessObject;if(!t.input||!t.input.length)return"before-label-cells"===e?ey:"before-rule-cells"===e?ny:void 0})})),iy=(ca.$inject=["components","sheet"],{__depends__:[kv],__init__:["createInputsProvider"],createInputsProvider:["type",ca]}),ry=["string","boolean","number","date","time","dateTime","dayTimeDuration","yearMonthDuration","Any"],js=function(){function t(e){h(this,t),this._dataTypes=e||ry}return u(t,[{key:"getAll",value:function(){return this._dataTypes}}]),t}(),oy=(js.$inject=["config.dataTypes"],{__init__:["dataTypes"],dataTypes:["type",js]}),Yo=function(){function p(r,i,e,t,n,o,a,s,c,u,l){h(this,p);var d=this;this._contextMenu=i,this._clipboard=e,this._editorActions=t,this._elementRegistry=o,this._eventBus=n,this._modeling=a,this._selection=s,this._sheet=c,this._rules=u,this._translate=l,this._getEntries=this._getEntries.bind(this),r.onGetComponent("context-menu",function(){var e,t,n,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(i.contextMenuType&&"context-menu"===i.contextMenuType)return e=d._getEntries(i),t=d._elementRegistry.get(i.id),(t=t instanceof Fh&&r.getComponents("context-menu-cell-additional",i))&&t.length?(n=I(1,"div","context-menu-group context-menu-group-cell",t,0),function(){return I(1,"div","context-menu-flex",(e||[]).concat(n),0)}):function(){return I(1,"div","context-menu-flex",e||[],0)}}),n.on("cell.contextmenu",function(e){var t=e.event,n=e.id;e.node;t.preventDefault(),i.open({x:t.pageX,y:t.pageY},{contextMenuType:"context-menu",event:t,id:n})})}return u(p,[{key:"_getEntries",value:function(n){var e,t,i,r,o,a,s,c=this,u=function(e){var t=e.cells.map(function(e){return e.id}).indexOf(n.id),e=c._editorActions.trigger("addRuleAbove",{rule:e});e.cells[t]?c._selection.select(e.cells[t]):c._selection.select(e.cells[0]),c._contextMenu.close()},l=function(e){var t=e.cells.map(function(e){return e.id}).indexOf(n.id),e=c._editorActions.trigger("addRuleBelow",{rule:e});e.cells[t]?c._selection.select(e.cells[t]):c._selection.select(e.cells[0]),c._contextMenu.close()},d=function(e){c._editorActions.trigger("removeRule",{rule:e}),c._contextMenu.close()},p=function(e){c._editorActions.trigger("addInputLeft",{input:e}),c._contextMenu.close()},h=function(e){c._editorActions.trigger("addInputRight",{input:e}),c._contextMenu.close()},f=function(e){c._editorActions.trigger("removeInput",{input:e}),c._contextMenu.close()},m=function(e){c._editorActions.trigger("addOutputLeft",{output:e}),c._contextMenu.close()},g=function(e){c._editorActions.trigger("addOutputRight",{output:e}),c._contextMenu.close()},v=function(e){c._editorActions.trigger("removeOutput",{output:e}),c._contextMenu.close()},y=function(e){c._editorActions.trigger("copy",{element:e}),c._contextMenu.close()},_=function(e){c._editorActions.trigger("cut",{element:e}),c._contextMenu.close()},b=function(e){c._editorActions.trigger("pasteBefore",{element:e}),c._contextMenu.close()},x=function(e){c._editorActions.trigger("pasteAfter",{element:e}),c._contextMenu.close()},w=n&&n.id;return(w=w&&this._elementRegistry.get(w))?(e=this._clipboard.get()||{},t=[],k(i=w.row||w,"dmn:DecisionRule")?(s=this._rules.allowed("paste",{data:e.elements,target:i}),t.push(I(1,"div","context-menu-group",[I(1,"div","context-menu-group-entry context-menu-entry-copy-rule",this._translate("Copy Rule"),0,{onClick:function(){return y(i)}}),I(1,"div","context-menu-group-entry context-menu-entry-cut-rule",this._translate("Cut Rule"),0,{onClick:function(){return _(i)}}),I(1,"div","context-menu-group-entry ".concat(s?"":"disabled"," context-menu-entry-paste-rule-above"),this._translate("Paste Rule Above"),0,{onClick:function(){return b(i)}}),I(1,"div","context-menu-group-entry ".concat(s?"":"disabled"," context-menu-entry-paste-rule-below"),this._translate("Paste Rule Below"),0,{onClick:function(){return x(i)}})],4),I(1,"div","context-menu-group",[I(1,"div","context-menu-group-entry context-menu-entry-add-rule-above",this._translate("Add Rule Above"),0,{onClick:function(){return u(i)}}),I(1,"div","context-menu-group-entry context-menu-entry-add-rule-below",this._translate("Add Rule Below"),0,{onClick:function(){return l(i)}}),I(1,"div","context-menu-group-entry context-menu-entry-remove-rule",this._translate("Remove Rule"),0,{onClick:function(){return d(i)}})],4))):k(w,"dmn:InputClause")?(r=k(w,"dmn:InputClause")?w:w.col,s=this._rules.allowed("col.remove",{col:w.col||w}),a=this._rules.allowed("paste",{data:e.elements,target:w.col||w}),t.push(I(1,"div","context-menu-group",[I(1,"div","context-menu-group-entry context-menu-entry-copy-input",this._translate("Copy Input Column"),0,{onClick:function(){return y(r)}}),I(1,"div","context-menu-group-entry ".concat(s?"":"disabled"," context-menu-entry-cut-input"),this._translate("Cut Input Column"),0,{onClick:function(){return _(r)}}),I(1,"div","context-menu-group-entry ".concat(a?"":"disabled"," context-menu-entry-paste-input-left"),this._translate("Paste Input Column Left"),0,{onClick:function(){return b(r)}}),I(1,"div","context-menu-group-entry ".concat(a?"":"disabled"," context-menu-entry-paste-input-right"),this._translate("Paste Input Column Right"),0,{onClick:function(){return x(r)}})],4),I(1,"div","context-menu-group",[I(1,"div","context-menu-group-entry context-menu-entry-add-input-left",this._translate("Add Input Column Left"),0,{onClick:function(){return p(r)}}),I(1,"div","context-menu-group-entry context-menu-entry-add-input-right",this._translate("Add Input Column Right"),0,{onClick:function(){return h(r)}}),I(1,"div","context-menu-group-entry ".concat(s?"":"disabled"," context-menu-entry-remove-input"),this._translate("Remove Input Column"),0,{onClick:function(){return f(r)}})],4))):(k(w,"dmn:OutputClause")||k(w.col,"dmn:OutputClause"))&&(o=k(w,"dmn:OutputClause")?w:w.col,a=this._rules.allowed("col.remove",{col:w.col||w}),s=this._rules.allowed("paste",{data:e.elements,target:w.col||w}),t.push(I(1,"div","context-menu-group",[I(1,"div","context-menu-group-entry context-menu-entry-copy-output",this._translate("Copy Output Column"),0,{onClick:function(){return y(o)}}),I(1,"div","context-menu-group-entry ".concat(a?"":"disabled"," context-menu-entry-cut-output"),this._translate("Cut Output Column"),0,{onClick:function(){return _(o)}}),I(1,"div","context-menu-group-entry ".concat(s?"":"disabled"," context-menu-entry-paste-output-left"),this._translate("Paste Output Column Left"),0,{onClick:function(){return b(o)}}),I(1,"div","context-menu-group-entry ".concat(s?"":"disabled"," context-menu-entry-paste-output-right"),this._translate("Paste Output Column Right"),0,{onClick:function(){return x(o)}})],4),I(1,"div","context-menu-group",[I(1,"div","context-menu-group-entry context-menu-entry-add-output-left",this._translate("Add Output Column Left"),0,{onClick:function(){return m(o)}}),I(1,"div","context-menu-group-entry context-menu-entry-add-output-right",this._translate("Add Output Column Right"),0,{onClick:function(){return g(o)}}),I(1,"div","context-menu-group-entry ".concat(a?"":"disabled"," context-menu-entry-remove-output"),this._translate("Remove Output Column"),0,{onClick:function(){return v(o)}})],4))),t):null}}]),p}();Yo.$inject=["components","contextMenu","clipboard","editorActions","eventBus","elementRegistry","modeling","selection","sheet","rules","translate"];var ay=["row.add","row.remove","col.add","col.remove"],yl=u(function e(t,n){h(this,e),n.on("commandStack.executed",function(e){e=e.command;-1!==ay.indexOf(e)&&t.close()}),n.on("commandStack.reverted",function(){t.close()})}),sy=(yl.$inject=["contextMenu","eventBus"],{__depends__:[kv,Kv,e],__init__:["decisionTableContextMenu","contextMenuCloseBehavior"],decisionTableContextMenu:["type",Yo],contextMenuCloseBehavior:["type",yl]});function cy(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var uy=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),cy(d(n=i.call(this,e,t)),"onClick",function(e){var t=n.props.output;n._eventBus.fire("output.edit",{event:e,output:t})}),cy(d(n),"onContextmenu",function(e){var t=n.props.output.id;n._eventBus.fire("cell.contextmenu",{event:e,id:t})}),cy(d(n),"onElementsChanged",function(){n.forceUpdate()}),Nm(d(n),qm),n._translate=t.injector.get("translate"),n}return u(r,[{key:"componentWillMount",value:function(){var e=this.context.injector,e=(this._changeSupport=this.context.changeSupport,this._eventBus=e.get("eventBus"),this._elementRegistry=e.get("elementRegistry"),this.props.output);this._changeSupport.onElementsChanged(e.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.props.output;this._changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"render",value:function(){var e=this.props,t=e.output,n=e.index,e=e.outputsLength,i=t.label,r=t.name,o=t.outputValues,a=t.typeRef,s=t.width?t.width+"px":"192px";return I(1,"th","output-cell output-editor",[this.slotFills({type:"cell-inner",context:{cellType:"output-cell",col:this._elementRegistry.get(t.id),index:n,outputsLength:e},col:t}),I(1,"div","clause",0===n?this._translate("Then"):this._translate("And"),0),i?I(1,"div","output-label",i,0,{title:this._translate("Output Label: ")+i}):I(1,"div","output-name",r,0,{title:this._translate("Output Name: ")+r}),I(1,"div","output-variable",o&&o.text||this._translate(a),0,{title:o&&o.text?this._translate("Output Values"):this._translate("Output Type")})],0,{"data-col-id":t.id,onDblClick:this.onClick,onContextmenu:this.onContextmenu,style:{width:s}})}}]),r}();function ly(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var dy=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),ly(d(n=i.call(this,e,t)),"onInput",function(e){var t=n.props.onInput;"function"==typeof t&&t(e.target.value)}),ly(d(n),"onKeyDown",function(e){var t=n.props.onKeyDown;"function"==typeof t&&t(e)}),ly(d(n),"onKeyUp",function(e){var t=n.props.onKeyUp;"function"==typeof t&&t(e)}),n}return u(r,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.placeholder,i=e.type,e=e.value;return I(64,"input",[t||"","dms-input"].join(" "),null,1,{placeholder:n||"",onInput:this.onInput,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,spellcheck:"false",type:i||"text",value:e})}}]),r}(),py=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),(n=i.call(this,e,t)).translate=t.injector?t.injector.get("translate"):hy,n.setName=function(e){n.handleChange({name:e=e||void 0})},n.setLabel=function(e){n.handleChange({label:e=e||void 0})},n}return u(r,[{key:"handleChange",value:function(e){var t=this.props.onChange;"function"==typeof t&&t(e)}},{key:"render",value:function(){var e=this.props,t=e.name,e=e.label;return I(1,"div","context-menu-container ref-output-editor output-edit",[I(1,"div","dms-form-control",A(2,Tv,{className:"dms-output-label",value:e||"",placeholder:this.translate("Output"),singleLine:!0,onInput:this.setLabel}),2),I(1,"div","dms-form-control",[I(1,"label","dms-label",this.translate("Output Name"),0),A(2,dy,{className:"ref-output-name",value:t||"",onInput:this.setName})],4)],4)}}]),r}();function hy(e){return e}function fy(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function my(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fy(Object(n),!0).forEach(function(e){gy(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fy(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function gy(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var vy=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),gy(d(n=i.call(this,e,t)),"persistChanges",function(){var e=n.props.context.output,t=n.state.unsaved;t&&(n.modeling.updateProperties(e,t),n.setState({unsaved:!1}))}),gy(d(n),"handleChange",function(e){n.setState({unsaved:my(my({},n.state.unsaved),e)},n.persistChanges)}),n.state={},Im(d(n)),n.persistChanges=n.debounceInput(n.persistChanges),n}return u(r,[{key:"getValue",value:function(e){var t=this.props.context.output,n=this.state.unsaved;return n&&e in n?n[e]:t.get(e)}},{key:"render",value:function(){return A(2,py,{name:this.getValue("name"),label:this.getValue("label"),onChange:this.handleChange})}}]),r}(),ia=(vy.$inject=["debounceInput","modeling"],u(function e(t,r,n,i){h(this,e),t.onGetComponent("cell",function(e){if("output-header"===e.cellType)return uy}),t.onGetComponent("context-menu",function(){if("output-edit"===(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).contextMenuType)return vy}),n.on("output.edit",function(e){var t=e.event,e=e.output,t=Cn(t.target,"th",!0),n=t.getBoundingClientRect(),i=n.left,n=n.top,t=function(e){if(!wn(e,".output-cell + .output-cell"))return{x:-1,y:0}}(t);r.open({x:i,y:n,align:"bottom-right"},{contextMenuType:"output-edit",output:e,offset:t})})}));function yy(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}ia.$inject=["components","contextMenu","eventBus","renderer"];var _y=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),yy(d(n=i.call(this,e,t)),"onClick",function(e){var t=n.props.input;n._eventBus.fire("input.edit",{event:e,input:t})}),yy(d(n),"onContextmenu",function(e){var t=n.props.input.id;n._eventBus.fire("cell.contextmenu",{event:e,id:t})}),yy(d(n),"onElementsChanged",function(){n.forceUpdate()}),Nm(d(n),qm),n._translate=t.injector.get("translate"),n}return u(r,[{key:"componentWillMount",value:function(){var e=this.context.injector,e=(this._changeSupport=this.context.changeSupport,this._sheet=e.get("sheet"),this._eventBus=e.get("eventBus"),this._elementRegistry=e.get("elementRegistry"),this._sheet.getRoot()),t=this.props.input;this._changeSupport.onElementsChanged(e.id,this.onElementsChanged),this._changeSupport.onElementsChanged(t.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this._sheet.getRoot(),t=this.props.input;this._changeSupport.offElementsChanged(e.id,this.onElementsChanged),this._changeSupport.offElementsChanged(t.id,this.onElementsChanged)}},{key:"render",value:function(){var e=this.props,t=e.input,n=e.index,e=e.inputsLength,i=t.inputExpression,r=t.inputValues,o=t.get("label"),a=t.width?t.width+"px":"192px";return I(1,"th","input-cell input-editor",[this.slotFills({type:"cell-inner",context:{cellType:"input-cell",col:this._elementRegistry.get(t.id),index:n,inputsLength:e},col:t}),I(1,"div","clause",0===n?this._translate("When"):this._translate("And"),0),o?I(1,"div","input-label",o,0,{title:this._translate("Input Label: ")+o}):I(1,"div","input-expression",i.text,0,{title:this._translate("Input Expression: ")+i.text}),I(1,"div","input-variable",r&&r.text||this._translate(i.typeRef),0,{title:r&&r.text?this._translate("Input Values"):this._translate("Input Type")})],0,{"data-col-id":t.id,onDblClick:this.onClick,onContextmenu:this.onContextmenu,style:{width:a}})}}]),r}(),by=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),(n=i.call(this,e,t)).translate=t.injector?t.injector.get("translate"):xy,n.handleValue=function(e){n.handleChange({text:e})},n.handleLabelChange=function(e){n.handleChange({label:e||void 0})},n}return u(r,[{key:"handleChange",value:function(e){var t=this.props.onChange;"function"==typeof t&&t(e)}},{key:"render",value:function(){var e=this.props,t=e.label,e=e.text;return I(1,"div","context-menu-container ref-input-editor input-edit",[I(1,"div","dms-form-control",A(2,Tv,{className:"dms-input-label",value:t||"",placeholder:this.translate("Input"),singleLine:!0,onInput:this.handleLabelChange}),2),I(1,"div","dms-form-control",[I(1,"label","dms-label",this.translate("Expression"),0),A(2,Tv,{placeholder:this.translate("enter expression"),className:["ref-text","dms-input"].join(" "),onInput:this.handleValue,value:e||""})],4)],4)}}]),r}();function xy(e){return e}var wy=["label"];function Cy(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function Ey(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Cy(Object(n),!0).forEach(function(e){Sy(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cy(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ky(e,t){if(null==e)return{};var n,i=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);return i}function Sy(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var jy=function(){l(i,a);var n=p(i);function i(e,t){var o;return h(this,i),Sy(d(o=n.call(this,e,t)),"persistChanges",function(){var e,t,n,i=o.props.context.input,r=o.state.unsaved;r&&(e=r.label,t=ky(r,wy),n={},"label"in r&&(n.label=e),Object.keys(t).length&&(n.inputExpression=t),o.modeling.updateProperties(i,n),o.setState({unsaved:!1}))}),Sy(d(o),"handleChange",function(e){o.setState({unsaved:Ey(Ey({},o.state.unsaved),e)},o.persistChanges)}),o.state={},Im(d(o)),o.persistChanges=o.debounceInput(o.persistChanges),o}return u(i,[{key:"getValue",value:function(e){var t=this.props.context.input,n=this.state.unsaved,i=t;return"text"===e&&(i=t.inputExpression),n&&e in n?n[e]:i.get(e)}},{key:"render",value:function(){return A(2,by,{label:this.getValue("label"),text:this.getValue("text"),onChange:this.handleChange})}}]),i}();jy.$inject=["debounceInput","modeling","injector"];bc=u(function e(t,i,n,r){h(this,e),t.onGetComponent("cell",function(e){if("input-header"===e.cellType)return _y}),t.onGetComponent("context-menu",function(){if("input-edit"===(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).contextMenuType)return jy}),n.on("input.edit",function(e){var t=e.event,e=e.input,t=Cn(t.target,"th",!0).getBoundingClientRect(),n=t.left,t=t.top;i.open({x:n,y:t,align:"bottom-right"},{contextMenuType:"input-edit",input:e})})});function Oy(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}bc.$inject=["components","contextMenu","eventBus","renderer"];var Py=function(){l(r,a);var n=p(r);function r(e,t){h(this,r),Oy(d(i=n.call(this,e,t)),"onChange",function(e){i.setState({value:e});var t=i.props.onChange;"function"==typeof t&&t(e)}),Oy(d(i),"onInputClick",function(e){e.preventDefault(),e.stopPropagation(),i.setOptionsVisible(!i.state.optionsVisible),i.focusInput()}),Oy(d(i),"onInput",function(e){e=e.target.value;i.onChange(e)}),Oy(d(i),"onOptionClick",function(e,t){t.preventDefault(),t.stopPropagation(),i.setOptionsVisible(!1),i.onChange(e),i.focusInput()}),Oy(d(i),"onFocusChanged",function(e){i.checkClose(e.target)}),Oy(d(i),"onGlobalClick",function(e){i.checkClose(e.target)}),Oy(d(i),"onKeyDown",function(e){var t=i.state.optionsVisible,n=e.which;40!==n&&38!==n||(e.stopPropagation(),e.preventDefault(),t?i.select(40===n?1:-1):i.setOptionsVisible(!0)),!t||13!==n&&27!==n||(e.stopPropagation(),e.preventDefault(),i.setOptionsVisible(!1))}),Oy(d(i),"onKeyboard",function(e){return i.state.optionsVisible&&27===e?(i.setOptionsVisible(!1),!0):void 0}),Im(d(i));var i,t=e.value;return i.state={value:t,optionsVisible:!1},i._portalEl=null,i}return u(r,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onGlobalClick),document.addEventListener("focusin",this.onFocusChanged),this.keyboard.addListener(this.onKeyboard)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("focusin",this.onFocusChanged),document.removeEventListener("mousedown",this.onGlobalClick),this.keyboard.removeListener(this.onKeyboard),this.removePortalEl()}},{key:"componentWillReceiveProps",value:function(e){e=e.value;this.setState({value:e})}},{key:"componentWillUpdate",value:function(e,t){t.optionsVisible?this._portalEl||this.addPortalEl():this._portalEl&&this.removePortalEl()}},{key:"componentDidUpdate",value:function(){var e;this.state.optionsVisible&&this.inputNode&&(e=this.getOptionsBounds(),C(this._portalEl.style,e))}},{key:"getOptionsBounds",value:function(){var e=this.renderer.getContainer(),t=e.getBoundingClientRect(),n=t.top,i=t.left,t=t.bottom,r=this.inputNode.getBoundingClientRect(),o=r.top,a=r.left,s=r.width,c=r.height,r=r.bottom,n=o+c-n+e.scrollTop,a=a-i+e.scrollLeft,i={top:"".concat(n,"px"),left:"".concat(a,"px"),width:"".concat(s,"px"),"max-height":"calc(100% - ".concat(n,"px)")};return t-r<c&&(i.bottom="".concat(e=t-o,"px"),i["max-height"]="calc(100% - ".concat(e,")"),delete i.top),i}},{key:"addPortalEl",value:function(){this._portalEl=_('<div class="dms-select-options"></div>'),this.renderer.getContainer().appendChild(this._portalEl),this._portalEl.addEventListener("mousedown",Dy)}},{key:"removePortalEl",value:function(){this._portalEl&&(this._portalEl.removeEventListener("mousedown",Dy),Tn(this._portalEl),this._portalEl=null)}},{key:"focusInput",value:function(){var e=this.inputNode;e.focus(),"selectionStart"in e&&(e.selectionStart=1e5)}},{key:"checkClose",value:function(e){!this._portalEl||this._portalEl.contains(e)||this.parentNode.contains(e)||this.setOptionsVisible(!1)}},{key:"select",value:function(e){var t,n=this.props.options,i=this.state.value;n&&(t=(t=n.filter(function(e){return e.value===i})[0])?n.indexOf(t):-1,e=n[(t=-1===t?1===e?0:n.length-1:(t+e)%n.length)<0?n.length+t:t],this.onChange(e.value))}},{key:"setOptionsVisible",value:function(e){this.setState({optionsVisible:e})}},{key:"renderOptions",value:function(e,n){var i=this;return I(1,"div","options",e.map(function(t){return I(1,"div",["option",n===t?"active":""].join(" "),t.label,0,{"data-value":t.value,onClick:function(e){return i.onOptionClick(t.value,e)}})}),0)}},{key:"render",value:function(){var t=this,e=this.props,n=e.className,i=e.options,r=e.noInput,e=e.title,o=this.state,a=o.optionsVisible,s=o.value,o=!!i&&i.filter(function(e){return e.value===s})[0],c=o?o.label:s;return I(1,"div",[n||"","dms-input-select"].join(" "),[r?I(1,"div","dms-input",c,0,{tabindex:"0",onKeyDown:this.onKeyDown},null,function(e){return t.inputNode=e}):I(64,"input","dms-input",null,1,{onInput:this.onInput,onKeyDown:this.onKeyDown,spellcheck:"false",type:"text",value:s},null,function(e){return t.inputNode=e}),I(1,"span",["dms-input-select-icon",a?"dmn-icon-up":"dmn-icon-down"].join(" ")),a&&(n=this.renderOptions(i,o),I(1024,this._portalEl,null,n,0,null,Zh(n)?null:n.key,null))],0,{title:e,onClick:this.onInputClick},null,function(e){return t.parentNode=e})}}]),r}();function Dy(e){e.stopPropagation()}function Ry(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}Py.$inject=["keyboard","renderer"];var Ty=function(){l(r,a);var n=p(r);function r(e,t){var i;return h(this,r),Ry(d(i=n.call(this,e)),"onTypeChange",function(e){var t,n=i.getElement(),n=k(n,"dmn:LiteralExpression")?n.$parent:n;x(n)?t={inputExpression:{typeRef:e}}:qn(n)&&(t={typeRef:e}),i._modeling.updateProperties(n,t)}),i._translate=t.injector.get("translate"),i._modeling=t.injector.get("modeling"),i._dataTypes=t.injector.get("dataTypes"),i}return u(r,[{key:"getElement",value:function(){return this.props.context.input||this.props.context.output}},{key:"render",value:function(){var t=this,e=this.getElement(),e=(k(e,"dmn:InputClause")?e.inputExpression:e).typeRef,n=this._dataTypes.getAll().map(function(e){return{label:t._translate(e),value:e}});return I(1,"div","type-ref-edit context-menu-container",I(1,"div","dms-form-control",[I(1,"label","dms-label",[this._translate("Type"),N(":")],0),A(2,Py,{className:"type-ref-edit-select",onChange:this.onTypeChange,options:n,value:e})],4),2)}}]),r}(),Oc=u(function e(t){h(this,e),t.onGetComponent("context-menu",750,function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).contextMenuType;if("input-edit"===e||"output-edit"===e)return Ty})}),ml=(Oc.$inject=["components"],{__depends__:[Kv,oy],__init__:["typeRefEditingProvider"],typeRefEditingProvider:["type",Oc]}),Nl=function(){l(i,ql);var t=p(i);function i(e,n){return h(this,i),(e=t.call(this,e)).postExecuted("element.updateProperties",function(e){var e=e.context,t=e.element,e=e.properties,e=x(t)?e.inputExpression:e;e&&e.typeRef&&"string"!==e.typeRef&&(e=k(t,"dmn:LiteralExpression")?t.$parent:t,n.editAllowedValues(e,null))}),e}return u(i)}();function My(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}Nl.$inject=["eventBus","modeling"];var Iy=function(){l(i,a);var n=p(i);function i(e,t){h(this,i),My(d(r=n.call(this,e,t)),"getRemoveClickHandler",function(t){return function(e){e.stopPropagation(),r.removeItem(t)}}),My(d(r),"getToggleClickHandler",function(t){return function(e){e.stopPropagation(),r.toggleItem(t)}}),My(d(r),"removeItem",function(t){var e=r.props.onChange,n=r.state.items.filter(function(e){return e!==t});r.setState({items:n}),e&&e(n)}),My(d(r),"toggleItem",function(t){var e=r.props,n=e.onChange,i=e.type,e=r.state.items.map(function(e){return e===t?e.isChecked=!e.isChecked:"radio"===i&&(e.isChecked=!1),e});r.setState({items:e}),n&&n(e)});var r,t=e.items;return r.state={items:t},r}return u(i,[{key:"componentWillReceiveProps",value:function(e){e=e.items;this.setState({items:e})}},{key:"render",value:function(){var n=this,e=this.props,t=e.className,i=e.items,r=e.type,o=e.labelComponent,e=["dms-list-component"];t&&e.push(t);t=function(e){var t,n=[];for(t in e)n.push([t,e[t]]);return n}(de(i,"group"));return I(1,"div",e.join(" "),t.map(function(e){var t=e[0],e=e[1];return I(1,"div","group",[o&&o(t)||I(1,"h4","dms-heading",t,0),I(1,"ul","items no-wrap",e.map(function(e){return I(1,"li","item",[r&&I(64,"input","item-toggle",null,1,{type:r,checked:e.isChecked,onClick:n.getToggleClickHandler(e)}),N(""),e.value,e.isRemovable&&I(1,"span","remove dmn-icon-clear",null,1,{title:"Remove item",onClick:n.getRemoveClickHandler(e)})],0)}),0)],0)}),0)}}]),i}();var Ay=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),t=i.call(this,e,t);var n=e.validate,e=e.value,n=n?n(e||""):void 0;return t.state={validationWarning:n,value:e},t.onInput=t.onInput.bind(d(t)),t.onKeyDown=t.onKeyDown.bind(d(t)),t.onKeyUp=t.onKeyUp.bind(d(t)),t}return u(r,[{key:"componentWillReceiveProps",value:function(e){var t=e.validate,e=e.value,t=t?t(e||""):void 0;this.setState({validationWarning:t,value:e})}},{key:"onInput",value:function(e){var t=this.props,n=t.onInput,t=t.validate,t=t?t(e):void 0;this.setState({validationWarning:t,value:e}),"function"==typeof n&&n&&n({isValid:!t,value:e})}},{key:"onKeyDown",value:function(e){var t=e.target.value,n=this.props,i=n.onKeyDown,n=n.validate,n=n?n(t):void 0;"function"==typeof i&&i({isValid:!n,value:t,event:e})}},{key:"onKeyUp",value:function(e){var t=e.target.value,n=this.props,i=n.onKeyUp,n=n.validate,n=n?n(t):void 0;"function"==typeof i&&i({isValid:!n,value:t,event:e})}},{key:"render",value:function(){var e=this.props,t=e.placeholder,n=e.type,e=e.className,i=this.state,r=i.validationWarning,i=i.value,e=["dms-validated-input",e].join(" "),o=[];return r&&o.push("invalid"),I(1,"div",e,[A(2,dy,{className:o,onInput:this.onInput,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,placeholder:t||"",type:n,value:i||""}),r&&I(1,"p","dms-hint dms-validation-warning",r,0)],0)}}]),r}();function Ny(e){var t,n;return e&&""!==e.trim()?(e=e.split(","),t={values:[]},n="",e.forEach(function(e){n+=e,/^"[^"]*"$/.test(n.trim())?(t.values.push(n.trim()),n=""):n+=","}),n?void 0:t):{values:[]}}function By(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var Ly=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),By(d(n=i.call(this,e,t)),"onElementsChanged",function(){n.forceUpdate()}),By(d(n),"setPredefinedValues",function(e){var t=n.getAllowedValuesTarget();n.setState({values:e}),n._modeling.editAllowedValues(t,e&&e.map(function(e){return e.value}))}),By(d(n),"onListChange",function(e){n.setPredefinedValues(e)}),By(d(n),"onInput",function(e){e.isValid;e=e.value;n.setState({inputValue:e})}),By(d(n),"onKeyDown",function(e){var t=e.isValid,e=e.event;13===e.keyCode&&(e.stopPropagation(),e.preventDefault(),t)&&(t=(e=n.state).inputValue,e=e.values,t=Ny(t),n.onListChange((e||[]).concat(t.values.map(function(e){return{value:e,isCheckable:!1,isRemovable:!0,group:n._translate("Predefined Values")}}))),n.setState({inputValue:""}))}),By(d(n),"handleRemovePredifinedValuesClick",function(e){e.stopPropagation(),n.removePredefinedValues()}),By(d(n),"removePredefinedValues",function(){n.setPredefinedValues(null)}),n._translate=t.injector.get("translate"),n._modeling=t.injector.get("modeling"),n._changeSupport=t.changeSupport;var n,e=n.getAllowedValuesTarget(),t=Ny(e.inputValues&&e.inputValues.text||e.outputValues&&e.outputValues.text||"");return n.state=t?{values:t.values.map(function(e){return{value:e,isCheckable:!1,isRemovable:!0,group:n._translate("Predefined Values")}}),inputValue:""}:{values:null,inputValue:""},n}return u(r,[{key:"componentWillMount",value:function(){var e=this.getAllowedValuesTarget();this._changeSupport.onElementsChanged(e.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.getAllowedValuesTarget();this._changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"getAllowedValuesTarget",value:function(){var e=this.getElement();return k(e,"dmn:LiteralExpression")?e.$parent:e}},{key:"getElement",value:function(){return this.props.context.output||this.props.context.input.inputExpression}},{key:"render",value:function(){var t=this,e=this.getElement(),n=this.state,i=n.inputValue,n=n.values;return"string"===e.typeRef?I(1,"div","context-menu-container allowed-values-edit",I(1,"div","dms-form-control",[!$y(n)&&0<n.length&&A(2,Iy,{labelComponent:Vy,items:n,onChange:this.onListChange}),!$y(n)&&!n.length&&I(1,"div",null,[I(1,"label","dms-label",this._translate("Predefined Values"),0),I(1,"span","placeholder",this._translate("No values"),0)],4),!$y(n)&&I(1,"p","dms-hint",I(1,"button","del-values",this._translate("Clear predefined values."),0,{type:"button",onClick:this.handleRemovePredifinedValuesClick}),2),I(1,"label","dms-label",this._translate("Add Predefined Values"),0),A(2,Ay,{onInput:this.onInput,onKeyDown:this.onKeyDown,placeholder:this._translate('"value", "value", ...'),type:"text",validate:function(e){if(!Ny(e))return t._translate("Strings must be in double quotes.")},value:i})],0),2):null}}]),r}();function Vy(e){return I(1,"label","dms-label",e,0)}function $y(e){return null===e}$l=u(function e(t){h(this,e),t.onGetComponent("context-menu",500,function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).contextMenuType;if("input-edit"===e||"output-edit"===e)return Ly})}),$l.$inject=["components"],Xl={__init__:["allowedValuesUpdateBehavior","allowedValuesEditingProvider"],allowedValuesUpdateBehavior:["type",Nl],allowedValuesEditingProvider:["type",$l]};function zy(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var Fy=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),zy(d(n=i.call(this,e,t)),"onElementsChanged",function(){n.forceUpdate()}),zy(d(n),"handleClick",function(e){e.stopPropagation(),n.add()}),zy(d(n),"add",function(){n._eventBus.fire("addInput")}),n._sheet=t.injector.get("sheet"),n._eventBus=t.injector.get("eventBus"),n._changeSupport=t.changeSupport,n._translate=t.injector.get("translate"),n}return u(r,[{key:"componentWillMount",value:function(){var e=this.getRoot();this._changeSupport.onElementsChanged(e.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.getRoot();this._changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"getRoot",value:function(){return this._sheet.getRoot()}},{key:"render",value:function(){return I(1,"div","add-input actionable",I(1,"span","dmn-icon-plus action-icon"),2,{onClick:this.handleClick,title:this._translate("Add Input")})}}]),r}();function Uy(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var Hy=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),Uy(d(n=i.call(this,e,t)),"onElementsChanged",function(){n.forceUpdate()}),Uy(d(n),"handleClick",function(e){e.stopPropagation(),n.add()}),Uy(d(n),"add",function(){n._eventBus.fire("addOutput")}),n._sheet=t.injector.get("sheet"),n._eventBus=t.injector.get("eventBus"),n._changeSupport=t.changeSupport,n._translate=t.injector.get("translate"),n}return u(r,[{key:"componentWillMount",value:function(){var e=this.getRoot();this._changeSupport.onElementsChanged(e.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.getRoot();this._changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"getRoot",value:function(){return this._sheet.getRoot()}},{key:"render",value:function(){return I(1,"div","add-output actionable",I(1,"span","dmn-icon-plus action-icon"),2,{onClick:this.handleClick,title:this._translate("Add Output")})}}]),r}();function Wy(e,t,n){e.onGetComponent("cell-inner",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.cellType,n=e.index,i=e.inputsLength,e=e.outputsLength;return"input-cell"===t&&n===i-1?Fy:"output-cell"===t&&n===e-1?Hy:void 0}),n.on("addInput",function(){t.trigger("addInput")}),n.on("addOutput",function(){t.trigger("addOutput")})}Wy.$inject=["components","editorActions","eventBus"];nd={__depends__:[kv],__init__:["addInputOutputProvider"],addInputOutputProvider:["type",Wy]};function qy(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}ed=function(){function r(e,t,n,i){var o=this;h(this,r),qy(this,"_init",function(){o._registerDefaultBindings(),o._fire("init")}),qy(this,"_destroy",function(){o._fire("destroy"),o.unbind(),o._listeners=null}),qy(this,"_keyHandler",function(e){for(var t,n=o._listeners,i=e.keyCode||e.charCode||-1,r=0;t=n[r];r++)if(t(i,e))return e.preventDefault(),void e.stopPropagation()}),qy(this,"unbind",function(){var e=o._node;e&&(o._fire("unbind"),E.unbind(e,"keydown",o._keyHandler,!0)),o._node=null}),this._config=e||{},this._editorActions=n,this._eventBus=t,this._cellSelection=i,this._listeners=[],t.on("table.destroy",this._destroy),t.on("table.init",this._init),t.on("attach",function(){o._config.bindTo&&o.bind(e.bindTo)}),t.on("detach",this.unbind)}return u(r,[{key:"bind",value:function(e){this.unbind(),this._node=e,E.bind(e,"keydown",this._keyHandler,!0),this._fire("bind")}},{key:"getBinding",value:function(){return this._node}},{key:"_fire",value:function(e){this._eventBus.fire("keyboard."+e,{node:this._node,listeners:this._listeners})}},{key:"_registerDefaultBindings",value:function(){var e=this._listeners,n=this._editorActions,i=this._cellSelection;e.push(function(e,t){if(Xv(t)&&!Yv(t)&&90===e)return n.trigger("undo"),!0}),e.push(function(e,t){if(Xv(t)&&(89===e||90===e&&Yv(t)))return n.trigger("redo"),!0}),e.push(function(e,t){if(13===e&&!Xv(t)&&Yv(t)&&rv(t.target))return n.trigger("selectCellAbove"),!0}),e.push(function(e,t){if(13===e&&!Xv(t)&&!Yv(t)&&rv(t.target))return e=n.trigger("selectCellBelow"),t=i.getCellSelection(),!(!e&&t&&"__decisionProperties_name"!==t)||(e=n.trigger("addRule"),n.trigger("selectCellBelow"),e)})}},{key:"addListener",value:function(e){this._listeners.unshift(e)}},{key:"removeListener",value:function(t){this._listeners=this._listeners.filter(function(e){return e!==t})}}]),r}();ed.$inject=["config.keyboard","eventBus","editorActions","cellSelection"];var Gy={__depends__:[kv],__init__:["keyboard"],keyboard:["type",ed]},Ky={__depends__:[nd,Xl,Kv,$a,pg,Gy,ml],__init__:["inputEditingProvider","outputEditingProvider"],inputEditingProvider:["type",bc],outputEditingProvider:["type",ia]};function Xy(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}_d=function(){function o(e,t,n,i){var r=this;h(this,o),Xy(this,"handleDragOver",function(e){Yy(e);var t=Cn(e.target,".dmn-decision-table-container td,\n   .dmn-decision-table-container th",!0),n=!!t,i=r._dragContext.hoverEl;i&&i!==t&&(r._emit("dragAndDrop.dragLeave",e),r._dragContext.targetEl=null,r._dragContext.hoverEl=null),t&&(t!==i&&(r._dragContext.hoverEl=t,!1!==(n=r._emit("dragAndDrop.dragEnter",e)))&&(r._dragContext.targetEl=t),n=r._emit("dragAndDrop.dragOver",e)),e.dataTransfer.dropEffect=!1!==n?"move":"none"}),Xy(this,"handleDrop",function(e){Yy(e);var t,n,i=r._emit("dragAndDrop.drop",e);i&&((t=r._dragContext.draggedElement)instanceof $h?(n=r._sheet.getRoot().rows.indexOf(i),r._modeling.moveRow(t,n)):t instanceof zh&&(n=r._sheet.getRoot().cols.indexOf(i),r._modeling.moveCol(t,n))),r.handleDragEnd(e)}),Xy(this,"handleDragEnd",function(e){Yy(e),r._unbindListeners(),r._emit("dragAndDrop.dragEnd",e),r._dragContext=null}),this._eventBus=e,this._renderer=t,this._modeling=n,this._sheet=i,this._dragContext=null,e.on("table.destroy",function(){r._unbindListeners()})}return u(o,[{key:"_bindListeners",value:function(){E.bind(document,"dragover",this.handleDragOver),E.bind(document,"drop",this.handleDrop),E.bind(document,"dragend",this.handleDragEnd)}},{key:"_unbindListeners",value:function(){E.unbind(document,"dragover",this.handleDragOver),E.unbind(document,"drop",this.handleDrop),E.unbind(document,"dragend",this.handleDragEnd)}},{key:"_emit",value:function(e,t){return this._eventBus.fire(e,{dragContext:this._dragContext,originalEvent:t})}},{key:"startDrag",value:function(e,t){Yy(t,!0),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData&&t.dataTransfer.setData("text","__DUMMY"),this._dragContext={draggedElement:e},this._bindListeners(),this._emit("dragAndDrop.dragStart",t)}}]),o}();function Yy(e,t){e.stopPropagation(),!0!==t&&e.preventDefault()}_d.$inject=["eventBus","renderer","modeling","sheet"];Pd={__init__:["dragAndDrop"],dragAndDrop:["type",_d]};function Zy(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var Qy="top",Jy="right",e_="bottom",t_="left",Ps=function(){function c(e,t,n,i,r,o,a){var s=this;h(this,c),Zy(this,"_cleanup",function(){var e=s._renderer.getContainer();r_(e),y(Rn(".dragged",e),function(e){s_(e)&&v(e).remove("dragged")}),s._dragImage&&(Tn(s._dragImage),s._dragImage=null)}),this._elementRegistry=t,this._dragAndDrop=i,this._renderer=r,this._rules=o,this._sheet=a,e.onGetComponent("cell-inner",function(e){var t,n=e.cellType,i=e.col,r=e.row;return"rule-index"===n?function(){return I(1,"span","dmn-icon-drag vertical",N(""),2,{draggable:"true",onDragStart:function(e){return s.startDrag(r,e)},title:"Move rule"})}:"input-cell"===n||"output-cell"===n?(t="Move ".concat(x(i)?"Input":"Output"),function(){return I(1,"span","dmn-icon-drag horizontal",null,1,{draggable:"true",onDragStart:function(e){return s.startDrag(i,e)},title:t})}):void 0}),n.on("dragAndDrop.dragEnter",function(e){var e=e.dragContext,t=e.draggedElement,e=e.hoverEl;return t instanceof $h||t instanceof zh&&-1!==(e=function(e,t,n){t=t.get(e.dataset.colId);return t?n.getRoot().cols.indexOf(t):-1}(e,s._elementRegistry,s._sheet))&&s._rules.allowed("col.move",{col:t,index:e})}),n.on("dragAndDrop.dragLeave",function(e){e.dragContext.targetEl&&r_(s._renderer.getContainer())}),n.on("dragAndDrop.dragOver",function(e){var t,n=e.dragContext,e=e.originalEvent,i=n.draggedElement,r=n.lastPosition,o=n.targetEl,a=s._renderer.getContainer();return!!o&&(i instanceof $h&&(t=a_(e,o)),r!==(t=i instanceof zh?o_(e,o):t)&&(r_(a),i instanceof $h&&n_(o,a,t===Qy?"top":"bottom"),i instanceof zh&&i_(o,a,t===t_?"left":"right"),n.lastPosition=t),!0)}),n.on("dragAndDrop.drop",function(e){var t=e.dragContext,e=e.originalEvent,n=t.draggedElement,t=t.targetEl;if(!t)return!1;if(n instanceof $h)return i=a_(e,t),r=t.dataset.rowId,!(r=s._elementRegistry.get(r))||r===n||(r=function(e,t,n,i){i.indexOf(e)>i.indexOf(t)&&(t=function(e,t){e=t.indexOf(e);return t[Math.min(t.length-1,e+1)]}(t,i));return n===Qy?function(e,t){e=t.indexOf(e);return t[Math.max(0,e-1)]}(t,i):t}(n,r,i,s._sheet.getRoot().rows))===n?void 0:r;if(n instanceof zh){var i=o_(e,t),r=t.dataset.colId,e=s._elementRegistry.get(r);if(e&&e!==n){t=function(e,t,n,i){i.indexOf(e)>i.indexOf(t)&&(t=function(e,t){var n=t.indexOf(e);if(x(e))return e=t.filter(x),e=e[e.length-1],e=t.indexOf(e),t[Math.min(e,n+1)];return t[Math.min(t.length-1,n+1)]}(t,i));return n===t_?function(e,t){var n=t.indexOf(e);if(qn(e))return e=t.filter(qn)[0],e=t.indexOf(e),t[Math.max(e,n-1)];return t[Math.max(0,n-1)]}(t,i):t}(n,e,i,s._sheet.getRoot().cols);if(t!==n)return t}}}),n.on("dragAndDrop.dragEnd",this._cleanup)}return u(c,[{key:"startDrag",value:function(e,t){var n,i=this._renderer.getContainer();this._dragImage=_('<span style="\n          visibility: hidden;\n          position: fixed;\n          top: -10000px\n      "></span>'),document.body.appendChild(this._dragImage),t.dataTransfer.setDragImage&&t.dataTransfer.setDragImage(this._dragImage,0,0),e instanceof $h?(n=i,y(Rn("[data-row-id=".concat(e.id,"]"),n),function(e){s_(e)&&v(e).add("dragged")})):e instanceof zh&&(n=i,y(Rn("[data-col-id=".concat(e.id,"]"),n),function(e){s_(e)&&v(e).add("dragged")})),this._dragAndDrop.startDrag(e,t)}}]),c}();function n_(e,t,n){e=e.dataset.rowId;e&&y(Rn("[data-row-id=".concat(e,"]"),t),function(e){s_(e)&&(v(e).add("dragover"),v(e).add(n))})}function i_(e,t,n){e=e.dataset.colId;e&&y(Rn("[data-col-id=".concat(e,"]"),t),function(e){s_(e)&&(v(e).add("dragover"),v(e).add(n))})}function r_(e){y(Rn(".dragover",e),function(e){s_(e)&&(v(e).remove("dragover"),v(e).remove("top"),v(e).remove("right"),v(e).remove("bottom"),v(e).remove("left"))})}function o_(e,t){t=t.getBoundingClientRect();return e.clientX<t.left+t.width/2?t_:Jy}function a_(e,t){t=t.getBoundingClientRect();return e.clientY<t.top+t.height/2?Qy:e_}function s_(e){return e&&(1===e.nodeType||11==e.nodeType)}Ps.$inject=["components","elementRegistry","eventBus","dragAndDrop","renderer","rules","sheet"];var c_={__depends__:[Pd,e],__init__:["dmnDragAndDrop"],dmnDragAndDrop:["type",Ps]};function u_(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var l_=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),u_(d(n=i.call(this,e,t)),"onElementsChanged",function(){n.forceUpdate()}),u_(d(n),"changeDescription",function(e){n._modeling.updateProperties(n._element,{description:e})}),n._elementRegistry=t.injector.get("elementRegistry"),n._modeling=t.injector.get("modeling"),n._changeSupport=n.context.changeSupport;var n,e=n.props.context.id;return n._element=n._elementRegistry.get(e),n}return u(r,[{key:"componentWillMount",value:function(){this._element&&this._changeSupport.onElementsChanged(this._element.id,this.onElementsChanged)}},{key:"componentDidMount",value:function(){this.props.context.autoFocus&&this.node&&b(".content-editable",this.node).focus()}},{key:"componentWillUnmount",value:function(){var e;this._element&&(this._changeSupport.offElementsChanged(this._element.id,this.onElementsChanged),ne(e=this._element.businessObject.description))&&!e.length&&this.changeDescription(null)}},{key:"render",value:function(){var t=this;if(this._element){var e=this._element.businessObject.description;if(ne(e))return I(1,"div","context-menu-container description-editor",A(2,d_,{className:"dms-input",onChange:this.changeDescription,value:e}),2,null,null,function(e){return t.node=e})}}}]),r}(),d_=function(){l(t,Av);var e=p(t);function t(){return h(this,t),e.apply(this,arguments)}return u(t,[{key:"render",value:function(){return I(1,"div",this.getClassName(),this.getEditor(),0)}}]),t}();function p_(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}pd=u(function e(t,r,o,n,i,a,s){var c=this,u=(h(this,e),this);p_(this,"addDescription",function(e){c._modeling.updateProperties(e,{description:""});var t=c._renderer.getContainer(),t=h_(t,iv(e.id,t).getBoundingClientRect());c._contextMenu.open(t,{contextMenuType:"cell-description",id:e.id,autoFocus:!0,offset:{x:4,y:4}})}),p_(this,"removeDescription",function(e){c._modeling.updateProperties(e,{description:null}),c._contextMenu.close()}),this._contextMenu=r,this._modeling=i,this._renderer=a,this._translate=s,n.on("cell.click",750,function(e){var t,n,i;e.defaultPrevented||(t=e.target,n=e.id,Kn(i=o.get(n),["dmn:UnaryTests","dmn:LiteralExpression"])&&(f_(i)||e.preventDefault(),i=h_(a.getContainer(),t.getBoundingClientRect()),r.open(i,{contextMenuType:"cell-description",autoFocus:!1,id:n,offset:{x:4,y:4}})))}),t.onGetComponent("context-menu",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"cell-description"===e.contextMenuType&&ne(f_(o.get(e.id))))return l_}),t.onGetComponent("context-menu-cell-additional",500,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"context-menu"===e.contextMenuType){e=e.id;if(e){var t,n,i=o.get(e);if(i)return n=(t=ne(e=i.businessObject.description))?function(){return u.removeDescription(i)}:function(){return u.addDescription(i)},I(1,"div","context-menu-group-entry ".concat(t?"remove-description":"add-description"),ne(e)?u._translate("Remove Cell Description"):u._translate("Add Cell Description"),0,{onClick:n})}}})});function h_(e,t){var n=t.top,i=t.left,r=t.width,t=t.height;return{x:i+e.parentNode.scrollLeft-26,y:n+e.parentNode.scrollTop,width:r+52,height:t}}function f_(e){return e&&e.businessObject&&e.businessObject.description}pd.$inject=["components","contextMenu","elementRegistry","eventBus","modeling","renderer","translate"];var m_={__depends__:[Kv,Bg],__init__:["description"],description:["type",pd]},aa=function(){function s(e,r,t,o,n,i){h(this,s);var a=this;this._modeling=t,this._translate=n,this._expressionLanguages=o,e.onGetComponent("context-menu-cell-additional",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"context-menu"===e.contextMenuType){var t=e.event,n=e.id;if(n){e=r.get(n);if(e)if(a._shouldDisplayContextMenuEntry(e))return I(1,"div","context-menu-group-entry",a._translate("Change Cell Expression Language"),0,{onClick:function(e){i.open({x:(t||e).pageX,y:(t||e).pageY},{contextMenuType:"expression-language",id:n})}})}}}),e.onGetComponent("context-menu",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"expression-language"===e.contextMenuType){e=e.id;if(e){var t,n,i=r.get(e);if(i)return t=a._getElementExpressionLanguage(i),n=o.getAll(),function(){return I(1,"div","context-menu-flex",I(1,"div","context-menu-group",I(1,"div","context-menu-group-entry context-menu-entry-set-expression-language",[I(1,"div",null,a._translate("Expression Language"),0),A(2,Py,{className:"expression-language",onChange:function(e){return a.onChange(i,e)},options:n,value:t})],4),2),2)}}}}),e.onGetComponent("context-menu",function(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if("input-edit"===i.contextMenuType)return function(){var e,t,n=i.input.inputExpression;if(a._shouldDisplayContextMenuEntry(n))return e=a._getElementExpressionLanguage(n),t=o.getAll(),I(1,"div","context-menu-container ref-language",I(1,"div","dms-form-control",[I(1,"label","dms-label",a._translate("Expression Language"),0),A(2,Py,{className:"ref-language",value:e||"",onChange:function(e){return a.onChange(n,e)},options:t})],4),2)}})}return u(s,[{key:"onChange",value:function(e,t){this._modeling.editExpressionLanguage(e,t)}},{key:"_shouldDisplayContextMenuEntry",value:function(e){return 1<this._expressionLanguages.getAll().length||this._getElementExpressionLanguage(e)!==this._getDefaultElementExpressionLanguage(e)}},{key:"_getElementExpressionLanguage",value:function(e){return Gn(e).expressionLanguage||this._getDefaultElementExpressionLanguage(e)}},{key:"_getDefaultElementExpressionLanguage",value:function(e){return this._expressionLanguages.getDefault(x(e.col)?"inputCell":"outputCell").value}}]),s}(),g_=(aa.$inject=["components","elementRegistry","modeling","expressionLanguages","translate","contextMenu"],{__depends__:[pg],__init__:["expressionLanguage"],expressionLanguage:["type",aa]});function v_(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var y_=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),v_(d(n=i.call(this,e,t)),"onElementsChanged",function(){n.forceUpdate()}),v_(d(n),"setDecisionTableName",function(e){n.modeling.editDecisionTableName(e)}),Im(d(n)),n}return u(r,[{key:"componentWillMount",value:function(){this.setupChangeListeners({bind:this.getBusinessObject().id})}},{key:"componentWillUnmount",value:function(){this.setupChangeListeners({unbind:this.getBusinessObject().id})}},{key:"setupChangeListeners",value:function(e){var t=e.bind,e=e.unbind;"string"==typeof e&&this.changeSupport.offElementsChanged(e,this.onElementsChanged),"string"==typeof t&&this.changeSupport.onElementsChanged(t,this.onElementsChanged)}},{key:"getBusinessObject",value:function(){return this.sheet.getRoot().businessObject.$parent}},{key:"render",value:function(){var e=this.getBusinessObject().name,t=this.components.getComponent("hit-policy")||b_;return I(1,"div","decision-table-properties",[A(2,__,{className:"decision-table-name",value:e,ctrlForNewline:!0,onBlur:x_,onChange:this.setDecisionTableName,elementId:"__decisionProperties_name",coords:"0:__decisionProperties"}),I(1,"div","decision-table-header-separator"),A(2,t)],4)}}]),r}(),__=(y_.$inject=["sheet","modeling","changeSupport","components"],function(){l(i,Av);var n=p(i);function i(e,t){return h(this,i),(e=n.call(this,e,t))._translate=t.injector.get("translate"),Nm(d(e),Bm),e}return u(i,[{key:"render",value:function(){var e=this.props.value;return I(1,"div",Mm(this.getSelectionClasses(),this.getClassName()),this.getEditor(),0,{"data-element-id":this.props.elementId,"data-coords":this.props.coords,title:this._translate("Decision Name: ")+e})}}]),i}());function b_(){return null}function x_(e){e.target.scroll(0,0)}var Wr=u(function e(t){h(this,e),t.onGetComponent("table.before",500,function(){return y_})}),w_=(Wr.$inject=["components"],{__depends__:[$a],__init__:["decisionTableProperties"],decisionTableProperties:["type",Wr]});function C_(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function E_(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C_(Object(n),!0).forEach(function(e){k_(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C_(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function k_(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var S_=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),k_(d(n=i.call(this,e,t)),"onChange",function(e){var t=e.aggregation,e=e.hitPolicy;n.modeling.editHitPolicy(e,t)}),k_(d(n),"onElementsChanged",function(){n.forceUpdate()}),n._translate=t.injector.get("translate"),Im(d(n)),n}return u(r,[{key:"componentDidMount",value:function(){this.changeSupport.onElementsChanged(this.getRoot().id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){this.changeSupport.offElementsChanged(this.getRoot().id,this.onElementsChanged)}},{key:"getRoot",value:function(){return this.sheet.getRoot()}},{key:"render",value:function(){var t=this,e=this.getRoot().businessObject,n=e.aggregation,i=e.hitPolicy,e=ie(vg,function(e){return e=e.value,t={aggregation:n,hitPolicy:i},e.hitPolicy===t.hitPolicy&&e.aggregation===t.aggregation;var t});return I(1,"div","hit-policy",[I(1,"label","dms-label",this._translate("Hit Policy:"),0),A(2,Py,{className:"hit-policy-edit-policy-select",onChange:this.onChange,options:vg.map(function(e){return E_(E_({},e),{},{label:t._translate(e.label)})}),value:e.value,"data-hit-policy":"true",noInput:!0})],4,{title:this._translate(e.explanation)})}}]),r}();function j_(e){e.onGetComponent("hit-policy",function(){return S_})}S_.$inject=["changeSupport","sheet","modeling"],j_.$inject=["components"];var O_={__depends__:[Kv],__init__:["hitPolicyProvider"],hitPolicyProvider:["type",j_]},Wc=function(){l(r,ql);var i=p(r);function r(e,t){var n;return h(this,r),(n=i.call(this,e)).executed(["row.add","row.remove","col.add","col.remove"],P_(function(e){var e=e.context,t=e.row||e.col;n.updateRoot(t,e.oldRoot)})),n.reverted(["row.add","row.remove","col.add","col.remove"],P_(function(e){var e=e.context,t=e.row||e.col;n.updateRoot(t,e.newRoot)})),n}return u(r,[{key:"updateRoot",value:function(n,i){var e,t,r,o,a,s=this,c=n.root,u=n.businessObject;if(k(n,"dmn:DecisionRule")&&(i&&(l=(d=i.businessObject.get("rule")).indexOf(u),d.splice(l,1),u.$parent=null),c)&&(d=c.businessObject,l=c.rows.indexOf(n),d.get("rule").splice(l,0,u),u.$parent=d,n.cells.forEach(function(e,t){s.wireCell(e,n,t)})),k(n,"dmn:InputClause")||k(n,"dmn:OutputClause")){if(i){var l=i.businessObject,d=l.get("input"),l=l.get("output");if(k(n,"dmn:InputClause")&&(e=(t=d).indexOf(u)),-1===(e=k(n,"dmn:OutputClause")?(t=l).indexOf(u):e))throw new Error("inconsistent model: clause not in table");t.splice(e,1),u.$parent=null,n.cells.forEach(function(e,t){s.unwireCell(e,i.rows[t])})}c&&(l=(d=c.businessObject).get("input"),t=d.get("output"),r=c.cols.indexOf(n),k(n,"dmn:InputClause")&&(a=l,o=r),k(n,"dmn:OutputClause")&&(a=t,o=r-l.length),a.splice(o,0,u),u.$parent=d,n.cells.forEach(function(e,t){s.wireCell(e,c.rows[t],r)}))}}},{key:"unwireCell",value:function(e,t){var n,i=e.businessObject,t=t.businessObject,r=t.get("inputEntry"),t=t.get("outputEntry");if(k(e,"dmn:UnaryTests")&&(n=r),-1===(r=(n=k(e,"dmn:LiteralExpression")?t:n).indexOf(i)))throw new Error("cell not in row");n.splice(r,1),i.$parent=null}},{key:"wireCell",value:function(e,t,n){var i,r,o=e.businessObject,t=t.businessObject,a=t.get("inputEntry"),s=t.get("outputEntry");o.$parent!==t&&(k(e,"dmn:UnaryTests")&&(i=a,r=n),k(e,"dmn:LiteralExpression")&&(i=s,r=n-a.length),i.splice(r,0,o),o.$parent=t)}}]),r}();function P_(n){return function(e){var t=e.context;k(t.row||t.col,"dmn:DMNElement")&&n(e)}}Wc.$inject=["eventBus","sheet"];var od=function(){function t(e){h(this,t),this._model=e}return u(t,[{key:"create",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=this._model.create(e,t||{});return k(e,"dmn:InputClause")&&(t.inputExpression?e.inputExpression=t.inputExpression:(e.inputExpression=this.create("dmn:LiteralExpression",{typeRef:"string"}),e.inputExpression.$parent=e)),k(e,"dmn:OutputClause")&&(e.typeRef=t.typeRef||"string"),(k(e,"dmn:UnaryTests")||k(e,"dmn:LiteralExpression"))&&(e.text=t.text||""),this._ensureId(e),e}},{key:"_needsId",value:function(e){return k(e,"dmn:DMNElement")}},{key:"_ensureId",value:function(e){var t=(e.$type||"").replace(/^[^:]*:/g,"")+"_";!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))}}]),t}(),D_=(od.$inject=["moddle"],["businessObject","type"]);function R_(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function T_(i){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?R_(Object(r),!0).forEach(function(e){var t,n;t=i,n=r[e=e],(e=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):R_(Object(r)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(r,e))})}return i}function M_(e,t){if(null==e)return{};var n,i=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);return i}var Tc=function(){l(a,Wh);var n=p(a);function a(e){var t;return h(this,a),(t=n.call(this))._dmnFactory=e,t}return u(a,[{key:"create",value:function(e,t){var n,i=this._dmnFactory,r=t.businessObject,o=t.type,t=M_(t,D_);if(!r){if(!o)if("root"===e?o="dmn:DecisionTable":"cell"===e&&(k(n=t.col,"dmn:OutputClause")&&(o="dmn:LiteralExpression"),k(n,"dmn:InputClause"))&&(o="dmn:UnaryTests"),!o)throw new Error("cannot guess <type>");r=i.create(o)}return F(s(a.prototype),"create",this).call(this,e,T_({businessObject:r,id:r.id},t))}}]),a}(),I_=(Tc.$inject=["dmnFactory"],function(){function n(e,t){h(this,n),this._sheet=e,this._elementFactory=t}return u(n,[{key:"execute",value:function(e){var t=this._sheet,n=this._elementFactory,i=t.getRoot(),r=e.row,o=e.index;return void 0===o&&(o=e.index=i.rows.length),e.newRoot=i,r.cells.length||i.cols.forEach(function(e,t){e=n.create("cell",{row:r,col:e});r.cells[t]=e}),t.addRow(r,o),t.getRoot()}},{key:"revert",value:function(e){var e=e.row,t=this._sheet;return t.removeRow(e),t.getRoot()}}]),n}()),A_=(I_.$inject=["sheet","elementFactory"],function(){function t(e){h(this,t),this._sheet=e}return u(t,[{key:"execute",value:function(e){var t=this._sheet,n=t.getRoot(),i=e.row,n=e.oldIndex=n.rows.indexOf(i);if(e.oldRoot=i.root,-1===n)throw new Error("row#".concat(i.id," not in sheet"));return t.removeRow(i),t.getRoot()}},{key:"revert",value:function(e){var t=e.row,e=e.oldIndex,n=this._sheet;return n.addRow(t,e),n.getRoot()}}]),t}()),N_=(A_.$inject=["sheet"],function(){function t(e){h(this,t),this._modeling=e}return u(t,[{key:"preExecute",value:function(e){e=e.row;this._modeling.removeRow(e)}},{key:"postExecute",value:function(e){var t=e.row,e=e.index;this._modeling.addRow(t,e)}}]),t}()),B_=(N_.$inject=["modeling"],function(){function n(e,t){h(this,n),this._sheet=e,this._elementFactory=t}return u(n,[{key:"execute",value:function(e){var t=this._sheet,n=this._elementFactory,i=t.getRoot(),r=e.col,o=e.index;return void 0===o&&(o=e.index=i.cols.length),e.newRoot=i,r.cells.length||i.rows.forEach(function(e,t){e=n.create("cell",{row:e,col:r});r.cells[t]=e}),t.addCol(r,o),t.getRoot()}},{key:"revert",value:function(e){var e=e.col,t=this._sheet;return t.removeCol(e),t.getRoot()}}]),n}()),L_=(B_.$inject=["sheet","elementFactory"],function(){function n(e,t){h(this,n),this._sheet=e,this._elementFactory=t}return u(n,[{key:"execute",value:function(e){var t=this._sheet,n=e.col,i=e.oldRoot=n.root;if(-1===(e.oldIndex=i.cols.indexOf(n)))throw new Error("col#".concat(n.id," not in sheet"));return t.removeCol(n),t.getRoot()}},{key:"revert",value:function(e){var t=e.col,e=e.oldIndex,n=this._sheet;return n.addCol(t,e),n.getRoot()}}]),n}()),V_=(L_.$inject=["sheet","elementFactory"],function(){function t(e){h(this,t),this._modeling=e}return u(t,[{key:"preExecute",value:function(e){e=e.col;this._modeling.removeCol(e)}},{key:"postExecute",value:function(e){var t=e.col,e=e.index;this._modeling.addCol(t,e)}}]),t}()),$_=(V_.$inject=["modeling"],function(){function e(){h(this,e)}return u(e,[{key:"execute",value:function(e){return e.cell}},{key:"revert",value:function(e){return e.cell}}]),e}()),z_=function(){function n(e,t,i){var r=this;h(this,n),this._eventBus=e,this._elementFactory=t,this._commandStack=i,e.on("table.init",function(){var e,n;e=r.getHandlers(),n=i,y(e,function(e,t){n.registerHandler(t,e)})})}return u(n,[{key:"getHandlers",value:function(){return n._getHandlers()}},{key:"_create",value:function(e,t){return t instanceof Vh?t:this._elementFactory.create(e,t)}},{key:"addRow",value:function(e,t){e=this._create("row",e);return this._commandStack.execute("row.add",{row:e,index:t}),e}},{key:"removeRow",value:function(e){this._commandStack.execute("row.remove",{row:e})}},{key:"moveRow",value:function(e,t){this._commandStack.execute("row.move",{row:e,index:t})}},{key:"addCol",value:function(e,t){e=this._create("col",e);return this._commandStack.execute("col.add",{col:e,index:t}),e}},{key:"removeCol",value:function(e){this._commandStack.execute("col.remove",{col:e})}},{key:"moveCol",value:function(e,t){this._commandStack.execute("col.move",{col:e,index:t})}},{key:"editCell",value:function(e,t){e=L({cell:e},t);this._commandStack.execute("cell.edit",e)}}],[{key:"_getHandlers",value:function(){return{"row.add":I_,"row.remove":A_,"row.move":N_,"col.add":B_,"col.remove":L_,"col.move":V_,"cell.edit":$_}}}]),n}();z_.$inject=["eventBus","elementFactory","commandStack"];var F_=function(){function i(e,t,n){h(this,i),this._dmnFactory=e,this._moddle=t,this._modeling=n}return u(i,[{key:"execute",value:function(e){var t=e.element,n=e.allowedValues;return k(t,"dmn:InputClause")?(t.inputValues?e.oldAllowedValues=t.inputValues.text:U_(n)||(t.inputValues=this._dmnFactory.create("dmn:UnaryTests",{text:""})),U_(n)?t.inputValues&&delete t.inputValues:t.inputValues.text=n.join(",")):(t.outputValues&&t?e.oldAllowedValues=t.outputValues.text:U_(n)||(t.outputValues=this._dmnFactory.create("dmn:UnaryTests",{text:""})),U_(n)?t.outputValues&&delete t.outputValues:t.outputValues.text=n.join(",")),t}},{key:"revert",value:function(e){var t=e.element,e=e.oldAllowedValues;return k(t,"dmn:InputClause")?e?(t.inputValues||(t.inputValues=this._dmnFactory.create("dmn:UnaryTests",{text:""})),t.inputValues.text=e):delete t.inputValues:e?(t.outputValues||(t.outputValues=this._dmnFactory.create("dmn:UnaryTests",{text:""})),t.outputValues.text=e):delete t.outputValues,t}}]),i}();function U_(e){return null===e}function H_(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function W_(i){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?H_(Object(r),!0).forEach(function(e){var t,n;t=i,n=r[e=e],(e=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):H_(Object(r)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(r,e))})}return i}F_.$inject=["dmnFactory","moddle","modeling"];var q_=function(){function n(e,t){h(this,n),this._elementRegistry=e,this._moddle=t}return u(n,[{key:"execute",value:function(e){var t=e.element,n=e.properties,i=Gn(t),i=this.updateProperties(i,n),n=i.changed,i=i.oldProperties;return e.oldProperties=i,[].concat(f(n),[t])}},{key:"revert",value:function(e){var t=e.element,e=e.oldProperties,n=Gn(t),n=this.updateProperties(n,e).changed;return[].concat(f(n),[t])}},{key:"updateProperties",value:function(a,e){var s=this,c=this._moddle.ids;return oe(e,function(e,t,n){var i,r,o=a.get(n);if(G_(t)){if(G_(o))return i=(r=s.updateProperties(o,t)).changed,r=r.oldProperties,{changed:[].concat(f(e.changed),f(i),[o]),oldProperties:W_(W_({},e.oldProperties),{},V({},n,r))};throw new Error("non-existing property <".concat(n,">: cannot update values"))}return"id"===n&&a.id!==t&&(c.unclaim(a.id),s._elementRegistry.updateId(a,t),c.claim(t,a)),a.set(n,t),{changed:e.changed,oldProperties:W_(W_({},e.oldProperties),{},V({},n,o))}},{changed:[],oldProperties:{}})}}]),n}();function G_(e){return Q(e)&&ee(e)}q_.$inject=["elementRegistry","moddle"];var K_=function(){function t(e){h(this,t),this._moddle=e}return u(t,[{key:"execute",value:function(e){var t=this._moddle.ids,n=e.id,i=e.element;e.claiming?t.claim(n,i):t.unclaim(n)}},{key:"revert",value:function(e){var t=this._moddle.ids,n=e.id,i=e.element;e.claiming?t.unclaim(n):t.claim(n,i)}}]),t}(),Nd=(K_.$inject=["moddle"],function(){l(a,z_);var o=p(a);function a(e,t,n,i){var r;return h(this,a),(r=o.call(this,e,t,n))._eventBus=e,r._elementFactory=t,r._commandStack=n,r._sheet=i,r}return u(a,[{key:"getHandlers",value:function(){return a._getHandlers()}},{key:"editDecisionTableName",value:function(e){var t=this._sheet.getRoot().businessObject.$parent;this._commandStack.execute("element.updateProperties",{element:t,properties:{name:e}})}},{key:"editDecisionTableId",value:function(e){var t=this._sheet.getRoot().businessObject.$parent;this._commandStack.execute("element.updateProperties",{element:t,properties:{id:e}})}},{key:"editHitPolicy",value:function(e,t){var n=this._sheet.getRoot().businessObject;this._commandStack.execute("element.updateProperties",{element:n,properties:{hitPolicy:e,aggregation:t}})}},{key:"updateProperties",value:function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})}},{key:"editInputExpression",value:function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})}},{key:"editOutputName",value:function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:{name:t}})}},{key:"editInputExpressionTypeRef",value:function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:{typeRef:t}})}},{key:"editOutputTypeRef",value:function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:{typeRef:t}})}},{key:"editCell",value:function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:{text:t}})}},{key:"editAnnotation",value:function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:{description:t}})}},{key:"editAllowedValues",value:function(e,t){this._commandStack.execute("editAllowedValues",{element:e,allowedValues:t})}},{key:"editExpressionLanguage",value:function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:{expressionLanguage:t}})}},{key:"claimId",value:function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})}},{key:"unclaimId",value:function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})}}],[{key:"_getHandlers",value:function(){return C({},F(s(a),"_getHandlers",this).call(this),{editAllowedValues:F_,"element.updateProperties":q_,"id.updateClaim":K_})}}]),a}()),Ho=(Nd.$inject=["eventBus","elementFactory","commandStack","sheet"],function(){l(o,ql);var r=p(o);function o(e,t,n){var i;return h(this,o),(i=r.call(this,e))._ids=t.ids,i._modeling=n,i.preExecute(["row.add","col.add"],function(e){e=e.context,e=e.row||e.col;i.claimId(e.businessObject),e.cells&&e.cells.forEach(function(e){return i.claimId(e.businessObject)})}),i}return u(o,[{key:"claimId",value:function(t){var n=this;t.id&&!this._ids.assigned(t.id)&&this._modeling.claimId(t.id,t),t.$descriptor.properties.forEach(function(e){e=t[e.name];e&&(m(e)&&e.forEach(function(e){return n.claimId(e)}),e.$type)&&n.claimId(e)})}}]),o}()),ca=(Ho.$inject=["eventBus","moddle","modeling"],function(){l(r,ql);var i=p(r);function r(e,t){var n;return h(this,r),(n=i.call(this,e))._modeling=t,n.preExecute(["row.remove","col.remove"],function(e){e=e.context,e=e.row||e.col;n.unclaimId(e.businessObject),e.cells&&e.cells.forEach(function(e){return n.unclaimId(e.businessObject)})}),n}return u(r,[{key:"unclaimId",value:function(t){var n=this;t.id&&this._modeling.unclaimId(t.id,t),t.$descriptor.properties.forEach(function(e){e=t[e.name];e&&(m(e)&&e.forEach(function(e){return n.unclaimId(e)}),e.$type)&&n.unclaimId(e)})}}]),r}());ca.$inject=["eventBus","modeling"];var X_={__init__:["dmnUpdater","idChangeBehavior","modeling"],__depends__:[{__init__:["idClaimBehavior","idUnclaimBehavior"],idClaimBehavior:["type",Ho],idUnclaimBehavior:["type",ca]},ld],dmnUpdater:["type",Wc],dmnFactory:["type",od],elementFactory:["type",Tc],idChangeBehavior:["type",Od],modeling:["type",Nd]},Y_=function(){l(i,a);var n=p(i);function i(e,t){return h(this,i),(e=n.call(this,e,t)).state={isFocussed:!1},e.changeCellValue=e.changeCellValue.bind(d(e)),e.onFocus=e.onFocus.bind(d(e)),e.onBlur=e.onBlur.bind(d(e)),e.onElementsChanged=e.onElementsChanged.bind(d(e)),e}return u(i,[{key:"onElementsChanged",value:function(){this.forceUpdate()}},{key:"componentWillMount",value:function(){var e=this.context.injector,t=this.props.cell,n=this._changeSupport=this.context.changeSupport;this._modeling=e.get("modeling"),n.onElementsChanged(t.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.props.cell;this._changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"changeCellValue",value:function(e){var t=this.props.cell;this._modeling.editCell(t.businessObject,e)}},{key:"onFocus",value:function(){this.setState({isFocussed:!0})}},{key:"onBlur",value:function(){this.setState({isFocussed:!1})}},{key:"render",value:function(){var e=this.props,t=e.cell,n=e.rowIndex,i=e.row,r=e.col,e=e.colIndex,o=this.state.isFocussed,a=k(t,"dmn:UnaryTests"),s=t.businessObject;return A(2,$m,{className:a?"input-cell":"output-cell",elementId:t.id,coords:"".concat(n,":").concat(e),"data-row-id":i.id,"data-col-id":r.id,children:A(2,Z_,{className:"cell-editor",placeholder:a?"-":"",ctrlForNewline:!0,onFocus:this.onFocus,onBlur:this.onBlur,isFocussed:o,onChange:this.changeCellValue,value:s.text,businessObject:s})})}}]),i}(),Z_=function(){l(i,Av);var n=p(i);function i(e,t){return h(this,i),(e=n.call(this,e,t))._expressionLanguages=t.injector.get("expressionLanguages"),e._translate=t.injector.get("translate"),e}return u(i,[{key:"isDefaultExpressionLanguage",value:function(e){var t=e.expressionLanguage,e=this.getDefaultExpressionLanguage(e).value;return!t||t===e}},{key:"getDescription",value:function(e){return e.description}},{key:"getExpressionLanguageLabel",value:function(e){var t=e.expressionLanguage,e=this.getDefaultExpressionLanguage(e);return this._expressionLanguages.getLabel(t)||e.label}},{key:"isScript",value:function(e){var t=this.getDefaultExpressionLanguage(e);return!!k(e,"dmn:UnaryTests")&&(-1!==e.text.indexOf("\n")||e.expressionLanguage&&e.expressionLanguage!==t)}},{key:"getDefaultExpressionLanguage",value:function(e){e=k(e,"dmn:UnaryTests")?"inputCell":"outputCell";return this._expressionLanguages.getDefault(e)}},{key:"render",value:function(){var e=this.props,t=e.businessObject,e=e.isFocussed,n=this.getDescription(t),i=this.isDefaultExpressionLanguage(t),r=this.getExpressionLanguageLabel(t),t=this.isScript(t);return I(1,"div",this.getClassName(),[ne(n)&&!e&&I(1,"div","description-indicator"),this.getEditor({className:t?"script-editor":null}),!i&&!e&&I(1,"span","dms-badge dmn-expression-language",[I(1,"span","dms-badge-icon dmn-icon-file-code"),I(1,"span","dms-badge-label",r,0)],4,{title:this._translate("Expression Language = {expressionLanguageLabel}",{expressionLanguageLabel:r})})],0)}}]),i}(),Yo=u(function e(t){h(this,e),t.onGetComponent("cell",1500,function(e){if("rule"===e.cellType)return Y_})}),Q_=(Yo.$inject=["components"],{__depends__:[$a,gg],__init__:["decisionRulesEditor"],decisionRulesEditor:["type",Yo]});function J_(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function eb(i){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?J_(Object(r),!0).forEach(function(e){var t,n;t=i,n=r[e=e],(e=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):J_(Object(r)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(r,e))})}return i}var tb=function(){l(i,a);var n=p(i);function i(e,t){h(this,i),(e=n.call(this,e,t))._translate=t.injector.get("translate"),e.state={top:0,left:0,isVisible:!1,isDisabled:!1,selection:null},Im(d(e));t=e.debounceInput;return e.onClick=e.onClick.bind(d(e)),e.handleSelectionChanged=e.handleSelectionChanged.bind(d(e)),e.hideAndShowDebounced=e.hideAndShowDebounced.bind(d(e)),e.showDebounced=t(e.showDebounced.bind(d(e))),e.updatePosition=e.updatePosition.bind(d(e)),e}return u(i,[{key:"componentDidMount",value:function(){var e=this.eventBus;e.on("cellSelection.changed",this.handleSelectionChanged),e.on("commandStack.changed",this.updatePosition),e.on("sheet.scroll",this.hideAndShowDebounced)}},{key:"componentWillUnmount",value:function(){var e=this.eventBus;e.off("cellSelection.changed",this.handleSelectionChanged),e.off("commandStack.changed",this.updatePosition),e.off("sheet.scroll",this.hideAndShowDebounced)}},{key:"hideAndShowDebounced",value:function(){this.state.isVisible&&(this.hide(),this.showDebounced())}},{key:"showDebounced",value:function(){this.show()}},{key:"hide",value:function(){this.setState(eb(eb({},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),{},{isVisible:!1}))}},{key:"show",value:function(){this.setState(eb(eb({},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),{},{isVisible:!0})),this.updatePosition()}},{key:"handleSelectionChanged",value:function(e){var e=e.elementId,t=this.elementRegistry,n=this.expressionLanguages,i=this.simpleMode,t=t.get(e);t&&i.canSimpleEdit(t)?(e=t.businessObject.expressionLanguage,i=t,n=n,e=!(!(e=e)||e===function(e,t){return x(e.col)?t.getDefault("inputCell").value:qn(e.col)?t.getDefault("outputCell").value:void 0}(i,n)),this.show({isDisabled:e,selection:t})):this.hide({isDisabled:!1,selection:null})}},{key:"updatePosition",value:function(){var e,t,n,i,r,o=this.state.selection,a=this.node;o&&a&&(e=(t=this.renderer.getContainer()).getBoundingClientRect(),o=iv(o.id,t).getBoundingClientRect(),t=this.node.getBoundingClientRect(),i=(n=(n=Cn(n=a,".tjs-table-container"))?(i=n.scrollLeft,{scrollTop:n.scrollTop,scrollLeft:i}):{scrollTop:0,scrollLeft:0}).scrollLeft,n=n.scrollTop,r={},o.left+o.width/2>e.width/2?(r.left=-e.left+o.left-t.width+4+i+"px",a.classList.remove("right"),a.classList.add("left")):(r.left=-e.left+o.left+o.width-4+i+"px",a.classList.remove("left"),a.classList.add("right")),o.top+o.height/2>e.height/2?(r.top=-e.top+o.top-t.height+4+n+"px",a.classList.remove("top"),a.classList.add("bottom")):(r.top=-e.top+o.top-4+n+"px",a.classList.remove("bottom"),a.classList.add("top")),C(this.node.style,r))}},{key:"onClick",value:function(){var e,t=this.eventBus;this.state.isDisabled||(e=this.selection.get())&&(t.fire("simpleMode.open",{element:e,node:iv(e.id,this._container)}),this.hide())}},{key:"render",value:function(){var t=this,e=this.state,n=e.isDisabled,i=e.isVisible,r=e.top,e=e.left,o=["simple-mode-button","no-deselect"];return n&&o.push("disabled"),i?I(1,"div",o.join(" "),I(1,"span","dmn-icon-edit"),2,{onClick:this.onClick,style:{top:r,left:e},title:n?this._translate("Editing not supported for set expression language"):this._translate("Edit")},null,function(e){return t.node=e}):null}}]),i}();tb.$inject=["debounceInput","elementRegistry","eventBus","expressionLanguages","renderer","selection","simpleMode"];yl=function(){function t(e,a,r,o,s){h(this,t),this._providers=[],e.onGetComponent("table.before",function(){return tb}),o.on("simpleMode.open",function(e){var t=e.element,e=e.node.getBoundingClientRect(),n=e.left,i=e.top,r=e.width,e=e.height,o=s.getContainer();a.open({x:n+o.parentNode.scrollLeft,y:i+o.parentNode.scrollTop,width:r,height:e},{contextMenuType:"simple-mode-edit",element:t,offset:{x:4,y:4}})}),o.on("cell.click",function(e){var t=e.event,n=e.node,i=e.id;!function(e){if(e.altKey)return;return e.ctrlKey||e.metaKey}(t)||((t=r.get(i))&&o.fire("simpleMode.open",{node:n,element:t}),e.preventDefault())})}return u(t,[{key:"registerProvider",value:function(e){this._providers.push(e)}},{key:"canSimpleEdit",value:function(n){return this._providers.reduce(function(e,t){return e||t(n)},!1)}}]),t}();yl.$inject=["components","contextMenu","elementRegistry","eventBus","renderer"];var nb={__depends__:[Kv,cv,pg],__init__:["simpleMode"],simpleMode:["type",yl]};var ib="none",rb=function(){l(i,a);var n=p(i);function i(e,t){h(this,i),(e=n.call(this,e,t))._translate=t.injector.get("translate"),e._modeling=t.injector.get("modeling");var t=e.props.context.element,t=(t=t.businessObject.text)&&""!==t?"true"===t.trim()?"true":"false"===t.trim()?"false":void 0:"none";return e.state={value:t||ib},e.editCell=e.editCell.bind(d(e)),e.onChange=e.onChange.bind(d(e)),e}return u(i,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onChange",value:function(e){var t=this.props.context.element;this.editCell(t.businessObject,e===ib?"":e),this.setState({value:e})}},{key:"render",value:function(){var e=this.state.value,t=[{label:"-",value:ib},{label:this._translate("Yes"),value:"true"},{label:this._translate("No"),value:"false"}];return I(1,"div","simple-boolean-edit context-menu-container",[I(1,"h3","dms-heading",this._translate("Edit Boolean"),0),I(1,"h4","dms-heading",this._translate("Set Value"),0),A(2,Py,{noInput:!0,className:"dms-block",onChange:this.onChange,options:t,value:e})],4)}}]),i}(),Oc=u(function e(t,n){h(this,e),n.registerProvider(function(e){return(x(e.col)||qn(e.col))&&"boolean"===ob(e)}),t.onGetComponent("context-menu",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.contextMenuType&&"simple-mode-edit"===e.contextMenuType&&e.element&&"boolean"===ob(e.element)?rb:void 0})});function ob(e){return x(e.col)?e.col&&e.col.businessObject.inputExpression.typeRef:e.col&&e.col.businessObject.typeRef}Oc.$inject=["components","simpleMode"];var ab={__depends__:[Gy,nb],__init__:["simpleBooleanEdit"],simpleBooleanEdit:["type",Oc]},sb=/^\d{4}(?:-\d\d){2}$/,cb=/^\[date\("([^"]*)"\)..date\("([^"]*)"\)\]$/,ub=/^(<|>)\s*date\("([^"]*)"\)$/,lb=/^date\("([^"]*)"\)$/;function db(e){if(!sb.test(e.trim()))return"Date must match pattern yyyy-MM-dd."}function pb(e,t){return"exact"===e?'date("'.concat(t[0],'")'):"before"===e?'< date("'.concat(t[0],'")'):"after"===e?'> date("'.concat(t[0],'")'):"between"===e?'[date("'.concat(t[0],'")..date("').concat(t[1],'")]'):void 0}function hb(){var e=new Date;return e.setUTCHours(0,0,0,0),e.toISOString().slice(0,10)}function fb(e){var t;return e&&""!==e.trim()?(t=e.match(cb))?{type:"between",dates:[t[1],t[2]]}:(t=e.match(ub))?{type:"<"===t[1]?"before":"after",date:t[2]}:(t=e.match(lb))?{type:"exact",date:t[1]}:void 0:{type:"exact",date:""}}var mb="between",gb=function(){l(o,a);var r=p(o);function o(e,t){h(this,o),(e=r.call(this,e,t))._translate=t.injector.get("translate"),e._modeling=t.injector.get("modeling");var n,i=fb(e.props.context.element.businessObject.text),i=(i?(n=i.date?[i.date,""]:i.dates||["",""],e.state={type:i.type,dates:n}):e.state={type:"exact",dates:["",""]},t.injector.get("debounceInput"));return e.debouncedEditCell=i(e.editCell.bind(d(e))),e.editCell=e.editCell.bind(d(e)),e.onTypeChange=e.onTypeChange.bind(d(e)),e.onSetStartDateTodayClick=e.onSetStartDateTodayClick.bind(d(e)),e.onSetEndDateTodayClick=e.onSetEndDateTodayClick.bind(d(e)),e.onStartDateInput=e.onStartDateInput.bind(d(e)),e.onEndDateInput=e.onEndDateInput.bind(d(e)),e}return u(o,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onTypeChange",value:function(e){var t=this.props.context.element,n=this.state.dates;this.setState({type:e}),fb(pb(e,n))&&this.editCell(t.businessObject,pb(e,n))}},{key:"onSetStartDateTodayClick",value:function(){var e=this.props.context.element,t=this.state,n=t.dates,t=t.type,i=hb();this.setState({dates:[i,n[1]]}),fb(pb(t,[i,n[1]]))&&this.editCell(e.businessObject,pb(t,[i,n[1]]))}},{key:"onSetEndDateTodayClick",value:function(){var e=this.props.context.element,t=this.state,n=t.dates,t=t.type,i=hb();this.setState({dates:[n[0],i]}),fb(pb(t,[n[0],i]))&&this.editCell(e.businessObject,pb(t,[n[0],i]))}},{key:"onStartDateInput",value:function(e){var e=e.value,t=this.props.context.element,n=this.state,i=n.dates,n=n.type;this.setState({dates:[e,i[1]]}),this.debouncedEditCell(t.businessObject,pb(n,[e,i[1]]))}},{key:"onEndDateInput",value:function(e){var e=e.value,t=this.props.context.element,n=this.state,i=n.dates,n=n.type;this.setState({dates:[i[0],e]}),this.debouncedEditCell(t.businessObject,pb(n,[i[0],e]))}},{key:"render",value:function(){var t=this,e=this.state,n=e.dates,e=e.type,i=[{label:this._translate("Exactly"),value:"exact"},{label:this._translate("Before"),value:"before"},{label:this._translate("After"),value:"after"},{label:this._translate("Between"),value:mb}];return I(1,"div","context-menu-container simple-date-edit",[I(1,"h3","dms-heading",this._translate("Edit date"),0),I(1,"div","dms-fill-row",A(2,Py,{noInput:!0,onChange:this.onTypeChange,options:i,value:e}),2),I(1,"h4","dms-heading",e===mb?this._translate("Edit start date"):this._translate("Set date"),0),I(1,"div",null,[A(2,Ay,{className:"start-date-input dms-block",onInput:this.onStartDateInput,placeholder:this._translate("e.g. { sample }",{sample:hb()}),validate:function(e){return db(e)&&t._translate(db(e))},value:n[0]}),I(1,"p","dms-hint",[I(1,"button","use-today",this._translate("Use today"),0,{type:"button",onClick:this.onSetStartDateTodayClick}),N(".")],4)],4),e===mb&&I(1,"h4","dms-heading",this._translate("Edit end date"),0),e===mb&&I(1,"div",null,[A(2,Ay,{className:"end-date-input dms-block",onInput:this.onEndDateInput,placeholder:this._translate("e.g. { sample }",{sample:hb()}),validate:function(e){return db(e)&&t._translate(db(e))},value:n[1]}),I(1,"p","dms-hint",[I(1,"button","use-today",this._translate("Use today"),0,{type:"button",onClick:this.onSetEndDateTodayClick}),N(".")],4)],4)],0)}}]),o}(),vb=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),(e=i.call(this,e,t))._translate=t.injector.get("translate"),e._modeling=t.injector.get("modeling");var n=fb(e.props.context.element.businessObject.text),n=(e.state={date:n?n.date:""},t.injector.get("debounceInput"));return e.debouncedEditCell=n(e.editCell.bind(d(e))),e.editCell=e.editCell.bind(d(e)),e.onClick=e.onClick.bind(d(e)),e.onInput=e.onInput.bind(d(e)),e}return u(r,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onClick",value:function(){var e=this.props.context.element,t=hb();this.setState({date:t}),this.editCell(e.businessObject,'date("'.concat(t,'")'))}},{key:"onInput",value:function(e){var e=e.value,t=this.props.context.element;this.setState({date:e}),this.debouncedEditCell(t.businessObject,'date("'.concat(e,'")'))}},{key:"render",value:function(){var t=this,e=this.state.date;return I(1,"div","context-menu-container simple-date-edit",[I(1,"h3","dms-heading",this._translate("Edit date"),0),I(1,"h4","dms-heading",this._translate("Set date"),0),I(1,"div",null,[A(2,Ay,{onInput:this.onInput,placeholder:this._translate("e.g. { example } ",{example:hb()}),validate:function(e){return db(e)&&t._translate(db(e))},value:e,className:"dms-block"}),I(1,"p","dms-hint",[this._translate("Set date"),N(" "),I(1,"button","use-today",this._translate("to today"),0,{type:"button",onClick:this.onClick}),N(".")],0)],4)],4)}}]),r}(),Nl=u(function e(t,n){h(this,e),n.registerProvider(function(e){var t=yb(e);return(x(e.col)||qn(e.col))&&_b(t)}),t.onGetComponent("context-menu",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.contextMenuType&&"simple-mode-edit"===e.contextMenuType&&e.element&&_b(yb(e.element))?x(e.element.col)?gb:qn(e.element.col)?vb:void 0:void 0})});function yb(e){return x(e.col)?e.col&&e.col.businessObject.inputExpression.typeRef:e.col&&e.col.businessObject.typeRef}function _b(e){return"date"===e}Nl.$inject=["components","simpleMode"];var bb={__depends__:[Gy,nb],__init__:["simpleDateEdit"],simpleDateEdit:["type",Nl]},xb=/^\d{4}(?:-\d\d){2}T(?:\d\d:){2}\d\d(?:Z|(?:[@+-][^")]+))?$/,wb=/^\[date and time\("([^"]*)"\)..date and time\("([^"]*)"\)\]$/,Cb=/^(<|>)\s*date and time\("([^"]*)"\)$/,Eb=/^date and time\("([^"]*)"\)$/;function kb(e){if(!xb.test(e.trim()))return"Date and time must match pattern yyyy-MM-ddTHH:mm:ss[time zone]."}function Sb(e,t){return"exact"===e?'date and time("'.concat(t[0],'")'):"before"===e?'< date and time("'.concat(t[0],'")'):"after"===e?'> date and time("'.concat(t[0],'")'):"between"===e?'[date and time("'.concat(t[0],'")..date and time("').concat(t[1],'")]'):void 0}function jb(){var e=new Date;return e.setUTCHours(0,0,0,0),e.toISOString().replace(".000Z","Z")}function Ob(e){var t;return e&&""!==e.trim()?(t=e.match(wb))?{type:"between",dates:[t[1],t[2]]}:(t=e.match(Cb))?{type:"<"===t[1]?"before":"after",date:t[2]}:(t=e.match(Eb))?{type:"exact",date:t[1]}:void 0:{type:"exact",date:""}}var Pb="between",Db=function(){l(o,a);var r=p(o);function o(e,t){h(this,o),(e=r.call(this,e,t))._translate=t.injector.get("translate"),e._modeling=t.injector.get("modeling");var n,i=Ob(e.props.context.element.businessObject.text),i=(i?(n=i.date?[i.date,""]:i.dates||["",""],e.state={type:i.type,dates:n}):e.state={type:"exact",dates:["",""]},t.injector.get("debounceInput"));return e.debouncedEditCell=i(e.editCell.bind(d(e))),e.editCell=e.editCell.bind(d(e)),e.onTypeChange=e.onTypeChange.bind(d(e)),e.onSetStartDateTodayClick=e.onSetStartDateTodayClick.bind(d(e)),e.onSetEndDateTodayClick=e.onSetEndDateTodayClick.bind(d(e)),e.onStartDateInput=e.onStartDateInput.bind(d(e)),e.onEndDateInput=e.onEndDateInput.bind(d(e)),e}return u(o,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onTypeChange",value:function(e){var t=this.props.context.element,n=this.state.dates;this.setState({type:e}),Ob(Sb(e,n))&&this.editCell(t.businessObject,Sb(e,n))}},{key:"onSetStartDateTodayClick",value:function(){var e=this.props.context.element,t=this.state,n=t.dates,t=t.type,i=jb();this.setState({dates:[i,n[1]]}),Ob(Sb(t,[i,n[1]]))&&this.editCell(e.businessObject,Sb(t,[i,n[1]]))}},{key:"onSetEndDateTodayClick",value:function(){var e=this.props.context.element,t=this.state,n=t.dates,t=t.type,i=jb();this.setState({dates:[n[0],i]}),Ob(Sb(t,[n[0],i]))&&this.editCell(e.businessObject,Sb(t,[n[0],i]))}},{key:"onStartDateInput",value:function(e){var e=e.value,t=this.props.context.element,n=this.state,i=n.dates,n=n.type;this.setState({dates:[e,i[1]]}),this.debouncedEditCell(t.businessObject,Sb(n,[e,i[1]]))}},{key:"onEndDateInput",value:function(e){var e=e.value,t=this.props.context.element,n=this.state,i=n.dates,n=n.type;this.setState({dates:[i[0],e]}),this.debouncedEditCell(t.businessObject,Sb(n,[i[0],e]))}},{key:"render",value:function(){var t=this,e=this.state,n=e.dates,e=e.type,i=[{label:this._translate("Exactly"),value:"exact"},{label:this._translate("Before"),value:"before"},{label:this._translate("After"),value:"after"},{label:this._translate("Between"),value:Pb}];return I(1,"div","context-menu-container simple-date-edit",[I(1,"h3","dms-heading",this._translate("Edit date and time"),0),I(1,"div","dms-fill-row",A(2,Py,{noInput:!0,onChange:this.onTypeChange,options:i,value:e}),2),I(1,"h4","dms-heading",e===Pb?this._translate("Edit start date"):this._translate("Set date"),0),I(1,"div",null,[A(2,Ay,{className:"start-date-input dms-block",onInput:this.onStartDateInput,placeholder:this._translate("e.g. { sample }",{sample:jb()}),validate:function(e){return kb(e)&&t._translate(kb(e))},value:n[0]}),I(1,"p","dms-hint",[I(1,"button","use-today",this._translate("Use today"),0,{type:"button",onClick:this.onSetStartDateTodayClick}),N(".")],4)],4),e===Pb&&I(1,"h4","dms-heading",this._translate("Edit end date"),0),e===Pb&&I(1,"div",null,[A(2,Ay,{className:"end-date-input dms-block",onInput:this.onEndDateInput,placeholder:this._translate("e.g. { sample }",{sample:jb()}),validate:function(e){return kb(e)&&t._translate(kb(e))},value:n[1]}),I(1,"p","dms-hint",[I(1,"button","use-today",this._translate("Use today"),0,{type:"button",onClick:this.onSetEndDateTodayClick}),N(".")],4)],4)],0)}}]),o}(),Rb=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),(e=i.call(this,e,t))._translate=t.injector.get("translate"),e._modeling=t.injector.get("modeling");var n=Ob(e.props.context.element.businessObject.text),n=(e.state={date:n?n.date:""},t.injector.get("debounceInput"));return e.debouncedEditCell=n(e.editCell.bind(d(e))),e.editCell=e.editCell.bind(d(e)),e.onClick=e.onClick.bind(d(e)),e.onInput=e.onInput.bind(d(e)),e}return u(r,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onClick",value:function(){var e=this.props.context.element,t=jb();this.setState({date:t}),this.editCell(e.businessObject,'date and time("'.concat(t,'")'))}},{key:"onInput",value:function(e){var e=e.value,t=this.props.context.element;this.setState({date:e}),this.debouncedEditCell(t.businessObject,'date and time("'.concat(e,'")'))}},{key:"render",value:function(){var t=this,e=this.state.date;return I(1,"div","context-menu-container simple-date-edit",[I(1,"h3","dms-heading",this._translate("Edit date and time"),0),I(1,"h4","dms-heading",this._translate("Set date and time"),0),I(1,"div",null,[A(2,Ay,{onInput:this.onInput,placeholder:this._translate("e.g. { sample }",{sample:jb()}),validate:function(e){return kb(e)&&t._translate(kb(e))},value:e,className:"dms-block"}),I(1,"p","dms-hint",[this._translate("Use"),N(" "),I(1,"button","use-today",this._translate("today"),0,{type:"button",onClick:this.onClick}),N(".")],0)],4)],4)}}]),r}(),$l=u(function e(t,n){h(this,e),n.registerProvider(function(e){var t=Tb(e);return(x(e.col)||qn(e.col))&&Mb(t)}),t.onGetComponent("context-menu",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.contextMenuType&&"simple-mode-edit"===e.contextMenuType&&e.element&&Mb(Tb(e.element))?x(e.element.col)?Db:qn(e.element.col)?Rb:void 0:void 0})});function Tb(e){return x(e.col)?e.col&&e.col.businessObject.inputExpression.typeRef:e.col&&e.col.businessObject.typeRef}function Mb(e){return"dateTime"===e}$l.$inject=["components","simpleMode"];var Ib={__depends__:[Gy,nb],__init__:["simpleDateTimeEdit"],simpleDateTimeEdit:["type",$l]};function Ab(){Ab=function(e,t){return new i(e,void 0,t)};var r=RegExp.prototype,a=new WeakMap;function i(e,t,n){t=new RegExp(e,t);return a.set(t,n||a.get(e)),Nb(t,i.prototype)}function o(r,e){var o=a.get(e);return Object.keys(o).reduce(function(e,t){var n=o[t];if("number"==typeof n)e[t]=r[n];else{for(var i=0;void 0===r[n[i]]&&i+1<n.length;)i++;e[t]=r[n[i]]}return e},Object.create(null))}var e=i,t=RegExp;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nb(e,t),i.prototype.exec=function(e){var t,e=r.exec.call(this,e);return e&&(e.groups=o(e,this),t=e.indices)&&(t.groups=o(t,this)),e},i.prototype[Symbol.replace]=function(e,t){var n,i;return"string"==typeof t?(n=a.get(this),r[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){t=n[t];return"$"+(Array.isArray(t)?t.join("$"):t)}))):"function"==typeof t?(i=this,r[Symbol.replace].call(this,e,function(){var e=arguments;return"object"!=Fe(e[e.length-1])&&(e=[].slice.call(e)).push(o(e,i)),t.apply(this,e)})):r[Symbol.replace].call(this,e,t)},Ab.apply(this,arguments)}function Nb(e,t){return(Nb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Bb={equals:"=",less:"<",lessEquals:"<=",greater:">",greaterEquals:">="};function Lb(e){return e&&""!==e.trim()?function(e){var t=zb(e);if(t)return{type:"comparison",operator:"equals",values:[t]};t=Fb(Ab(/^(=|(:?<|>)=?)\s*duration\("([^"]*)"\)$/,{operator:1,value:3}),e),e=t.operator,t=t.value;if(e&&t)return{type:"comparison",values:[t],operator:function(t){return ue(Bb).filter(function(e){return t===Bb[e]})[0]}(e)}}(e)||function(e){var e=Fb(Ab(/^([[\]])duration\("([^"]*)"\)\.\.duration\("([^"]*)"\)([[\]])$/,{start:1,firstValue:2,secondValue:3,end:4}),e),t=e.start,n=e.end,i=e.firstValue,e=e.secondValue;if(t&&n)return{type:"range",values:[i,e],start:"]"===t?"exclude":"include",end:"["===n?"exclude":"include"}}(e)||void 0:{type:"comparison",values:[]}}function Vb(e,t){return("equals"===e?'duration("':"".concat(Bb[e],' duration("')).concat(t,'")')}function $b(e,t,n,i){i="exclude"===i?"[":"]";return"".concat("exclude"===n?"]":"[",'duration("').concat(e,'")')+'..duration("'.concat(t,'")').concat(i)}function zb(e){e=/^duration\("([^"]*)"\)$/.exec(e);return e&&e[1]}function Fb(e,t){return(e.exec(t)||{groups:{}}).groups}var Ub={yearMonthDuration:"Must match PnYnM.",dayTimeDuration:"Must match PnDTnH."},Hb=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),(n=i.call(this,e,t))._translate=t.injector.get("translate"),n._type=e.type,n.onInput=n.onInput.bind(d(n)),n.validate=n.validate.bind(d(n)),n.state={value:e.value},n}return u(r,[{key:"onInput",value:function(e){e=e.value;this.setState({value:e}),this.props.onInput(e)}},{key:"validate",value:function(e){if(t=this._type,e=e,!("yearMonthDuration"===t?/^P(\d+Y\d+M|\d+Y|\d+M)$/.test(e):"dayTimeDuration"===t&&/^P(\d+DT\d+H|\d+D|T\d+H)$/.test(e)))return this._translate(Ub[this._type]);var t}},{key:"_getPlaceholder",value:function(){if("yearMonthDuration"===this._type)return this._translate("e.g. { sample }",{sample:"P1Y2M"});"dayTimeDuration"===this._type&&this._translate("e.g. { sample }",{sample:"P1DT2H"})}},{key:"render",value:function(){return A(2,Ay,{type:"text",onInput:this.onInput,placeholder:this._getPlaceholder(),validate:this.validate,value:this.state.value,className:this.props.className})}}]),r}(),Wb="comparison",qb="range",Gb=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),(e=i.call(this,e,t))._translate=t.injector.get("translate"),e._modeling=t.injector.get("modeling");var n=e.props.context.element,n=(e._type=n.col.businessObject.inputExpression.typeRef,Lb(n.businessObject.text,e._type)),n=(e.state=n?{type:n.type,comparisonOperator:n.operator||"equals",startValue:n.values[0]||"",endValue:n.values[1]||"",rangeStartType:n.start||"include",rangeEndType:n.end||"include"}:{type:Wb,comparisonOperator:"equals",startValue:"",endValue:"",rangeStartType:"include",rangeEndType:"include"},t.injector.get("debounceInput"));return e.debouncedEditCell=n(e.editCell.bind(d(e))),e.editCell=e.editCell.bind(d(e)),e.onComparisonOperatorChange=e.onComparisonOperatorChange.bind(d(e)),e.onComparisonValueChange=e.onComparisonValueChange.bind(d(e)),e.onTypeChange=e.onTypeChange.bind(d(e)),e.onRangeStartTypeChange=e.onRangeStartTypeChange.bind(d(e)),e.onRangeStartValueChange=e.onRangeStartValueChange.bind(d(e)),e.onRangeEndTypeChange=e.onRangeEndTypeChange.bind(d(e)),e.onRangeEndValueChange=e.onRangeEndValueChange.bind(d(e)),e}return u(r,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onTypeChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.comparisonOperator,r=n.startValue,o=n.endValue,a=n.rangeStartType,n=n.rangeEndType;e===Wb?this.editCell(t.businessObject,Vb(i,r)):this.editCell(t.businessObject,$b(r,o,a,n)),this.setState({type:e})}},{key:"onComparisonOperatorChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.type,n=n.startValue;i===Wb&&(this.editCell(t.businessObject,Vb(e,n)),this.setState({comparisonOperator:e}))}},{key:"onComparisonValueChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.type,n=n.comparisonOperator;i===Wb&&(this.debouncedEditCell(t.businessObject,Vb(n,e)),this.setState({startValue:e}))}},{key:"onRangeStartTypeChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.type,r=n.startValue,o=n.endValue,n=n.rangeEndType;i===qb&&(this.editCell(t.businessObject,$b(r,o,e,n)),this.setState({rangeStartType:e}))}},{key:"onRangeStartValueChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.type,r=n.endValue,o=n.rangeStartType,n=n.rangeEndType;i===qb&&(this.editCell(t.businessObject,$b(e,r,o,n)),this.setState({startValue:e}))}},{key:"onRangeEndTypeChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.type,r=n.startValue,o=n.endValue,n=n.rangeStartType;i===qb&&(this.editCell(t.businessObject,$b(r,o,n,e)),this.setState({rangeEndType:e}))}},{key:"onRangeEndValueChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.type,r=n.startValue,o=n.rangeStartType,n=n.rangeEndType;i===qb&&(this.editCell(t.businessObject,$b(r,e,o,n)),this.setState({endValue:e}))}},{key:"renderComparison",value:function(e,t){var n=[{label:this._translate("Equals"),value:"equals"},{label:this._translate("Less"),value:"less"},{label:this._translate("Less or equals"),value:"lessEquals"},{label:this._translate("Greater"),value:"greater"},{label:this._translate("Greater or equals"),value:"greaterEquals"}];return I(1,"div","comparison",[I(1,"h4","dms-heading",N("Value"),2),I(1,"div","dms-fill-row dms-input-duration-edit-row",[A(2,Py,{noInput:!0,onChange:this.onComparisonOperatorChange,options:n,value:e}),N(""),A(2,Hb,{type:this._type,className:"comparison-duration-input",onInput:this.onComparisonValueChange,value:t})],4)],4)}},{key:"renderRange",value:function(e,t,n,i){var r=[{label:this._translate("Include"),value:"include"},{label:this._translate("Exclude"),value:"exclude"}];return I(1,"div","range",[I(1,"h4","dms-heading",this._translate("Start value"),0),I(1,"div","dms-fill-row dms-input-duration-edit-row",[A(2,Py,{noInput:!0,onChange:this.onRangeStartTypeChange,options:r,value:n}),N(""),A(2,Hb,{type:this._type,className:"range-start-duration-input",onInput:this.onRangeStartValueChange,value:e})],4),I(1,"h4","dms-heading",this._translate("End value"),0),I(1,"div","dms-fill-row dms-input-duration-edit-row",[A(2,Py,{noInput:!0,onChange:this.onRangeEndTypeChange,options:r,value:i}),N(""),A(2,Hb,{type:this._type,className:"range-end-duration-input",onInput:this.onRangeEndValueChange,value:t})],4)],4)}},{key:"render",value:function(){var e=this.state,t=e.type,n=e.comparisonOperator,i=e.startValue,r=e.endValue,o=e.rangeStartType,e=e.rangeEndType,a=[{label:this._translate("Comparison"),value:Wb},{label:this._translate("Range"),value:qb}];return I(1,"div","context-menu-container simple-duration-edit",[I(1,"h3","dms-heading",this._translate("Edit duration"),0),I(1,"div","dms-fill-row",A(2,Py,{noInput:!0,onChange:this.onTypeChange,options:a,value:t}),2),t===Wb&&this.renderComparison(n,i),t===qb&&this.renderRange(i,r,o,e)],0)}}]),r}();var Kb=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),(e=i.call(this,e,t))._translate=t.injector.get("translate"),e._modeling=t.injector.get("modeling");var n=e.props.context.element,n=(e._type=n.col.businessObject.typeRef,t.injector.get("debounceInput"));return e.debouncedEditCell=n(e.editCell.bind(d(e))),e.editCell=e.editCell.bind(d(e)),e.onInput=e.onInput.bind(d(e)),e}return u(r,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onInput",value:function(e){var t=this.props.context.element;this.debouncedEditCell(t.businessObject,'duration("'.concat(e,'")'))}},{key:"render",value:function(){var e=zb(this.props.context.element.businessObject.text,this._type);return I(1,"div","context-menu-container simple-duration-edit",[I(1,"h3","dms-heading",this._translate("Edit duration"),0),I(1,"h4","dms-heading",this._translate("Set duration"),0),A(2,Hb,{onInput:this.onInput,value:e,type:this._type,className:"dms-block"})],4)}}]),r}();ed=u(function e(t,n){h(this,e),n.registerProvider(function(e){var t=Xb(e);return(x(e.col)||qn(e.col))&&Zb(t)}),t.onGetComponent("context-menu",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.contextMenuType&&"simple-mode-edit"===e.contextMenuType&&e.element&&Zb(Xb(e.element))?x(e.element.col)?Gb:qn(e.element.col)?Kb:void 0:void 0})});function Xb(e){return x(e.col)?e.col&&e.col.businessObject.inputExpression.typeRef:e.col&&e.col.businessObject.typeRef}ed.$inject=["components","simpleMode"];var Yb=["yearMonthDuration","dayTimeDuration"];function Zb(e){return Yb.includes(e)}var Qb={__depends__:[Gy,nb],__init__:["simpleDurationEdit"],simpleDurationEdit:["type",ed]},Jb=/^(-?(?:[0-9]|\.[0-9])+)$|^((?:<|>|=){0,2})\s*(-?(?:[0-9]|\.[0-9])+)$/,ex=/^(\[|\]){1}(-?(?:[0-9]|\.[0-9])+){1,}\.\.(-?(?:[0-9]|\.[0-9])+){1,}(\[|\]){1}$/,tx={equals:"=",less:"<",lessEquals:"<=",greater:">",greaterEquals:">="};function nx(e){var t,n,i;return e&&""!==e.trim()?(t=e.match(Jb),e=e.match(ex),t?(i=t)[0]&&i[1]&&!i[2]&&!i[3]?{type:"comparison",value:parseFloat(t[1]),operator:"equals"}:(i=t)[0]&&!i[1]&&i[2]&&i[3]?{type:"comparison",value:parseFloat(t[3]),operator:(n=t[2],ue(tx).filter(function(e){return n===tx[e]})[0])}:void 0:e?{type:"range",values:[e[2],e[3]].map(function(e){return parseFloat(e)}),start:"]"===e[1]?"exclude":"include",end:"["===e[4]?"exclude":"include"}:void 0):{type:"comparison"}}function ix(e,t){return("equals"===e?"":"".concat(tx[e]," ")).concat(t)}function rx(e,t,n,i){i="exclude"===i?"[":"]";return"".concat("exclude"===n?"]":"[").concat(e,"..").concat(t).concat(i)}var ox="comparison",ax="range",sx=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),(e=i.call(this,e,t))._translate=t.injector.get("translate"),e._modeling=t.injector.get("modeling");var n=nx(e.props.context.element.businessObject.text),n=(e.state=n?{type:n.type,comparisonOperator:n.operator||"equals",comparisonValue:n.value||0,rangeStartValue:n.values?n.values[0]:0,rangeEndValue:n.values?n.values[1]:0,rangeStartType:n.start||"include",rangeEndType:n.end||"include"}:{type:ox,comparisonOperator:"equals",comparisonValue:0,rangeStartValue:0,rangeEndValue:0,rangeStartType:"include",rangeEndType:"include"},t.injector.get("debounceInput"));return e.debouncedEditCell=n(e.editCell.bind(d(e))),e.editCell=e.editCell.bind(d(e)),e.onComparisonOperatorChange=e.onComparisonOperatorChange.bind(d(e)),e.onComparisonValueChange=e.onComparisonValueChange.bind(d(e)),e.onTypeChange=e.onTypeChange.bind(d(e)),e.onRangeStartTypeChange=e.onRangeStartTypeChange.bind(d(e)),e.onRangeStartValueChange=e.onRangeStartValueChange.bind(d(e)),e.onRangeEndTypeChange=e.onRangeEndTypeChange.bind(d(e)),e.onRangeEndValueChange=e.onRangeEndValueChange.bind(d(e)),e}return u(r,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onTypeChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.comparisonOperator,r=n.comparisonValue,o=n.rangeStartValue,a=n.rangeEndValue,s=n.rangeStartType,n=n.rangeEndType;e===ox?this.editCell(t.businessObject,ix(i,r)):this.editCell(t.businessObject,rx(o,a,s,n)),this.setState({type:e})}},{key:"onComparisonOperatorChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.type,n=n.comparisonValue;i===ox&&(this.editCell(t.businessObject,ix(e,n)),this.setState({comparisonOperator:e}))}},{key:"onComparisonValueChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.type,n=n.comparisonOperator;i===ox&&(this.debouncedEditCell(t.businessObject,ix(n,e)),this.setState({comparisonValue:e}))}},{key:"onRangeStartTypeChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.type,r=n.rangeStartValue,o=n.rangeEndValue,n=n.rangeEndType;i===ax&&(this.editCell(t.businessObject,rx(r,o,e,n)),this.setState({rangeStartType:e}))}},{key:"onRangeStartValueChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.type,r=n.rangeEndValue,o=n.rangeStartType,n=n.rangeEndType;i===ax&&(this.editCell(t.businessObject,rx(e,r,o,n)),this.setState({rangeStartValue:e}))}},{key:"onRangeEndTypeChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.type,r=n.rangeStartValue,o=n.rangeEndValue,n=n.rangeStartType;i===ax&&(this.editCell(t.businessObject,rx(r,o,n,e)),this.setState({rangeEndType:e}))}},{key:"onRangeEndValueChange",value:function(e){var t=this.props.context.element,n=this.state,i=n.type,r=n.rangeStartValue,o=n.rangeStartType,n=n.rangeEndType;i===ax&&(this.editCell(t.businessObject,rx(r,e,o,n)),this.setState({rangeEndValue:e}))}},{key:"renderComparison",value:function(e,t){var n=[{label:this._translate("Equals"),value:"equals"},{label:this._translate("Less"),value:"less"},{label:this._translate("Less or equals"),value:"lessEquals"},{label:this._translate("Greater"),value:"greater"},{label:this._translate("Greater or equals"),value:"greaterEquals"}];return I(1,"div","comparison",[I(1,"h4","dms-heading",this._translate("Value"),0),I(1,"div","dms-fill-row",[A(2,Py,{noInput:!0,onChange:this.onComparisonOperatorChange,options:n,value:e}),N(""),A(2,dy,{className:"comparison-number-input",onInput:this.onComparisonValueChange,type:"number",value:t})],4)],4)}},{key:"renderRange",value:function(e,t,n,i){var r=[{label:this._translate("Include"),value:"include"},{label:this._translate("Exclude"),value:"exclude"}];return I(1,"div","range",[I(1,"h4","dms-heading",this._translate("Start value"),0),I(1,"div","dms-fill-row",[A(2,Py,{noInput:!0,onChange:this.onRangeStartTypeChange,options:r,value:n}),N(""),A(2,dy,{className:"range-start-number-input",onInput:this.onRangeStartValueChange,type:"number",value:e})],4),I(1,"h4","dms-heading",this._translate("End value"),0),I(1,"div","dms-fill-row",[A(2,Py,{noInput:!0,onChange:this.onRangeEndTypeChange,options:r,value:i}),N(""),A(2,dy,{className:"range-end-number-input",onInput:this.onRangeEndValueChange,type:"number",value:t})],4)],4)}},{key:"render",value:function(){var e=this.state,t=e.type,n=e.comparisonOperator,i=e.comparisonValue,r=e.rangeStartValue,o=e.rangeEndValue,a=e.rangeStartType,e=e.rangeEndType,s=[{label:this._translate("Comparison"),value:ox},{label:this._translate("Range"),value:ax}];return I(1,"div","context-menu-container simple-number-edit",[I(1,"h3","dms-heading",this._translate("Edit Number"),0),I(1,"div","dms-fill-row",A(2,Py,{noInput:!0,onChange:this.onTypeChange,options:s,value:t}),2),t===ox&&this.renderComparison(n,i),t===ax&&this.renderRange(r,o,a,e)],0)}}]),r}(),cx=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),(e=i.call(this,e,t))._translate=t.injector.get("translate"),e._modeling=t.injector.get("modeling");var n=nx(e.props.context.element.businessObject.text),n=(e.state=n?{value:n.value}:{value:""},t.injector.get("debounceInput"));return e.debouncedEditCell=n(e.editCell.bind(d(e))),e.editCell=e.editCell.bind(d(e)),e.onInput=e.onInput.bind(d(e)),e}return u(r,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onInput",value:function(e){var t=this.props.context.element;this.debouncedEditCell(t.businessObject,e),this.setState({value:e})}},{key:"render",value:function(){var e=this.state.value;return I(1,"div","context-menu-container simple-number-edit",[I(1,"h3","dms-heading",this._translate("Edit Number"),0),I(1,"h4","dms-heading",this._translate("Set Value"),0),A(2,dy,{onInput:this.onInput,type:"number",value:e})],4)}}]),r}(),nd=u(function e(t,n){h(this,e),n.registerProvider(function(e){var t=ux(e);return(x(e.col)||qn(e.col))&&dx(t)}),t.onGetComponent("context-menu",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.contextMenuType&&"simple-mode-edit"===e.contextMenuType&&e.element&&dx(ux(e.element))?x(e.element.col)?sx:qn(e.element.col)?cx:void 0:void 0})});function ux(e){return x(e.col)?e.col&&e.col.businessObject.inputExpression.typeRef:e.col&&e.col.businessObject.typeRef}nd.$inject=["components","simpleMode"];var lx=["number","integer","long","double"];function dx(e){return lx.includes(e)}var px={__depends__:[Gy,nb],__init__:["simpleNumberEdit"],simpleNumberEdit:["type",nd]};function hx(e){if(!e||fx(e.trim()))return{type:"disjunction",values:[]};var t=e.split(","),n={type:"disjunction",values:[]},i="";if(t.forEach(function(e){i+=e,/^"[^"]*"$/.test(i.trim())?(n.values.push(i.trim()),i=""):i+=","}),!i)return n;n.type="negation",n.values=[];i="",e=e.match(/^\s*not\((.*)\)\s*$/);return e&&((t=e[1].split(",")).forEach(function(e){i+=e,/^"[^"]*"$/.test(i.trim())?(n.values.push(i.trim()),i=""):i+=","}),!i)?n:void 0}function fx(e){return""===e}var mx="disjunction",gx="negation",vx=function(){l(c,a);var s=p(c);function c(e,t){var n;h(this,c),(n=s.call(this,e,t))._translate=t.injector.get("translate"),n._modeling=t.injector.get("modeling");var i=(i=hx(e.context.element.businessObject.text))||{values:[],type:mx},r=!(o=x(o=e.context.element.col.businessObject)?o.inputValues:o.outputValues)||fx(o.text)?[]:o.text.split(",").map(function(e){return e.trim()}),o=i.values.filter(function(e){return!_x(r,e)}),e=x(e.context.element.col),a=r.map(function(e){return{value:e,isChecked:_x(i.values,e),isRemovable:!1,group:n._translate("Predefined Values")}}),o=(e&&(a=a.concat(o.map(function(e){return{value:e,isChecked:!0,isRemovable:!0,group:n._translate("Custom Values")}}))),""),e=(e||!i.values.length||_x(r,i.values[0])||(o=i.values[0]),n.state={items:a,unaryTestsType:i.type,inputValue:o,isOutputValueInputChecked:""!==o},t.injector.get("debounceInput"));return n.debouncedEditCell=e(n.editCell.bind(d(n))),n.editCell=n.editCell.bind(d(n)),n.addUnaryTestsListItem=n.addUnaryTestsListItem.bind(d(n)),n.onInput=n.onInput.bind(d(n)),n.onKeyDown=n.onKeyDown.bind(d(n)),n.onOutputValueInputClick=n.onOutputValueInputClick.bind(d(n)),n.onUnaryTestsListChanged=n.onUnaryTestsListChanged.bind(d(n)),n.onUnaryTestsTypeChange=n.onUnaryTestsTypeChange.bind(d(n)),n}return u(c,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onUnaryTestsTypeChange",value:function(e){var t=yx(this.state.items),n=this.props.context.element;e===mx?(this.editCell(n.businessObject,t.join(",")),this.setState({unaryTestsType:mx})):(this.editCell(n.businessObject,"not(".concat(t.join(","),")")),this.setState({unaryTestsType:gx}))}},{key:"onUnaryTestsListChanged",value:function(e){var t=yx(e),n=this.props.context.element;this.state.unaryTestsType===mx?this.editCell(n.businessObject,t.join(",")):this.editCell(n.businessObject,"not(".concat(t.join(","),")")),this.setState({items:e,isOutputValueInputChecked:!1})}},{key:"onOutputValueInputClick",value:function(){var e=this.props.context.element,t=this.state,n=t.inputValue,t=t.items,n=hx(n);!n||1<n.values.length||(this.editCell(e.businessObject,"".concat(n.values.join(""))),this.setState({items:t.map(function(e){return e.isChecked=!1,e}),isOutputValueInputChecked:!0}))}},{key:"onInput",value:function(e){var t=e.isValid,e=e.value,n=this.state.isOutputValueInputChecked,i=(this.setState({inputValue:e}),this.props.context.element);!x(i)&&t&&n&&this.debouncedEditCell(i.businessObject,e)}},{key:"onKeyDown",value:function(e){var t,n=e.isValid,e=e.event;13===e.keyCode&&(!(t=x(this.props.context.element.col))&&n||(e.stopPropagation(),e.preventDefault()),n)&&(t?this.addUnaryTestsListItem():this.onOutputValueInputClick())}},{key:"addUnaryTestsListItem",value:function(){var e,t,n=this,i=this.state,r=i.inputValue,o=i.items,i=i.unaryTestsType,r=hx(r);r&&(e=this.props.context.element,t=yx(o),t=[].concat(t,r.values),i===mx?this.editCell(e.businessObject,t.join(",")):this.editCell(e.businessObject,"not(".concat(t.join(","),")")),i=o.concat(r.values.map(function(e){return{value:e,isChecked:!0,isRemovable:!0,group:n._translate("Custom Values")}})),this.setState({items:i,inputValue:""}))}},{key:"render",value:function(){var t=this,e=this.props.context.element,n=this.state,i=n.inputValue,r=n.isOutputValueInputChecked,o=n.items,n=n.unaryTestsType,a=[{label:this._translate("Match one"),value:mx},{label:this._translate("Match none"),value:gx}],e=x(e.col),n=n===gx,s=!e&&0<o.length;return I(1,"div","simple-string-edit context-menu-container",[I(1,"h3","dms-heading",this._translate("Edit String"),0),e&&I(1,"p",null,A(2,Py,{noInput:!0,onChange:this.onUnaryTestsTypeChange,options:a,value:n?gx:mx},null,function(e){return t.selectNode=e}),2),A(2,Iy,{onChange:this.onUnaryTestsListChanged,items:o,type:e?"checkbox":"radio"}),I(1,"h4","dms-heading",e?this._translate("Add Values"):this._translate("Set Value"),0),I(1,"div","dms-fill-row",[s&&I(64,"input","cursor-pointer",null,1,{checked:r,onClick:this.onOutputValueInputClick,type:"radio",style:{marginRight:"8px"}}),A(2,Ay,{className:"dms-block",onKeyDown:this.onKeyDown,onInput:this.onInput,placeholder:e?this._translate('"value", "value", ...'):this._translate('"value"'),type:"text",validate:function(e){if(!hx(e))return t._translate("Strings must be in double quotes.")},value:i})],0)],0)}}]),c}();function yx(e){return e.filter(function(e){return e.isChecked}).map(function(e){return e.value})}function _x(e,t){return-1!==e.indexOf(t)}Xl=u(function e(t,n){h(this,e),n.registerProvider(function(e){return(x(e.col)||qn(e.col))&&"string"===bx(e)}),t.onGetComponent("context-menu",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.contextMenuType&&"simple-mode-edit"===e.contextMenuType&&e.element&&"string"===bx(e.element)?vx:void 0})});function bx(e){return x(e.col)?e.col&&e.col.businessObject.inputExpression.typeRef:e.col&&e.col.businessObject.typeRef}Xl.$inject=["components","simpleMode"];var xx={__depends__:[Gy,nb],__init__:["simpleStringEdit"],simpleStringEdit:["type",Xl]},wx=/^(?:\d\d:){2}\d\d(?:Z|(?:[@+-][^")]+))?$/,Cx=/^\[time\("([^"]*)"\)..time\("([^"]*)"\)\]$/,Ex=/^(<|>)\s*time\("([^"]*)"\)$/,kx=/^time\("([^"]*)"\)$/;function Sx(e){if(!wx.test(e.trim()))return"Time must match pattern hh:mm:ss[time zone]."}function jx(e,t){return"exact"===e?'time("'.concat(t[0],'")'):"before"===e?'< time("'.concat(t[0],'")'):"after"===e?'> time("'.concat(t[0],'")'):"between"===e?'[time("'.concat(t[0],'")..time("').concat(t[1],'")]'):void 0}function Ox(){return(new Date).toISOString().slice(11,-5)+"Z"}function Px(e){var t;return e&&""!==e.trim()?(t=e.match(Cx))?{type:"between",times:[t[1],t[2]]}:(t=e.match(Ex))?{type:"<"===t[1]?"before":"after",time:t[2]}:(t=e.match(kx))?{type:"exact",time:t[1]}:void 0:{type:"exact",time:""}}var Dx="between",Rx=function(){l(o,a);var r=p(o);function o(e,t){h(this,o),(e=r.call(this,e,t))._translate=t.injector.get("translate"),e._modeling=t.injector.get("modeling");var n,i=Px(e.props.context.element.businessObject.text),i=(i?(n=i.time?[i.time,""]:i.times||["",""],e.state={type:i.type,times:n}):e.state={type:"exact",times:["",""]},t.injector.get("debounceInput"));return e.debouncedEditCell=i(e.editCell.bind(d(e))),e.editCell=e.editCell.bind(d(e)),e.onTypeChange=e.onTypeChange.bind(d(e)),e.onSetStartTimeNowClick=e.onSetStartTimeNowClick.bind(d(e)),e.onSetEndTimeNowClick=e.onSetEndTimeNowClick.bind(d(e)),e.onStartTimeInput=e.onStartTimeInput.bind(d(e)),e.onEndTimeInput=e.onEndTimeInput.bind(d(e)),e}return u(o,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onTypeChange",value:function(e){var t=this.props.context.element,n=this.state.times;this.setState({type:e}),Px(jx(e,n))&&this.editCell(t.businessObject,jx(e,n))}},{key:"onSetStartTimeNowClick",value:function(){var e=this.props.context.element,t=this.state,n=t.times,t=t.type,i=Ox();this.setState({times:[i,n[1]]}),Px(jx(t,[i,n[1]]))&&this.editCell(e.businessObject,jx(t,[i,n[1]]))}},{key:"onSetEndTimeNowClick",value:function(){var e=this.props.context.element,t=this.state,n=t.times,t=t.type,i=Ox();this.setState({times:[n[0],i]}),Px(jx(t,[n[0],i]))&&this.editCell(e.businessObject,jx(t,[n[0],i]))}},{key:"onStartTimeInput",value:function(e){var e=e.value,t=this.props.context.element,n=this.state,i=n.times,n=n.type;this.setState({times:[e,i[1]]}),this.debouncedEditCell(t.businessObject,jx(n,[e,i[1]]))}},{key:"onEndTimeInput",value:function(e){var e=e.value,t=this.props.context.element,n=this.state,i=n.times,n=n.type;this.setState({times:[i[0],e]}),this.debouncedEditCell(t.businessObject,jx(n,[i[0],e]))}},{key:"render",value:function(){var t=this,e=this.state,n=e.times,e=e.type,i=[{label:this._translate("Exactly"),value:"exact"},{label:this._translate("Before"),value:"before"},{label:this._translate("After"),value:"after"},{label:this._translate("Between"),value:Dx}];return I(1,"div","context-menu-container simple-time-edit",[I(1,"h3","dms-heading",this._translate("Edit time"),0),I(1,"div","dms-fill-row",A(2,Py,{noInput:!0,onChange:this.onTypeChange,options:i,value:e}),2),I(1,"h4","dms-heading",e===Dx?this._translate("Edit start time"):this._translate("Set time"),0),I(1,"div",null,[A(2,Ay,{className:"start-time-input dms-block",onInput:this.onStartTimeInput,placeholder:this._translate("e.g. { example } ",{example:hb()}),validate:function(e){return Sx(e)&&t._translate(Sx(e))},value:n[0]}),I(1,"p","dms-hint",[I(1,"button","use-now",this._translate("Use now"),0,{type:"button",onClick:this.onSetStartTimeNowClick}),N(".")],4)],4),e===Dx&&I(1,"h4","dms-heading",this._translate("Edit end time"),0),e===Dx&&I(1,"div",null,[A(2,Ay,{className:"end-time-input dms-block",onInput:this.onEndTimeInput,placeholder:this._translate("e.g. { example } ",{example:hb()}),validate:function(e){return Sx(e)&&t._translate(Sx(e))},value:n[1]}),I(1,"p","dms-hint",[I(1,"button","use-now",this._translate("Use now"),0,{type:"button",onClick:this.onSetEndTimeNowClick}),N(".")],4)],4)],0)}}]),o}(),Tx=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),(e=i.call(this,e,t))._translate=t.injector.get("translate"),e._modeling=t.injector.get("modeling");var n=Px(e.props.context.element.businessObject.text),n=(e.state={date:n?n.date:""},t.injector.get("debounceInput"));return e.debouncedEditCell=n(e.editCell.bind(d(e))),e.editCell=e.editCell.bind(d(e)),e.onClick=e.onClick.bind(d(e)),e.onInput=e.onInput.bind(d(e)),e}return u(r,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onClick",value:function(){var e=this.props.context.element,t=Ox();this.setState({date:t}),this.editCell(e.businessObject,'time("'.concat(t,'")'))}},{key:"onInput",value:function(e){var e=e.value,t=this.props.context.element;this.setState({date:e}),this.debouncedEditCell(t.businessObject,'time("'.concat(e,'")'))}},{key:"render",value:function(){var t=this,e=this.state.date;return I(1,"div","context-menu-container simple-time-edit",[I(1,"h3","dms-heading",this._translate("Edit Date"),0),I(1,"h4","dms-heading",this._translate("Set Date"),0),I(1,"div",null,[A(2,Ay,{onInput:this.onInput,placeholder:this._translate("e.g. { example } ",{example:hb()}),validate:function(e){return Sx(e)&&t._translate(Sx(e))},value:e,className:"dms-block"}),I(1,"p","dms-hint",[this._translate("Set date"),N(" "),I(1,"button","use-now",this._translate("to now"),0,{type:"button",onClick:this.onClick}),N(".")],0)],4)],4)}}]),r}(),ml=u(function e(t,n){h(this,e),n.registerProvider(function(e){var t=Mx(e);return(x(e.col)||qn(e.col))&&Ix(t)}),t.onGetComponent("context-menu",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.contextMenuType&&"simple-mode-edit"===e.contextMenuType&&e.element&&Ix(Mx(e.element))?x(e.element.col)?Rx:qn(e.element.col)?Tx:void 0:void 0})});function Mx(e){return x(e.col)?e.col&&e.col.businessObject.inputExpression.typeRef:e.col&&e.col.businessObject.typeRef}function Ix(e){return"time"===e}ml.$inject=["components","simpleMode"];var Ax={__depends__:[Gy,nb],__init__:["simpleTimeEdit"],simpleTimeEdit:["type",ml]};function Nx(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var Bx=function(){l(i,a);var n=p(i);function i(e,t){var l;return h(this,i),Nx(d(l=n.call(this,e,t)),"onElementsChanged",function(){l.forceUpdate()}),Nx(d(l),"handleMouseDown",function(e){var n,i,t,r,o,a,s=Cn(e.target,"th",!1);function c(e){e.preventDefault();var t=u(e.clientX);n&&cancelAnimationFrame(n),n=requestAnimationFrame(function(){i.style.width=t+"px"})}function u(e){return Math.max(o+(e-a),t)}s={node:s,event:e,minWidth:l.props.minWidth||150,onEnd:l.saveWidth},i=s.node,e=s.event,t=s.minWidth,s=s.onEnd,r=void 0===s?Lx:s,e.preventDefault(),o=i.getBoundingClientRect().width,a=e.clientX,document.addEventListener("mousemove",c),document.addEventListener("mouseup",function e(t){t.preventDefault(),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",e);t=u(t.clientX);r(t)})}),Nx(d(l),"saveWidth",function(e){var t=l.props.col,n={};k(t,"dmn:DecisionTable")?n.annotationsWidth=e:n.width=e,l.modeling.updateProperties(t,n)}),Im(d(l)),l}return u(i,[{key:"componentDidMount",value:function(){var e=this.getRoot();this.changeSupport.onElementsChanged(e,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.getRoot();this.changeSupport.offElementsChanged(e,this.onElementsChanged)}},{key:"getRoot",value:function(){return this.sheet.getRoot()}},{key:"isLastInputOrOutput",value:function(){var e,t=this.props.col,n=Gn(this.getRoot());return k(t,"dmn:InputClause")?(e=n.get("input")).indexOf(t)===e.length-1:k(t,"dmn:OutputClause")?(e=n.get("output")).indexOf(t)===e.length-1:void 0}},{key:"render",value:function(){var e=this.isLastInputOrOutput()?{right:"-7px",width:"27px"}:null;return I(1,"div","resize-column-handle",null,1,{onMouseDown:this.handleMouseDown,title:this.translate("Resize"),style:e})}}]),i}();function Lx(){}function Vx(e){e.onGetComponent("cell-inner",function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).cellType;if("input-cell"===e||"output-cell"===e||"annotations"===e)return Bx})}Bx.$inject=["sheet","changeSupport","translate","modeling"],Vx.$inject=["components"];var $x={__init__:["columnResizeProvider"],columnResizeProvider:["type",Vx]},zx=function(){l(t,Tg);var e=p(t);function t(){return h(this,t),e.apply(this,arguments)}return u(t,[{key:"getModules",value:function(){return[].concat(f(Tg._getModules()),f(t._getModules()))}}],[{key:"_getModules",value:function(){return[Sv,zv,cv,Kv,xv,Qv,iy,oy,sy,kv,Ky,$x,c_,m_,g_,pg,Gy,w_,Ev,O_,Bg,X_,Q_,Ag,nb,ab,bb,Ib,Qb,px,xx,Ax]}}]),t}(),bc=function(){function t(e){var n=this;h(this,t),this._listeners={},e.on("elements.changed",function(e){e=e.elements;n.elementsChanged(e)}),e.on("element.updateId",function(e){var t=e.element,e=e.newId;n.updateId(t.id,e)})}return u(t,[{key:"elementsChanged",value:function(e){for(var t={},n=e.length,i=0;i<n;i++){var r=e[i].id;if(t[r])return;t[r]=!0;var o=this._listeners[r]&&this._listeners[r].length;if(o)for(var a=0;a<o;a++)this._listeners[r][a]&&this._listeners[r][a]()}}},{key:"onElementsChanged",value:function(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e][this._listeners[e].length]=t}},{key:"offElementsChanged",value:function(e,t){this._listeners[e]&&(t?-1!==(t=this._listeners[e].indexOf(t))&&this._listeners[e].splice(t,1):this._listeners[e].length=0)}},{key:"updateId",value:function(e,t){this._listeners[e]&&(this._listeners[t]=this._listeners[e],delete this._listeners[e])}}]),t}(),ia=(bc.$inject=["eventBus"],function(){function e(){h(this,e),this._listeners={}}return u(e,[{key:"getComponent",value:function(e,t){var n=this._listeners[e];if(n){for(var i,r=0;r<n.length&&!(i=n[r].callback(t));r++);return i}}},{key:"getComponents",value:function(e,t){var n=this._listeners[e];if(n){for(var i=[],r=0;r<n.length;r++){var o=n[r].callback(t);o&&i.push(o)}if(i.length)return i}}},{key:"onGetComponent",value:function(e,t,n){if(te(t)&&(n=t,t=1e3),!g(t))throw new Error("priority must be a number");for(var i,r=this._getListeners(e),o={priority:t,callback:n},a=0;i=r[a];a++)if(i.priority<t)return void r.splice(a,0,o);r.push(o)}},{key:"offGetComponent",value:function(e,t){var n,i,r=this._getListeners(e);if(t)for(i=r.length-1;n=r[i];i--)n.callback===t&&r.splice(i,1);else r.length=0}},{key:"_getListeners",value:function(e){var t=this._listeners[e];return t||(this._listeners[e]=t=[]),t}}]),e}()),Fx=function(){l(i,a);var n=p(i);function i(e){h(this,i);var t,e=(t=n.call(this,e))._injector=e.injector;return t._changeSupport=e.get("changeSupport"),t._components=e.get("components"),t._renderer=e.get("renderer"),t}return u(i,[{key:"getChildContext",value:function(){return{changeSupport:this._changeSupport,components:this._components,renderer:this._renderer,injector:this._injector}}},{key:"render",value:function(){var e=this._components.getComponents("viewer");return I(1,"div","viewer-container",e&&e.map(function(e,t){return A(2,e,null,t)}),0)}}]),i}(),_d=function(){function a(e,t,n,i,r){h(this,a);var o=n.container;this._container=o,i.on("renderer.mount",function(){gm(A(2,Fx,{injector:r}),o)}),i.on("renderer.unmount",function(){gm(null,o)})}return u(a,[{key:"getContainer",value:function(){return this._container}}]),a}(),Ux=(_d.$inject=["changeSupport","components","config.renderer","eventBus","injector"],{__init__:["changeSupport","components","renderer"],changeSupport:["type",bc],components:["type",ia],eventBus:["type",Ce],renderer:["type",_d]}),Hx=["modules"];function Wx(e,t){if(null==e)return{};var n,i=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);return i}var qx=function(){function i(){h(this,i);var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.injector;n||(e=(t=this._init(t)).modules,n=function(e,t){e=new oi([{config:["value",e]},Ux].concat(t||[]));return e.init(),e}(t.config,e)),this.get=n.get,this.invoke=n.invoke,this.get("eventBus").fire("viewer.init")}return u(i,[{key:"_init",value:function(e){return{modules:e.modules,config:Wx(e,Hx)}}},{key:"destroy",value:function(){this.get("eventBus").fire("viewer.destroy")}},{key:"clear",value:function(){this.get("eventBus").fire("viewer.clear")}}]),i}();var Pd=function(){function n(e,t){h(this,n),this._eventBus=t,this._viewer=e}return u(n,[{key:"getDecision",value:function(){return this._viewer.getDecision()}},{key:"updateId",value:function(e,t){if(e!==this.getDecision())throw new Error("element !== decision");this._eventBus.fire("element.updateId",{element:e,newId:t}),e.id=t}}]),n}(),Gx=(Pd.$inject=["viewer","eventBus"],{__init__:["elementRegistry"],elementRegistry:["type",Pd]}),Kx=function(){l(i,a);var n=p(i);function i(e,t){return h(this,i),(e=n.call(this,e,t))._viewer=t.injector.get("viewer"),e}return u(i,[{key:"render",value:function(){return I(1,"div","decision-properties",I(1,"h3","decision-name",this._viewer.getDecision().name,0),2)}}]),i}(),e=u(function e(t){h(this,e),t.onGetComponent("viewer",1500,function(){return Kx})}),Xx=(e.$inject=["components"],{__init__:["decisionProperties"],decisionProperties:["type",e]}),Yx=function(){l(i,a);var n=p(i);function i(e,t){return h(this,i),(e=n.call(this,e,t))._translate=t.injector.get("translate"),e._viewer=t.injector.get("viewer"),e}return u(i,[{key:"render",value:function(){var e=this._viewer.getDecision(),t=e.decisionLogic,e=e.variable;return I(1,"div","literal-expression-properties",I(1,"table",null,[I(1,"tr",null,[I(1,"td",null,this._translate("Variable Name:"),0),I(1,"td",null,I(1,"span",null,e.name||"-",0),2)],4),I(1,"tr",null,[I(1,"td",null,this._translate("Variable Type:"),0),I(1,"td",null,I(1,"span",null,this._translate(e.typeRef)||"-",0),2)],4),I(1,"tr",null,[I(1,"td",null,this._translate("Expression Language:"),0),I(1,"td",null,I(1,"span",null,t.expressionLanguage||"-",0),2)],4)],4),2)}}]),i}(),Ps=u(function e(t){h(this,e),t.onGetComponent("viewer",500,function(){return Yx})}),Zx=(Ps.$inject=["components"],{__depends__:[],__init__:["literalExpressionProperties"],literalExpressionProperties:["type",Ps]});function Qx(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var Jx=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),Qx(d(n=i.call(this,e,t)),"onClick",function(){n._eventBus.fire("poweredBy.show")});var n,e=t.injector;return n._eventBus=e.get("eventBus"),n}return u(r,[{key:"render",value:function(){var t=this;return I(1,"div","powered-by",I(1,"div","powered-by__logo",A(2,kg),2),2,{onClick:this.onClick,title:"Powered by bpmn.io"},null,function(e){return t.node=e})}}]),r}(),e0=function(){l(n,a);var t=p(n);function n(e){return h(this,n),(e=t.call(this,e)).state={show:!1},e.onClick=e.onClick.bind(d(e)),e.onShow=e.onShow.bind(d(e)),e}return u(n,[{key:"onClick",value:function(){this.setState({show:!1})}},{key:"onShow",value:function(){this.setState({show:!0})}},{key:"componentWillMount",value:function(){(this._eventBus=this.context.injector.get("eventBus")).on("poweredBy.show",this.onShow)}},{key:"componentWillUnmount",value:function(){this._eventBus.off("poweredBy.show",this.onShow)}},{key:"render",value:function(){return this.state.show&&I(1,"div","powered-by-overlay",I(1,"div","powered-by-overlay-content",[I(1,"a","logo",A(2,kg),2,{href:"https://bpmn.io",target:"_blank",rel:"noopener"}),I(1,"span",null,[N("Web-based tooling for BPMN, DMN and CMMN diagrams powered by "),I(1,"a",null,N("bpmn.io"),2,{href:"http://bpmn.io",target:"_blank"}),N(".")],4)],4,{onClick:function(e){return e.stopPropagation()}}),2,{onClick:this.onClick})}}]),n}(),pd=u(function e(t,n){h(this,e),t.onGetComponent("viewer",2e3,function(){return Jx}),t.onGetComponent("viewer",function(){return e0})}),t0=(pd.$inject=["components","eventBus"],{__init__:["poweredBy"],poweredBy:["type",pd]}),n0=function(){l(i,a);var n=p(i);function i(e,t){return h(this,i),(e=n.call(this,e,t))._viewer=t.injector.get("viewer"),e}return u(i,[{key:"render",value:function(){return I(1,"div","textarea",I(1,"div","content",this._viewer.getDecision().decisionLogic.text,0),2)}}]),i}(),aa=u(function e(t){h(this,e),t.onGetComponent("viewer",function(){return n0})}),i0=(aa.$inject=["components"],{__init__:["textarea"],textarea:["type",aa]});function r0(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var o0=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),r0(d(n=i.call(this,e,t)),"onClick",function(){n._eventBus.fire("showDrd")});var n,e=t.injector;return n._translate=e.get("translate"),n._eventBus=e.get("eventBus"),n}return u(r,[{key:"render",value:function(){var t=this;return I(1,"div","view-drd",I(1,"button","view-drd-button",this._translate("View DRD"),0,{type:"button",onClick:this.onClick}),2,null,null,function(e){return t.node=e})}}]),r}(),Wr=(o0.$inject=["translate"],function(){function o(e,t,n,i){var r=this;h(this,o),this._injector=i,this._viewer=t,e.onGetComponent("viewer",2e3,function(){if(r.canViewDrd())return o0}),n.on("showDrd",function(){var e=i.get("_parent",!1),t=r.getDefinitions(),t=e.getView(t);e.open(t)})}return u(o,[{key:"canViewDrd",value:function(){var e,t=this._injector.get("_parent",!1);if(t)return e=this.getDefinitions(),!!t.getView(e)}},{key:"getDefinitions",value:function(){return this._viewer.getDecision().$parent}}]),o}());Wr.$inject=["components","viewer","eventBus","injector"];var a0={__init__:["viewDrd"],viewDrd:["type",Wr]},s0=["modules","additionalModules"];function c0(e,t){if(null==e)return{};var n,i=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);return i}var u0=function(){l(i,qx);var n=p(i);function i(){h(this,i);var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=i._createContainer(),e=n.call(this,C(e,{renderer:{container:t}}));return e._container=t,e}return u(i,[{key:"open",value:function(i){var r=this;return new Promise(function(e,t){var n;try{r._decision&&(r.clear(),r.get("eventBus").fire("renderer.unmount")),r._decision=i,r.get("eventBus").fire("import",i),r.get("eventBus").fire("renderer.mount")}catch(e){n=e}n?(n.warnings=n.warnings||[],t(n)):e({warnings:[]})})}},{key:"_init",value:function(e){var t=e.modules,n=e.additionalModules,e=c0(e,s0),t=t||this.getModules(),n=n||[],i=[{viewer:["value",this]}];return{modules:[].concat(f(t),f(n),i),config:e}}},{key:"on",value:function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)}},{key:"off",value:function(e,t){this.get("eventBus").off(e,t)}},{key:"_emit",value:function(e,t){return this.get("eventBus").fire(e,t)}},{key:"getDecision",value:function(){return this._decision}},{key:"attachTo",value:function(e){if(!e)throw new Error("parentNode required");this.detach(),e.appendChild(this._container),this._emit("attach",{})}},{key:"detach",value:function(){var e=this._container;e.parentNode&&(this._emit("detach",{}),Tn(e))}},{key:"destroy",value:function(){F(s(i.prototype),"destroy",this).call(this),this.detach()}},{key:"getModules",value:function(){return i._getModules()}}],[{key:"_getModules",value:function(){return[Gx,Ro,Xx,Zx,t0,i0,a0]}},{key:"_createContainer",value:function(){return _('<div class="dmn-literal-expression-container"></div>')}}]),i}();function l0(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var d0=function(){l(r,a);var i=p(r);function r(e,t){var n;return h(this,r),l0(d(n=i.call(this,e,t)),"onElementsChanged",function(){n.forceUpdate()}),l0(d(n),"setDecisionName",function(e){n._modeling.editDecisionName(e)}),n._viewer=t.injector.get("viewer"),n._modeling=t.injector.get("modeling"),n.setupChangeListeners({bind:n.getDecision().id}),n}return u(r,[{key:"componentWillUnmount",value:function(){this.setupChangeListeners({unbind:this.getDecision().id})}},{key:"getDecision",value:function(){return this._viewer.getDecision()}},{key:"setupChangeListeners",value:function(e){var t=e.bind,e=e.unbind,n=this.context.changeSupport;"string"==typeof e&&n.offElementsChanged(e,this.onElementsChanged),"string"==typeof t&&n.onElementsChanged(t,this.onElementsChanged)}},{key:"render",value:function(){var e=this.getDecision().name;return I(1,"header","decision-properties",A(2,p0,{className:"decision-name editor",value:e,onBlur:h0,onChange:this.setDecisionName}),2)}}]),r}(),p0=function(){l(t,Av);var e=p(t);function t(){return h(this,t),e.apply(this,arguments)}return u(t,[{key:"render",value:function(){return I(1,"h3",this.getClassName(),this.getEditor(),0)}}]),t}();function h0(e){e.target.scroll(0,0)}var Ho=u(function e(t){h(this,e),t.onGetComponent("viewer",1500,function(){return d0})}),f0=(Ho.$inject=["components"],{__depends__:[$a],__init__:["decisionProperties"],decisionProperties:["type",Ho]}),m0="is not a registered action",ca=function(){function n(e,t){h(this,n),this._actions={undo:function(){e.undo()},redo:function(){e.redo()}}}return u(n,[{key:"trigger",value:function(e,t){if(this._actions[e])return this._actions[e](t);throw g0(e,m0)}},{key:"register",value:function(e,t){var n=this;if("string"==typeof e)return this._registerAction(e,t);y(e,function(e,t){n._registerAction(t,e)})}},{key:"_registerAction",value:function(e,t){if(this.isRegistered(e))throw g0(e,"is already registered");this._actions[e]=t}},{key:"unregister",value:function(e){if(!this.isRegistered(e))throw g0(e,m0);this._actions[e]=void 0}},{key:"isRegistered",value:function(e){return!!this._actions[e]}}]),n}();function g0(e,t){return new Error(e+" "+t)}ca.$inject=["commandStack","eventBus"];ld={__init__:["editorActions"],editorActions:["type",ca]};function v0(e){return!e.altKey&&(e.ctrlKey||e.metaKey)}function y0(e){return e.shiftKey}function _0(e,t,n){(t=function(e){e=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===Fe(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var Wc=function(){function i(e,t,n){var o=this;h(this,i),_0(this,"_init",function(){o._registerDefaultBindings(),o._fire("init")}),_0(this,"_destroy",function(){o._fire("destroy"),o.unbind(),o._listeners=null}),_0(this,"_keyHandler",function(e){for(var t,n=o._listeners,i=e.keyCode||e.charCode||-1,r=0;t=n[r];r++)if(t(i,e))return e.preventDefault(),void e.stopPropagation()}),_0(this,"unbind",function(){var e=o._node;e&&(o._fire("unbind"),E.unbind(e,"keydown",o._keyHandler,!0)),o._node=null}),this._config=e||{},this._eventBus=t,this._editorActions=n,this._listeners=[],t.on("viewer.destroy",this._destroy),t.on("viewer.init",this._init),t.on("attach",function(){o._config.bindTo&&o.bind(e.bindTo)}),t.on("detach",this.unbind)}return u(i,[{key:"bind",value:function(e){this.unbind(),this._node=e,E.bind(e,"keydown",this._keyHandler,!0),this._fire("bind")}},{key:"getBinding",value:function(){return this._node}},{key:"_fire",value:function(e){this._eventBus.fire("keyboard."+e,{node:this._node,listeners:this._listeners})}},{key:"_registerDefaultBindings",value:function(){var e=this._listeners,n=this._editorActions;e.push(function(e,t){if(v0(t)&&!y0(t)&&90===e)return n.trigger("undo"),!0}),e.push(function(e,t){if(v0(t)&&(89===e||90===e&&y0(t)))return n.trigger("redo"),!0})}},{key:"addListener",value:function(e){this._listeners.unshift(e)}},{key:"removeListener",value:function(t){this._listeners=this._listeners.filter(function(e){return e!==t})}}]),i}(),b0=(Wc.$inject=["config.keyboard","eventBus","editorActions"],{__depends__:[ld],__init__:["keyboard"],keyboard:["type",Wc]}),x0=function(){l(i,a);var n=p(i);function i(e,t){h(this,i),(e=n.call(this,e,t))._translate=t.injector.get("translate"),e._viewer=t.injector.get("viewer"),e._modeling=t.injector.get("modeling"),e._dataTypes=t.injector.get("dataTypes");t=e._viewer.getDecision();return e.state={name:t.variable.name,typeRef:t.variable.typeRef},e.setVariableName=e.setVariableName.bind(d(e)),e.setVariableType=e.setVariableType.bind(d(e)),e}return u(i,[{key:"setVariableName",value:function(e){this._modeling.editVariableName(e),this.setState({name:e})}},{key:"setVariableType",value:function(e){""===e?(this._modeling.editVariableType(void 0),this.setState({typeRef:void 0})):(this._modeling.editVariableType(e),this.setState({typeRef:e}))}},{key:"render",value:function(){var t=this,e=this.state,n=e.name,e=e.typeRef,i=this._dataTypes.getAll().map(function(e){return{label:t._translate(e),value:e}});return I(1,"div","literal-expression-properties",I(1,"table",null,[I(1,"tr",null,[I(1,"td",null,this._translate("Variable Name:"),0),I(1,"td",null,A(2,dy,{className:"variable-name-input",onInput:this.setVariableName,placeholder:"name",value:n||""}),2)],4),I(1,"tr",null,[I(1,"td",null,this._translate("Variable Type:"),0),I(1,"td",null,I(1,"div","dms-fill-row",A(2,Py,{onChange:this.setVariableType,options:i,value:e,className:"variable-type-select dms-block"}),2),2)],4),A(2,w0)],4),2)}}]),i}(),w0=function(){l(i,a);var n=p(i);function i(e,t){return h(this,i),(e=n.call(this,e,t))._translate=t.injector.get("translate"),e._viewer=t.injector.get("viewer"),e._modeling=t.injector.get("modeling"),e._expressionLanguages=t.injector.get("expressionLanguages"),e.setExpressionLanguage=e.setExpressionLanguage.bind(d(e)),e}return u(i,[{key:"setExpressionLanguage",value:function(e){""===e?this._modeling.editExpressionLanguage(void 0):this._modeling.editExpressionLanguage(e)}},{key:"_getExpressionLanguage",value:function(){var e=this._viewer.getDecision().decisionLogic;return e&&e.expressionLanguage?e.expressionLanguage.toLowerCase():this._getDefaultExpressionLanguage()}},{key:"_getDefaultExpressionLanguage",value:function(){return this._expressionLanguages.getDefault().value}},{key:"_shouldRender",value:function(){return 1<this._expressionLanguages.getAll().length||this._getExpressionLanguage()!==this._getDefaultExpressionLanguage()}},{key:"render",value:function(){var e,t;return this._shouldRender()?(e=this._getExpressionLanguage(),t=this._expressionLanguages.getAll(),I(1,"tr",null,[I(1,"td",null,this._translate("Expression Language:"),0),I(1,"td",null,I(1,"div","dms-fill-row",A(2,Py,{onChange:this.setExpressionLanguage,options:t,value:e,className:"expression-language-select dms-block"}),2),2)],4)):null}}]),i}(),od=u(function e(t){h(this,e),t.onGetComponent("viewer",500,function(){return x0})}),C0=(od.$inject=["components"],{__depends__:[$a,b0,pg,js],__init__:["literalExpressionProperties"],literalExpressionProperties:["type",od]}),Tc=function(){function r(t,e,n){var i=this;h(this,r),this._commandStack=t,this._viewer=e,(this._eventBus=n).on("viewer.init",function(){var e,n;e=i.getHandlers(),n=t,y(e,function(e,t){n.registerHandler(t,e)})})}return u(r,[{key:"getHandlers",value:function(){return r._getHandlers()}},{key:"getDecision",value:function(){return this._viewer.getDecision()}},{key:"editDecisionName",value:function(e){var t=this.getDecision();this._commandStack.execute("element.updateProperties",{element:t,properties:{name:e}})}},{key:"editDecisionId",value:function(e){var t=this.getDecision();this._commandStack.execute("element.updateProperties",{element:t,properties:{id:e}})}},{key:"editLiteralExpressionText",value:function(e){var t=this.getDecision().decisionLogic;this._commandStack.execute("element.updateProperties",{element:t,properties:{text:e}})}},{key:"editExpressionLanguage",value:function(e){var t=this.getDecision().decisionLogic;this._commandStack.execute("element.updateProperties",{element:t,properties:{expressionLanguage:e}})}},{key:"editVariableName",value:function(e){var t=this.getDecision().variable;this._commandStack.execute("element.updateProperties",{element:t,properties:{name:e}})}},{key:"editVariableType",value:function(e){var t=this.getDecision().variable;this._commandStack.execute("element.updateProperties",{element:t,properties:{typeRef:e}})}}],[{key:"_getHandlers",value:function(){return{"element.updateProperties":q_}}}]),r}();Tc.$inject=["commandStack","viewer","eventBus"];var E0={__init__:["idChangeBehavior","modeling"],commandStack:["type",n],idChangeBehavior:["type",Od],modeling:["type",Tc]},k0=function(){l(r,a);var i=p(r);function r(e,t){h(this,r),(e=i.call(this,e,t))._modeling=t.injector.get("modeling"),e._viewer=t.injector.get("viewer"),e.editLiteralExpressionText=e.editLiteralExpressionText.bind(d(e)),e.onElementsChanged=e.onElementsChanged.bind(d(e));var n=e.getLiteralExpression().id;return t.changeSupport.onElementsChanged(n,e.onElementsChanged),e}return u(r,[{key:"getLiteralExpression",value:function(){return this._viewer.getDecision().decisionLogic}},{key:"onElementsChanged",value:function(){this.forceUpdate()}},{key:"editLiteralExpressionText",value:function(e){this._modeling.editLiteralExpressionText(e)}},{key:"render",value:function(){var e=this.getLiteralExpression().text;return A(2,S0,{className:"textarea editor",value:e,onChange:this.editLiteralExpressionText})}}]),r}(),S0=function(){l(t,Av);var e=p(t);function t(){return h(this,t),e.apply(this,arguments)}return u(t,[{key:"render",value:function(){return I(1,"div",this.getClassName(),this.getEditor(),0)}}]),t}(),Nd=u(function e(t){h(this,e),t.onGetComponent("viewer",function(){return k0})}),j0=(Nd.$inject=["components"],{__depends__:[$a],__init__:["textarea"],textarea:["type",Nd]}),O0=function(){l(t,u0);var e=p(t);function t(){return h(this,t),e.apply(this,arguments)}return u(t,[{key:"getModules",value:function(){return[].concat(f(u0._getModules()),f(t._getModules()))}}],[{key:"_getModules",value:function(){return[f0,b0,C0,E0,pg,oy,j0]}}]),t}();return function(){l(a,Xn);var e=p(a);function a(){return h(this,a),e.apply(this,arguments)}return u(a,[{key:"_getViewProviders",value:function(){return[{id:"drd",constructor:Lh,opens:"dmn:Definitions"},{id:"decisionTable",constructor:zx,opens:function(e){return k(e,"dmn:Decision")&&k(e.decisionLogic,"dmn:DecisionTable")}},{id:"literalExpression",constructor:O0,opens:function(e){return k(e,"dmn:Decision")&&k(e.decisionLogic,"dmn:LiteralExpression")}}]}},{key:"_getInitialView",value:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,o=(o=F(s(a.prototype),"_getInitialView",this)).call.apply(o,[this,e].concat(n));if(o)return k(r=o.element,"dmn:Definitions")&&!Ll(r)&&ie(e,function(e){return!k(e.element,"dmn:Definitions")})||o}}]),a}()});
