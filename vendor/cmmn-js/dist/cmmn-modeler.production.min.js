/*! cmmn-js - cmmn-modeler v0.16.0 | Copyright (c) 2014-present, camunda Services GmbH | bpmn.io/license */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).CmmnJS=e()}}(function(){var e={};function t(e,t){return function(e,t){return!(!e||"function"!=typeof e.$instanceOf||!e.$instanceOf(t))}(n(e),t)}function n(e){return e&&e.businessObject?e.businessObject:e}function i(e){return t(e=n(e),"cmmn:Stage")&&e.$parent&&t(e.$parent,"cmmn:Case")}function r(e){var i=n(e);return t(e,"cmmn:PlanItemDefinition")||t(e,"cmmn:CaseFileItemDefinition")?i:i&&i.definitionRef}function o(e){var t=r(e);return t&&t.defaultControl}function a(e){return(e=n(e))&&e.itemControl}function s(e,t){var n=a(e),i=o(e);return n&&n[t]?n[t]:i&&i[t]}function c(e){if(t(e=n(e),"cmmn:CaseFileItem"))return["addChild","addReference","create","delete","removeChild","removeReference","replace","update"];if(t(e,"cmmn:PlanItem")||t(e,"cmmn:DiscretionaryItem")){var o=r(e);return t(o,"cmmn:EventListener")||t(o,"cmmn:Milestone")?["create","occur","resume","suspend","terminate"]:["complete","create","disable","enable","exit","fault","manualStart","parentResume","parentSuspend","reactivate","reenable","resume","start","suspend","terminate"]}return i(e)?["close","complete","create","fault","reactivate","suspend","terminate"]:[]}e.is=t,e.getBusinessObject=n,e.isCasePlanModel=i,e.getDefinition=r,e.getDefaultControl=o,e.getItemControl=a,e.isRequired=function(e){return!!s(e,"requiredRule")},e.isRepeatable=function(e){return!!s(e,"repetitionRule")},e.isManualActivation=function(e){return!!s(e,"manualActivationRule")},e.isAutoComplete=function(e){var t=r(e=n(e));return e.autoComplete||t&&t.autoComplete},e.hasPlanningTable=function(e){return(e=n(e)).planningTable||r(e)&&r(e).planningTable},e.getName=function(e){t(e=n(e),"cmmndi:CMMNEdge")&&e.cmmnElementRef&&(e=e.cmmnElementRef);var i=e.name;return i||e.definitionRef&&(i=e.definitionRef.name),i},e.getSentry=function(e){var i=n(e);return t(i,"cmmn:Sentry")?i:i&&i.sentryRef},e.getStandardEvent=function(e){return(e=n(e)).cmmnElementRef&&e.cmmnElementRef.standardEvent},e.getStandardEvents=function(e){return t(e,"cmmndi:CMMNEdge")&&(e=n(e).cmmnElementRef),t(e,"cmmn:OnPart")?t(e.exitCriterionRef,"cmmn:ExitCriterion")?["exit"]:c(e.sourceRef):[]};var u={};u="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e};var l={};Object.defineProperty(l,"__esModule",{value:!0});var d=Object.prototype.toString,p=Object.prototype.hasOwnProperty;function f(e){return void 0===e}function h(e){return"[object Array]"===d.call(e)}function m(e){return"[object Object]"===d.call(e)}function y(e){return"[object Function]"===d.call(e)}function v(e){if(!h(e))throw new Error("must supply array")}function g(e,t){return p.call(e,t)}function _(e,t){var n;return t=T(t),x(e,function(e,i){if(t(e,i))return n=e,!1}),n}function x(e,t){if(!f(e)){var n=h(e)?A:k;for(var i in e){if(g(e,i))if(!1===t(e[i],n(i)))return}}}function b(e,t,n){return x(e,function(e,i){n=t(n,e,i)}),n}function E(e,t){return b(e,function(e,n,i){return e&&t(n,i)},!0)}function w(e,t){var n=[];return x(e,function(e,i){n.push(t(e,i))}),n}function M(e){return e&&Object.keys(e)||[]}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=R(t),x(e,function(e){var i=t(e)||"_",r=n[i];r||(r=n[i]=[]),r.push(e)}),n}function C(e){e=R(e);for(var t={},n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return x(i,function(n){return S(n,e,t)}),w(t,function(e,t){return e[0]})}var P=C;function R(e){return y(e)?e:function(t){return t[e]}}function T(e){return y(e)?e:function(t){return t===e}}function k(e){return e}function A(e){return Number(e)}var O=Array.prototype.slice;var j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};l.flatten=function(e){return Array.prototype.concat.apply([],e)},l.find=_,l.findIndex=function(e,t){t=T(t);var n=h(e)?-1:void 0;return x(e,function(e,i){if(t(e,i))return n=i,!1}),n},l.filter=function(e,t){var n=[];return x(e,function(e,i){t(e,i)&&n.push(e)}),n},l.forEach=x,l.without=function(e,t){return f(e)?[]:(v(e),t=T(t),e.filter(function(e,n){return!t(e,n)}))},l.reduce=b,l.every=E,l.some=function(e,t){return!!_(e,t)},l.map=w,l.keys=M,l.size=function(e){return M(e).length},l.values=function(e){return w(e,function(e){return e})},l.groupBy=S,l.uniqueBy=C,l.unionBy=P,l.sortBy=function(e,t){t=R(t);var n=[];return x(e,function(e,i){for(var r=t(e,i),o={d:r,v:e},a=0;a<n.length;a++)if(r<n[a].d)return void n.splice(a,0,o);n.push(o)}),w(n,function(e){return e.v})},l.matchPattern=function(e){return function(t){return E(e,function(e,n){return t[n]===e})}},l.debounce=function(e,t){var n;return function(){var i=O.call(arguments);n&&clearTimeout(n),n=setTimeout(function(){e.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(i))},t)}},l.bind=function(e,t){return e.bind(t)},l.isUndefined=f,l.isDefined=function(e){return void 0!==e},l.isArray=h,l.isObject=m,l.isNumber=function(e){return"[object Number]"===d.call(e)},l.isFunction=y,l.isString=function(e){return"[object String]"===d.call(e)},l.assign=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return j.apply(void 0,[e].concat(n))},l.pick=function(e,t){var n={},i=Object(e);return x(t,function(t){t in i&&(n[t]=e[t])}),n},l.omit=function(e,t){var n={};return x(Object(e),function(e,i){-1===t.indexOf(i)&&(n[i]=e)}),n};var N={};function I(e,t,n){var i=N.extend(n[t.name]||[],e,t,n);Object.defineProperty(n,t.name,{enumerable:t.enumerable,value:i}),i.length&&i.forEach(function(i){e.set(i,t.inverse,n)})}function D(e,t){if(!(this instanceof D))return new D(e,t);e.inverse=t,t.inverse=e,this.props={},this.props[e.name]=e,this.props[t.name]=t}N.extend=function(e,t,n,i){var r=n.inverse;return Object.defineProperty(e,"remove",{value:function(e){var n=this.indexOf(e);return-1!==n&&(this.splice(n,1),t.unset(e,r,i)),e}}),Object.defineProperty(e,"contains",{value:function(e){return-1!==this.indexOf(e)}}),Object.defineProperty(e,"add",{value:function(e,n){var o=this.indexOf(e);if(void 0===n){if(-1!==o)return;n=this.length}-1!==o&&this.splice(o,1),this.splice(n,0,e),-1===o&&t.set(e,r,i)}}),Object.defineProperty(e,"__refs_collection",{value:!0}),e},N.isExtended=function(e){return!0===e.__refs_collection},D.prototype.bind=function(e,t){if("string"==typeof t){if(!this.props[t])throw new Error("no property <"+t+"> in ref");t=this.props[t]}t.collection?I(this,t,e):function(e,t,n){var i=t.inverse,r=n[t.name];Object.defineProperty(n,t.name,{configurable:t.configurable,enumerable:t.enumerable,get:function(){return r},set:function(t){if(t!==r){var o=r;r=null,o&&e.unset(o,i,n),r=t,e.set(r,i,n)}}})}(this,t,e)},D.prototype.ensureRefsCollection=function(e,t){var n=e[t.name];return N.isExtended(n)||I(this,t,e),n},D.prototype.ensureBound=function(e,t){(function(e,t){return Object.prototype.hasOwnProperty.call(e,t.name||t)})(e,t)||this.bind(e,t)},D.prototype.unset=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).remove(n):e[t.name]=void 0)},D.prototype.set=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).add(n):e[t.name]=n)};var B={};(B=D).Collection=N;var L={};Object.defineProperty(L,"__esModule",{value:!0}),L.Base=G,L.Label=X,L.create=function(e,t){var n=Q[e];if(!n)throw new Error("unknown type: <"+e+">");return(0,l.assign)(new n,t)};var z=$(u),F=$(B);function $(e){return e&&e.__esModule?e:{default:e}}var H=new F.default({name:"children",enumerable:!0,collection:!0},{name:"parent"}),U=new F.default({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),W=new F.default({name:"attachers",collection:!0},{name:"host"}),V=new F.default({name:"outgoing",collection:!0},{name:"source"}),q=new F.default({name:"incoming",collection:!0},{name:"target"});function G(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(e){var t=this.label,n=this.labels;!e&&t?n.remove(t):n.add(e,0)}}),H.bind(this,"parent"),U.bind(this,"labels"),V.bind(this,"outgoing"),q.bind(this,"incoming")}function K(){G.call(this),H.bind(this,"children"),W.bind(this,"host"),W.bind(this,"attachers")}function Y(){K.call(this)}function X(){K.call(this),U.bind(this,"labelTarget")}function Z(){G.call(this),V.bind(this,"source"),q.bind(this,"target")}(0,z.default)(K,G),(0,z.default)(Y,K),(0,z.default)(X,K),(0,z.default)(Z,G);var Q={connection:Z,shape:K,label:X,root:Y};var J={},ee=l.some,te=e.is,ne=e.getBusinessObject;function ie(e,t){return e===t}function re(e){return oe(ne(e),"cmmn:Case")}function oe(e,t){for("string"==typeof t&&(t=[t]);e=e.$parent||e.parent;){if(!t)return e;if(ae(e,t))return e}return null}function ae(e,t){return ee(t,function(t){return te(e,t)})}J.isSame=ie,J.isSameCase=function(e,t){return ie(re(e),re(t))},J.getCase=re,J.getParents=function(e,t){var n=[];for("string"==typeof t&&(t=[t]);e;)(e=e.$parent||e.parent)&&(t?ae(e,t)&&n.push(e):n.push(e));return n},J.getParent=oe,J.isAny=ae,J.isLabel=function(e){return e instanceof L.Label};var se=e.getDefinition,ce=e.getSentry,ue=J.isAny,le=l.forEach,de=l.isArray;function pe(e,t){this._items={},this._referencedBy={},this._elementRegistry=e,this._eventBus=t,this._init()}pe.$inject=["elementRegistry","eventBus"];var fe=pe;function he(e){return se(e)||ce(e)}function me(e){return ue(e,["cmmn:PlanItemDefinition","cmmn:Sentry","cmmn:CaseFileItemDefinition"])}pe.prototype._init=function(e){var t=this._eventBus;t.on("diagram.destroy",500,this._clear,this),t.on("diagram.clear",500,this._clear,this)},pe.prototype._clear=function(){this._items={},this._referencedBy={}},pe.prototype.add=function(e){var t=this._items,n=e.id,i=this._referencedBy,r=he(e),o=r&&r.id;t[n]=e,r&&(i[o]=i[o]||[],-1===i[o].indexOf(e)&&i[o].push(e))},pe.prototype.remove=function(e){var t=this._items,n=e.id,i=this._referencedBy,r=he(e),o=r&&r.id;if(delete t[n],r){var a=i[o]||[],s=a.indexOf(e);-1!==s&&a.splice(s,1),a.length||delete i[o]}},pe.prototype.updateId=function(e,t){var n,i;"string"==typeof e&&(e=this.get(e)),n=me(e)?this._referencedBy:this._items,e&&(i=n[e.id],delete n[e.id],n[t]=i)},pe.prototype.updateReference=function(e,t){var n=this._referencedBy,i=he(e),r=i&&i.id;if(i){var o=n[r]||[],a=o.indexOf(e);-1!==a&&o.splice(a,1),o.length||delete n[r]}if(t){var s=t.id;s&&(n[s]=n[s]||[],-1===n[s].indexOf(e)&&n[s].push(e))}},pe.prototype.get=function(e){return this._items[e]},pe.prototype.filter=function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(n)}),t},pe.prototype.getAll=function(){return this.filter(function(e){return e})},pe.prototype.forEach=function(e){var t=this._items;le(t,function(t){return e(t,he(t))})},pe.prototype.getReferences=function(e){var t=e.id||e;return(this._referencedBy[t]||[]).slice()},pe.prototype.getShape=function(e){var t=e.id||e;return this._elementRegistry&&this._elementRegistry.get(t)},pe.prototype.getShapes=function(e){var t=[],n=this;function i(e){e&&t.push(e)}if(de(e))le(e,function(e){i(n.getShape(e))});else if(me(e)){var r=n.getReferences(e);le(r,function(e){i(n.getShape(e))})}else i(n.getShape(e));return t};var ye={},ve=e.is,ge=e.getBusinessObject,_e=e.isCasePlanModel;ye.isCollapsed=function(e){if(!_e(e)){var t=(e=ge(e)).definitionRef;if(ve(t,"cmmn:PlanFragment"))return!!(e&&e.di&&e.di.isCollapsed)}return!1},ye.isPlanningTableCollapsed=function(e){return e=ge(e),!!(ve(e,"cmmn:Stage")||e.definitionRef&&(ve(e.definitionRef,"cmmn:Stage")||ve(e.definitionRef,"cmmn:HumanTask")))&&(e.di&&e.di.isPlanningTableCollapsed)},ye.isStandardEventVisible=function(e){var t=(e=ge(e)).cmmnElementRef;return!(!ve(t,"cmmn:OnPart")||!e.isStandardEventVisible)};var xe={};Object.defineProperty(xe,"__esModule",{value:!0}),xe.default=Ee;var be=1e3;function Ee(e,t){var n=this;t=t||be,e.on(["render.shape","render.connection"],t,function(e,t){var i=e.type,r=t.element,o=t.gfx;if(n.canRender(r))return"render.shape"===i?n.drawShape(o,r):n.drawConnection(o,r)}),e.on(["render.getShapePath","render.getConnectionPath"],t,function(e,t){if(n.canRender(t))return"render.getShapePath"===e.type?n.getShapePath(t):n.getConnectionPath(t)})}Ee.prototype.canRender=function(){},Ee.prototype.drawShape=function(){},Ee.prototype.drawConnection=function(){},Ee.prototype.getShapePath=function(){},Ee.prototype.getConnectionPath=function(){};var we={};function Me(e,t){if(e.ownerDocument!==t.ownerDocument)try{return t.ownerDocument.importNode(e,!0)}catch(e){}return e}function Se(e,t){return t.appendChild(Me(e,t))}Object.defineProperty(we,"__esModule",{value:!0});var Ce=2,Pe={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":Ce,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":Ce,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function Re(e,t,n){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=Pe[i];r?(r===Ce&&"number"==typeof n&&(n=String(n)+"px"),e.style[i]=n):e.setAttributeNS(null,t,n)}function Te(e,t,n){if("string"==typeof t){if(void 0===n)return function(e,t){return Pe[t]?e.style[t]:e.getAttributeNS(null,t)}(e,t);Re(e,t,n)}else!function(e,t){var n,i,r=Object.keys(t);for(n=0;i=r[n];n++)Re(e,i,t[i])}(e,t);return e}function ke(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var Ae=/\s+/,Oe=Object.prototype.toString;function je(e){return void 0!==e}function Ne(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}function Ie(e){var t=e.parentNode;return t&&t.removeChild(e),e}function De(e){for(var t;t=e.firstChild;)Ie(t);return e}Ne.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~ke(t,e)||t.push(e),je(this.el.className.baseVal)?this.el.className.baseVal=t.join(" "):this.el.className=t.join(" "),this},Ne.prototype.remove=function(e){if("[object RegExp]"===Oe.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=ke(t,e);return~n&&t.splice(n,1),this.el.className.baseVal=t.join(" "),this},Ne.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},Ne.prototype.toggle=function(e,t){return this.list?(je(t)?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(je(t)?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},Ne.prototype.array=function(){var e=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(Ae);return""===e[0]&&e.shift(),e},Ne.prototype.has=Ne.prototype.contains=function(e){return this.list?this.list.contains(e):!!~ke(this.array(),e)};var Be={svg:"http://www.w3.org/2000/svg"},Le='<svg xmlns="'+Be.svg+'"';function ze(e){var t=!1;"<svg"===e.substring(0,4)?-1===e.indexOf(Be.svg)&&(e=Le+e.substring(4)):(e=Le+">"+e+"</svg>",t=!0);var n=function(e){var t;return(t=new DOMParser).async=!1,t.parseFromString(e,"text/xml")}(e);if(!t)return n;for(var i=document.createDocumentFragment(),r=n.firstChild;r.firstChild;)i.appendChild(r.firstChild);return i}function Fe(e,t){var n;return"<"===e.charAt(0)?(n=ze(e).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(Be.svg,e),t&&Te(n,t),n}var $e=Fe("svg");function He(e,t){var n,i,r=Object.keys(t);for(n=0;i=r[n];n++)e[i]=t[i];return e}var Ue=/([&<>]{1})/g,We=/([\n\r"]{1})/g,Ve={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function qe(e,t){return e.replace(t,function(e,t){return Ve[t]||t})}function Ge(e,t){var n,i,r,o,a;switch(e.nodeType){case 3:t.push(qe(e.textContent,Ue));break;case 1:if(t.push("<",e.tagName),e.hasAttributes())for(n=0,i=(r=e.attributes).length;n<i;++n)o=r.item(n),t.push(" ",o.name,'="',qe(o.value,We),'"');if(e.hasChildNodes()){for(t.push(">"),n=0,i=(a=e.childNodes).length;n<i;++n)Ge(a.item(n),t);t.push("</",e.tagName,">")}else t.push("/>");break;case 8:t.push("\x3c!--",qe(e.nodeValue,Ue),"--\x3e");break;case 4:t.push("<![CDATA[",e.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+e.nodeType)}return t}function Ke(e,t){var n=ze(t);if(De(e),t){"#document-fragment"!==n.nodeName&&(n=n.documentElement);for(var i,r=(i=n.childNodes,Array.prototype.slice.call(i)),o=0;o<r.length;o++)Se(r[o],e)}}function Ye(e,t){return t instanceof SVGMatrix?e.createSVGTransformFromMatrix(t):t}we.append=function(e,t){return Se(t,e),e},we.attr=Te,we.classes=function(e){return new Ne(e)},we.clear=De,we.clone=function(e){return e.cloneNode(!0)},we.create=Fe,we.innerSVG=function(e,t){if(void 0!==t){try{Ke(e,t)}catch(e){throw new Error("error parsing SVG: "+e.message)}return e}return function(e){for(var t=e.firstChild,n=[];t;)Ge(t,n),t=t.nextSibling;return n.join("")}(e)},we.remove=Ie,we.transform=function(e,t){var n=e.transform.baseVal;if(1===arguments.length)return n.consolidate();t.length?function(e,t){var n,i;for(e.clear(),n=0;i=t[n];n++)e.appendItem(Ye(e,i));e.consolidate()}(n,t):n.initialize(Ye(n,t))},we.createMatrix=function(e,t,n,i,r,o){var a=$e.createSVGMatrix();switch(arguments.length){case 0:return a;case 6:e={a:e,b:t,c:n,d:i,e:r,f:o}}return He(a,e)},we.createTransform=function(e){return e?$e.createSVGTransformFromMatrix(e):$e.createSVGTransform()};var Xe={};function Ze(e){for(var t,n="",i=0;t=e[i];i++)n+=t.x+","+t.y+" ";return n}Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.componentsToPath=function(e){return e.join(",").replace(/,?([A-z]),?/g,"$1")},Xe.createLine=function(e,t){var n=(0,we.create)("polyline");(0,we.attr)(n,{points:Ze(e)}),t&&(0,we.attr)(n,t);return n},Xe.updateLine=function(e,t){return(0,we.attr)(e,{points:Ze(t)}),e};var Qe={};Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.transform=function(e,t,n,i,r){var o=(0,we.createTransform)();o.setTranslate(t,n);var a=(0,we.createTransform)();a.setRotate(i,0,0);var s=(0,we.createTransform)();s.setScale(r||1,r||1),(0,we.transform)(e,[o,a,s])},Qe.translate=function(e,t,n){var i=(0,we.createTransform)();i.setTranslate(t,n),(0,we.transform)(e,i)},Qe.rotate=function(e,t){var n=(0,we.createTransform)();n.setRotate(t,0,0),(0,we.transform)(e,n)};var Je={};Object.defineProperty(Je,"__esModule",{value:!0}),Je.default=at;var et=0,tt={width:150,height:50};function nt(e,t){var n;t.textContent=e;try{var i,r=""===e;return t.textContent=r?"dummy":e,i={width:(n=t.getBBox()).width+2*n.x,height:n.height},r&&(i.width=0),i}catch(e){return{width:0,height:0}}}function it(e,t,n){for(var i,r=e.shift(),o=r;;){if((i=nt(o,n)).width=o?i.width:0," "===o||""===o||i.width<Math.round(t)||o.length<2)return rt(e,o,r,i);o=ot(o,i.width,t)}}function rt(e,t,n,i){if(t.length<n.length){var r=n.slice(t.length).trim();e.unshift(r)}return{width:i.width,height:i.height,text:t}}function ot(e,t,n){var i=Math.max(e.length*(n/t),1),r=function(e,t){var n,i=e.split(/(\s|-)/g),r=[],o=0;if(i.length>1)for(;n=i.shift();){if(!(n.length+o<t)){"-"===n&&r.pop();break}r.push(n),o+=n.length}return r.join("")}(e,i);return r||(r=e.slice(0,Math.max(Math.round(i-1),1))),r}function at(e){this._config=(0,l.assign)({},{size:tt,padding:et,style:{},align:"center-top"},e||{})}at.prototype.createText=function(e,t){return this.layoutText(e,t).element},at.prototype.getDimensions=function(e,t){return this.layoutText(e,t).dimensions},at.prototype.layoutText=function(e,t){var n=(0,l.assign)({},this._config.size,t.box),i=(0,l.assign)({},this._config.style,t.style),r=function(e){var t=e.split("-");return{horizontal:t[0]||"center",vertical:t[1]||"top"}}(t.align||this._config.align),o=function(e){return(0,l.isObject)(e)?(0,l.assign)({top:0,left:0,right:0,bottom:0},e):{top:e,left:e,right:e,bottom:e}}(void 0!==t.padding?t.padding:this._config.padding),a=t.fitBox||!1,s=function(e){if("fontSize"in e&&"lineHeight"in e)return e.lineHeight*parseInt(e.fontSize,10)}(i),c=e.split(/\r?\n/g),u=[],d=n.width-o.left-o.right,p=(0,we.create)("text");(0,we.attr)(p,{x:0,y:0}),(0,we.attr)(p,i);var f=function(){var e=document.getElementById("helper-svg");return e||(e=(0,we.create)("svg"),(0,we.attr)(e,{id:"helper-svg",width:0,height:0,style:"visibility: hidden; position: fixed"}),document.body.appendChild(e)),e}();for((0,we.append)(f,p);c.length;)u.push(it(c,d,p));"middle"===r.vertical&&(o.top=o.bottom=0);var h=(0,l.reduce)(u,function(e,t,n){return e+(s||t.height)},0)+o.top+o.bottom,m=(0,l.reduce)(u,function(e,t,n){return t.width>e?t.width:e},0),y=o.top;"middle"===r.vertical&&(y+=(n.height-h)/2),y-=(s||u[0].height)/4;var v=(0,we.create)("text");return(0,we.attr)(v,i),(0,l.forEach)(u,function(e){var t;switch(y+=s||e.height,r.horizontal){case"left":t=o.left;break;case"right":t=(a?m:d)-o.right-e.width;break;default:t=Math.max(((a?m:d)-e.width)/2+o.left,0)}var n=(0,we.create)("tspan");(0,we.attr)(n,{x:t,y:y}),n.textContent=e.text,(0,we.append)(v,n)}),(0,we.remove)(p),{dimensions:{width:m,height:h},element:v}};var st={};Object.defineProperty(st,"__esModule",{value:!0});var ct=[].indexOf,ut=function(e,t){if(ct)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1},lt=/\s+/,dt=Object.prototype.toString;function pt(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}pt.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~ut(t,e)||t.push(e),this.el.className=t.join(" "),this},pt.prototype.remove=function(e){if("[object RegExp]"==dt.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=ut(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this},pt.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},pt.prototype.toggle=function(e,t){return this.list?(void 0!==t?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(void 0!==t?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},pt.prototype.array=function(){var e=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(lt);return""===e[0]&&e.shift(),e},pt.prototype.has=pt.prototype.contains=function(e){return this.list?this.list.contains(e):!!~ut(this.array(),e)};var ft=Element.prototype,ht=ft.matchesSelector||ft.webkitMatchesSelector||ft.mozMatchesSelector||ft.msMatchesSelector||ft.oMatchesSelector,mt=function(e,t){if(ht)return ht.call(e,t);for(var n=e.parentNode.querySelectorAll(t),i=0;i<n.length;++i)if(n[i]==e)return!0;return!1};var yt,vt=function(e,t,n){for(var i=n?e:e.parentNode;i&&i!==document;){if(mt(i,t))return i;i=i.parentNode}},gt=window.addEventListener?"addEventListener":"attachEvent",_t=window.removeEventListener?"removeEventListener":"detachEvent",xt="addEventListener"!==gt?"on":"",bt={bind:function(e,t,n,i){return e[gt](xt+t,n,i||!1),n},unbind:function(e,t,n,i){return e[_t](xt+t,n,i||!1),n}},Et=["focus","blur"],wt={bind:function(e,t,n,i,r){return-1!==Et.indexOf(n)&&(r=!0),bt.bind(e,n,function(n){var r=n.target||n.srcElement;n.delegateTarget=vt(r,t,!0),n.delegateTarget&&i.call(e,n)},r)},unbind:function(e,t,n,i){-1!==Et.indexOf(t)&&(i=!0),bt.unbind(e,t,n,i)}},Mt=function(e,t){if("string"!=typeof e)throw new TypeError("String expected");t||(t=document);var n=/<([\w:]+)/.exec(e);if(!n)return t.createTextNode(e);e=e.replace(/^\s+|\s+$/g,"");var i=n[1];if("body"==i){var r=t.createElement("html");return r.innerHTML=e,r.removeChild(r.lastChild)}var o=Ct[i]||Ct._default,a=o[0],s=o[1],c=o[2];(r=t.createElement("div")).innerHTML=s+e+c;for(;a--;)r=r.lastChild;if(r.firstChild==r.lastChild)return r.removeChild(r.firstChild);var u=t.createDocumentFragment();for(;r.firstChild;)u.appendChild(r.removeChild(r.firstChild));return u},St=!1;"undefined"!=typeof document&&((yt=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',St=!yt.getElementsByTagName("link").length,yt=void 0);var Ct={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:St?[1,"X<div>","</div>"]:[0,"",""]};Ct.td=Ct.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],Ct.option=Ct.optgroup=[1,'<select multiple="multiple">',"</select>"],Ct.thead=Ct.tbody=Ct.colgroup=Ct.caption=Ct.tfoot=[1,"<table>","</table>"],Ct.polyline=Ct.ellipse=Ct.polygon=Ct.circle=Ct.text=Ct.line=Ct.path=Ct.rect=Ct.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];var Pt="undefined"!=typeof Element?Element.prototype:{},Rt=Pt.matches||Pt.matchesSelector||Pt.webkitMatchesSelector||Pt.mozMatchesSelector||Pt.msMatchesSelector||Pt.oMatchesSelector,Tt=function(e,t){if(!e||1!==e.nodeType)return!1;if(Rt)return Rt.call(e,t);for(var n=e.parentNode.querySelectorAll(t),i=0;i<n.length;i++)if(n[i]==e)return!0;return!1};st.attr=function(e,t,n){return 2==arguments.length?e.getAttribute(t):null===n?e.removeAttribute(t):(e.setAttribute(t,n),e)},st.classes=function(e){return new pt(e)},st.clear=function(e){for(var t;e.childNodes.length;)t=e.childNodes[0],e.removeChild(t);return e},st.closest=vt,st.delegate=wt,st.domify=Mt,st.event=bt,st.matches=Tt,st.query=function(e,t){return(t=t||document).querySelector(e)},st.queryAll=function(e,t){return(t=t||document).querySelectorAll(e)},st.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};var kt=l.isArray,At=l.isObject,Ot=l.assign,jt=xe.default,Nt=Je.default,It=ye.isStandardEventVisible,Dt=ye.isPlanningTableCollapsed,Bt=ye.isCollapsed,Lt=e.isCasePlanModel,zt=e.getBusinessObject,Ft=e.getDefinition,$t=e.isRequired,Ht=e.isRepeatable,Ut=e.isManualActivation,Wt=e.isAutoComplete,Vt=e.hasPlanningTable,qt=e.getName,Gt=e.is,Kt=e.getStandardEvent,Yt=st.query,Xt=we.append,Zt=we.attr,Qt=we.classes,Jt=we.create,en=Qe.translate,tn=Xe.createLine;function nn(e,t,n){jt.call(this,e);var i=20,r=new Nt({style:{fontFamily:"Arial, sans-serif",fontSize:"12px"},size:{width:100}}),o={};function a(e){return o[e]}function s(e){function t(t,n){var i=Ot({fill:"black",strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},n.attrs),r=n.ref||{x:0,y:0},a=n.scale||1;"none"===i.strokeDasharray&&(i.strokeDasharray=[1e4,1]);var s=Jt("marker");Zt(n.element,i),Xt(s,n.element),Zt(s,{id:t,viewBox:"0 0 20 20",refX:r.x,refY:r.y,markerWidth:20*a,markerHeight:20*a,orient:"auto"});var c=Yt("defs",e);return c||(c=Jt("defs"),Xt(e,c)),Xt(c,s),function(e,t){o[e]=t}(t,s)}var n=Jt("path");Zt(n,{d:"M 11 5 L 1 10 L 11 15"}),t("association-start",{element:n,attrs:{fill:"none",stroke:"black",strokeWidth:1.5},ref:{x:1,y:10},scale:.5});var i=Jt("path");Zt(i,{d:"M 1 5 L 11 10 L 1 15"}),t("association-end",{element:i,attrs:{fill:"none",stroke:"black",strokeWidth:1.5},ref:{x:12,y:10},scale:.5})}function c(e,n,i){return kt(n)||(i=n,n=[]),t.style(n||[],Ot(i,e||{}))}function u(e,t,n,i,r){At(i)&&(r=i,i=0),i=i||0,r=c(r,{stroke:"black",strokeWidth:2,fill:"white"});var o=t/2,a=n/2,s=Jt("circle");return Zt(s,{cx:o,cy:a,r:Math.round((t+n)/4-i)}),Zt(s,r),Xt(e,s),s}function l(e,t,n,i,r,o){At(r)&&(o=r,r=0),r=r||0,o=c(o,{stroke:"black",strokeWidth:2,fill:"white"});var a=Jt("rect");return Zt(a,{x:r,y:r,width:t-2*r,height:n-2*r,rx:i,ry:i}),Zt(a,o),Xt(e,a),a}function d(e,t,n,i){var r=t/2,o=n/2,a=[{x:r,y:0},{x:t,y:o},{x:r,y:n},{x:0,y:o}].map(function(e){return e.x+","+e.y}).join(" ");i=c(i,{stroke:"black",strokeWidth:2,fill:"white"});var s=Jt("polygon");return Zt(s,{points:a}),Zt(s,i),Xt(e,s),s}function p(e,t,n){n=c(n,["no-fill"],{strokeWidth:2,stroke:"black"});var i=Jt("path");return Zt(i,{d:t}),Zt(i,n),Xt(e,i),i}function f(e,t,n){var i=t.map(function(e){return e.x+","+e.y}).join(" "),r=Jt("polygon");return Zt(r,{points:i}),Zt(r,n),Xt(e,r),r}function h(e){for(var t=e.waypoints,n="m  "+t[0].x+","+t[0].y,i=1;i<t.length;i++)n+="L"+t[i].x+","+t[i].y+" ";return n}function m(e,t,n){var i=r.createText(t||"",n);return Qt(i).add("djs-label"),Xt(e,i),i}function y(e,t,n){return m(e,qt(t),{box:t,align:n,padding:5})}function v(e){return g[e]}var g={"cmmn:PlanItem":function(e,t){return v(Ft(t).$type)(e,t)},"cmmn:DiscretionaryItem":function(e,t){var n=Ft(t),i={strokeDasharray:"10, 12"};return Gt(n,"cmmn:Task")&&Ot(i,{strokeDasharray:"12, 12.4",strokeDashoffset:13.6}),v(n.$type)(e,t,i)},"cmmn:Stage":function(e,t,n){var r;return n=Ot({fillOpacity:.95},n),Lt(t)?g["cmmn:CasePlanModel"](e,t):(r=function(e,t,n,i,r){var o=[{x:i=i||20,y:n},{x:0,y:n-i},{x:0,y:i},{x:i,y:0},{x:t-i,y:0},{x:t,y:i},{x:t,y:n-i},{x:t-i,y:n}];return(r=r||{}).fill="white",r.stroke="black",r.strokeWidth=2,f(e,o,r)}(e,t.width,t.height,i,n),Bt(t)?y(e,t,"center-middle"):function(e,t,n){var r=m(e,qt(t),{box:t,align:n,padding:5});en(r,i,0)}(e,t,"left-top"),b(e,t),x(e,t),r)},"cmmn:PlanFragment":function(e,t,n){var i=l(e,t.width,t.height,10,{strokeDasharray:"10, 12",fillOpacity:.95});return y(e,t,Bt(t)?"center-middle":"left-top"),x(e,t),i},"cmmn:CasePlanModel":function(e,t){var n=l(e,t.width,t.height,0,{fillOpacity:.95});return function(e,t){var n=zt(t),i=t.width/2-60,r=m(e,n.name,{box:{height:18,width:i},align:"left-top"}),o=r.getBBox().width,a=o+40;o<60&&(a=100);var s=f(e,[{x:10,y:0},{x:20,y:-18},{x:a,y:-18},{x:a+10,y:0}],{fill:"white",stroke:"black",strokeWidth:2,fillOpacity:.95,"pointer-events":"all"});r.parentNode.insertBefore(s,r),en(r,25,-13)}(e,t),b(e,t),function(e,t){var n=zt(t);Wt(n)&&E("AutoCompleteMarker",e,t,-7)}(e,t),n},"cmmn:Milestone":function(e,t,n){var i=l(e,t.width,t.height,24,n);return y(e,t,"center-middle"),_(e,t),i},"cmmn:EventListener":function(e,t,n){var i=u(e,t.width,t.height,n);return(n=n||{}).strokeWidth=2,u(e,t.width,t.height,.1*t.height,n),i},"cmmn:TimerEventListener":function(e,t,i){var r=v("cmmn:EventListener")(e,t,i);p(e,n.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.5}}),{strokeWidth:2,strokeLinecap:"square"});for(var o=0;o<12;o++){var a=n.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.5}}),s=t.width/2;p(e,a,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+30*o+","+t.height/2+","+s+")"})}return r},"cmmn:UserEventListener":function(e,t,i){var r=v("cmmn:EventListener")(e,t,i);return p(e,n.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:20,y:15}}),{strokeWidth:.5,fill:"none"}),p(e,n.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:20,y:15}}),{strokeWidth:.5,fill:"none"}),p(e,n.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:20,y:15}}),{strokeWidth:.5,fill:"black"}),r},"cmmn:Task":function(e,t,n){var i=l(e,t.width,t.height,10,n);return y(e,t,"center-middle"),_(e,t),i},"cmmn:HumanTask":function(e,t,i){var r=v("cmmn:Task")(e,t,i);if(t.businessObject.definitionRef.isBlocking){p(e,n.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:"none"}),p(e,n.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:"none"}),p(e,n.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:"black"})}else{p(e,n.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}}),{strokeWidth:1.25,fill:"white",stroke:"black"})}return b(e,t),r},"cmmn:CaseTask":function(e,t,i){var r=v("cmmn:Task")(e,t,i);return p(e,n.getScaledPath("TASK_TYPE_FOLDER",{abspos:{x:7,y:7}}),{strokeWidth:1.25,fill:"white",stroke:"black"}),r},"cmmn:ProcessTask":function(e,t,i){var r=v("cmmn:Task")(e,t,i);return p(e,n.getScaledPath("TASK_TYPE_CHEVRON",{abspos:{x:5,y:5}}),{strokeWidth:1.25,fill:"white",stroke:"black"}),r},"cmmn:DecisionTask":function(e,t,i){var r=v("cmmn:Task")(e,t,i);return p(e,n.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}),{strokeWidth:1,fill:"000"}),p(e,n.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}),{strokeWidth:1}),r},"cmmn:CaseFileItem":function(e,t,i){return p(e,n.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.474,my:.296}}),{fill:"white"})},"cmmn:TextAnnotation":function(e,t){var i=l(e,t.width,t.height,0,0,{fill:"none",stroke:"none"});return p(e,n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:0}})),m(e,zt(t).text||"",{box:t,align:"left-middle",padding:5}),i},"cmmn:Association":function(e,t,n){var i=zt(t);return n=Ot({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round"},n||{}),"One"!==i.associationDirection&&"Both"!==i.associationDirection||(n.markerEnd=a("association-end")),"Both"===i.associationDirection&&(n.markerStart=a("association-start")),function(e,t,n){n=c(n,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"});var i=tn(t,n);return Xt(e,i),i}(e,t.waypoints,n)},StageMarker:function(e,t){var i=l(e,14,14,0,{strokeWidth:1,stroke:"black"});en(i,t.width/2-7,t.height-17);var r=Bt(t)?"MARKER_STAGE_COLLAPSED":"MARKER_STAGE_EXPANDED";p(e,n.getScaledPath(r,{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2-7)/t.width,my:(t.height-17)/t.height}}))},RequiredMarker:function(e,t,i){p(e,n.getScaledPath("MARKER_REQUIRED",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i)/t.width,my:(t.height-17)/t.height}}),{strokeWidth:3})},AutoCompleteMarker:function(e,t,n){var i=l(e,11,14,0,{strokeWidth:1,stroke:"black",fill:"black"});en(i,t.width/2+n+2,t.height-17)},ManualActivationMarker:function(e,t,i){p(e,n.getScaledPath("MARKER_MANUAL_ACTIVATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i)/t.width,my:(t.height-17)/t.height}}),{strokeWidth:1})},RepetitionMarker:function(e,t,i){p(e,n.getScaledPath("MARKER_REPEATABLE",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i)/t.width,my:(t.height-17)/t.height}}))},PlanningTableMarker:function(e,t,i){var r=l(e,30,24,0,{strokeWidth:1.5,stroke:"black"});en(r,t.width/2-15,-17);var o=Dt(t)?"MARKER_PLANNING_TABLE_COLLAPSED":"MARKER_PLANNING_TABLE_EXPANDED";p(e,n.getScaledPath(o,{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2-15)/t.width,my:-17/t.height}}),{strokeWidth:1.5})},"cmmn:OnPart":function(e,t){return p(e,h(t),{strokeDasharray:"10, 5, 2, 5, 2, 5",strokeWidth:1.5})},"cmmn:PlanItemOnPart":function(e,t){return v("cmmn:OnPart")(e,t)},"cmmn:CaseFileItemOnPart":function(e,t){return v("cmmn:OnPart")(e,t)},"cmmn:EntryCriterion":function(e,t){return d(e,t.width,t.height,{fill:"white"})},"cmmn:ExitCriterion":function(e,t){return d(e,t.width,t.height,{fill:"black"})},"cmmndi:CMMNEdge":function(e,t){var n=zt(t);return n.cmmnElementRef?v(n.cmmnElementRef.$type)(e,t):p(e,h(t),{strokeDasharray:"3, 5",strokeWidth:1})},label:function(e,t){var n,i=function(e,t){var n=qt(t),i=!1,r=Kt(t);if(r){var o=It(t);r="["+r+"]",n?o&&(n=n+" "+r):(n=r,t.hidden=i=!o)}var a={width:90,height:30,x:t.width/2+t.x,y:t.height/2+t.y};return t.hidden=t.labelTarget.hidden||i||!n,m(e,n,{box:a,style:{fontSize:"11px"}})}(e,t);try{n=i.getBBox()}catch(e){n={width:0,height:0,x:0}}return t.x=Math.ceil(t.x+t.width/2)-Math.ceil(n.width/2),t.width=Math.ceil(n.width),t.height=Math.ceil(n.height),Zt(i,{transform:"translate("+-1*n.x+",0)"}),i}};function _(e,t){var n=zt(t),i=[];$t(n)&&i.push({marker:"RequiredMarker",width:1}),Ut(n)&&i.push({marker:"ManualActivationMarker",width:14}),Ht(n)&&i.push({marker:"RepetitionMarker",width:14}),i.length&&(1===i.length?E(i[0].marker,e,t,i[0].width/2*-1):2===i.length?(E(i[0].marker,e,t,-1*i[0].width-3),E(i[1].marker,e,t,3)):3===i.length&&(E(i[1].marker,e,t,i[1].width/2*-1),E(i[0].marker,e,t,i[1].width/2*-1-6-i[0].width),E(i[2].marker,e,t,i[1].width/2+6)))}function x(e,t,n){var i=zt(t);E("StageMarker",e,t,-7);var r=[];$t(i)&&r.push({marker:"RequiredMarker",width:1}),Wt(i)&&r.push({marker:"AutoCompleteMarker",width:14}),r.length&&(1===r.length?E(r[0].marker,e,t,-1*r[0].width-7-6):2===r.length&&(E(r[0].marker,e,t,-1*r[1].width-7-6- -1*r[0].width-6),E(r[1].marker,e,t,-1*r[1].width-7-6)));var o=[];Ut(i)&&o.push({marker:"ManualActivationMarker",width:14}),Ht(i)&&o.push({marker:"RepetitionMarker",width:14}),o.length&&(1===o.length?E(o[0].marker,e,t,13):2===o.length&&(E(o[0].marker,e,t,13),E(o[1].marker,e,t,13+o[0].width+6)))}function b(e,t){Vt(t)&&E("PlanningTableMarker",e,t)}function E(e,t,n,i){v(e)(t,n,i)}this.canRender=function(e){return Gt(e,"cmmn:CMMNElement")||Gt(e,"cmmndi:CMMNEdge")},this.drawShape=function(e,t){var n=g[t.type];return n?n(e,t):jt.prototype.drawShape.apply(this,[e,t])},this.drawConnection=function(e,t){var n=t.type,i=g[n];return i?i(e,t):jt.prototype.drawConnection.apply(this,[e,t])},e.on("canvas.init",function(e){s(e.svg)})}u(nn,jt),nn.$inject=["eventBus","styles","pathMap"];var rn=function(){var e="m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5",t="m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005",n="m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z";this.pathMap={TASK_TYPE_FOLDER:{d:"m {mx},{my} l18,0 l0,12 l-18,0 l0,-12 m 2,0 l3,-4 l5,0 l3,4"},TASK_TYPE_CHEVRON:{d:"m {mx},{my} l15,0 l6,6 l-6,6 l-15,0 l6,-6 l-6,-6"},TASK_TYPE_USER_1:{d:e},TASK_TYPE_USER_2:{d:t},TASK_TYPE_USER_3:{d:n},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_USER_1:{d:e,height:36,width:36,heightElements:[],widthElements:[]},EVENT_USER_2:{d:t,height:36,width:36,heightElements:[],widthElements:[]},EVENT_USER_3:{d:n,height:36,width:36,heightElements:[],widthElements:[]},MARKER_STAGE_EXPANDED:{d:"m{mx},{my} m 2,7 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_STAGE_COLLAPSED:{d:"m{mx},{my} m 2,7 l 10,0 m -5,-5 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_REQUIRED:{d:"m{mx},{my} l 0,9 m 0,2 l0,3",height:14,width:3,heightElements:[],widthElements:[]},MARKER_MANUAL_ACTIVATION:{d:"m{mx}, {my} l 14,7 l -14,7 l 0,-14 z",height:14,width:14,heightElements:[],widthElements:[]},MARKER_REPEATABLE:{d:"m{mx},{my} m 3,0 l 0,14 m 6,-14 l 0,14 m -10,-10 l 14,0 m -14,6 l 14,0",height:14,width:14,heightElements:[],widthElements:[]},MARKER_PLANNING_TABLE_EXPANDED:{d:"m{mx},{my} m 0,12 l 30,0 m -20,-12 l 0, 24 m 10, -24 l 0, 24 m -10, -6 l 10,0",height:24,width:30,heightElements:[],widthElements:[]},MARKER_PLANNING_TABLE_COLLAPSED:{d:"m{mx},{my} m 0,12 l 30,0 m -20,-12 l 0, 24 m 10, -24 l 0, 24 m -10, -6 l 10,0 m -5, -6 l 0,12",height:10,width:10,heightElements:[],widthElements:[]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]}},this.getRawPath=function(e){return this.pathMap[e].d},this.getScaledPath=function(e,t){var n,i,r=this.pathMap[e];t.abspos?(n=t.abspos.x,i=t.abspos.y):(n=t.containerWidth*t.position.mx,i=t.containerHeight*t.position.my);var o,a,s={};if(t.position){for(var c=t.containerHeight/r.height*t.yScaleFactor,u=t.containerWidth/r.width*t.xScaleFactor,l=0;l<r.heightElements.length;l++)s["y"+l]=r.heightElements[l]*c;for(var d=0;d<r.widthElements.length;d++)s["x"+d]=r.widthElements[d]*u}return o=r.d,a={mx:n,my:i,e:s},String(o).replace(on,function(e,t){return function(e,t,n){var i=n;return t.replace(an,function(e,t,n,r,o){t=t||r,i&&(t in i&&(i=i[t]),"function"==typeof i&&o&&(i=i()))}),i=(null==i||i==n?e:i)+""}(e,t,a)})}},on=/\{([^}]+)\}/g,an=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;var sn={__init__:["cmmnRenderer"],cmmnRenderer:["type",nn],pathMap:["type",rn]},cn={elementToString:function(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}},un={},ln=e.is,dn=l.assign,pn=un.DEFAULT_LABEL_SIZE={width:90,height:20};un.hasExternalLabel=function(e){return(ln(e,"cmmn:PlanItem")||ln(e,"cmmn:DiscretionaryItem"))&&(e=e.definitionRef),ln(e,"cmmndi:CMMNEdge")&&e.cmmnElementRef&&ln(e.cmmnElementRef,"cmmn:OnPart")&&(e=e.cmmnElementRef),ln(e,"cmmn:EventListener")||ln(e,"cmmn:OnPart")||ln(e,"cmmn:CaseFileItem")};var fn=un.getExternalLabelMid=function(e){var t,n,i,r,o=e.businessObject,a=o.di;return!a&&ln(o,"cmmndi:CMMNEdge")&&o.cmmnElementRef&&(a=o),o&&a&&a.waypoint?(t=a.waypoint,n=t.length/2-1,i=t[Math.floor(n)],r=t[Math.ceil(n+.01)],{x:i.x+(r.x-i.x)/2,y:i.y+(r.y-i.y)/2}):{x:e.x+e.width/2,y:e.y+e.height+pn.height/2}};un.getExternalLabelBounds=function(e,t){var n,i,r,o=(e.di||e).label;return o&&o.bounds?(r=o.bounds,i={width:Math.max(pn.width,r.width),height:r.height},n={x:r.x+r.width/2,y:r.y+r.height/2}):(n=fn(t),i=pn),dn({x:n.x-i.width/2,y:n.y-i.height/2},i)};var hn=l.assign,mn=l.map,yn=e.is,vn=un.hasExternalLabel,gn=un.getExternalLabelBounds,_n=ye.isCollapsed,xn=cn.elementToString;function bn(e,t){return hn({id:e.id,type:e.$type,businessObject:e},t)}function En(e,t,n){return new Error("element "+xn(t)+" referenced by "+xn(e)+"#"+n+" not yet drawn")}function wn(e,t,n,i){this._eventBus=e,this._canvas=t,this._elementFactory=n,this._elementRegistry=i}wn.$inject=["eventBus","canvas","elementFactory","elementRegistry"];var Mn=wn;wn.prototype.root=function(e){var t=this._elementFactory.createRoot(bn(e));return this._canvas.setRootElement(t),t},wn.prototype.add=function(e,t){var n,i,r,o=e.di;if(o&&yn(o,"cmmndi:CMMNShape")&&!this._getElement(e)){var a=_n(e);i=t&&(t.hidden||t.collapsed);var s=e.di.bounds;n=this._elementFactory.createShape(bn(e,{collapsed:a,hidden:i,x:Math.round(s.x),y:Math.round(s.y),width:Math.round(s.width),height:Math.round(s.height)})),yn(e,"cmmn:Criterion")&&this._attachCriterion(e,n),this._canvas.addShape(n,t)}else{if(!(o&&yn(o,"cmmndi:CMMNEdge")||yn(e,"cmmndi:CMMNEdge")))throw new Error("unknown di "+xn(o)+" for element "+xn(e));var c=this._getSource(e),u=this._getTarget(e);i=t&&(t.hidden||t.collapsed)||c&&c.hidden||u&&u.hidden;var l=(e.di||{}).waypoint||e.waypoint;n=this._elementFactory.createConnection(bn(e,{hidden:i,source:c,target:u,waypoints:(r=l,mn(r,function(e){return{x:e.x,y:e.y}}))})),this._canvas.addConnection(n,t)}return vn(e)&&this.addLabel(e,n),this._eventBus.fire("cmmnElement.added",{element:n}),n},wn.prototype._attachCriterion=function(e,t){var n=e.$parent;if(!n)throw new Error("missing "+xn(e)+"$parent");var i=this._elementRegistry.get(n.id),r=i&&i.attachers;if(!i)throw En(e,n,"criterion");t.host=i,r||(i.attachers=r=[]),-1===r.indexOf(t)&&r.push(t)},wn.prototype.addLabel=function(e,t){var n=gn(e,t),i=this._elementFactory.createLabel(bn(e,{id:e.id+"_label",labelTarget:t,type:"label",hidden:t.hidden,x:Math.round(n.x),y:Math.round(n.y),width:Math.round(n.width),height:Math.round(n.height)}));return this._canvas.addShape(i,t.parent)},wn.prototype._getSource=function(e){var t=e.cmmnElementRef;if(t){if(yn(t,"cmmn:OnPart"))return t.exitCriterionRef?this._getEnd(t,"exitCriterionRef"):this._getEnd(t,"sourceRef");if(yn(t,"cmmn:Association"))return this._getEnd(t,"sourceRef")}if(yn(e,"cmmndi:CMMNEdge"))return this._getEnd(e,"sourceCMMNElementRef")},wn.prototype._getTarget=function(e){var t=e.cmmnElementRef;return t&&yn(t,"cmmn:Association")?this._getEnd(t,"targetRef"):this._getEnd(e,"targetCMMNElementRef")},wn.prototype._getEnd=function(e,t){var n=e[t],i=n&&this._getElement(n);if(i)return i;throw n?En(e,n,t):new Error(xn(e)+"#"+t+"Ref not specified")},wn.prototype._getElement=function(e){return this._elementRegistry.get(e.id)};var Sn={__depends__:[sn,{cmmnImporter:["type",Mn]}],itemRegistry:["type",fe]},Cn={};Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.remove=function(e,t){if(!e||!t)return-1;var n=e.indexOf(t);-1!==n&&e.splice(n,1);return n},Cn.add=function(e,t,n){if(!e||!t)return;"number"!=typeof n&&(n=-1);var i=e.indexOf(t);if(-1!==i){if(i===n)return;if(-1===n)return;e.splice(i,1)}-1!==n?e.splice(n,0,t):e.push(t)},Cn.indexOf=function(e,t){if(!e||!t)return-1;return e.indexOf(t)};var Pn=l.forEach,Rn=l.filter,Tn=cn.elementToString,kn=e.is,An=new B({name:"cmmnElement",enumerable:!0},{name:"di"});var On=function(e){var t=[],n=[],i={},r=[],o={},a=[],s=[];function c(t,n){return e.element(t,n)}function u(t,n){try{return e.addItem(t),t.di&&c(t,n)}catch(e){l(e.message,{element:t,error:e}),console.error("failed to import "+Tn(t)),console.error(e)}}function l(t,n){e.error(t,n)}function d(e,t){return function(n){e(n,t)}}function p(e){var t,o=e.cmmnElementRef;if(o&&!kn(e,"cmmndi:CMMNEdge"))if(o.di)l("multiple DI elements defined for "+Tn(o),{element:o});else{var u=function(e){for(;e&&!kn(e,"cmmn:Case");)e=e.$parent;return e}(o);u&&-1===r.indexOf(u)&&r.push(u),(kn(o,"cmmn:TextAnnotation")||kn(o,"cmmn:CaseFileItem"))&&a.push(o),An.bind(o,"di"),o.di=e}else if(kn(e,"cmmndi:CMMNEdge")){var d=!0;if((kn((t=e).cmmnElementRef,"cmmn:Association")?!!t.cmmnElementRef.targetRef:!!t.targetCMMNElementRef)||(d=!1,l("no target referenced in "+Tn(e),{element:e})),function(e){return kn(e.cmmnElementRef,"cmmn:OnPart")?!(!e.cmmnElementRef.exitCriterionRef&&!e.cmmnElementRef.sourceRef):kn(e.cmmnElementRef,"cmmn:Association")?!!e.cmmnElementRef.sourceRef:!!e.sourceCMMNElementRef}(e)||(d=!1,l("no source referenced in "+Tn(e),{element:e})),d)if(kn(o,"cmmn:Association"))s.push(e);else if(o)n.push(function(t){c(e,t)});else{var p=e.sourceCMMNElementRef;i[p.id]=i[p.id]||[],i[p.id].push(e)}}else l("no cmmnElement referenced in "+Tn(e),{element:e})}function f(e){var t;t=e.diagramElements,Pn(t,h)}function h(e){p(e)}function m(e,t){!function(e,t){Pn(e,d(v,t))}(e.planItems,t),kn(e,"cmmn:Stage")&&function(e,t){y(e.planningTable,t)}(e,t)}function y(e,t){e&&Pn(e.tableItems,function(e){kn(e,"cmmn:DiscretionaryItem")?function(e,t){o[e.id]||(function(e){o[e.id]=e}(e),v(e,t))}(e,t):kn(e,"cmmn:PlanningTable")&&y(e,t)})}function v(e,t){var n=u(e,t);Pn(e.exitCriteria,d(g,t)),Pn(e.entryCriteria,d(g,t));var r=e.definitionRef;if(kn(r,"cmmn:PlanFragment"))m(r,n),_(e,n);else if(kn(r,"cmmn:HumanTask")){y(r.planningTable,t);var o=i[e.id];Pn(o,d(E,t)),delete i[e.id]}}function g(e,n){t.unshift(function(){u(e,n)})}function _(e,t){if(e.di&&e.di.bounds){var n=function(e,t){var n=t.di.bounds;return Rn(e,function(e){return e.di.bounds.x>n.x&&e.di.bounds.x<n.x+n.width&&e.di.bounds.y>n.y&&e.di.bounds.y<n.y+n.height})}(a,e);Pn(n,function(e){Cn.remove(a,e),x(e,t)})}}function x(e,t){kn(e,"cmmn:TextAnnotation")?function(e,t){u(e,t)}(e,t):kn(e,"cmmn:CaseFileItem")&&function(e,t){u(e,t)}(e,t)}function b(e,t){c(e,t)}function E(e,n){t.push(function(){c(e,n)})}return{handleDefinitions:function(i,o){var c=i.CMMNDI;if(c){var l=c.diagrams;if(o&&-1===l.indexOf(o))throw new Error("diagram not part of cmmn:Definitions");!o&&l&&l.length&&(o=l[0]),f(o);var p=function(t,n){return e.root(t,n)}(o,o);!function(e,i){Pn(e,function(e){!function(e,i){var r,o=e.casePlanModel;o&&(r=function(e,t){var n=u(e,t);return Pn(e.exitCriteria,d(g,n)),m(e,n),_(e,n),n}(o,i)),function(e){Pn(e,function(e){e()})}(t),Pn(n,function(e){e(r)})}(e,i),t=[],n=[]})}(r,p),Pn(a,d(x)),Pn(s,d(b))}}}},jn={};jn.importCmmnDiagram=function(e,t,n){var i,r=e.get("cmmnImporter"),o=e.get("eventBus"),a=e.get("itemRegistry"),s=[];o.fire("import.render.start",{definitions:t});try{!function(e){new On({root:function(e){return r.root(e)},element:function(e,t){return r.add(e,t)},error:function(e,t){s.push({message:e,context:t})},addItem:function(e){a.add(e)}}).handleDefinitions(e)}(t)}catch(e){i=e}o.fire("import.render.complete",{error:i,warnings:s}),n(i,s)};var Nn={},In=st.domify,Dn=st.delegate,Bn='<img width="52" height="52" src="'+("data:image/svg+xml,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 960"><path fill="#fff" d="M960 60v839c0 33-27 61-60 61H60c-33 0-60-27-60-60V60C0 27 27 0 60 0h839c34 0 61 27 61 60z"/><path fill="#52b415" d="M217 548a205 205 0 0 0-144 58 202 202 0 0 0-4 286 202 202 0 0 0 285 3 200 200 0 0 0 48-219 203 203 0 0 0-185-128zM752 6a206 206 0 0 0-192 285 206 206 0 0 0 269 111 207 207 0 0 0 111-260A204 204 0 0 0 752 6zM62 0A62 62 0 0 0 0 62v398l60 46a259 259 0 0 1 89-36c5-28 10-57 14-85l99 2 12 85a246 246 0 0 1 88 38l70-52 69 71-52 68c17 30 29 58 35 90l86 14-2 100-86 12a240 240 0 0 1-38 89l43 58h413c37 0 60-27 60-61V407a220 220 0 0 1-44 40l21 85-93 39-45-76a258 258 0 0 1-98 1l-45 76-94-39 22-85a298 298 0 0 1-70-69l-86 22-38-94 76-45a258 258 0 0 1-1-98l-76-45 40-94 85 22a271 271 0 0 1 41-47z"/></svg>'))+'" />';function Ln(e){return e.join(";")}var zn,Fn='<div class="bjs-powered-by-lightbox" style="'+Ln(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"])+'"><div class="backdrop" style="'+Ln(["width: 100%","height: 100%","background: rgba(0,0,0,0.2)"])+'"></div><div class="notice" style="'+Ln(["position: absolute","left: 50%","top: 40%","margin: 0 -130px","width: 260px","padding: 10px","background: white","border: solid 1px #AAA","border-radius: 3px","font-family: Helvetica, Arial, sans-serif","font-size: 14px","line-height: 1.2em"])+'"><a href="http://bpmn.io" target="_blank" style="float: left; margin-right: 10px">'+Bn+'</a>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="http://bpmn.io" target="_blank">bpmn.io</a>.</div></div>';Nn.open=function(){zn||(zn=In(Fn),Dn.bind(zn,".backdrop","click",function(e){document.body.removeChild(zn)})),document.body.appendChild(zn)},Nn.BPMNIO_IMG=Bn;var $n={};Object.defineProperty($n,"__esModule",{value:!0}),$n.hasLowerCaseAlias=function(e){return e.xml&&"lowerCase"===e.xml.tagAlias},$n.serializeAsType=function(e){return Un(e)===Hn},$n.serializeAsProperty=function(e){return"property"===Un(e)};$n.DEFAULT_NS_MAP={xsi:"http://www.w3.org/2001/XMLSchema-instance"};var Hn=$n.XSI_TYPE="xsi:type";function Un(e){return e.xml&&e.xml.serialize}var Wn={};function Vn(){}Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.default=Vn,Vn.prototype.get=function(e){return this.$model.properties.get(this,e)},Vn.prototype.set=function(e,t){this.$model.properties.set(this,e,t)};var qn={};Object.defineProperty(qn,"__esModule",{value:!0}),qn.default=Yn;var Gn,Kn=(Gn=Wn)&&Gn.__esModule?Gn:{default:Gn};function Yn(e,t){this.model=e,this.properties=t}Yn.prototype.createType=function(e){var t=this.model,n=this.properties,i=Object.create(Kn.default.prototype);(0,l.forEach)(e.properties,function(e){e.isMany||void 0===e.default||(i[e.name]=e.default)}),n.defineModel(i,t),n.defineDescriptor(i,e);var r=e.ns.name;function o(e){n.define(this,"$type",{value:r,enumerable:!0}),n.define(this,"$attrs",{value:{}}),n.define(this,"$parent",{writable:!0}),(0,l.forEach)(e,(0,l.bind)(function(e,t){this.set(t,e)},this))}return o.prototype=i,o.hasType=i.$instanceOf=this.model.hasType,n.defineModel(o,t),n.defineDescriptor(o,e),o};var Xn={};Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.parseName=function(e,t){var n,i,r=e.split(/:/);if(1===r.length)n=e,i=t;else{if(2!==r.length)throw new Error("expected <prefix:localName> or <localName>, got "+e);n=r[1],i=r[0]}return{name:e=(i?i+":":"")+n,prefix:i,localName:n}};var Zn={};function Qn(e){this.model=e}function Jn(e,t,n){Object.defineProperty(e,t.name,{enumerable:!t.isReference,writable:!0,value:n,configurable:!0})}Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.default=Qn,Qn.prototype.set=function(e,t,n){var i=this.model.getPropertyDescriptor(e,t),r=i&&i.name;void 0===n?i?delete e[r]:delete e.$attrs[t]:i?r in e?e[r]=n:Jn(e,i,n):e.$attrs[t]=n},Qn.prototype.get=function(e,t){var n=this.model.getPropertyDescriptor(e,t);if(!n)return e.$attrs[t];var i=n.name;return!e[i]&&n.isMany&&Jn(e,n,[]),e[i]},Qn.prototype.define=function(e,t,n){Object.defineProperty(e,t,n)},Qn.prototype.defineDescriptor=function(e,t){this.define(e,"$descriptor",{value:t})},Qn.prototype.defineModel=function(e,t){this.define(e,"$model",{value:t})};var ei={};function ti(e){this.ns=e,this.name=e.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}Object.defineProperty(ei,"__esModule",{value:!0}),ei.default=ti,ti.prototype.build=function(){return(0,l.pick)(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])},ti.prototype.addProperty=function(e,t,n){"boolean"==typeof t&&(n=t,t=void 0),this.addNamedProperty(e,!1!==n);var i=this.properties;void 0!==t?i.splice(t,0,e):i.push(e)},ti.prototype.replaceProperty=function(e,t,n){var i=e.ns,r=this.properties,o=this.propertiesByName,a=e.name!==t.name;if(e.isId){if(!t.isId)throw new Error("property <"+t.ns.name+"> must be id property to refine <"+e.ns.name+">");this.setIdProperty(t,!1)}if(e.isBody){if(!t.isBody)throw new Error("property <"+t.ns.name+"> must be body property to refine <"+e.ns.name+">");this.setBodyProperty(t,!1)}var s=r.indexOf(e);if(-1===s)throw new Error("property <"+i.name+"> not found in property list");r.splice(s,1),this.addProperty(t,n?void 0:s,a),o[i.name]=o[i.localName]=t},ti.prototype.redefineProperty=function(e,t,n){var i=e.ns.prefix,r=t.split("#"),o=(0,Xn.parseName)(r[0],i),a=(0,Xn.parseName)(r[1],o.prefix).name,s=this.propertiesByName[a];if(!s)throw new Error("refined property <"+a+"> not found");this.replaceProperty(s,e,n),delete e.redefines},ti.prototype.addNamedProperty=function(e,t){var n=e.ns,i=this.propertiesByName;t&&(this.assertNotDefined(e,n.name),this.assertNotDefined(e,n.localName)),i[n.name]=i[n.localName]=e},ti.prototype.removeNamedProperty=function(e){var t=e.ns,n=this.propertiesByName;delete n[t.name],delete n[t.localName]},ti.prototype.setBodyProperty=function(e,t){if(t&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+e.ns.name+">)");this.bodyProperty=e},ti.prototype.setIdProperty=function(e,t){if(t&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+e.ns.name+">)");this.idProperty=e},ti.prototype.assertNotDefined=function(e,t){var n=e.name,i=this.propertiesByName[n];if(i)throw new Error("property <"+n+"> already defined; override of <"+i.definedBy.ns.name+"#"+i.ns.name+"> by <"+e.definedBy.ns.name+"#"+e.ns.name+"> not allowed without redefines")},ti.prototype.hasProperty=function(e){return this.propertiesByName[e]},ti.prototype.addTrait=function(e,t){var n=this.allTypesByName,i=this.allTypes,r=e.name;r in n||((0,l.forEach)(e.properties,(0,l.bind)(function(n){n=(0,l.assign)({},n,{name:n.ns.localName,inherited:t}),Object.defineProperty(n,"definedBy",{value:e});var i=n.replaces,r=n.redefines;i||r?this.redefineProperty(n,i||r,i):(n.isBody&&this.setBodyProperty(n),n.isId&&this.setIdProperty(n),this.addProperty(n))},this)),i.push(e),n[r]=e)};var ni={};Object.defineProperty(ni,"__esModule",{value:!0}),ni.coerceType=function(e,t){var n=ri[e];return n?n(t):t},ni.isBuiltIn=function(e){return!!ii[e]},ni.isSimple=function(e){return!!ri[e]};var ii={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},ri={String:function(e){return e},Boolean:function(e){return"true"===e},Integer:function(e){return parseInt(e,10)},Real:function(e){return parseFloat(e,10)}};var oi={};Object.defineProperty(oi,"__esModule",{value:!0}),oi.default=si;var ai=function(e){return e&&e.__esModule?e:{default:e}}(ei);function si(e,t){this.packageMap={},this.typeMap={},this.packages=[],this.properties=t,(0,l.forEach)(e,(0,l.bind)(this.registerPackage,this))}function ci(e,t,n){var i=t[n];if(i in e)throw new Error("package with "+n+" <"+i+"> already defined")}si.prototype.getPackage=function(e){return this.packageMap[e]},si.prototype.getPackages=function(){return this.packages},si.prototype.registerPackage=function(e){e=(0,l.assign)({},e);var t=this.packageMap;ci(t,e,"prefix"),ci(t,e,"uri"),(0,l.forEach)(e.types,(0,l.bind)(function(t){this.registerType(t,e)},this)),t[e.uri]=t[e.prefix]=e,this.packages.push(e)},si.prototype.registerType=function(e,t){e=(0,l.assign)({},e,{superClass:(e.superClass||[]).slice(),extends:(e.extends||[]).slice(),properties:(e.properties||[]).slice(),meta:(0,l.assign)(e.meta||{})});var n=(0,Xn.parseName)(e.name,t.prefix),i=n.name,r={};(0,l.forEach)(e.properties,(0,l.bind)(function(e){var t=(0,Xn.parseName)(e.name,n.prefix),i=t.name;(0,ni.isBuiltIn)(e.type)||(e.type=(0,Xn.parseName)(e.type,t.prefix).name),(0,l.assign)(e,{ns:t,name:i}),r[i]=e},this)),(0,l.assign)(e,{ns:n,name:i,propertiesByName:r}),(0,l.forEach)(e.extends,(0,l.bind)(function(e){var t=this.typeMap[e];t.traits=t.traits||[],t.traits.push(i)},this)),this.definePackage(e,t),this.typeMap[i]=e},si.prototype.mapTypes=function(e,t,n){var i=(0,ni.isBuiltIn)(e.name)?{name:e.name}:this.typeMap[e.name],r=this;function o(e){return a(e,!0)}function a(n,i){var o=(0,Xn.parseName)(n,(0,ni.isBuiltIn)(n)?"":e.prefix);r.mapTypes(o,t,i)}if(!i)throw new Error("unknown type <"+e.name+">");(0,l.forEach)(i.superClass,n?o:a),t(i,!n),(0,l.forEach)(i.traits,o)},si.prototype.getEffectiveDescriptor=function(e){var t=(0,Xn.parseName)(e),n=new ai.default(t);this.mapTypes(t,function(e,t){n.addTrait(e,t)});var i=n.build();return this.definePackage(i,i.allTypes[i.allTypes.length-1].$pkg),i},si.prototype.definePackage=function(e,t){this.properties.define(e,"$pkg",{value:t})};var ui={};Object.defineProperty(ui,"__esModule",{value:!0}),ui.default=hi;var li=fi(qn),di=fi(oi),pi=fi(Zn);function fi(e){return e&&e.__esModule?e:{default:e}}function hi(e){this.properties=new pi.default(this),this.factory=new li.default(this,this.properties),this.registry=new di.default(e,this.properties),this.typeCache={}}hi.prototype.create=function(e,t){var n=this.getType(e);if(!n)throw new Error("unknown type <"+e+">");return new n(t)},hi.prototype.getType=function(e){var t=this.typeCache,n=(0,l.isString)(e)?e:e.ns.name,i=t[n];return i||(e=this.registry.getEffectiveDescriptor(n),i=t[n]=this.factory.createType(e)),i},hi.prototype.createAny=function(e,t,n){var i=(0,Xn.parseName)(e),r={$type:e,$instanceOf:function(e){return e===this.$type}},o={name:e,isGeneric:!0,ns:{prefix:i.prefix,localName:i.localName,uri:t}};return this.properties.defineDescriptor(r,o),this.properties.defineModel(r,this),this.properties.define(r,"$parent",{enumerable:!1,writable:!0}),(0,l.forEach)(n,function(e,t){(0,l.isObject)(e)&&void 0!==e.value?r[e.name]=e.value:r[t]=e}),r},hi.prototype.getPackage=function(e){return this.registry.getPackage(e)},hi.prototype.getPackages=function(){return this.registry.getPackages()},hi.prototype.getElementDescriptor=function(e){return e.$descriptor},hi.prototype.hasType=function(e,t){return void 0===t&&(t=e,e=this),t in e.$model.getElementDescriptor(e).allTypesByName},hi.prototype.getPropertyDescriptor=function(e,t){return this.getElementDescriptor(e).propertiesByName[t]},hi.prototype.getTypeDescriptor=function(e){return this.registry.typeMap[e]};var mi={};Object.defineProperty(mi,"__esModule",{value:!0}),Object.defineProperty(mi,"default",{enumerable:!0,get:function(){return(e=ui,e&&e.__esModule?e:{default:e}).default;var e}});var yi={},vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(yi,"__esModule",{value:!0});var gi=String.fromCharCode,_i=Object.prototype.hasOwnProperty,xi=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/gi,bi={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'};function Ei(e,t,n,i){return i?_i.call(bi,i)?bi[i]:"&"+i+";":gi(t||parseInt(n,16))}function wi(e){return e.length>3&&-1!==e.indexOf("&")?e.replace(xi,Ei):e}Object.keys(bi).forEach(function(e){bi[e.toUpperCase()]=bi[e]});var Mi="http://www.w3.org/2001/XMLSchema-instance",Si="xsi",Ci="xsi:type",Pi="non-whitespace outside of root node";function Ri(e){return new Error(e)}function Ti(e){return"missing namespace for prefix <"+e+">"}function ki(e){return{get:e,enumerable:!0}}function Ai(e){var t,n={};for(t in e)n[t]=e[t];return n}function Oi(e){return e+"$uri"}function ji(){return{line:0,column:0}}function Ni(e){throw e}yi.Parser=function e(t){if(!this)return new e(t);var n,i,r,o,a,s,c,u,l,d=t&&t.proxy,p=Ni,f=ji,h=!1,m=!1,y=null,v=!1;function g(e){e instanceof Error||(e=Ri(e)),y=e,p(e,f)}function _(e){a&&(e instanceof Error||(e=Ri(e)),a(e,f))}this.on=function(e,t){if("function"!=typeof t)throw Ri("required args <name, cb>");switch(e){case"openTag":i=t;break;case"text":n=t;break;case"closeTag":r=t;break;case"error":p=t;break;case"warn":a=t;break;case"cdata":o=t;break;case"attention":u=t;break;case"question":c=t;break;case"comment":s=t;break;default:throw Ri("unsupported event: "+e)}return this},this.ns=function(e){if(void 0===e&&(e={}),"object"!==(void 0===e?"undefined":vi(e)))throw Ri("required args <nsMap={}>");var t,n={};for(t in e)n[t]=e[t];return n[Mi]=Si,m=!0,l=n,this},this.parse=function(e){if("string"!=typeof e)throw Ri("required args <xml=string>");return y=null,function(e){var t,a,p,y,x,b,E,w,M,S,C=m?[]:null,P=m?function(e){var t,n,i={};for(t in e)i[n=e[t]]=n,i[Oi(n)]=t;return i}(l):null,R=[],T=0,k=!1,A=!1,O=0,j=0,N="",I=0;function D(){if(null!==S)return S;var e,t,n,i,r,o,a,s,c,u,d,p=m&&P.xmlns,f=m&&h?[]:null,y=I,v=N,g=v.length,x={},b={};e:for(;y<g;y++)if(c=!1,!(32===(u=v.charCodeAt(y))||u<14&&u>8)){for((u<65||u>122||u>90&&u<97)&&95!==u&&58!==u&&(_("illegal first char attribute name"),c=!0),d=y+1;d<g;d++)if(!((u=v.charCodeAt(d))>96&&u<123||u>64&&u<91||u>47&&u<59||46===u||45===u||95===u)){if(32===u||u<14&&u>8){_("missing attribute value"),y=d;continue e}if(61===u)break;_("illegal attribute name char"),c=!0}if("xmlns:xmlns"===(s=v.substring(y,d))&&(_("illegal declaration of xmlns"),c=!0),34===(u=v.charCodeAt(d+1)))-1===(d=v.indexOf('"',y=d+2))&&-1!==(d=v.indexOf("'",y))&&(_("attribute value quote missmatch"),c=!0);else if(39===u)-1===(d=v.indexOf("'",y=d+2))&&-1!==(d=v.indexOf('"',y))&&(_("attribute value quote missmatch"),c=!0);else for(_("missing attribute value quotes"),c=!0,d+=1;d<g&&!(32===(u=v.charCodeAt(d+1))||u<14&&u>8);d++);for(-1===d&&(_("missing closing quotes"),d=g,c=!0),c||(o=v.substring(y,d)),y=d;d+1<g&&!(32===(u=v.charCodeAt(d+1))||u<14&&u>8);d++)y===d&&(_("illegal character after attribute end"),c=!0);if(y=d+1,!c)if(s in b)_("attribute <"+s+"> already defined");else if(b[s]=!0,m)if(h){if(null!==(r="xmlns"===s?"xmlns":120===s.charCodeAt(0)&&"xmlns:"===s.substr(0,6)?s.substr(6):null)){if(e=wi(o),t=Oi(r),!(a=l[e])){if("xmlns"===r||t in P&&P[t]!==e)do{a="ns"+T++}while(void 0!==P[a]);else a=r;l[e]=a}P[r]!==a&&(i||(P=Ai(P),i=!0),P[r]=a,"xmlns"===r&&(P[Oi(a)]=e,p=a),P[t]=e),x[s]=o;continue}f.push(s,o)}else-1!==(u=s.indexOf(":"))?(n=P[s.substring(0,u)])?((s=p===n?s.substr(u+1):n+s.substr(u))===Ci&&(-1!==(u=o.indexOf(":"))?(n=o.substring(0,u),n=P[n]||n,o=n+o.substring(u)):o=p+":"+o),x[s]=o):_(Ti(s.substring(0,u))):x[s]=o;else x[s]=o}if(h)for(y=0,g=f.length;y<g;y++){if(s=f[y++],o=f[y],-1!==(u=s.indexOf(":"))){if(!(n=P[s.substring(0,u)])){_(Ti(s.substring(0,u)));continue}(s=p===n?s.substr(u+1):n+s.substr(u))===Ci&&(-1!==(u=o.indexOf(":"))?(n=o.substring(0,u),n=P[n]||n,o=n+o.substring(u)):o=p+":"+o)}x[s]=o}return S=x}for(f=function(){for(var t,n,i=/(\r\n|\r|\n)/g,r=0,o=0,a=0,s=j;O>=a&&(t=i.exec(e))&&!((s=t[0].length+t.index)>O);)r+=1,a=s;return-1==O?(o=s,n=e.substring(j)):0===j?(console.log(O-a),n=e.substring(j,O)):(o=O-a,n=-1==j?e.substring(O):e.substring(O,j+1)),{data:n,line:r,column:o}},d&&(M=Object.create({},{name:ki(function(){return E}),originalName:ki(function(){return w}),attrs:ki(D),ns:ki(function(){return P})}));-1!==j;){if(-1===(O=60===e.charCodeAt(j)?j:e.indexOf("<",j)))return R.length?g("unexpected end of file"):0===j?g("missing start tag"):void(j<e.length&&e.substring(j).trim()&&_(Pi));if(j!==O)if(R.length){if(n&&(n(e.substring(j,O),wi,f),v))return}else if(e.substring(j,O).trim()&&(_(Pi),v))return;if(33!==(x=e.charCodeAt(O+1)))if(63!==x){if(-1==(j=e.indexOf(">",O+1)))return g("unclosed tag");if(S={},47===x){if(k=!1,A=!0,!R.length)return g("missing open tag");if(a=E=R.pop(),y=O+2+a.length,e.substring(O+2,y)!==a)return g("closing tag mismatch");for(;y<j;y++)if(!(32===(x=e.charCodeAt(y))||x>8&&x<14))return g("close tag")}else{if(47===e.charCodeAt(j-1)?(a=E=e.substring(O+1,j-1),k=!0,A=!0):(a=E=e.substring(O+1,j),k=!0,A=!1),!(x>96&&x<123||x>64&&x<91||95===x||58===x))return g("illegal first char nodeName");for(y=1,p=a.length;y<p;y++)if(!((x=a.charCodeAt(y))>96&&x<123||x>64&&x<91||x>47&&x<59||45===x||95===x||46==x)){if(32===x||x<14&&x>8){E=a.substring(0,y),S=null;break}return g("invalid nodeName")}A||R.push(E)}if(m){if(t=P,k&&(A||C.push(t),null===S&&(h=-1!==a.indexOf("xmlns",y))&&(I=y,N=a,D(),h=!1)),w=E,-1!==(x=E.indexOf(":"))){if(!(b=P[E.substring(0,x)]))return g("missing namespace on <"+w+">");E=E.substr(x+1)}else b=P.xmlns;b&&(E=b+":"+E)}if(k&&(I=y,N=a,i&&(d?i(M,wi,A,f):i(E,D,wi,A,f),v)))return;if(A){if(r&&(r(d?M:E,wi,k,f),v))return;m&&(P=k?t:C.pop())}j+=1}else{if(-1===(j=e.indexOf("?>",O)))return g("unclosed question");if(c&&(c(e.substring(O,j+2),f),v))return;j+=2}else{if(91===(x=e.charCodeAt(O+2))&&"CDATA["===e.substr(O+3,6)){if(-1===(j=e.indexOf("]]>",O)))return g("unclosed cdata");if(o&&(o(e.substring(O+9,j),f),v))return;j+=3;continue}if(45===x&&45===e.charCodeAt(O+3)){if(-1===(j=e.indexOf("--\x3e",O)))return g("unclosed comment");if(s&&(s(e.substring(O+4,j),wi,f),v))return;j+=3;continue}if(-1===(j=e.indexOf(">",O+1)))return g("unclosed tag");if(u&&(u(e.substring(O,j+1),wi,f),v))return;j+=1}}}(e),f=ji,v=!1,y},this.stop=function(){v=!0}};var Ii={};(function(e){"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();!function(e){var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];this.data=[null].concat(n),this.top=this.data.length-1}return t(e,[{key:"clear",value:function(){return this.data.length=1,this.top=0,this}},{key:"empty",value:function(){return 0===this.top}},{key:"length",value:function(){return this.top}},{key:"peek",value:function(){return this.data[this.top]}},{key:"pop",value:function(){var e=void 0;return this.top>0&&(e=this.data.pop(),this.top--),e}},{key:"push",value:function(e){return this.data[++this.top]=e,this}},{key:"search",value:function(e){var t=this.data.indexOf(e);return-1===t?-1:this.data.length-t}}]),e}();function i(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return new(Function.prototype.bind.apply(n,[null].concat(t)))}void 0!==Ii?Ii=i:e.stack=i}("undefined"!=typeof window?window:e)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Di={};Object.defineProperty(Di,"__esModule",{value:!0}),Di.Reader=Ji;var Bi=zi(Ii),Li=zi(mi);function zi(e){return e&&e.__esModule?e:{default:e}}function Fi(e,t){return(0,$n.hasLowerCaseAlias)(t)?e.prefix+":"+((n=e.localName).charAt(0).toUpperCase()+n.slice(1)):e.name;var n}function $i(e){return new Error(e)}function Hi(e){return e.$descriptor}function Ui(e){(0,l.assign)(this,e),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(e){this.references.push(e)},this.addElement=function(e){if(!e)throw $i("expected element");var t,n=this.elementsById,i=Hi(e).idProperty;if(i&&(t=e.get(i.name))){if(n[t])throw $i("duplicate ID <"+t+">");n[t]=e}},this.addWarning=function(e){this.warnings.push(e)}}function Wi(){}function Vi(){}function qi(){}function Gi(e,t){this.property=e,this.context=t}function Ki(e,t){this.element=t,this.propertyDesc=e}function Yi(){}function Xi(e,t,n){this.model=e,this.type=e.getType(t),this.context=n}function Zi(e,t,n){Xi.call(this,e,t,n)}function Qi(e,t,n){this.model=e,this.context=n}function Ji(e){e instanceof Li.default&&(e={model:e}),(0,l.assign)(this,{lax:!1},e)}Wi.prototype.handleEnd=function(){},Wi.prototype.handleText=function(){},Wi.prototype.handleNode=function(){},Vi.prototype=Object.create(Wi.prototype),Vi.prototype.handleNode=function(){return this},qi.prototype=Object.create(Wi.prototype),qi.prototype.handleText=function(e){this.body=(this.body||"")+e},Gi.prototype=Object.create(qi.prototype),Gi.prototype.handleNode=function(e){if(this.element)throw $i("expected no sub nodes");return this.element=this.createReference(e),this},Gi.prototype.handleEnd=function(){this.element.id=this.body},Gi.prototype.createReference=function(e){return{property:this.property.ns.name,id:""}},Ki.prototype=Object.create(qi.prototype),Ki.prototype.handleEnd=function(){var e=this.body||"",t=this.element,n=this.propertyDesc;e=(0,ni.coerceType)(n.type,e),n.isMany?t.get(n.name).push(e):t.set(n.name,e)},Yi.prototype=Object.create(qi.prototype),Yi.prototype.handleNode=function(e){var t=this,n=this.element;return n?t=this.handleChild(e):(n=this.element=this.createElement(e),this.context.addElement(n)),t},Xi.prototype=Object.create(Yi.prototype),Xi.prototype.addReference=function(e){this.context.addReference(e)},Xi.prototype.handleEnd=function(){var e=this.body,t=this.element,n=Hi(t).bodyProperty;n&&void 0!==e&&(e=(0,ni.coerceType)(n.type,e),t.set(n.name,e))},Xi.prototype.createElement=function(e){var t,n=e.attributes,i=this.type,r=Hi(i),o=this.context,a=new i({}),s=this.model;return(0,l.forEach)(n,function(e,n){var i,c=r.propertiesByName[n];c&&c.isReference?c.isMany?(i=e.split(" "),(0,l.forEach)(i,function(e){o.addReference({element:a,property:c.ns.name,id:e})})):o.addReference({element:a,property:c.ns.name,id:e}):(c?e=(0,ni.coerceType)(c.type,e):"xmlns"!==n&&(t=(0,Xn.parseName)(n,r.ns.prefix),s.getPackage(t.prefix)&&o.addWarning({message:"unknown attribute <"+n+">",element:a,property:n,value:e})),a.set(n,e))}),a},Xi.prototype.getPropertyForNode=function(e){var t,n,i=e.name,r=(0,Xn.parseName)(i),o=this.type,a=this.model,s=Hi(o),c=r.name,u=s.propertiesByName[c];if(u)return(0,$n.serializeAsType)(u)&&(t=e.attributes[$n.XSI_TYPE])?(t=function(e,t){var n=(0,Xn.parseName)(e);return function(e,t){var n=e.name,i=e.localName,r=t.xml&&t.xml.typePrefix;return r&&0===i.indexOf(r)?e.prefix+":"+i.slice(r.length):n}(n,t.getPackage(n.prefix))}(t,a),n=a.getType(t),(0,l.assign)({},u,{effectiveType:Hi(n).name})):u;var d=a.getPackage(r.prefix);if(d){if(t=Fi(r,d),n=a.getType(t),u=(0,l.find)(s.properties,function(e){return!e.isVirtual&&!e.isReference&&!e.isAttribute&&n.hasType(e.type)}))return(0,l.assign)({},u,{effectiveType:Hi(n).name})}else if(u=(0,l.find)(s.properties,function(e){return!e.isReference&&!e.isAttribute&&"Element"===e.type}))return u;throw $i("unrecognized element <"+r.name+">")},Xi.prototype.toString=function(){return"ElementDescriptor["+Hi(this.type).name+"]"},Xi.prototype.valueHandler=function(e,t){return new Ki(e,t)},Xi.prototype.referenceHandler=function(e){return new Gi(e,this.context)},Xi.prototype.handler=function(e){return"Element"===e?new Qi(this.model,e,this.context):new Xi(this.model,e,this.context)},Xi.prototype.handleChild=function(e){var t,n,i,r;if(t=this.getPropertyForNode(e),i=this.element,n=t.effectiveType||t.type,(0,ni.isSimple)(n))return this.valueHandler(t,i);var o=(r=t.isReference?this.referenceHandler(t).handleNode(e):this.handler(n).handleNode(e)).element;return void 0!==o&&(t.isMany?i.get(t.name).push(o):i.set(t.name,o),t.isReference?((0,l.assign)(o,{element:i}),this.context.addReference(o)):o.$parent=i),r},Zi.prototype=Object.create(Xi.prototype),Zi.prototype.createElement=function(e){var t=e.name,n=(0,Xn.parseName)(t),i=this.model,r=this.type,o=i.getPackage(n.prefix),a=o&&Fi(n,o)||t;if(!r.hasType(a))throw $i("unexpected element <"+e.originalName+">");return Xi.prototype.createElement.call(this,e)},Qi.prototype=Object.create(Yi.prototype),Qi.prototype.createElement=function(e){var t=e.name,n=(0,Xn.parseName)(t).prefix,i=e.ns[n+"$uri"],r=e.attributes;return this.model.createAny(t,i,r)},Qi.prototype.handleChild=function(e){var t=new Qi(this.model,"Element",this.context).handleNode(e),n=this.element,i=t.element;return void 0!==i&&((n.$children=n.$children||[]).push(i),i.$parent=n),t},Qi.prototype.handleText=function(e){this.body=this.body||""+e},Qi.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)},Ji.prototype.fromXML=function(e,t,n){var i=t.rootHandler;t instanceof Xi?(i=t,t={}):"string"==typeof t?(i=this.handler(t),t={}):"string"==typeof i&&(i=this.handler(i));var r=this.model,o=this.lax,a=new Ui((0,l.assign)({},t,{rootHandler:i})),s=new yi.Parser({proxy:!0}),c=new Bi.default;function u(e,t,n){var i=t(),r=i.line,o=i.column,s=i.data;"<"===s.charAt(0)&&-1!==s.indexOf(" ")&&(s=s.slice(0,s.indexOf(" "))+">");var c="unparsable content "+(s?s+" ":"")+"detected\n\tline: "+r+"\n\tcolumn: "+o+"\n\tnested error: "+e.message;if(n)return a.addWarning({message:c,error:e}),console.warn("could not parse node"),console.warn(e),!0;throw console.error("could not parse document"),console.error(e),$i(c)}i.context=a,c.push(i);var d=/^<\?xml /i,p=/ encoding="([^"]+)"/i,f=/^utf-8$/i;var h=r.getPackages().reduce(function(e,t){return e[t.uri]=t.prefix,e},{});s.ns(h).on("openTag",function(e,t,n,i){var r=e.attrs||{},a=Object.keys(r).reduce(function(e,n){var i=t(r[n]);return e[n]=i,e},{});!function(e,t){var n=c.peek();try{c.push(n.handleNode(e))}catch(e){u(e,t,o)&&c.push(new Vi)}}({name:e.name,originalName:e.originalName,attributes:a,ns:e.ns},i)}).on("question",function(e){if(d.test(e)){var t=p.exec(e),n=t&&t[1];n&&!f.test(n)&&a.addWarning({message:"unsupported document encoding <"+n+">, falling back to UTF-8"})}}).on("closeTag",function(){c.pop().handleEnd()}).on("cdata",function(e){c.peek().handleText(e)}).on("text",function(e,t){!function(e){(e=e.trim())&&c.peek().handleText(e)}(t(e))}).on("error",u).on("warn",function(e,t){return u(e,t,!0)}),setTimeout(function(){var t;try{s.parse(e),function(){var e,t,n=a.elementsById,i=a.references;for(e=0;t=i[e];e++){var r=t.element,o=n[t.id],s=Hi(r).propertiesByName[t.property];if(o||a.addWarning({message:"unresolved reference <"+t.id+">",element:t.element,property:t.property,value:t.id}),s.isMany){var c=r.get(s.name),u=c.indexOf(t);-1===u&&(u=c.length),o?c[u]=o:c.splice(u,1)}else r.set(s.name,o)}}()}catch(e){t=e}var r=i.element;t||r||(t=$i("failed to parse document as <"+i.type.$descriptor.name+">")),n(t,t?void 0:r,a)},0)},Ji.prototype.handler=function(e){return new Zi(this.model,e)};var er={};Object.defineProperty(er,"__esModule",{value:!0}),er.Writer=function(e){return e=(0,l.assign)({format:!1,preamble:!0},e||{}),{toXML:function(t,n){var i=n||new function(){this.value="",this.write=function(e){this.value+=e}},r=new function(e,t){var n=[""];this.append=function(t){return e.write(t),this},this.appendNewLine=function(){return t&&e.write("\n"),this},this.appendIndent=function(){return t&&e.write(n.join("  ")),this},this.indent=function(){return n.push(""),this},this.unindent=function(){return n.pop(),this}}(i,e.format);if(e.preamble&&r.append(tr),(new hr).build(t).serializeTo(r),!n)return i.value}}};var tr='<?xml version="1.0" encoding="UTF-8"?>\n',nr=/<|>|'|"|&|\n\r|\n/g,ir=/<|>|&/g;function rr(e){var t={},n={},i={},r=[],o=[];this.byUri=function(t){return n[t]||e&&e.byUri(t)},this.add=function(e,t){n[e.uri]=e,t?r.push(e):o.push(e),this.mapPrefix(e.prefix,e.uri)},this.uriByPrefix=function(e){return t[e||"xmlns"]},this.mapPrefix=function(e,n){t[e||"xmlns"]=n},this.logUsed=function(e){var t=e.uri;i[t]=this.byUri(t)},this.getUsed=function(e){return[].concat(r,o).filter(function(e){return i[e.uri]})}}function or(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function ar(e){return(0,l.isString)(e)?e:(e.prefix?e.prefix+":":"")+e.localName}function sr(e,t){return t.isGeneric?(0,l.assign)({localName:t.ns.localName},e):(0,l.assign)({localName:(n=t.ns.localName,i=t.$pkg,(0,$n.hasLowerCaseAlias)(i)?(r=n).charAt(0).toLowerCase()+r.slice(1):n)},e);var n,i,r}var cr={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},ur={"<":"lt",">":"gt","&":"amp"};function lr(e,t,n){return(e=(0,l.isString)(e)?e:""+e).replace(t,function(e){return"&"+n[e]+";"})}function dr(e){this.tagName=e}function pr(){}function fr(e){this.tagName=e}function hr(e,t){this.body=[],this.attrs=[],this.parent=e,this.propertyDescriptor=t}function mr(e,t){hr.call(this,e,t)}dr.prototype.build=function(e){return this.element=e,this},dr.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()},pr.prototype.serializeValue=pr.prototype.serializeTo=function(e){e.append(this.escape?lr(this.value,ir,ur):this.value)},pr.prototype.build=function(e,t){return this.value=t,"String"===e.type&&-1!==t.search(ir)&&(this.escape=!0),this},or(fr,pr),fr.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"),this.serializeValue(e),e.append("</"+this.tagName+">").appendNewLine()},hr.prototype.build=function(e){this.element=e;var t,n,i,r=e.$descriptor,o=this.propertyDescriptor,a=r.isGeneric;return t=a?this.parseGeneric(e):this.parseNsAttributes(e),this.ns=o?this.nsPropertyTagName(o):this.nsTagName(r),this.tagName=this.addTagName(this.ns),a||(n=function(e){var t=e.$descriptor;return(0,l.filter)(t.properties,function(t){var n=t.name;if(t.isVirtual)return!1;if(!e.hasOwnProperty(n))return!1;var i=e[n];return i!==t.default&&null!==i&&(!t.isMany||i.length)})}(e),this.parseAttributes((i=n,(0,l.filter)(i,function(e){return e.isAttr}))),this.parseContainments(function(e){return(0,l.filter)(e,function(e){return!e.isAttr})}(n))),this.parseGenericAttributes(e,t),this},hr.prototype.nsTagName=function(e){return sr(this.logNamespaceUsed(e.ns),e)},hr.prototype.nsPropertyTagName=function(e){return function(e,t){return(0,l.assign)({localName:t.ns.localName},e)}(this.logNamespaceUsed(e.ns),e)},hr.prototype.isLocalNs=function(e){return e.uri===this.ns.uri},hr.prototype.nsAttributeName=function(e){var t;if(t=(0,l.isString)(e)?(0,Xn.parseName)(e):e.ns,e.inherited)return{localName:t.localName};var n=this.logNamespaceUsed(t);return this.getNamespaces().logUsed(n),this.isLocalNs(n)?{localName:t.localName}:(0,l.assign)({localName:t.localName},n)},hr.prototype.parseGeneric=function(e){var t=this,n=this.body,i=[];return(0,l.forEach)(e,function(r,o){"$body"===o?n.push((new pr).build({type:"String"},r)):"$children"===o?(0,l.forEach)(r,function(e){n.push(new hr(t).build(e))}):0!==o.indexOf("$")&&t.parseNsAttribute(e,o,r)&&i.push({name:o,value:r})}),i},hr.prototype.parseNsAttribute=function(e,t,n){var i,r=e.$model,o=(0,Xn.parseName)(t);if("xmlns"===o.prefix&&(i={prefix:o.localName,uri:n}),o.prefix||"xmlns"!==o.localName||(i={uri:n}),!i)return{name:t,value:n};if(r&&r.getPackage(n))this.logNamespace(i,!0,!0);else{var a=this.logNamespaceUsed(i,!0);this.getNamespaces().logUsed(a)}},hr.prototype.parseNsAttributes=function(e,t){var n=this,i=e.$attrs,r=[];return(0,l.forEach)(i,function(t,i){var o=n.parseNsAttribute(e,i,t);o&&r.push(o)}),r},hr.prototype.parseGenericAttributes=function(e,t){var n=this;(0,l.forEach)(t,function(t){if(t.name!==$n.XSI_TYPE)try{n.addAttribute(n.nsAttributeName(t.name),t.value)}catch(n){console.warn("missing namespace information for ",t.name,"=",t.value,"on",e,n)}})},hr.prototype.parseContainments=function(e){var t=this,n=this.body,i=this.element;(0,l.forEach)(e,function(e){var r=i.get(e.name),o=e.isReference;if(e.isMany||(r=[r]),e.isBody)n.push((new pr).build(e,r[0]));else if((0,ni.isSimple)(e.type))(0,l.forEach)(r,function(i){n.push(new fr(t.addTagName(t.nsPropertyTagName(e))).build(e,i))});else if(o)(0,l.forEach)(r,function(i){n.push(new dr(t.addTagName(t.nsPropertyTagName(e))).build(i))});else{var a=(0,$n.serializeAsType)(e),s=(0,$n.serializeAsProperty)(e);(0,l.forEach)(r,function(i){var r;r=a?new mr(t,e):s?new hr(t,e):new hr(t),n.push(r.build(i))})}})},hr.prototype.getNamespaces=function(e){var t,n=this.namespaces,i=this.parent;return n||(t=i&&i.getNamespaces(),e||!t?this.namespaces=n=new rr(t):n=t),n},hr.prototype.logNamespace=function(e,t,n){var i=this.getNamespaces(n),r=e.uri,o=e.prefix;return i.byUri(r)||i.add(e,t),i.mapPrefix(o,r),e},hr.prototype.logNamespaceUsed=function(e,t){var n,i,r,o=this.element.$model,a=this.getNamespaces(t),s=e.prefix,c=e.uri;if(!s&&!c)return{localName:e.localName};if(r=$n.DEFAULT_NS_MAP[s]||o&&(o.getPackage(s)||{}).uri,!(c=c||r||a.uriByPrefix(s)))throw new Error("no namespace uri given for prefix <"+s+">");if(!(e=a.byUri(c))){for(n=s,i=1;a.uriByPrefix(n);)n=s+"_"+i++;e=this.logNamespace({prefix:n,uri:c},r===c)}return s&&a.mapPrefix(s,c),e},hr.prototype.parseAttributes=function(e){var t=this,n=this.element;(0,l.forEach)(e,function(e){var i=n.get(e.name);if(e.isReference)if(e.isMany){var r=[];(0,l.forEach)(i,function(e){r.push(e.id)}),i=r.join(" ")}else i=i.id;t.addAttribute(t.nsAttributeName(e),i)})},hr.prototype.addTagName=function(e){var t=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(t),ar(e)},hr.prototype.addAttribute=function(e,t){var n=this.attrs;(0,l.isString)(t)&&(t=lr(t,nr,cr)),n.push({name:e,value:t})},hr.prototype.serializeAttributes=function(e){var t=this.attrs,n=this.namespaces;n&&(t=function(e){return(0,l.map)(e.getUsed(),function(e){return{name:"xmlns"+(e.prefix?":"+e.prefix:""),value:e.uri}})}(n).concat(t)),(0,l.forEach)(t,function(t){e.append(" ").append(ar(t.name)).append('="').append(t.value).append('"')})},hr.prototype.serializeTo=function(e){var t=this.body[0],n=t&&t.constructor!==pr;e.appendIndent().append("<"+this.tagName),this.serializeAttributes(e),e.append(t?">":" />"),t&&(n&&e.appendNewLine().indent(),(0,l.forEach)(this.body,function(t){t.serializeTo(e)}),n&&e.unindent().appendIndent(),e.append("</"+this.tagName+">")),e.appendNewLine()},or(mr,hr),mr.prototype.parseNsAttributes=function(e){var t=hr.prototype.parseNsAttributes.call(this,e),n=e.$descriptor;if(n.name===this.propertyDescriptor.type)return t;var i=this.typeNs=this.nsTagName(n);this.getNamespaces().logUsed(this.typeNs);var r=e.$model.getPackage(i.uri),o=r.xml&&r.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName($n.XSI_TYPE),(i.prefix?i.prefix+":":"")+o+n.ns.localName),t},mr.prototype.isLocalNs=function(e){return e.uri===(this.typeNs||this.ns).uri};var yr={};Object.defineProperty(yr,"__esModule",{value:!0}),Object.defineProperty(yr,"Reader",{enumerable:!0,get:function(){return Di.Reader}}),Object.defineProperty(yr,"Writer",{enumerable:!0,get:function(){return er.Writer}});var vr={};Object.defineProperty(vr,"__esModule",{value:!0}),vr.default=_r;var gr=function(e){return e&&e.__esModule?e:{default:e}}(mi);function _r(e,t){gr.default.call(this,e,t)}_r.prototype=Object.create(gr.default.prototype),_r.prototype.fromXML=function(e,t,n,i){(0,l.isString)(t)||(i=n,n=t,t="cmmn:Definitions"),(0,l.isFunction)(n)&&(i=n,n={});var r=new yr.Reader((0,l.assign)({model:this,lax:!0},n)),o=r.handler(t);r.fromXML(e,o,i)},_r.prototype.toXML=function(e,t,n){(0,l.isFunction)(t)&&(n=t,t={});var i,r,o=new yr.Writer(t);try{i=o.toXML(e)}catch(e){r=e}return n(r,i)};var xr={};Object.defineProperty(xr,"__esModule",{value:!0}),xr.default=function(e,t){var n=(0,l.assign)({},Pr,e);return new br.default(n,t)};var br=Cr(vr),Er=Cr({name:"CMMN",uri:"http://www.omg.org/spec/CMMN/20151109/MODEL",types:[{name:"ApplicabilityRule",superClass:["CMMNElement"],properties:[{name:"condition",type:"Expression",xml:{serialize:"property"}},{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Artifact",isAbstract:!0,superClass:["CMMNElement"]},{name:"Association",superClass:["Artifact"],properties:[{name:"associationDirection",type:"AssociationDirection",isAttr:!0},{name:"sourceRef",type:"CMMNElement",isAttr:!0,isReference:!0},{name:"targetRef",type:"CMMNElement",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"ManualActivationRule",superClass:["CMMNElement"],properties:[{name:"condition",type:"Expression",xml:{serialize:"property"}},{name:"name",isAttr:!0,type:"String"},{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"Case",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"caseFileModel",type:"CaseFile",xml:{serialize:"property"}},{name:"casePlanModel",type:"Stage",xml:{serialize:"property"}},{name:"caseRoles",type:"CaseRoles"},{name:"input",type:"CaseParameter",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"CaseParameter",isMany:!0,xml:{serialize:"property"}}]},{name:"CaseFile",superClass:["CMMNElement"],properties:[{name:"caseFileItems",type:"CaseFileItem",isMany:!0}]},{name:"CaseFileItem",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"multiplicity",type:"String",isAttr:!0,default:"Unspecified"},{name:"definitionRef",type:"CaseFileItemDefinition",isAttr:!0,isReference:!0},{name:"sourceRef",type:"CaseFileItem",isAttr:!0,isReference:!0},{name:"targetRefs",type:"CaseFileItem",isAttr:!0,isReference:!0,isMany:!0},{name:"children",type:"Children",xml:{serialize:"property"}}]},{name:"CaseFileItemDefinition",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"definitionType",type:"String",default:"http://www.omg.org/spec/CMMN/DefinitionType/Unspecified",isAttr:!0},{name:"properties",type:"Property",isMany:!0},{name:"structureRef",type:"String",isAttr:!0},{name:"importRef",type:"Import",isAttr:!0,isReference:!0}]},{name:"CaseFileItemOnPart",superClass:["OnPart"],properties:[{name:"standardEvent",type:"String"},{name:"sourceRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"CaseParameter",superClass:["Parameter"],properties:[{name:"bindingRef",type:"CaseFileItem",isAttr:!0,isReference:!0},{name:"bindingRefinement",type:"Expression",xml:{serialize:"property"}}]},{name:"CaseRoles",superClass:["Parameter"],properties:[{name:"role",type:"Role",isMany:!0}]},{name:"CaseTask",superClass:["Task"],properties:[{name:"parameterMapping",type:"ParameterMapping",isMany:!0},{name:"caseRefExpression",type:"Expression",xml:{serialize:"property"}},{name:"caseRef",type:"String",isAttr:!0}]},{name:"Children",superClass:["CMMNElement"],properties:[{name:"caseFileItems",type:"CaseFileItem",isMany:!0}]},{name:"CMMNElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionElements",type:"ExtensionElements"},{name:"extensionDefinitions",type:"ExtensionDefinition",isReference:!0,isMany:!0}]},{name:"Definitions",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",type:"String",isAttr:!0},{name:"expressionLanguage",type:"String",isAttr:!0,default:"http://www.w3.org/1999/XPath"},{name:"exporter",isAttr:!0,type:"String"},{name:"exporterVersion",isAttr:!0,type:"String"},{name:"author",isAttr:!0,type:"String"},{name:"creationDate",type:"DateTime",isAttr:!0},{name:"imports",type:"Import",isMany:!0},{name:"caseFileItemDefinitions",type:"CaseFileItemDefinition",isMany:!0},{name:"cases",type:"Case",isMany:!0},{name:"processes",type:"Process",isMany:!0},{name:"decisions",type:"Decision",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"relationships",type:"Relationship",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"CMMNDI",type:"cmmndi:CMMNDI"}]},{name:"DiscretionaryItem",superClass:["TableItem"],properties:[{name:"itemControl",type:"PlanItemControl",xml:{serialize:"property"}},{name:"definitionRef",type:"PlanItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"entryCriteria",type:"EntryCriterion",isMany:!0},{name:"exitCriteria",type:"ExitCriterion",isMany:!0}]},{name:"EventListener",superClass:["PlanItemDefinition"]},{name:"Expression",superClass:["CMMNElement"],properties:[{name:"language",type:"String",isAttr:!0},{name:"body",isBody:!0,type:"String"}]},{name:"HumanTask",superClass:["Task"],properties:[{name:"planningTable",type:"PlanningTable"},{name:"performerRef",type:"Role",isAttr:!0,isReference:!0}]},{name:"IfPart",superClass:["CMMNElement"],properties:[{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0},{name:"condition",type:"Expression",xml:{serialize:"property"}}]},{name:"Import",properties:[{name:"location",isAttr:!0,type:"String"},{name:"namespace",type:"String",isAttr:!0},{name:"importType",isAttr:!0,type:"String"}]},{name:"Milestone",superClass:["PlanItemDefinition"]},{name:"On",isAbstract:!0,superClass:["CMMNElement"]},{name:"OnPart",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"Parameter",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ParameterMapping",properties:[{name:"sourceRef",type:"Parameter",isAttr:!0,isReference:!0},{name:"targetRef",type:"Parameter",isAttr:!0,isReference:!0},{name:"transformation",type:"Expression",xml:{serialize:"property"}}]},{name:"PlanFragment",superClass:["PlanItemDefinition"],properties:[{name:"planItems",type:"PlanItem",isMany:!0},{name:"sentries",type:"Sentry",isMany:!0}]},{name:"PlanItem",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"definitionRef",type:"PlanItemDefinition",isAttr:!0,isReference:!0},{name:"itemControl",type:"PlanItemControl",xml:{serialize:"property"}},{name:"entryCriteria",type:"EntryCriterion",isMany:!0},{name:"exitCriteria",type:"ExitCriterion",isMany:!0}]},{name:"PlanItemControl",superClass:["CMMNElement"],properties:[{name:"repetitionRule",type:"RepetitionRule"},{name:"requiredRule",type:"RequiredRule"},{name:"manualActivationRule",type:"ManualActivationRule"}]},{name:"PlanItemDefinition",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"defaultControl",type:"PlanItemControl",xml:{serialize:"property"}}]},{name:"PlanItemOnPart",superClass:["OnPart"],properties:[{name:"standardEvent",type:"String"},{name:"sourceRef",type:"PlanItem",isAttr:!0,isReference:!0},{name:"exitCriterionRef",type:"ExitCriterion",isAttr:!0,isReference:!0}]},{name:"PlanningTable",superClass:["TableItem"],properties:[{name:"tableItems",type:"TableItem",isMany:!0},{name:"applicabilityRules",type:"ApplicabilityRule",isMany:!0}]},{name:"Process",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"implementationType",type:"String",isAttr:!0,default:"http://www.omg.org/spec/CMMN/ProcessType/Unspecified"},{name:"externalRef",type:"String",isAttr:!0},{name:"input",type:"ProcessParameter",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"ProcessParameter",isMany:!0,xml:{serialize:"property"}}]},{name:"ProcessParameter",superClass:["Parameter"]},{name:"ProcessTask",superClass:["Task"],properties:[{name:"parameterMapping",type:"ParameterMapping",isMany:!0},{name:"processRefExpression",type:"Expression",xml:{serialize:"property"}},{name:"processRef",type:"String",isAttr:!0}]},{name:"Property",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",type:"String",isAttr:!0,default:"http://www.omg.org/spec/CMMN/PropertyType/Unspecified"}]},{name:"RepetitionRule",superClass:["CMMNElement"],properties:[{name:"condition",type:"Expression",xml:{serialize:"property"}},{name:"name",isAttr:!0,type:"String"},{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"RequiredRule",superClass:["CMMNElement"],properties:[{name:"condition",type:"Expression",xml:{serialize:"property"}},{name:"name",isAttr:!0,type:"String"},{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"Role",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"Sentry",superClass:["CMMNElement"],properties:[{name:"onParts",type:"OnPart",isMany:!0},{name:"ifPart",type:"IfPart"},{name:"name",isAttr:!0,type:"String"}]},{name:"Stage",superClass:["PlanFragment"],properties:[{name:"planningTable",type:"PlanningTable"},{name:"planItemDefinitions",type:"PlanItemDefinition",isMany:!0},{name:"autoComplete",isAttr:!0,type:"Boolean"},{name:"exitCriteria",type:"ExitCriterion",isMany:!0}]},{name:"TableItem",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"authorizedRoleRefs",type:"Role",isAttr:!0,isReference:!0,isMany:!0},{name:"applicabilityRuleRefs",type:"ApplicabilityRule",isAttr:!0,isReference:!0,isMany:!0}]},{name:"Task",superClass:["PlanItemDefinition"],properties:[{name:"input",type:"CaseParameter",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"CaseParameter",isMany:!0,xml:{serialize:"property"}},{name:"isBlocking",isAttr:!0,default:!0,type:"Boolean"}]},{name:"TimerEventListener",superClass:["EventListener"],properties:[{name:"timerExpression",type:"Expression",xml:{serialize:"property"}},{name:"timerStart",type:"StartTrigger"}]},{name:"UserEventListener",superClass:["EventListener"],properties:[{name:"authorizedRoleRefs",type:"Role",isMany:!0,isAttr:!0}]},{name:"DateTime",superClass:[]},{name:"StartTrigger",isAbstract:!0,superClass:["CMMNElement"]},{name:"PlanItemStartTrigger",superClass:["StartTrigger"],properties:[{name:"standardEvent",type:"String",isAttr:!0},{name:"sourceRef",type:"PlanItem",isAttr:!0,isReference:!0}]},{name:"CaseFileItemStartTrigger",superClass:["StartTrigger"],properties:[{name:"standardEvent",type:"String",isAttr:!0},{name:"sourceRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition"}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",isAttr:!0,default:!1,type:"Boolean"}]},{name:"ExtensionElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Relationship",properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,type:"Element"},{name:"target",isMany:!0,type:"Element"}]},{name:"Documentation",superClass:["CMMNElement"],properties:[{name:"text",type:"String",isBody:!0},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"DecisionTask",superClass:["Task"],properties:[{name:"mappings",type:"ParameterMapping",isMany:!0},{name:"decisionRef",type:"String",isAttr:!0},{name:"decisionRefExpression",type:"Expression",xml:{serialize:"property"}}]},{name:"Decision",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"implementationType",type:"String",isAttr:!0,default:"http://www.omg.org/spec/CMMN/DecisionType/Unspecified"},{name:"input",type:"DecisionParameter",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"DecisionParameter",isMany:!0,xml:{serialize:"property"}},{name:"externalRef",type:"String",isAttr:!0}]},{name:"DecisionParameter",superClass:["Parameter"]},{name:"Criterion",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sentryRef",type:"Sentry",isAttr:!0,isReference:!0}]},{name:"EntryCriterion",superClass:["Criterion"]},{name:"ExitCriterion",superClass:["Criterion"]}],emumerations:[{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"CaseFileItemTransition",literalValues:[{name:"addChild"},{name:"addReference"},{name:"create"},{name:"delete"},{name:"removeChild"},{name:"removeReference"},{name:"replace"},{name:"update"}]},{name:"MultiplicityEnum",literalValues:[{name:"ZeroOrOne"},{name:"ZeroOrMore"},{name:"ExactlyOne"},{name:"OneOrMore"},{name:"Unspecified"},{name:"Unknown"}]},{name:"PlanItemTransition",literalValues:[{name:"close"},{name:"complete"},{name:"create"},{name:"disable"},{name:"enable"},{name:"exit"},{name:"fault"},{name:"manualStart"},{name:"occur"},{name:"parentResume"},{name:"parentSuspend"},{name:"reactivate"},{name:"reenable"},{name:"resume"},{name:"start"},{name:"suspend"},{name:"terminate"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]}],associations:[],xml:{tagAlias:"lowerCase",typePrefix:"t"},prefix:"cmmn"}),wr=Cr({name:"CMMNDI",uri:"http://www.omg.org/spec/CMMN/20151109/CMMNDI",types:[{name:"CMMNDI",properties:[{name:"diagrams",type:"CMMNDiagram",isMany:!0},{name:"styles",type:"CMMNStyle",isMany:!0}]},{name:"CMMNDiagram",properties:[{name:"cmmnElementRef",isAttr:!0,type:"cmmn:CMMNElement",isReference:!0},{name:"Size",type:"dc:Dimension",xml:{serialize:"xsi:type"}},{name:"diagramElements",type:"CMMNDiagramElement",isMany:!0}],superClass:["di:Diagram"]},{name:"CMMNDiagramElement",superClass:["di:DiagramElement"]},{name:"CMMNShape",properties:[{name:"cmmnElementRef",isAttr:!0,isReference:!0,type:"cmmn:CMMNElement"},{name:"label",type:"CMMNLabel"},{name:"isCollapsed",isAttr:!0,type:"Boolean"},{name:"isPlanningTableCollapsed",isAttr:!0,type:"Boolean"}],superClass:["CMMNDiagramElement","di:Shape"]},{name:"CMMNEdge",properties:[{name:"label",type:"CMMNLabel"},{name:"cmmnElementRef",isAttr:!0,isReference:!0,type:"cmmn:CMMNElement"},{name:"sourceCMMNElementRef",isAttr:!0,isReference:!0,type:"cmmn:CMMNElement"},{name:"targetCMMNElementRef",isAttr:!0,isReference:!0,type:"cmmn:CMMNElement"},{name:"isStandardEventVisible",type:"Boolean",isAttr:!0}],superClass:["CMMNDiagramElement","di:Edge"]},{name:"CMMNLabel",superClass:["di:Shape"]},{name:"CMMNStyle",properties:[{name:"FillColor",type:"dc:Color",xml:{serialize:"xsi:type"}},{name:"StrokeColor",type:"dc:Color",xml:{serialize:"xsi:type"}},{name:"FontColor",type:"dc:Color",xml:{serialize:"xsi:type"}},{name:"fontFamily",type:"String",isAttr:!0},{name:"fontSize",type:"Real",isAttr:!0},{name:"fontItalic",type:"Boolean",isAttr:!0},{name:"fontBold",type:"Boolean",isAttr:!0},{name:"fontUnderline",type:"Boolean",isAttr:!0},{name:"fontStrikeThrough",type:"Boolean",isAttr:!0}],superClass:["di:Style"]}],associations:[],prefix:"cmmndi"}),Mr=Cr({name:"DC",uri:"http://www.omg.org/spec/CMMN/20151109/DC",types:[{name:"rgb"},{name:"Real"},{name:"Color",properties:[{name:"red",type:"rgb",isAttr:!0},{name:"green",type:"rgb",isAttr:!0},{name:"blue",type:"rgb",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",isAttr:!0},{name:"y",type:"Real",isAttr:!0}]},{name:"Dimension",properties:[{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",isAttr:!0},{name:"y",type:"Real",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],prefix:"dc",associations:[]}),Sr=Cr({name:"DI",uri:"http://www.omg.org/spec/CMMN/20151109/DI",types:[{name:"DiagramElement",isAbstract:!0,properties:[{name:"extension",type:"Extension"},{name:"style",type:"Style"},{name:"sharedStyle",type:"Style",isReference:!0,isAttr:!0},{name:"id",type:"String",isAttr:!0,isId:!0}]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"waypoint",isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"name",type:"String",isAttr:!0},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,default:300,type:"double"}]},{name:"Shape",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"extension",type:"Extension"},{name:"id",type:"String",isAttr:!0,isId:!0}]},{name:"Extension",properties:[{name:"values",type:"Element",isMany:!0}]}],associations:[],prefix:"di",xml:{tagAlias:"lowerCase"}});function Cr(e){return e&&e.__esModule?e:{default:e}}var Pr={cmmn:Er.default,cmmndi:wr.default,dc:Mr.default,di:Sr.default},Rr={};Object.defineProperty(Rr,"__esModule",{value:!0}),Object.defineProperty(Rr,"default",{enumerable:!0,get:function(){return(e=xr,e&&e.__esModule?e:{default:e}).default;var e}});var Tr={};function kr(e,t,n){var i=!n||-1===e.indexOf(t);return i&&e.push(t),i}function Ar(e,t,n){n=n||0,(0,l.isArray)(e)||(e=[e]),(0,l.forEach)(e,function(e,i){var r=t(e,i,n);(0,l.isArray)(r)&&r.length&&Ar(r,t,n+1)})}function Or(e,t,n){var i=[],r=[];return Ar(e,function(e,o,a){kr(i,e,t);var s=e.children;if((-1===n||a<n)&&s&&kr(r,s,t))return s}),i}function jr(e,t){var n,i,r,o;return t=!!t,(0,l.isArray)(e)||(e=[e]),(0,l.forEach)(e,function(e){var a=e;e.waypoints&&!t&&(a=jr(e.waypoints,!0));var s=a.x,c=a.y,u=a.height||0,l=a.width||0;(s<n||void 0===n)&&(n=s),(c<i||void 0===i)&&(i=c),(s+l>r||void 0===r)&&(r=s+l),(c+u>o||void 0===o)&&(o=c+u)}),{x:n,y:i,height:o-i,width:r-n}}function Nr(e,t){return(0,l.assign)({},e||{},t||{})}Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.eachElement=Ar,Tr.selfAndAllChildren=function(e,t){return Or(e,!t,-1)},Tr.getClosure=function(e,t,n){(0,l.isUndefined)(t)&&(t=!0);(0,l.isObject)(t)&&(n=t,t=!0);var i=Nr((n=n||{}).allShapes),r=Nr(n.allConnections),o=Nr(n.enclosedElements),a=Nr(n.enclosedConnections),s=Nr(n.topLevel,t&&(0,l.groupBy)(e,function(e){return e.id}));function c(e){s[e.source.id]&&s[e.target.id]&&(s[e.id]=[e]),i[e.source.id]&&i[e.target.id]&&(a[e.id]=o[e.id]=e),r[e.id]=e}return Ar(e,function(e){if(o[e.id]=e,!e.waypoints)return i[e.id]=e,(0,l.forEach)(e.incoming,c),(0,l.forEach)(e.outgoing,c),e.children;a[e.id]=r[e.id]=e}),{allShapes:i,allConnections:r,topLevel:s,enclosedConnections:a,enclosedElements:o}},Tr.getBBox=jr,Tr.getEnclosedElements=function(e,t){var n={};return(0,l.forEach)(e,function(e){var i=e;i.waypoints&&(i=jr(i)),!(0,l.isNumber)(t.y)&&i.x>t.x&&(n[e.id]=e),!(0,l.isNumber)(t.x)&&i.y>t.y&&(n[e.id]=e),i.x>t.x&&i.y>t.y&&((0,l.isNumber)(t.width)&&(0,l.isNumber)(t.height)&&i.width+i.x<t.width+t.x&&i.height+i.y<t.height+t.y?n[e.id]=e:(0,l.isNumber)(t.width)&&(0,l.isNumber)(t.height)||(n[e.id]=e))}),n},Tr.getType=function(e){if("waypoints"in e)return"connection";if("x"in e)return"shape";return"root"};var Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});var Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function Br(e,t){return Math.round(e*t)/t}function Lr(e){return(0,l.isNumber)(e)?e+"px":e}function zr(e,t,n){var i=(0,we.create)("g");(0,we.classes)(i).add(t);var r=void 0!==n?n:e.childNodes.length-1;return e.insertBefore(i,e.childNodes[r]||null),i}Ir.default=$r;var Fr={shape:["x","y","width","height"],connection:["waypoints"]};function $r(e,t,n,i){this._eventBus=t,this._elementRegistry=i,this._graphicsFactory=n,this._init(e||{})}function Hr(e,t){var n="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",n)}$r.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],$r.prototype._init=function(e){var t=this._eventBus,n=this._container=function(e){var t=(e=(0,l.assign)({},{width:"100%",height:"100%"},e)).container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container"),(0,l.assign)(n.style,{position:"relative",overflow:"hidden",width:Lr(e.width),height:Lr(e.height)}),t.appendChild(n),n}(e),i=this._svg=(0,we.create)("svg");(0,we.attr)(i,{width:"100%",height:"100%"}),(0,we.append)(n,i);var r=this._viewport=zr(i,"viewport");this._layers={},!1!==e.deferUpdate&&(this._viewboxChanged=(0,l.debounce)((0,l.bind)(this._viewboxChanged,this),300)),t.on("diagram.init",function(){t.fire("canvas.init",{svg:i,viewport:r})},this),t.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed"],function(){delete this._cachedViewbox},this),t.on("diagram.destroy",500,this._destroy,this),t.on("diagram.clear",500,this._clear,this)},$r.prototype._destroy=function(e){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var t=this._container.parentNode;t&&t.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._rootElement,delete this._viewport},$r.prototype._clear=function(){var e=this;this._elementRegistry.getAll().forEach(function(t){var n=(0,Tr.getType)(t);"root"===n?e.setRootElement(null,!0):e._removeElement(t,n)}),delete this._cachedViewbox},$r.prototype.getDefaultLayer=function(){return this.getLayer("base",0)},$r.prototype.getLayer=function(e,t){if(!e)throw new Error("must specify a name");var n=this._layers[e];if(n||(n=this._layers[e]=this._createLayer(e,t)),void 0!==t&&n.index!==t)throw new Error("layer <"+e+"> already created at index <"+t+">");return n.group},$r.prototype._createLayer=function(e,t){t||(t=0);var n=(0,l.reduce)(this._layers,function(e,n){return t>=n.index&&e++,e},0);return{group:zr(this._viewport,"layer-"+e,n),index:t}},$r.prototype.getContainer=function(){return this._container},$r.prototype._updateMarker=function(e,t,n){var i;e.id||(e=this._elementRegistry.get(e)),(i=this._elementRegistry._elements[e.id])&&((0,l.forEach)([i.gfx,i.secondaryGfx],function(e){e&&(n?(0,we.classes)(e).add(t):(0,we.classes)(e).remove(t))}),this._eventBus.fire("element.marker.update",{element:e,gfx:i.gfx,marker:t,add:!!n}))},$r.prototype.addMarker=function(e,t){this._updateMarker(e,t,!0)},$r.prototype.removeMarker=function(e,t){this._updateMarker(e,t,!1)},$r.prototype.hasMarker=function(e,t){e.id||(e=this._elementRegistry.get(e));var n=this.getGraphics(e);return(0,we.classes)(n).has(t)},$r.prototype.toggleMarker=function(e,t){this.hasMarker(e,t)?this.removeMarker(e,t):this.addMarker(e,t)},$r.prototype.getRootElement=function(){return this._rootElement||this.setRootElement({id:"__implicitroot",children:[]}),this._rootElement},$r.prototype.setRootElement=function(e,t){e&&this._ensureValid("root",e);var n=this._rootElement,i=this._elementRegistry,r=this._eventBus;if(n){if(!t)throw new Error("rootElement already set, need to specify override");r.fire("root.remove",{element:n}),r.fire("root.removed",{element:n}),i.remove(n)}if(e){var o=this.getDefaultLayer();r.fire("root.add",{element:e}),i.add(e,o,this._svg),r.fire("root.added",{element:e,gfx:o})}return this._rootElement=e,e},$r.prototype._ensureValid=function(e,t){if(!t.id)throw new Error("element must have an id");if(this._elementRegistry.get(t.id))throw new Error("element with id "+t.id+" already exists");var n=Fr[e];if(!(0,l.every)(n,function(e){return void 0!==t[e]}))throw new Error("must supply { "+n.join(", ")+" } with "+e)},$r.prototype._setParent=function(e,t,n){(0,Cn.add)(t.children,e,n),e.parent=t},$r.prototype._addElement=function(e,t,n,i){n=n||this.getRootElement();var r=this._eventBus,o=this._graphicsFactory;this._ensureValid(e,t),r.fire(e+".add",{element:t,parent:n}),this._setParent(t,n,i);var a=o.create(e,t,i);return this._elementRegistry.add(t,a),o.update(e,t,a),r.fire(e+".added",{element:t,gfx:a}),t},$r.prototype.addShape=function(e,t,n){return this._addElement("shape",e,t,n)},$r.prototype.addConnection=function(e,t,n){return this._addElement("connection",e,t,n)},$r.prototype._removeElement=function(e,t){var n=this._elementRegistry,i=this._graphicsFactory,r=this._eventBus;if(e=n.get(e.id||e))return r.fire(t+".remove",{element:e}),i.remove(e),(0,Cn.remove)(e.parent&&e.parent.children,e),e.parent=null,r.fire(t+".removed",{element:e}),n.remove(e),e},$r.prototype.removeShape=function(e){return this._removeElement(e,"shape")},$r.prototype.removeConnection=function(e){return this._removeElement(e,"connection")},$r.prototype.getGraphics=function(e,t){return this._elementRegistry.getGraphics(e,t)},$r.prototype._changeViewbox=function(e){this._eventBus.fire("canvas.viewbox.changing"),e.apply(this),this._cachedViewbox=null,this._viewboxChanged()},$r.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},$r.prototype.viewbox=function(e){if(void 0===e&&this._cachedViewbox)return this._cachedViewbox;var t,n,i,r,o,a,s=this._viewport,c=this.getSize();return e?(this._changeViewbox(function(){r=Math.min(c.width/e.width,c.height/e.height);var t=this._svg.createSVGMatrix().scale(r).translate(-e.x,-e.y);(0,we.transform)(s,t)}),e):(t=this.getDefaultLayer().getBBox(),n=(i=(0,we.transform)(s))?i.matrix:(0,we.createMatrix)(),r=Br(n.a,1e3),o=Br(-n.e||0,1e3),a=Br(-n.f||0,1e3),e=this._cachedViewbox={x:o?o/r:0,y:a?a/r:0,width:c.width/r,height:c.height/r,scale:r,inner:{width:t.width,height:t.height,x:t.x,y:t.y},outer:c})},$r.prototype.scroll=function(e){var t=this._viewport,n=t.getCTM();return e&&this._changeViewbox(function(){e=(0,l.assign)({dx:0,dy:0},e||{}),n=this._svg.createSVGMatrix().translate(e.dx,e.dy).multiply(n),Hr(t,n)}),{x:n.e,y:n.f}},$r.prototype.zoom=function(e,t){return e?"fit-viewport"===e?this._fitViewport(t):(this._changeViewbox(function(){"object"!==(void 0===t?"undefined":Dr(t))&&(n=this.viewbox().outer,t={x:n.width/2,y:n.height/2}),i=this._setZoom(e,t)}),Br(i.a,1e3)):this.viewbox(e).scale;var n,i},$r.prototype._fitViewport=function(e){var t,n,i=this.viewbox(),r=i.outer,o=i.inner;return o.x>=0&&o.y>=0&&o.x+o.width<=r.width&&o.y+o.height<=r.height&&!e?n={x:0,y:0,width:Math.max(o.width+o.x,r.width),height:Math.max(o.height+o.y,r.height)}:(t=Math.min(1,r.width/o.width,r.height/o.height),n={x:o.x+(e?o.width/2-r.width/t/2:0),y:o.y+(e?o.height/2-r.height/t/2:0),width:r.width/t,height:r.height/t}),this.viewbox(n),this.viewbox(!1).scale},$r.prototype._setZoom=function(e,t){var n,i,r,o,a=this._svg,s=this._viewport,c=a.createSVGMatrix(),u=a.createSVGPoint(),d=(i=s.getCTM()).a;return t?(n=(0,l.assign)(u,t).matrixTransform(i.inverse()),r=c.translate(n.x,n.y).scale(1/d*e).translate(-n.x,-n.y),o=i.multiply(r)):o=c.scale(e),Hr(this._viewport,o),o},$r.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},$r.prototype.getAbsoluteBBox=function(e){var t,n=this.viewbox();e.waypoints?t=this.getGraphics(e).getBBox():t=e;return{x:t.x*n.scale-n.x*n.scale,y:t.y*n.scale-n.y*n.scale,width:t.width*n.scale,height:t.height*n.scale}},$r.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var Ur={};function Wr(){this._uid=12}Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.default=Wr,Wr.prototype.createRoot=function(e){return this.create("root",e)},Wr.prototype.createLabel=function(e){return this.create("label",e)},Wr.prototype.createShape=function(e){return this.create("shape",e)},Wr.prototype.createConnection=function(e){return this.create("connection",e)},Wr.prototype.create=function(e,t){return(t=(0,l.assign)({},t||{})).id||(t.id=e+"_"+this._uid++),(0,L.create)(e,t)};var Vr={};Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.default=Gr;var qr="data-element-id";function Gr(e){this._elements={},this._eventBus=e}Gr.$inject=["eventBus"],Gr.prototype.add=function(e,t,n){var i=e.id;this._validateId(i),(0,we.attr)(t,qr,i),n&&(0,we.attr)(n,qr,i),this._elements[i]={element:e,gfx:t,secondaryGfx:n}},Gr.prototype.remove=function(e){var t=this._elements,n=e.id||e,i=n&&t[n];i&&((0,we.attr)(i.gfx,qr,""),i.secondaryGfx&&(0,we.attr)(i.secondaryGfx,qr,""),delete t[n])},Gr.prototype.updateId=function(e,t){this._validateId(t),"string"==typeof e&&(e=this.get(e)),this._eventBus.fire("element.updateId",{element:e,newId:t});var n=this.getGraphics(e),i=this.getGraphics(e,!0);this.remove(e),e.id=t,this.add(e,n,i)},Gr.prototype.get=function(e){var t;t="string"==typeof e?e:e&&(0,we.attr)(e,qr);var n=this._elements[t];return n&&n.element},Gr.prototype.filter=function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(n)}),t},Gr.prototype.getAll=function(){return this.filter(function(e){return e})},Gr.prototype.forEach=function(e){var t=this._elements;Object.keys(t).forEach(function(n){var i=t[n],r=i.element,o=i.gfx;return e(r,o)})},Gr.prototype.getGraphics=function(e,t){var n=e.id||e,i=this._elements[n];return i&&(t?i.secondaryGfx:i.gfx)},Gr.prototype._validateId=function(e){if(!e)throw new Error("element must have an id");if(this._elements[e])throw new Error("element with id "+e+" already added")};var Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});var Yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Kr.default=Zr;var Xr=Array.prototype.slice;function Zr(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}function Qr(){}Zr.prototype.on=function(e,t,n,i){if(e=(0,l.isArray)(e)?e:[e],(0,l.isFunction)(t)&&(i=n,n=t,t=1e3),!(0,l.isNumber)(t))throw new Error("priority must be a number");var r=n;i&&((r=(0,l.bind)(n,i)).__fn=n.__fn||n);var o=this,a={priority:t,callback:r};e.forEach(function(e){o._addListener(e,a)})},Zr.prototype.once=function(e,t,n,i){var r=this;if((0,l.isFunction)(t)&&(i=n,n=t,t=1e3),!(0,l.isNumber)(t))throw new Error("priority must be a number");function o(){return r.off(e,o),n.apply(i,arguments)}o.__fn=n,this.on(e,t,o)},Zr.prototype.off=function(e,t){e=(0,l.isArray)(e)?e:[e];var n=this;e.forEach(function(e){n._removeListener(e,t)})},Zr.prototype.createEvent=function(e){var t=new Qr;return t.init(e),t},Zr.prototype.fire=function(e,t){var n,i,r,o;if(o=Xr.call(arguments),"object"===(void 0===e?"undefined":Yr(e))&&(e=(n=e).type),!e)throw new Error("no event type specified");if(i=this._listeners[e]){n=t instanceof Qr?t:this.createEvent(t),o[0]=n;var a=n.type;e!==a&&(n.type=e);try{r=this._invokeListeners(n,o,i)}finally{e!==a&&(n.type=a)}return void 0===r&&n.defaultPrevented&&(r=!1),r}},Zr.prototype.handleError=function(e){return!1===this.fire("error",{error:e})},Zr.prototype._destroy=function(){this._listeners={}},Zr.prototype._invokeListeners=function(e,t,n){var i,r,o;for(i=0;(r=n[i])&&!e.cancelBubble;i++)o=this._invokeListener(e,t,r);return o},Zr.prototype._invokeListener=function(e,t,n){var i;try{void 0!==(i=function(e,t){return e.apply(null,t)}(n.callback,t))&&(e.returnValue=i,e.stopPropagation()),!1===i&&e.preventDefault()}catch(e){if(!this.handleError(e))throw console.error("unhandled error in event listener"),console.error(e.stack),e}return i},Zr.prototype._addListener=function(e,t){var n,i,r=this._getListeners(e);for(i=0;n=r[i];i++)if(n.priority<t.priority)return void r.splice(i,0,t);r.push(t)},Zr.prototype._getListeners=function(e){var t=this._listeners[e];return t||(this._listeners[e]=t=[]),t},Zr.prototype._removeListener=function(e,t){var n,i,r,o=this._getListeners(e);if(t)for(r=o.length-1;n=o[r];r--)(i=n.callback)!==t&&i.__fn!==t||o.splice(r,1);else o.length=0},Qr.prototype.stopPropagation=function(){this.cancelBubble=!0},Qr.prototype.preventDefault=function(){this.defaultPrevented=!0},Qr.prototype.init=function(e){(0,l.assign)(this,e||{})};var Jr={};Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.getVisual=function(e){return(0,st.query)(".djs-visual",e)},Jr.getChildren=function(e){return e.parentNode.childNodes[1]};var eo={};function to(e,t){this._eventBus=e,this._elementRegistry=t}function no(e,t,n){t.insertBefore(e,n||t.firstChild)}Object.defineProperty(eo,"__esModule",{value:!0}),eo.default=to,to.$inject=["eventBus","elementRegistry"],to.prototype._getChildren=function(e){var t,n=this._elementRegistry.getGraphics(e);return e.parent?(t=(0,Jr.getChildren)(n))||(t=(0,we.create)("g"),(0,we.classes)(t).add("djs-children"),(0,we.append)(n.parentNode,t)):t=n,t},to.prototype._clear=function(e){var t=(0,Jr.getVisual)(e);return(0,st.clear)(t),t},to.prototype._createContainer=function(e,t,n){var i=(0,we.create)("g");(0,we.classes)(i).add("djs-group"),void 0!==n?no(i,t,t.childNodes[n]):(0,we.append)(t,i);var r=(0,we.create)("g");(0,we.classes)(r).add("djs-element"),(0,we.classes)(r).add("djs-"+e),(0,we.append)(i,r);var o=(0,we.create)("g");return(0,we.classes)(o).add("djs-visual"),(0,we.append)(r,o),r},to.prototype.create=function(e,t,n){var i=this._getChildren(t.parent);return this._createContainer(e,i,n)},to.prototype.updateContainments=function(e){var t,n=this,i=this._elementRegistry;t=(0,l.reduce)(e,function(e,t){return t.parent&&(e[t.parent.id]=t.parent),e},{}),(0,l.forEach)(t,function(e){var t=e.children;if(t){var r=n._getChildren(e);(0,l.forEach)(t.slice().reverse(),function(e){no(i.getGraphics(e).parentNode,r)})}})},to.prototype.drawShape=function(e,t){return this._eventBus.fire("render.shape",{gfx:e,element:t})},to.prototype.getShapePath=function(e){return this._eventBus.fire("render.getShapePath",e)},to.prototype.drawConnection=function(e,t){return this._eventBus.fire("render.connection",{gfx:e,element:t})},to.prototype.getConnectionPath=function(e){return this._eventBus.fire("render.getConnectionPath",e)},to.prototype.update=function(e,t,n){if(t.parent){var i=this._clear(n);if("shape"===e)this.drawShape(i,t),(0,Qe.translate)(n,t.x,t.y);else{if("connection"!==e)throw new Error("unknown type: "+e);this.drawConnection(i,t)}t.hidden?(0,we.attr)(n,"display","none"):(0,we.attr)(n,"display","block")}},to.prototype.remove=function(e){var t=this._elementRegistry.getGraphics(e);(0,we.remove)(t.parentNode)};var io={};Object.defineProperty(io,"__esModule",{value:!0}),io.default=co;var ro=ao(u),oo=ao(xe);function ao(e){return e&&e.__esModule?e:{default:e}}var so=1;function co(e,t){oo.default.call(this,e,so),this.CONNECTION_STYLE=t.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=t.style({fill:"white",stroke:"fuchsia",strokeWidth:2})}(0,ro.default)(co,oo.default),co.prototype.canRender=function(){return!0},co.prototype.drawShape=function(e,t){var n=(0,we.create)("rect");return(0,we.attr)(n,{x:0,y:0,width:t.width||0,height:t.height||0}),(0,we.attr)(n,this.SHAPE_STYLE),(0,we.append)(e,n),n},co.prototype.drawConnection=function(e,t){var n=(0,Xe.createLine)(t.waypoints,this.CONNECTION_STYLE);return(0,we.append)(e,n),n},co.prototype.getShapePath=function(e){var t=e.x,n=e.y,i=e.width,r=[["M",t,n],["l",i,0],["l",0,e.height],["l",-i,0],["z"]];return(0,Xe.componentsToPath)(r)},co.prototype.getConnectionPath=function(e){var t,n,i=e.waypoints,r=[];for(t=0;n=i[t];t++)n=n.original||n,r.push([0===t?"M":"L",n.x,n.y]);return(0,Xe.componentsToPath)(r)},co.$inject=["eventBus","styles"];var uo={};Object.defineProperty(uo,"__esModule",{value:!0}),uo.default=function(){var e={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},t=this;this.cls=function(e,t,n){var i=this.style(t,n);return(0,l.assign)(i,{class:e})},this.style=function(t,n){(0,l.isArray)(t)||n||(n=t,t=[]);var i=(0,l.reduce)(t,function(t,n){return(0,l.assign)(t,e[n]||{})},{});return n?(0,l.assign)(i,n):i},this.computeStyle=function(e,n,i){return(0,l.isArray)(n)||(i=n,n=[]),t.style(n||[],(0,l.assign)({},i,e||{}))}};var lo={};Object.defineProperty(lo,"__esModule",{value:!0});var po=ho(io),fo=ho(uo);function ho(e){return e&&e.__esModule?e:{default:e}}lo.default={__init__:["defaultRenderer"],defaultRenderer:["type",po.default],styles:["type",fo.default]};var mo={};Object.defineProperty(mo,"__esModule",{value:!0});var yo=Eo(lo),vo=Eo(Ir),go=Eo(Vr),_o=Eo(Ur),xo=Eo(Kr),bo=Eo(eo);function Eo(e){return e&&e.__esModule?e:{default:e}}mo.default={__depends__:[yo.default],__init__:["canvas"],canvas:["type",vo.default],elementRegistry:["type",go.default],elementFactory:["type",_o.default],eventBus:["type",xo.default],graphicsFactory:["type",bo.default]};var wo={},Mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(wo,"__esModule",{value:!0});var So=/^class /;function Co(e){return"[object Array]"===Object.prototype.toString.call(e)}function Po(){var e=Array.prototype.slice.call(arguments);1===e.length&&Co(e[0])&&(e=e[0]);var t=e.pop();return t.$inject=e,t}var Ro=/constructor\s*[^(]*\(\s*([^)]*)\)/m,To=/^function\s*[^(]*\(\s*([^)]*)\)/m,ko=/\/\*([^*]*)\*\//m;function Ao(e){if("function"!=typeof e)throw new Error('Cannot annotate "'+e+'". Expected a function!');var t=e.toString().match(function(e){return So.test(e.toString())}(e)?Ro:To);return t&&t[1]&&t[1].split(",").map(function(e){return(t=e.match(ko))?t[1].trim():e.trim()})||[]}function Oo(){var e=[];this.factory=function(t,n){return e.push([t,"factory",n]),this},this.value=function(t,n){return e.push([t,"value",n]),this},this.type=function(t,n){return e.push([t,"type",n]),this},this.forEach=function(t){e.forEach(t)}}var jo="function"==typeof Symbol&&"symbol"===Mo(Symbol.iterator)?function(e){return void 0===e?"undefined":Mo(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":Mo(e)};function No(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function Io(e,t){return Object.hasOwnProperty.call(e,t)}wo.Injector=function e(t,n){n=n||{get:function(e,t){if(i.push(e),!1===t)return null;throw s('No provider for "'+e+'"!')}};var i=[],r=this._providers=Object.create(n._providers||null),o=this._instances=Object.create(null),a=o.injector=this,s=function(e){var t=i.join(" -> ");return i.length=0,new Error(t?e+" (Resolving: "+t+")":e)},c=function e(t,a){if(!r[t]&&-1!==t.indexOf(".")){for(var c=t.split("."),u=e(c.shift());c.length;)u=u[c.shift()];return u}if(Io(o,t))return o[t];if(Io(r,t)){if(-1!==i.indexOf(t))throw i.push(t),s("Cannot resolve circular dependency!");return i.push(t),o[t]=r[t][0](r[t][1]),i.pop(),o[t]}return n.get(t,a)},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"!=typeof e){if(!Co(e))throw new Error('Cannot invoke "'+e+'". Expected a function!');e=Po(e.slice())}return{fn:e,dependencies:(e.$inject||Ao(e)).map(function(e){return Io(t,e)?t[e]:c(e)})}},l=function(e){var t=u(e),n=t.dependencies,i=t.fn;return new(Function.prototype.bind.apply(i,[null].concat(No(n))))},d=function(e,t,n){var i=u(e,n),r=i.dependencies,o=i.fn;return o.call.apply(o,[t].concat(No(r)))},p=function(e){return Po(function(t){return e.get(t)})},f={factory:d,type:l,value:function(e){return e}};t.forEach(function(t){function n(e,t){return"value"!==e&&Co(t)&&(t=Po(t.slice())),t}if(t instanceof Oo)t.forEach(function(e){var t=e[0],i=e[1],o=e[2];r[t]=[f[i],n(i,o),i]});else if("object"===(void 0===t?"undefined":jo(t)))if(t.__exports__){var i=Object.keys(t).reduce(function(e,n){return"__"!==n.substring(0,2)&&(e[n]=t[n]),e},Object.create(null)),o=new e((t.__modules__||[]).concat([i]),a),s=Po(function(e){return o.get(e)});t.__exports__.forEach(function(e){r[e]=[s,e,"private",o]})}else Object.keys(t).forEach(function(e){if("private"!==t[e][2]){var i=t[e][0],o=t[e][1];r[e]=[f[i],n(i,o),i]}else r[e]=t[e]})}),this.get=c,this.invoke=d,this.instantiate=l,this.createChild=function(t,n){if(n&&n.length){var i,o,s,c,u=Object.create(null),l=Object.create(null),d=[],f=[],h=[];for(var m in r)i=r[m],-1!==n.indexOf(m)&&("private"===i[2]?-1===(o=d.indexOf(i[3]))?(s=i[3].createChild([],n),c=p(s),d.push(i[3]),f.push(s),h.push(c),u[m]=[c,m,"private",s]):u[m]=[h[o],m,"private",f[o]]:u[m]=[i[2],i[1]],l[m]=!0),"factory"!==i[2]&&"type"!==i[2]||!i[1].$scope||n.forEach(function(e){-1!==i[1].$scope.indexOf(e)&&(u[m]=[i[2],i[1]],l[e]=!0)});n.forEach(function(e){if(!l[e])throw new Error('No provider for "'+e+'". Cannot use provider from the parent!')}),t.unshift(u)}return new e(t,a)}};var Do={};Object.defineProperty(Do,"__esModule",{value:!0}),Do.default=zo;var Bo=function(e){return e&&e.__esModule?e:{default:e}}(mo);function Lo(e){var t=[],n=[];function i(e){return t.indexOf(e)>=0}e.forEach(function e(r){i(r)||((r.__depends__||[]).forEach(e),i(r)||(function(e){t.push(e)}(r),(r.__init__||[]).forEach(function(e){n.push(e)})))});var r=new wo.Injector(t);return n.forEach(function(e){try{r["string"==typeof e?"get":"invoke"](e)}catch(e){throw console.error("Failed to instantiate component"),console.error(e.stack),e}}),r}function zo(e,t){this.injector=t=t||function(e){return Lo([{config:["value",e=e||{}]},Bo.default].concat(e.modules||[]))}(e),this.get=t.get,this.invoke=t.invoke,this.get("eventBus").fire("diagram.init")}zo.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},zo.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")};var Fo=Do,$o={};function Ho(e){this._counter=0,this._prefix=(e?e+"-":"")+Math.floor(1e9*Math.random())+"-"}Object.defineProperty($o,"__esModule",{value:!0}),$o.default=Ho,Ho.prototype.next=function(){return this._prefix+ ++this._counter};var Uo={};Object.defineProperty(Uo,"__esModule",{value:!0}),Uo.default=Vo;var Wo=new(function(e){return e&&e.__esModule?e:{default:e}}($o).default)("ov");function Vo(e,t,n,i){var r,o;this._eventBus=t,this._canvas=n,this._elementRegistry=i,this._ids=Wo,this._overlayDefaults=(0,l.assign)({show:null,scale:!0},e&&e.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=(r=n.getContainer(),o=(0,st.domify)('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />'),r.insertBefore(o,r.firstChild),o),this._init()}function qo(e,t,n){(0,l.assign)(e.style,{left:t+"px",top:n+"px"})}function Go(e,t){e.style.display=!1===t?"none":""}function Ko(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}Vo.$inject=["config.overlays","eventBus","canvas","elementRegistry"],Vo.prototype.get=function(e){if((0,l.isString)(e)&&(e={id:e}),(0,l.isString)(e.element)&&(e.element=this._elementRegistry.get(e.element)),e.element){var t=this._getOverlayContainer(e.element,!0);return t?e.type?(0,l.filter)(t.overlays,(0,l.matchPattern)({type:e.type})):t.overlays.slice():[]}return e.type?(0,l.filter)(this._overlays,(0,l.matchPattern)({type:e.type})):e.id?this._overlays[e.id]:null},Vo.prototype.add=function(e,t,n){if((0,l.isObject)(t)&&(n=t,t=null),e.id||(e=this._elementRegistry.get(e)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");if(!e)throw new Error("invalid element specified");var i=this._ids.next();return n=(0,l.assign)({},this._overlayDefaults,n,{id:i,type:t,element:e,html:n.html}),this._addOverlay(n),i},Vo.prototype.remove=function(e){var t=this.get(e)||[];(0,l.isArray)(t)||(t=[t]);var n=this;(0,l.forEach)(t,function(e){var t=n._getOverlayContainer(e.element,!0);if(e&&((0,st.remove)(e.html),(0,st.remove)(e.htmlContainer),delete e.htmlContainer,delete e.element,delete n._overlays[e.id]),t){var i=t.overlays.indexOf(e);-1!==i&&t.overlays.splice(i,1)}})},Vo.prototype.show=function(){Go(this._overlayRoot)},Vo.prototype.hide=function(){Go(this._overlayRoot,!1)},Vo.prototype.clear=function(){this._overlays={},this._overlayContainers=[],(0,st.clear)(this._overlayRoot)},Vo.prototype._updateOverlayContainer=function(e){var t=e.element,n=e.html,i=t.x,r=t.y;if(t.waypoints){var o=(0,Tr.getBBox)(t);i=o.x,r=o.y}qo(n,i,r),(0,st.attr)(e.html,"data-container-id",t.id)},Vo.prototype._updateOverlay=function(e){var t,n,i=e.position,r=e.htmlContainer,o=e.element,a=i.left,s=i.top;void 0!==i.right&&(t=o.waypoints?(0,Tr.getBBox)(o).width:o.width,a=-1*i.right+t);void 0!==i.bottom&&(n=o.waypoints?(0,Tr.getBBox)(o).height:o.height,s=-1*i.bottom+n);qo(r,a||0,s||0)},Vo.prototype._createOverlayContainer=function(e){var t=(0,st.domify)('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(t);var n={html:t,element:e,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n},Vo.prototype._updateRoot=function(e){var t=e.scale||1,n="matrix("+[t,0,0,t,-1*e.x*t,-1*e.y*t].join(",")+")";Ko(this._overlayRoot,n)},Vo.prototype._getOverlayContainer=function(e,t){var n=(0,l.find)(this._overlayContainers,function(t){return t.element===e});return n||t?n:this._createOverlayContainer(e)},Vo.prototype._addOverlay=function(e){var t,n,i=e.id,r=e.element,o=e.html;o.get&&o.constructor.prototype.jquery&&(o=o.get(0)),(0,l.isString)(o)&&(o=(0,st.domify)(o)),n=this._getOverlayContainer(r),(t=(0,st.domify)('<div class="djs-overlay" data-overlay-id="'+i+'" style="position: absolute">')).appendChild(o),e.type&&(0,st.classes)(t).add("djs-overlay-"+e.type),e.htmlContainer=t,n.overlays.push(e),n.html.appendChild(t),this._overlays[i]=e,this._updateOverlay(e),this._updateOverlayVisibilty(e,this._canvas.viewbox())},Vo.prototype._updateOverlayVisibilty=function(e,t){var n=e.show,i=n&&n.minZoom,r=n&&n.maxZoom,o=e.htmlContainer,a=!0;n&&(((0,l.isDefined)(i)&&i>t.scale||(0,l.isDefined)(r)&&r<t.scale)&&(a=!1),Go(o,a)),this._updateOverlayScale(e,t)},Vo.prototype._updateOverlayScale=function(e,t){var n,i,r,o=e.scale,a=e.htmlContainer,s="";!0!==o&&(!1===o?(n=1,i=1):(n=o.min,i=o.max),(0,l.isDefined)(n)&&t.scale<n&&(r=(1/t.scale||1)*n),(0,l.isDefined)(i)&&t.scale>i&&(r=(1/t.scale||1)*i)),(0,l.isDefined)(r)&&(s="scale("+r+","+r+")"),Ko(a,s)},Vo.prototype._updateOverlaysVisibilty=function(e){var t=this;(0,l.forEach)(this._overlays,function(n){t._updateOverlayVisibilty(n,e)})},Vo.prototype._init=function(){var e=this._eventBus,t=this;e.on("canvas.viewbox.changing",function(e){t.hide()}),e.on("canvas.viewbox.changed",function(e){var n;n=e.viewbox,t._updateRoot(n),t._updateOverlaysVisibilty(n),t.show()}),e.on(["shape.remove","connection.remove"],function(e){var n=e.element,i=t.get({element:n});(0,l.forEach)(i,function(e){t.remove(e.id)});var r=t._getOverlayContainer(n);if(r){(0,st.remove)(r.html);var o=t._overlayContainers.indexOf(r);-1!==o&&t._overlayContainers.splice(o,1)}}),e.on("element.changed",500,function(e){var n=e.element,i=t._getOverlayContainer(n,!0);i&&((0,l.forEach)(i.overlays,function(e){t._updateOverlay(e)}),t._updateOverlayContainer(i))}),e.on("element.marker.update",function(e){var n=t._getOverlayContainer(e.element,!0);n&&(0,st.classes)(n.html)[e.add?"add":"remove"](e.marker)}),e.on("diagram.clear",this.clear,this)};var Yo={};Object.defineProperty(Yo,"__esModule",{value:!0});var Xo=function(e){return e&&e.__esModule?e:{default:e}}(Uo);Yo.default={__init__:["overlays"],overlays:["type",Xo.default]};var Zo={};function Qo(e){e&&"function"==typeof e.stopPropagation&&e.stopPropagation()}function Jo(e){return e.originalEvent||e.srcEvent}Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.getOriginal=Jo,Zo.stopPropagation=function(e,t){Qo(e),Qo(Jo(e))},Zo.toPoint=function(e){e.pointers&&e.pointers.length&&(e=e.pointers[0]);e.touches&&e.touches.length&&(e=e.touches[0]);return e?{x:e.clientX,y:e.clientY}:null};var ea={};Object.defineProperty(ea,"__esModule",{value:!0}),ea.isMac=function(){return/mac/i.test(navigator.platform)};var ta={};function na(e){return!((0,Zo.getOriginal)(e)||e).button}Object.defineProperty(ta,"__esModule",{value:!0}),Object.defineProperty(ta,"isMac",{enumerable:!0,get:function(){return ea.isMac}}),ta.isPrimaryButton=na,ta.hasPrimaryModifier=function(e){var t=(0,Zo.getOriginal)(e)||e;if(!na(e))return!1;return(0,ea.isMac)()?t.metaKey:t.ctrlKey},ta.hasSecondaryModifier=function(e){var t=(0,Zo.getOriginal)(e)||e;return na(e)&&t.shiftKey};var ia={};function ra(e){return!0}Object.defineProperty(ia,"__esModule",{value:!0}),ia.default=aa;var oa=500;function aa(e,t,n){var i=n.cls("djs-hit",["no-fill","no-border"],{stroke:"white",strokeWidth:15});function r(n,i,r){var o,a;(function(e,t){return!(c[e]||ta.isPrimaryButton)(t)})(n,i)||(r?a=t.getGraphics(r):(o=i.delegateTarget||i.target)&&(a=o,r=t.get(a)),a&&r&&!1===e.fire(n,{element:r,gfx:a,originalEvent:i})&&(i.stopPropagation(),i.preventDefault()))}var o={};function a(e){return o[e]}var s={mouseover:"element.hover",mouseout:"element.out",click:"element.click",dblclick:"element.dblclick",mousedown:"element.mousedown",mouseup:"element.mouseup",contextmenu:"element.contextmenu"},c={"element.contextmenu":ra};var u="svg, .djs-element";function d(e,t,n,i){var a=o[n]=function(e){r(n,e)};i&&(c[n]=i),a.$delegate=st.delegate.bind(e,u,t,a)}function p(e,t,n){var i=a(n);i&&st.delegate.unbind(e,t,i.$delegate)}e.on("canvas.destroy",function(e){var t;t=e.svg,(0,l.forEach)(s,function(e,n){p(t,n,e)})}),e.on("canvas.init",function(e){var t;t=e.svg,(0,l.forEach)(s,function(e,n){d(t,n,e)})}),e.on(["shape.added","connection.added"],function(e){var t,n=e.element,r=e.gfx;n.waypoints?t=(0,Xe.createLine)(n.waypoints):(t=(0,we.create)("rect"),(0,we.attr)(t,{x:0,y:0,width:n.width,height:n.height})),(0,we.attr)(t,i),(0,we.append)(r,t)}),e.on("shape.changed",oa,function(e){var t=e.element,n=e.gfx,i=(0,st.query)(".djs-hit",n);(0,we.attr)(i,{width:t.width,height:t.height})}),e.on("connection.changed",function(e){var t=e.element,n=e.gfx,i=(0,st.query)(".djs-hit",n);(0,Xe.updateLine)(i,t.waypoints)}),this.fire=r,this.triggerMouseEvent=function(e,t,n){var i=s[e];if(!i)throw new Error("unmapped DOM event name <"+e+">");return r(i,t,n)},this.mouseHandler=a,this.registerEvent=d,this.unregisterEvent=p}aa.$inject=["eventBus","elementRegistry","styles"];var sa={};Object.defineProperty(sa,"__esModule",{value:!0});var ca=function(e){return e&&e.__esModule?e:{default:e}}(ia);sa.default={__init__:["interactionEvents"],interactionEvents:["type",ca.default]};var ua={};Object.defineProperty(ua,"__esModule",{value:!0}),ua.default=da;var la=500;function da(e,t,n){this.offset=6;var i=t.cls("djs-outline",["no-fill"]),r=this;function o(e,t){var n=(0,we.create)("rect");return(0,we.attr)(n,(0,l.assign)({x:10,y:10,width:100,height:100},i)),(0,we.append)(e,n),n}e.on(["shape.added","shape.changed"],la,function(e){var t=e.element,n=e.gfx,i=(0,st.query)(".djs-outline",n);i||(i=o(n)),r.updateShapeOutline(i,t)}),e.on(["connection.added","connection.changed"],function(e){var t=e.element,n=e.gfx,i=(0,st.query)(".djs-outline",n);i||(i=o(n)),r.updateConnectionOutline(i,t)})}da.prototype.updateShapeOutline=function(e,t){(0,we.attr)(e,{x:-this.offset,y:-this.offset,width:t.width+2*this.offset,height:t.height+2*this.offset})},da.prototype.updateConnectionOutline=function(e,t){var n=(0,Tr.getBBox)(t);(0,we.attr)(e,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+2*this.offset,height:n.height+2*this.offset})},da.$inject=["eventBus","styles","elementRegistry"];var pa={};Object.defineProperty(pa,"__esModule",{value:!0});var fa=function(e){return e&&e.__esModule?e:{default:e}}(ua);pa.default={__init__:["outline"],outline:["type",fa.default]};var ha={};function ma(e){this._eventBus=e,this._selectedElements=[];var t=this;e.on(["shape.remove","connection.remove"],function(e){var n=e.element;t.deselect(n)}),e.on(["diagram.clear"],function(e){t.select(null)})}Object.defineProperty(ha,"__esModule",{value:!0}),ha.default=ma,ma.$inject=["eventBus"],ma.prototype.deselect=function(e){var t=this._selectedElements,n=t.indexOf(e);if(-1!==n){var i=t.slice();t.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:t})}},ma.prototype.get=function(){return this._selectedElements},ma.prototype.isSelected=function(e){return-1!==this._selectedElements.indexOf(e)},ma.prototype.select=function(e,t){var n=this._selectedElements,i=n.slice();(0,l.isArray)(e)||(e=e?[e]:[]),t?(0,l.forEach)(e,function(e){-1===n.indexOf(e)&&n.push(e)}):this._selectedElements=n=e.slice(),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:n})};var ya={};function va(e,t,n,i){e.on("create.end",500,function(e){e.context.canExecute&&t.select(e.context.shape)}),e.on("connect.end",500,function(e){e.context.canExecute&&e.context.target&&t.select(e.context.target)}),e.on("shape.move.end",500,function(e){var n=e.previousSelection||[],r=i.get(e.context.shape.id);(0,l.find)(n,function(e){return r.id===e.id})||t.select(r)}),e.on("element.click",function(e){var i=e.element;i===n.getRootElement()&&(i=null);var r=t.isSelected(i),o=t.get().length>1,a=(0,ta.hasPrimaryModifier)(e);if(r&&o)return a?t.deselect(i):t.select(i);r?t.deselect(i):t.select(i,a)})}Object.defineProperty(ya,"__esModule",{value:!0}),ya.default=va,va.$inject=["eventBus","selection","canvas","elementRegistry"];var ga={};Object.defineProperty(ga,"__esModule",{value:!0}),ga.default=ba;var _a="hover",xa="selected";function ba(e,t,n,i){function r(e,n){t.addMarker(e,n)}function o(e,n){t.removeMarker(e,n)}this._multiSelectionBox=null,e.on("element.hover",function(e){r(e.element,_a)}),e.on("element.out",function(e){o(e.element,_a)}),e.on("selection.changed",function(e){var t=e.oldSelection,n=e.newSelection;(0,l.forEach)(t,function(e){-1===n.indexOf(e)&&o(e,xa)}),(0,l.forEach)(n,function(e){-1===t.indexOf(e)&&r(e,xa)})})}ba.$inject=["eventBus","canvas","selection","styles"];var Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});var wa=Ra(sa),Ma=Ra(pa),Sa=Ra(ha),Ca=Ra(ga),Pa=Ra(ya);function Ra(e){return e&&e.__esModule?e:{default:e}}Ea.default={__init__:["selectionVisuals","selectionBehavior"],__depends__:[wa.default,Ma.default],selection:["type",Sa.default],selectionVisuals:["type",Ca.default],selectionBehavior:["type",Pa.default]};var Ta=l.assign,ka=l.omit,Aa=l.isNumber,Oa=st.domify,ja=st.query,Na=st.remove,Ia=we.innerSVG,Da=Fo.default,Ba=Rr.default;var La={width:"100%",height:"100%",position:"relative"};function za(e){return e+(Aa(e)?"px":"")}function Fa(e){var t,n,i;e=Ta({},La,e),this._moddle=this._createModdle(e),this._container=this._createContainer(e),t=this._container,n=Nn.BPMNIO_IMG,i=Oa('<a href="http://bpmn.io" target="_blank" class="cjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100">'+n+"</a>"),t.appendChild(i),Ha.bind(i,"click",function(e){Nn.open(),e.preventDefault()}),this._init(this._container,this._moddle,e)}u(Fa,Da);var $a=Fa;Fa.prototype.importXML=function(e,t){t=t||function(){};var n=this;e=this._emit("import.parse.start",{xml:e})||e,this._moddle.fromXML(e,"cmmn:Definitions",function(e,i,r){i=n._emit("import.parse.complete",{error:e,definitions:i,context:r})||i;var o=r.warnings;if(e)return e=function(e){var t=/unparsable content <([^>]+)> detected([\s\S]*)$/.exec(e.message);return t&&(e.message="unparsable content <"+t[1]+"> detected; this may indicate an invalid CMMN 1.1 diagram file"+t[2]),e}(e),n._emit("import.done",{error:e,warnings:o}),t(e,o);n.importDefinitions(i,function(e,i){var r=[].concat(o,i||[]);n._emit("import.done",{error:e,warnings:r}),t(e,r)})})},Fa.prototype.saveXML=function(e,t){t||(t=e,e={});var n=this._definitions;if(!n)return t(new Error("no definitions loaded"));this._moddle.toXML(n,e,t)},Fa.prototype.saveSVG=function(e,t){t||(t=e,e={});var n=this.get("canvas"),i=n.getDefaultLayer(),r=ja("defs",n._svg),o=Ia(i),a=r&&r.outerHTML||"",s=i.getBBox();t(null,'<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- created with cmmn-js / http://bpmn.io --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+s.width+'" height="'+s.height+'" viewBox="'+s.x+" "+s.y+" "+s.width+" "+s.height+'" version="1.1">'+a+o+"</svg>")},Fa.prototype.importDefinitions=function(e,t){try{this._definitions&&this.clear(),this._definitions=e,jn.importCmmnDiagram(this,e,t)}catch(e){t(e)}},Fa.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach(),e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),"string"==typeof e&&(e=ja(e)),e.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()},Fa.prototype.getDefinitions=function(){return this._definitions},Fa.prototype.detach=function(){var e=this._container,t=e.parentNode;t&&(this._emit("detach",{}),t.removeChild(e))},Fa.prototype.getModules=function(){return this._modules},Fa.prototype.destroy=function(){Da.prototype.destroy.call(this),Na(this._container)},Fa.prototype.on=function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)},Fa.prototype.off=function(e,t){this.get("eventBus").off(e,t)},Fa.prototype._init=function(e,t,n){var i=n.modules||this.getModules(),r=n.additionalModules||[],o=[].concat([{cmmnjs:["value",this],moddle:["value",t]}],i,r),a=Ta(ka(n,"additionalModules"),{canvas:Ta({},n.canvas,{container:e}),modules:o});Da.call(this,a),n&&n.container&&this.attachTo(n.container)},Fa.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)},Fa.prototype._createContainer=function(e){var t=Oa('<div class="cjs-container"></div>');return Ta(t.style,{width:za(e.width),height:za(e.height),position:e.position}),t},Fa.prototype._createModdle=function(e){var t=Ta({},this._moddleExtensions,e.moddleExtensions);return new Ba(t)},Fa.prototype._modules=[Sn,Ea.default,Yo.default];var Ha=st.event;var Ua={};Object.defineProperty(Ua,"__esModule",{value:!0}),Ua.install=function(e,t){function n(){return!1}return t=t||"element.click",e.once(t,Wa,n),function(){e.off(t,n)}};var Wa=5e3;var Va={};Object.defineProperty(Va,"__esModule",{value:!0}),Va.set=Ga,Va.unset=function(){Ga(null)};var qa=/^djs-cursor-.*$/;function Ga(e){var t=(0,st.classes)(document.body);t.removeMatching(qa),e&&t.add("djs-cursor-"+e)}var Ka={};Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.center=function(e){return{x:e.x+e.width/2,y:e.y+e.height/2}},Ka.delta=function(e,t){return{x:e.x-t.x,y:e.y-t.y}};var Ya={};Object.defineProperty(Ya,"__esModule",{value:!0}),Ya.default=Za;var Xa=15;function Za(e,t){var n;function i(i){var r,o=n.start,a=(0,Zo.toPoint)(i),s=(0,Ka.delta)(a,o);if(!n.dragging&&(r=s,Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))>Xa)&&(n.dragging=!0,(0,Ua.install)(e),(0,Va.set)("grab")),n.dragging){var c=n.last||n.start;s=(0,Ka.delta)(a,c),t.scroll({dx:s.x,dy:s.y}),n.last=a}i.preventDefault()}function r(e){st.event.unbind(document,"mousemove",i),st.event.unbind(document,"mouseup",r),n=null,(0,Va.unset)()}e.on("element.mousedown",500,function(e){return function(e){if((0,st.closest)(e.target,".djs-draggable"))return;if(e.button||e.ctrlKey||e.shiftKey||e.altKey)return;return n={start:(0,Zo.toPoint)(e)},st.event.bind(document,"mousemove",i),st.event.bind(document,"mouseup",r),!0}(e.originalEvent)})}Za.$inject=["eventBus","canvas"];var Qa={};Object.defineProperty(Qa,"__esModule",{value:!0});var Ja=function(e){return e&&e.__esModule?e:{default:e}}(Ya);Qa.default={__init__:["moveCanvas"],moveCanvas:["type",Ja.default]};var es={};Object.defineProperty(es,"__esModule",{value:!0}),es.log10=function(e){return Math.log(e)/Math.log(10)},Object.defineProperty(es,"substract",{enumerable:!0,get:function(){return Ka.delta}});var ts={};Object.defineProperty(ts,"__esModule",{value:!0}),ts.getStepSize=function(e,t){var n=(0,es.log10)(e.min),i=(0,es.log10)(e.max);return(Math.abs(n)+Math.abs(i))/t},ts.cap=function(e,t){return Math.max(e.min,Math.min(e.max,t))};var ns={};Object.defineProperty(ns,"__esModule",{value:!0}),ns.default=as;var is=Math.sign||function(e){return e>=0?1:-1},rs={min:.2,max:4},os=.75;function as(e,t,n){e=e||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=(0,l.bind)(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||os;var i=this;t.on("canvas.init",function(t){i._init(!1!==e.enabled)})}as.$inject=["config.zoomScroll","eventBus","canvas"],as.prototype.scroll=function(e){this._canvas.scroll(e)},as.prototype.reset=function(){this._canvas.zoom("fit-viewport")},as.prototype.zoom=function(e,t){var n=(0,ts.getStepSize)(rs,20);this._totalDelta+=e,Math.abs(this._totalDelta)>.1&&(this._zoom(e,t,n),this._totalDelta=0)},as.prototype._handleWheel=function(e){if(!(0,st.closest)(e.target,".djs-scrollable",!0)){var t=this._container;e.preventDefault();var n,i=e.ctrlKey,r=e.shiftKey,o=-1*this._scale;if(o*=i?0===e.deltaMode?.02:.32:0===e.deltaMode?1:16,i){var a=t.getBoundingClientRect(),s={x:e.clientX-a.left,y:e.clientY-a.top};n=Math.sqrt(Math.pow(e.deltaY,2)+Math.pow(e.deltaX,2))*is(e.deltaY)*o,this.zoom(n,s)}else n=r?{dx:o*e.deltaY,dy:0}:{dx:o*e.deltaX,dy:o*e.deltaY},this.scroll(n)}},as.prototype.stepZoom=function(e,t){var n=(0,ts.getStepSize)(rs,10);this._zoom(e,t,n)},as.prototype._zoom=function(e,t,n){var i=this._canvas,r=e>0?1:-1,o=(0,es.log10)(i.zoom()),a=Math.round(o/n)*n;a+=n*r;var s=Math.pow(10,a);i.zoom((0,ts.cap)(rs,s),t)},as.prototype.toggle=function(e){var t=this._container,n=this._handleWheel,i=this._enabled;return void 0===e&&(e=!i),i!==e&&st.event[e?"bind":"unbind"](t,"wheel",n,!1),this._enabled=e,e},as.prototype._init=function(e){this.toggle(e)};var ss={};Object.defineProperty(ss,"__esModule",{value:!0});var cs=function(e){return e&&e.__esModule?e:{default:e}}(ns);function us(e){$a.call(this,e)}ss.default={__init__:["zoomScroll"],zoomScroll:["type",cs.default]},u(us,$a);var ls=us;us.prototype._navigationModules=[ss.default,Qa.default],us.prototype._modules=[].concat(us.prototype._modules,us.prototype._navigationModules);var ds={};Object.defineProperty(ds,"__esModule",{value:!0}),ds.default=ps;function ps(e){this._eventBus=e}ps.$inject=["eventBus"],ps.prototype.on=function(e,t,n,i,r,o){if(((0,l.isFunction)(t)||(0,l.isNumber)(t))&&(o=r,r=i,i=n,n=t,t=null),(0,l.isFunction)(n)&&(o=r,r=i,i=n,n=1e3),(0,l.isObject)(r)&&(o=r,r=!1),!(0,l.isFunction)(i))throw new Error("handlerFn must be a function");(0,l.isArray)(e)||(e=[e]);var a=this._eventBus;(0,l.forEach)(e,function(e){var s=["commandStack",e,t].filter(function(e){return e}).join(".");a.on(s,n,r?function(e,t){return function(n){return e.call(t||null,n.context,n.command,n)}}(i,o):i,o)})};(0,l.forEach)(["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"],function(e){ps.prototype[e]=function(t,n,i,r,o){((0,l.isFunction)(t)||(0,l.isNumber)(t))&&(o=r,r=i,i=n,n=t,t=null),this.on(t,e,n,i,r,o)}});var fs={};Object.defineProperty(fs,"__esModule",{value:!0}),fs.default=vs;var hs=ys(u),ms=ys(ds);function ys(e){return e&&e.__esModule?e:{default:e}}function vs(e){ms.default.call(this,e),this.init()}vs.$inject=["eventBus"],(0,hs.default)(vs,ms.default),vs.prototype.addRule=function(e,t,n){var i=this;"string"==typeof e&&(e=[e]),e.forEach(function(e){i.canExecute(e,t,function(e,t,i){return n(e)},!0)})},vs.prototype.init=function(){};var gs={};Object.defineProperty(gs,"__esModule",{value:!0}),gs.default=Es;var _s=bs(fs),xs=bs(u);function bs(e){return e&&e.__esModule?e:{default:e}}function Es(e){_s.default.call(this,e);var t=this;this.addRule("element.autoResize",function(e){return t.canResize(e.elements,e.target)})}Es.$inject=["eventBus"],(0,xs.default)(Es,_s.default),Es.prototype.canResize=function(e,t){return!1};var ws=e.is,Ms=e.getDefinition,Ss=l.forEach,Cs=gs.default;function Ps(e){Cs.call(this,e)}u(Ps,Cs),Ps.$inject=["eventBus"];var Rs=Ps;Ps.prototype.canResize=function(e,t){if(ws(t,"cmmn:CMMNElement")){var n=!0;if(Ss(e,function(e){ws(e,"cmmn:Criterion")||(n=!1)}),!n){var i=Ms(t);return ws(i,"cmmn:PlanFragment")}}};var Ts={};function ks(e,t){return e&&t?Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)):-1}Object.defineProperty(Ts,"__esModule",{value:!0}),Ts.pointDistance=ks,Ts.pointsOnLine=function(e,t,n,i){void 0===i&&(i=5);if(!e||!t||!n)return!1;var r=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),o=ks(e,t);return Math.abs(r/o)<=i},Ts.pointsAligned=function(e,t){if(Math.abs(e.x-t.x)<=As)return"h";if(Math.abs(e.y-t.y)<=As)return"v";return!1},Ts.pointInRect=function(e,t,n){return n=n||0,e.x>t.x-n&&e.y>t.y-n&&e.x<t.x+t.width+n&&e.y<t.y+t.height+n},Ts.getMidPoint=function(e,t){return{x:Math.round(e.x+(t.x-e.x)/2),y:Math.round(e.y+(t.y-e.y)/2)}};var As=2;var Os="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},js="hasOwnProperty",Ns=/,?([a-z]),?/gi,Is=parseFloat,Ds=Math,Bs=Ds.PI,Ls=Ds.min,zs=Ds.max,Fs=Ds.pow,$s=Ds.abs,Hs=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,Us=/(-?\d*\.?\d*(?:e[-+]?\\d+)?)[\s]*,?[\s]*/gi;function Ws(e,t){return"finite"==(t=String.prototype.toLowerCase.call(t))?isFinite(e):!("array"!=t||!(e instanceof Array||Array.isArray&&Array.isArray(e)))||("null"==t&&null===e||t==(void 0===e?"undefined":Os(e))&&null!==e||"object"==t&&e===Object(e)||Object.prototype.toString.call(e).slice(8,-1).toLowerCase()==t)}function Vs(e){if("function"==typeof e||Object(e)!==e)return e;var t=new e.constructor;for(var n in e)e[js](n)&&(t[n]=Vs(e[n]));return t}function qs(e){var t=qs.ps=qs.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var n in t)t[js](n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])}),t[e]}function Gs(e,t,n,i){return null==e&&(e=t=n=i=0),null==t&&(t=e.y,n=e.width,i=e.height,e=e.x),{x:e,y:t,width:n,w:n,height:i,h:i,x2:e+n,y2:t+i,cx:e+n/2,cy:t+i/2,r1:Ds.min(n,i)/2,r2:Ds.max(n,i)/2,r0:Ds.sqrt(n*n+i*i)/2,path:function(e,t,n,i,r){if(r)return[["M",+e+ +r,t],["l",n-2*r,0],["a",r,r,0,0,1,r,r],["l",0,i-2*r],["a",r,r,0,0,1,-r,r],["l",2*r-n,0],["a",r,r,0,0,1,-r,-r],["l",0,2*r-i],["a",r,r,0,0,1,r,-r],["z"]];var o=[["M",e,t],["l",n,0],["l",0,i],["l",-n,0],["z"]];return o.toString=Ks,o}(e,t,n,i),vb:[e,t,n,i].join(" ")}}function Ks(){return this.join(",").replace(Ns,"$1")}function Ys(e){var t=Vs(e);return t.toString=Ks,t}function Xs(e,t,n,i,r,o,a,s,c){var u=1-c,l=Fs(u,3),d=Fs(u,2),p=c*c,f=p*c,h=e+2*c*(n-e)+p*(r-2*n+e),m=t+2*c*(i-t)+p*(o-2*i+t),y=n+2*c*(r-n)+p*(a-2*r+n),v=i+2*c*(o-i)+p*(s-2*o+i);return{x:l*e+3*d*c*n+3*u*c*c*r+f*a,y:l*t+3*d*c*i+3*u*c*c*o+f*s,m:{x:h,y:m},n:{x:y,y:v},start:{x:u*e+c*n,y:u*t+c*i},end:{x:u*r+c*a,y:u*o+c*s},alpha:90-180*Ds.atan2(h-y,m-v)/Bs}}function Zs(e,t,n,i,r,o,a,s){Ws(e,"array")||(e=[e,t,n,i,r,o,a,s]);var c=function(e,t,n,i,r,o,a,s){for(var c,u,l,d,p,f,h,m,y=[],v=[[],[]],g=0;g<2;++g)if(0==g?(u=6*e-12*n+6*r,c=-3*e+9*n-9*r+3*a,l=3*n-3*e):(u=6*t-12*i+6*o,c=-3*t+9*i-9*o+3*s,l=3*i-3*t),$s(c)<1e-12){if($s(u)<1e-12)continue;0<(d=-l/u)&&d<1&&y.push(d)}else h=u*u-4*l*c,m=Ds.sqrt(h),h<0||(0<(p=(-u+m)/(2*c))&&p<1&&y.push(p),0<(f=(-u-m)/(2*c))&&f<1&&y.push(f));var _,x=y.length,b=x;for(;x--;)d=y[x],_=1-d,v[0][x]=_*_*_*e+3*_*_*d*n+3*_*d*d*r+d*d*d*a,v[1][x]=_*_*_*t+3*_*_*d*i+3*_*d*d*o+d*d*d*s;return v[0][b]=e,v[1][b]=t,v[0][b+1]=a,v[1][b+1]=s,v[0].length=v[1].length=b+2,{min:{x:Ls.apply(0,v[0]),y:Ls.apply(0,v[1])},max:{x:zs.apply(0,v[0]),y:zs.apply(0,v[1])}}}.apply(null,e);return Gs(c.min.x,c.min.y,c.max.x-c.min.x,c.max.y-c.min.y)}function Qs(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Js(e,t,n,i,r){return e*(e*(-3*t+9*n-9*i+3*r)+6*t-12*n+6*i)-3*t+3*n}function ec(e,t,n,i,r,o,a,s,c){null==c&&(c=1);for(var u=(c=c>1?1:c<0?0:c)/2,l=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],d=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0,f=0;f<12;f++){var h=u*l[f]+u,m=Js(h,e,n,r,a),y=Js(h,t,i,o,s),v=m*m+y*y;p+=d[f]*Ds.sqrt(v)}return u*p}function tc(e,t,n,i,r,o,a,s){if(!(zs(e,n)<Ls(r,a)||Ls(e,n)>zs(r,a)||zs(t,i)<Ls(o,s)||Ls(t,i)>zs(o,s))){var c=(e-n)*(o-s)-(t-i)*(r-a);if(c){var u=((e*i-t*n)*(r-a)-(e-n)*(r*s-o*a))/c,l=((e*i-t*n)*(o-s)-(t-i)*(r*s-o*a))/c,d=+u.toFixed(2),p=+l.toFixed(2);if(!(d<+Ls(e,n).toFixed(2)||d>+zs(e,n).toFixed(2)||d<+Ls(r,a).toFixed(2)||d>+zs(r,a).toFixed(2)||p<+Ls(t,i).toFixed(2)||p>+zs(t,i).toFixed(2)||p<+Ls(o,s).toFixed(2)||p>+zs(o,s).toFixed(2)))return{x:u,y:l}}}}function nc(e,t,n){if(!function(e,t){return e=Gs(e),Qs(t=Gs(t),e.x,e.y)||Qs(t,e.x2,e.y)||Qs(t,e.x,e.y2)||Qs(t,e.x2,e.y2)||Qs(e,t.x,t.y)||Qs(e,t.x2,t.y)||Qs(e,t.x,t.y2)||Qs(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)}(Zs(e),Zs(t)))return n?0:[];for(var i=~~(ec.apply(0,e)/5),r=~~(ec.apply(0,t)/5),o=[],a=[],s={},c=n?0:[],u=0;u<i+1;u++){var l=Xs.apply(0,e.concat(u/i));o.push({x:l.x,y:l.y,t:u/i})}for(u=0;u<r+1;u++)l=Xs.apply(0,t.concat(u/r)),a.push({x:l.x,y:l.y,t:u/r});for(u=0;u<i;u++)for(var d=0;d<r;d++){var p=o[u],f=o[u+1],h=a[d],m=a[d+1],y=$s(f.x-p.x)<.01?"y":"x",v=$s(m.x-h.x)<.01?"y":"x",g=tc(p.x,p.y,f.x,f.y,h.x,h.y,m.x,m.y);if(g){if(s[g.x.toFixed(0)]==g.y.toFixed(0))continue;s[g.x.toFixed(0)]=g.y.toFixed(0);var _=p.t+$s((g[y]-p[y])/(f[y]-p[y]))*(f.t-p.t),x=h.t+$s((g[v]-h[v])/(m[v]-h[v]))*(m.t-h.t);_>=0&&_<=1&&x>=0&&x<=1&&(n?c++:c.push({x:g.x,y:g.y,t1:_,t2:x}))}}return c}function ic(e,t,n,i,r){if(null==r&&null==i&&(i=n),e=+e,t=+t,n=+n,i=+i,null!=r)var o=Math.PI/180,a=e+n*Math.cos(-i*o),s=e+n*Math.cos(-r*o),c=[["M",a,t+n*Math.sin(-i*o)],["A",n,n,0,+(r-i>180),0,s,t+n*Math.sin(-r*o)]];else c=[["M",e,t],["m",0,-i],["a",n,i,0,1,1,0,2*i],["a",n,i,0,1,1,0,-2*i],["z"]];return c.toString=Ks,c}function rc(e){var t=qs(e);if(t.abs)return Ys(t.abs);if(Ws(e,"array")&&Ws(e&&e[0],"array")||(e=function(e){if(!e)return null;var t=qs(e);if(t.arr)return Vs(t.arr);var n={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},i=[];return Ws(e,"array")&&Ws(e[0],"array")&&(i=Vs(e)),i.length||String(e).replace(Hs,function(e,t,r){var o=[],a=t.toLowerCase();if(r.replace(Us,function(e,t){t&&o.push(+t)}),"m"==a&&o.length>2&&(i.push([t].concat(o.splice(0,2))),a="l",t="m"==t?"l":"L"),"o"==a&&1==o.length&&i.push([t,o[0]]),"r"==a)i.push([t].concat(o));else for(;o.length>=n[a]&&(i.push([t].concat(o.splice(0,n[a]))),n[a]););}),i.toString=qs.toString,t.arr=Vs(i),i}(e)),!e||!e.length)return[["M",0,0]];var n,i=[],r=0,o=0,a=0,s=0,c=0;"M"==e[0][0]&&(a=r=+e[0][1],s=o=+e[0][2],c++,i[0]=["M",r,o]);for(var u,l,d=3==e.length&&"M"==e[0][0]&&"R"==e[1][0].toUpperCase()&&"Z"==e[2][0].toUpperCase(),p=c,f=e.length;p<f;p++){if(i.push(u=[]),(n=(l=e[p])[0])!=n.toUpperCase())switch(u[0]=n.toUpperCase(),u[0]){case"A":u[1]=l[1],u[2]=l[2],u[3]=l[3],u[4]=l[4],u[5]=l[5],u[6]=+l[6]+r,u[7]=+l[7]+o;break;case"V":u[1]=+l[1]+o;break;case"H":u[1]=+l[1]+r;break;case"R":for(var h=[r,o].concat(l.slice(1)),m=2,y=h.length;m<y;m++)h[m]=+h[m]+r,h[++m]=+h[m]+o;i.pop(),i=i.concat(cc(h,d));break;case"O":i.pop(),(h=ic(r,o,l[1],l[2])).push(h[0]),i=i.concat(h);break;case"U":i.pop(),i=i.concat(ic(r,o,l[1],l[2],l[3])),u=["U"].concat(i[i.length-1].slice(-2));break;case"M":a=+l[1]+r,s=+l[2]+o;default:for(m=1,y=l.length;m<y;m++)u[m]=+l[m]+(m%2?r:o)}else if("R"==n)h=[r,o].concat(l.slice(1)),i.pop(),i=i.concat(cc(h,d)),u=["R"].concat(l.slice(-2));else if("O"==n)i.pop(),(h=ic(r,o,l[1],l[2])).push(h[0]),i=i.concat(h);else if("U"==n)i.pop(),i=i.concat(ic(r,o,l[1],l[2],l[3])),u=["U"].concat(i[i.length-1].slice(-2));else for(var v=0,g=l.length;v<g;v++)u[v]=l[v];if("O"!=(n=n.toUpperCase()))switch(u[0]){case"Z":r=+a,o=+s;break;case"H":r=u[1];break;case"V":o=u[1];break;case"M":a=u[u.length-2],s=u[u.length-1];default:r=u[u.length-2],o=u[u.length-1]}}return i.toString=Ks,t.abs=Ys(i),i}function oc(e,t,n,i){return[e,t,n,i,n,i]}function ac(e,t,n,i,r,o){return[1/3*e+2/3*n,1/3*t+2/3*i,1/3*r+2/3*n,1/3*o+2/3*i,r,o]}function sc(e,t,n,i,r,o,a,s,c,u){var l,d,p,f,h=120*Bs/180,m=Bs/180*(+r||0),y=[],v=(d=function(e,t,n){return{x:e*Ds.cos(n)-t*Ds.sin(n),y:e*Ds.sin(n)+t*Ds.cos(n)}},function e(){var t=Array.prototype.slice.call(arguments,0),n=t.join("␀"),i=e.cache=e.cache||{},r=e.count=e.count||[];return i[js](n)?(function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}(r,n),f?f(i[n]):i[n]):(r.length>=1e3&&delete i[r.shift()],r.push(n),i[n]=d.apply(p,t),f?f(i[n]):i[n])});if(u)C=u[0],P=u[1],M=u[2],S=u[3];else{e=(l=v(e,t,-m)).x,t=l.y;var g=(e-(s=(l=v(s,c,-m)).x))/2,_=(t-(c=l.y))/2,x=g*g/(n*n)+_*_/(i*i);x>1&&(n*=x=Ds.sqrt(x),i*=x);var b=n*n,E=i*i,w=(o==a?-1:1)*Ds.sqrt($s((b*E-b*_*_-E*g*g)/(b*_*_+E*g*g))),M=w*n*_/i+(e+s)/2,S=w*-i*g/n+(t+c)/2,C=Ds.asin(((t-S)/i).toFixed(9)),P=Ds.asin(((c-S)/i).toFixed(9));(C=e<M?Bs-C:C)<0&&(C=2*Bs+C),(P=s<M?Bs-P:P)<0&&(P=2*Bs+P),a&&C>P&&(C-=2*Bs),!a&&P>C&&(P-=2*Bs)}var R=P-C;if($s(R)>h){var T=P,k=s,A=c;P=C+h*(a&&P>C?1:-1),y=sc(s=M+n*Ds.cos(P),c=S+i*Ds.sin(P),n,i,r,0,a,k,A,[P,T,M,S])}R=P-C;var O=Ds.cos(C),j=Ds.sin(C),N=Ds.cos(P),I=Ds.sin(P),D=Ds.tan(R/4),B=4/3*n*D,L=4/3*i*D,z=[e,t],F=[e+B*j,t-L*O],$=[s+B*I,c-L*N],H=[s,c];if(F[0]=2*z[0]-F[0],F[1]=2*z[1]-F[1],u)return[F,$,H].concat(y);for(var U=[],W=0,V=(y=[F,$,H].concat(y).join().split(",")).length;W<V;W++)U[W]=W%2?v(y[W-1],y[W],m).y:v(y[W],y[W+1],m).x;return U}function cc(e,t){for(var n=[],i=0,r=e.length;r-2*!t>i;i+=2){var o=[{x:+e[i-2],y:+e[i-1]},{x:+e[i],y:+e[i+1]},{x:+e[i+2],y:+e[i+3]},{x:+e[i+4],y:+e[i+5]}];t?i?r-4==i?o[3]={x:+e[0],y:+e[1]}:r-2==i&&(o[2]={x:+e[0],y:+e[1]},o[3]={x:+e[2],y:+e[3]}):o[0]={x:+e[r-2],y:+e[r-1]}:r-4==i?o[3]=o[2]:i||(o[0]={x:+e[i],y:+e[i+1]}),n.push(["C",(-o[0].x+6*o[1].x+o[2].x)/6,(-o[0].y+6*o[1].y+o[2].y)/6,(o[1].x+6*o[2].x-o[3].x)/6,(o[1].y+6*o[2].y-o[3].y)/6,o[2].x,o[2].y])}return n}function uc(e,t){var n=!t&&qs(e);if(!t&&n.curve)return Ys(n.curve);for(var i=rc(e),r=t&&rc(t),o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s=function(e,t,n){var i,r;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(sc.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":"C"==n||"S"==n?(i=2*t.x-t.bx,r=2*t.y-t.by):(i=t.x,r=t.y),e=["C",i,r].concat(e.slice(1));break;case"T":"Q"==n||"T"==n?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(ac(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(ac(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(oc(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(oc(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(oc(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(oc(t.x,t.y,t.X,t.Y))}return e},c=function(e,t){if(e[t].length>7){e[t].shift();for(var n=e[t];n.length;)l[t]="A",r&&(d[t]="A"),e.splice(t++,0,["C"].concat(n.splice(0,6)));e.splice(t,1),m=zs(i.length,r&&r.length||0)}},u=function(e,t,n,o,a){e&&t&&"M"==e[a][0]&&"M"!=t[a][0]&&(t.splice(a,0,["M",o.x,o.y]),n.bx=0,n.by=0,n.x=e[a][1],n.y=e[a][2],m=zs(i.length,r&&r.length||0))},l=[],d=[],p="",f="",h=0,m=zs(i.length,r&&r.length||0);h<m;h++){i[h]&&(p=i[h][0]),"C"!=p&&(l[h]=p,h&&(f=l[h-1])),i[h]=s(i[h],o,f),"A"!=l[h]&&"C"==p&&(l[h]="C"),c(i,h),r&&(r[h]&&(p=r[h][0]),"C"!=p&&(d[h]=p,h&&(f=d[h-1])),r[h]=s(r[h],a,f),"A"!=d[h]&&"C"==p&&(d[h]="C"),c(r,h)),u(i,r,o,a,h),u(r,i,a,o,h);var y=i[h],v=r&&r[h],g=y.length,_=r&&v.length;o.x=y[g-2],o.y=y[g-1],o.bx=Is(y[g-4])||o.x,o.by=Is(y[g-3])||o.y,a.bx=r&&(Is(v[_-4])||a.x),a.by=r&&(Is(v[_-3])||a.y),a.x=r&&v[_-2],a.y=r&&v[_-1]}return r||(n.curve=Ys(i)),r?[i,r]:i}var lc=function(e,t,n){e=uc(e),t=uc(t);for(var i,r,o,a,s,c,u,l,d,p,f=n?0:[],h=0,m=e.length;h<m;h++){var y=e[h];if("M"==y[0])i=s=y[1],r=c=y[2];else{"C"==y[0]?(i=(d=[i,r].concat(y.slice(1)))[6],r=d[7]):(d=[i,r,i,r,s,c,s,c],i=s,r=c);for(var v=0,g=t.length;v<g;v++){var _=t[v];if("M"==_[0])o=u=_[1],a=l=_[2];else{"C"==_[0]?(o=(p=[o,a].concat(_.slice(1)))[6],a=p[7]):(p=[o,a,o,a,u,l,u,l],o=u,a=l);var x=nc(d,p,n);if(n)f+=x;else{for(var b=0,E=x.length;b<E;b++)x[b].segment1=h,x[b].segment2=v,x[b].bez1=d,x[b].bez2=p;f=f.concat(x)}}}}}return f},dc={};Object.defineProperty(dc,"__esModule",{value:!0}),dc.roundBounds=function(e){return{x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height)}},dc.roundPoint=fc,dc.asTRBL=hc,dc.asBounds=function(e){return{x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top}},dc.getMid=function(e){return fc({x:e.x+(e.width||0)/2,y:e.y+(e.height||0)/2})},dc.getOrientation=function(e,t,n){n=n||0,(0,l.isObject)(n)||(n={x:n,y:n});var i=hc(e),r=hc(t),o=i.bottom+n.y<=r.top,a=i.left-n.x>=r.right,s=i.top-n.y>=r.bottom,c=i.right+n.x<=r.left,u=o?"top":s?"bottom":null,d=c?"left":a?"right":null;return d&&u?u+"-"+d:d||u||"intersect"},dc.getElementLineIntersection=function(e,t,n){var i=mc(e,t);if(1===i.length)return fc(i[0]);if(2===i.length&&(0,Ts.pointDistance)(i[0],i[1])<1)return fc(i[0]);if(i.length>1)return fc((i=(0,l.sortBy)(i,function(e){var t=Math.floor(100*e.t2)||1;return t=((t=100-t)<10?"0":"")+t,e.segment2+"#"+t}))[n?0:i.length-1]);return null};var pc=function(e){return e&&e.__esModule?e:{default:e}}(lc);function fc(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function hc(e){return{top:e.y,right:e.x+(e.width||0),bottom:e.y+(e.height||0),left:e.x}}function mc(e,t){return(0,pc.default)(e,t)}var yc={};Object.defineProperty(yc,"__esModule",{value:!0}),yc.default=xc;var vc=_c(u),gc=_c(ds);function _c(e){return e&&e.__esModule?e:{default:e}}function xc(e,t,n,i){gc.default.call(this,e),this._elementRegistry=t,this._modeling=n,this._rules=i;var r=this;this.postExecuted(["shape.create"],function(e){var t=e.context,n=t.hints,i=t.shape,o=t.parent||t.newParent;(!n||!1!==n.root&&!1!==n.autoResize)&&r._expand([i],o)}),this.postExecuted(["elements.move"],function(e){var t=e.context,n=(0,l.flatten)((0,l.values)(t.closure.topLevel)),i=t.hints,o=!i||i.autoResize;if(!1!==o){var a=(0,l.groupBy)(n,function(e){return e.parent.id});(0,l.forEach)(a,function(e,t){(0,l.isArray)(o)&&(e=e.filter(function(e){return-1!==o.indexOf(e)})),r._expand(e,t)})}}),this.postExecuted(["shape.toggleCollapse"],function(e){var t=e.context,n=t.hints,i=t.shape;(!n||!1!==n.root&&!1!==n.autoResize)&&(i.collapsed||r._expand(i.children||[],i))}),this.postExecuted(["shape.resize"],function(e){var t=e.context,n=t.hints,i=t.shape,o=i.parent;(!n||!1!==n.root&&!1!==n.autoResize)&&o&&r._expand([i],o)})}xc.$inject=["eventBus","elementRegistry","modeling","rules"],(0,vc.default)(xc,gc.default),xc.prototype._getOptimalBounds=function(e,t){var n=this.getOffset(t),i=this.getPadding(t),r=(0,dc.asTRBL)((0,Tr.getBBox)(e)),o=(0,dc.asTRBL)(t),a={};return r.top-o.top<i.top&&(a.top=r.top-n.top),r.left-o.left<i.left&&(a.left=r.left-n.left),o.right-r.right<i.right&&(a.right=r.right+n.right),o.bottom-r.bottom<i.bottom&&(a.bottom=r.bottom+n.bottom),(0,dc.asBounds)((0,l.assign)({},o,a))},xc.prototype._expand=function(e,t){if("string"==typeof t&&(t=this._elementRegistry.get(t)),this._rules.allowed("element.autoResize",{elements:e,target:t})){var n=this._getOptimalBounds(e,t);if(function(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}(n,t)){this.resize(t,n);var i=t.parent;i&&this._expand([t],i)}}},xc.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}},xc.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}},xc.prototype.resize=function(e,t){this._modeling.resizeShape(e,t)};var bc={};Object.defineProperty(bc,"__esModule",{value:!0});var Ec=function(e){return e&&e.__esModule?e:{default:e}}(yc);bc.default={__init__:["autoResize"],autoResize:["type",Ec.default]};var wc={__init__:["cmmnAutoResizeProvider"],__depends__:[bc.default],cmmnAutoResizeProvider:["type",Rs]},Mc=l.assign,Sc=l.isArray,Cc=J.isAny,Pc=e.is,Rc=e.getDefinition;function Tc(e,t,n,i,r,o,a,s){e.registerProvider(this),this._contextPad=e,this._connect=t,this._create=n,this._elementFactory=i,this._modeling=r,this._rules=o,this._popupMenu=a,this._canvas=s}Tc.$inject=["contextPad","connect","create","elementFactory","modeling","rules","popupMenu","canvas"];var kc=Tc;Tc.prototype.getContextPadEntries=function(e){var t,n,i,r=this._contextPad,o=this._connect,a=this._create,s=this._elementFactory,c=this._modeling,u=this._canvas,l=this._rules,d=this._popupMenu,p={};if("label"===e.type)return p;function f(e,t,n){o.start(e,t,n)}function h(e,t,n,i,r){function o(t,n){var r=s.createShape(Mc({type:e},i));a.start(t,r,n)}return"string"!=typeof n&&(i=n,n="Append "+e.replace(/^cmmn:/,"")),{group:"model",className:t,title:n,action:{dragstart:r||o,click:r||o}}}Cc(e,["cmmn:PlanItem","cmmn:CaseFileItem"])&&Mc(p,{"append.entryCriterion":(t="cmmn-icon-entry-criterion",n="Append Criterion",h("cmmn:EntryCriterion",t,n,i,function(e,t){var n=s.createCriterionShape("cmmn:EntryCriterion");a.start(e,n,t)}))}),function(e){var t=Rc(e);return Pc(t,"cmmn:HumanTask")&&t.isBlocking}(e)&&Mc(p,{"append.discretionaryItem":function(e,t,n){return h("cmmn:DiscretionaryItem",e,t,n,function(e,t){var n=s.createDiscretionaryItemShape("cmmn:Task");a.start(e,n,t)})}("cmmn-icon-task-discretionary","Append DiscretionaryItem")}),d.isEmpty(e,"cmmn-replace")||Mc(p,{replace:{group:"edit",className:"cmmn-icon-screw-wrench",title:"Change type",action:{click:function(e,t){var n=Mc(function(e){var t=u.getContainer(),n=r.getPad(e).html,i=t.getBoundingClientRect(),o=n.getBoundingClientRect(),a=o.top-i.top;return{x:o.left-i.left,y:a+o.height+5}}(t),{cursor:{x:e.x,y:e.y}});d.open(t,"cmmn-replace",n)}}}}),Cc(e,["cmmndi:CMMNEdge","cmmn:TextAnnotation"])||Mc(p,{"append.text-annotation":h("cmmn:TextAnnotation","cmmn-icon-text-annotation")}),Cc(e,["cmmn:PlanItem","cmmn:DiscretionaryItem","cmmn:CaseFileItem","cmmn:Criterion"])&&Mc(p,{connect:{group:"connect",className:"cmmn-icon-connection",title:"Connect using Discretionary/OnPart or Association",action:{click:f,dragstart:f}}});var m=l.allowed("elements.delete",{elements:[e]});return Sc(m)&&(m=m[0]===e),m&&Mc(p,{delete:{group:"edit",className:"cmmn-icon-trash",title:"Remove",action:{click:function(t){c.removeElements([e])}}}}),p};var Ac={},Oc=e.is,jc=e.getDefinition,Nc=e.getBusinessObject,Ic=J.isAny,Dc=J.getParent,Bc=Tr.eachElement;function Lc(e){zc(e=Nc(e))&&(e=jc(e));var t=[];if(Fc(e)&&(e=e.planningTable)){var n=e.get("tableItems");Bc(n,function(e){if(!$c(e))return e.get("tableItems");t.push(e)})}return t}function zc(e){return Ic(e,["cmmn:DiscretionaryItem","cmmn:PlanItem"])}function Fc(e){return Ic(e,["cmmn:HumanTask","cmmn:Stage"])}function $c(e){return Oc(e,"cmmn:DiscretionaryItem")}Ac.getAllDiscretionaryItems=Lc,Ac.getDirectItemCapables=function(e){zc(e=Nc(e))&&(e=jc(e));var t,n=[];function i(e){n.push(e)}return e&&(Oc(e,"cmmn:PlanFragment")&&(t=e.get("planItems"),Bc(t,i)),Fc(e)&&(t=Lc(e),Bc(t,i))),n},Ac.isItemCapable=zc,Ac.isPlanningTableCapable=Fc,Ac.isDiscretionaryItem=$c,Ac.isDiscretionaryToHumanTask=function(e){var t=Nc(e),n=Dc(t,"cmmn:PlanItemDefinition");return Oc(n,"cmmn:HumanTask")},Ac.isHumanTask=function(e){return Oc(e,"cmmn:HumanTask")},Ac.isPlanFragment=function(e){return Oc(e,"cmmn:PlanFragment")&&!Oc(e,"cmmn:Stage")};var Hc={TASK:[{label:"Task",actionName:"replace-with-task-plan-item",className:"cmmn-icon-task-none",target:{definitionType:"cmmn:Task",type:"cmmn:PlanItem"}},{label:"Human Task",actionName:"replace-with-blocking-human-task-plan-item",className:"cmmn-icon-human-blocking-task",target:{definitionType:"cmmn:HumanTask",type:"cmmn:PlanItem",isBlocking:!0}},{label:"Human Task",actionName:"replace-with-non-blocking-human-task-plan-item",className:"cmmn-icon-human-non-blocking-task",target:{definitionType:"cmmn:HumanTask",type:"cmmn:PlanItem",isBlocking:!1}},{label:"Decision Task",actionName:"replace-with-decision-task-plan-item",className:"cmmn-icon-decision-task",target:{definitionType:"cmmn:DecisionTask",type:"cmmn:PlanItem"}},{label:"Process Task",actionName:"replace-with-process-task-plan-item",className:"cmmn-icon-process-task",target:{definitionType:"cmmn:ProcessTask",type:"cmmn:PlanItem"}},{label:"Case Task",actionName:"replace-with-case-task-plan-item",className:"cmmn-icon-case-task",target:{definitionType:"cmmn:CaseTask",type:"cmmn:PlanItem"}},{label:"Stage (collapsed)",actionName:"replace-with-collapsed-stage-plan-item",className:"cmmn-icon-stage-collapsed",target:{definitionType:"cmmn:Stage",type:"cmmn:PlanItem",isCollapsed:!0}},{label:"Stage (expanded)",actionName:"replace-with-expanded-stage-plan-item",className:"cmmn-icon-stage-expanded",target:{definitionType:"cmmn:Stage",type:"cmmn:PlanItem",isCollapsed:!1}},{label:"Discretionary Task",actionName:"replace-with-task-discretionary-item",className:"cmmn-icon-task-discretionary",target:{definitionType:"cmmn:Task",type:"cmmn:DiscretionaryItem"}},{label:"Discretionary Human Task",actionName:"replace-with-blocking-human-task-discretionary-item",className:"cmmn-icon-human-blocking-task-discretionary",target:{definitionType:"cmmn:HumanTask",type:"cmmn:DiscretionaryItem",isBlocking:!0}},{label:"Discretionary Human Task",actionName:"replace-with-non-blocking-human-task-discretionary-item",className:"cmmn-icon-human-non-blocking-task-discretionary",target:{definitionType:"cmmn:HumanTask",type:"cmmn:DiscretionaryItem",isBlocking:!1}},{label:"Discretionary Decision Task",actionName:"replace-with-decision-task-discretionary-item",className:"cmmn-icon-decision-task-discretionary",target:{definitionType:"cmmn:DecisionTask",type:"cmmn:DiscretionaryItem"}},{label:"Discretionary Process Task",actionName:"replace-with-process-task-discretionary-item",className:"cmmn-icon-process-task-discretionary",target:{definitionType:"cmmn:ProcessTask",type:"cmmn:DiscretionaryItem"}},{label:"Discretionary Case Task",actionName:"replace-with-case-task-discretionary-item",className:"cmmn-icon-case-task-discretionary",target:{definitionType:"cmmn:CaseTask",type:"cmmn:DiscretionaryItem"}},{label:"Discretionary Stage (collapsed)",actionName:"replace-with-collapsed-stage-discretionary-item",className:"cmmn-icon-stage-collapsed-discretionary",target:{definitionType:"cmmn:Stage",type:"cmmn:DiscretionaryItem",isCollapsed:!0}},{label:"Discretionary Stage (expanded)",actionName:"replace-with-expanded-stage-discretionary-item",className:"cmmn-icon-stage-expanded-discretionary",target:{definitionType:"cmmn:Stage",type:"cmmn:DiscretionaryItem",isCollapsed:!1}}],PLAN_FRAGMENT_EXPANDED:[{label:"Stage",actionName:"replace-with-stage-plan-item",className:"cmmn-icon-stage-expanded",target:{definitionType:"cmmn:Stage",type:"cmmn:PlanItem",isCollapsed:!1}},{label:"Discretionary Stage",actionName:"replace-with-stage-discretionary-item",className:"cmmn-icon-stage-expanded-discretionary",target:{definitionType:"cmmn:Stage",type:"cmmn:DiscretionaryItem",isCollapsed:!1}},{label:"Discretionary Plan Fragment",actionName:"replace-with-plan-fragment-discretionary-item",className:"cmmn-icon-plan-fragment-expanded-discretionary",target:{definitionType:"cmmn:PlanFragment",type:"cmmn:DiscretionaryItem",isCollapsed:!1}}],EVENT_LISTENER:[{label:"Event Listener",actionName:"replace-with-event-listener-plan-item",className:"cmmn-icon-event-listener",target:{definitionType:"cmmn:EventListener",type:"cmmn:PlanItem"}},{label:"Timer Event Listener",actionName:"replace-with-timer-event-listener-plan-item",className:"cmmn-icon-timer-event-listener",target:{definitionType:"cmmn:TimerEventListener",type:"cmmn:PlanItem"}},{label:"User Event Listener",actionName:"replace-with-user-event-listener-plan-item",className:"cmmn-icon-user-event-listener",target:{definitionType:"cmmn:UserEventListener",type:"cmmn:PlanItem"}}],CRITERION:[{label:"Entry Criterion",actionName:"replace-with-entry-criterion",className:"cmmn-icon-entry-criterion",target:{type:"cmmn:EntryCriterion"}},{label:"Exit Criterion",actionName:"replace-with-exit-criterion",className:"cmmn-icon-exit-criterion",target:{type:"cmmn:ExitCriterion"}}]},Uc=l.forEach,Wc=l.filter,Vc=Ac.isItemCapable,qc=J.isAny,Gc=e.getBusinessObject,Kc=e.getDefinition,Yc=e.isCasePlanModel,Xc=e.isRequired,Zc=e.isRepeatable,Qc=e.isManualActivation,Jc=e.is,eu=ye.isCollapsed;function tu(e,t){return Gc(e).$type!==t.target.type}function nu(e,t){return Kc(e).$type!==t.target.definitionType}function iu(e,t){var n=t.type,i=t.definitionType,r=e.parent,o=Kc(e);if(function(e){return Jc(e,"cmmn:PlanItem")}(e)&&"cmmn:DiscretionaryItem"===n&&!au(r))return!1;if("cmmn:HumanTask"===i){if(ou(e)&&!t.isBlocking)return!1;if(su(e)&&o.isBlocking!==t.isBlocking)return!1}return!0}function ru(e,t,n,i,r){this._popupMenu=e,this._cmmnReplace=t,this._cmmnFactory=n,this._modeling=i,this._rules=r,this.register()}function ou(e){return Jc(Kc(e),"cmmn:PlanFragment")}function au(e){return Jc(Kc(e),"cmmn:Stage")}function su(e){return Jc(Kc(e),"cmmn:Task")}ru.$inject=["popupMenu","cmmnReplace","cmmnFactory","modeling","rules"],ru.prototype.register=function(){this._popupMenu.registerProvider("cmmn-replace",this)},ru.prototype.getEntries=function(e){var t,n=this._rules,i=Kc(e);if(!n.allowed("shape.replace",{element:e}))return[];if(Vc(e)){if(su(e))return t=Wc(Hc.TASK,function(t){var n=t.target;if(iu(e,n))return tu(e,t)^nu(e,t)}),this._createEntries(e,t);if(ou(e)){if(!eu(e))return t=Wc(Hc.PLAN_FRAGMENT_EXPANDED,function(t){var n=t.target;if(iu(e,n))return tu(e,t)||nu(e,t)}),this._createEntries(e,t);if(eu(e))return t=Wc(Hc.TASK,function(t){var n=t.target,r=n.definitionType;return!!iu(e,n)&&(r===i.$type&&!n.isCollapsed||tu(e,t)^nu(e,t))}),this._createEntries(e,t)}if(function(e){return Jc(Kc(e),"cmmn:EventListener")}(e))return t=Wc(Hc.EVENT_LISTENER,function(t){return nu(e,t)}),this._createEntries(e,t)}return function(e){return Jc(e,"cmmn:Criterion")}(e)?(t=Wc(Hc.CRITERION,function(t){return tu(e,t)}),this._createEntries(e,t)):[]},ru.prototype.getHeaderEntries=function(e){var t=[];return su(e)&&(t=t.concat(this._getBlockingEntry(e))),au(e)&&(t=t.concat(this._getAutoCompleteEntry(e))),function(e){var t=Kc(e);return!Yc(e)&&qc(t,["cmmn:Stage","cmmn:Milestone","cmmn:Task"])}(e)&&(t=t.concat(this._getRuleEntries(e))),t},ru.prototype._createEntries=function(e,t){var n=[],i=this;return Uc(t,function(t){var r=i._createMenuEntry(t,e);n.push(r)}),n},ru.prototype._createMenuEntry=function(e,t,n){var i=this._cmmnReplace.replaceElement;return n=n||function(){return i(t,e.target)},{label:e.label,className:e.className,id:e.actionName,action:n}},ru.prototype._getBlockingEntry=function(e){var t=this;return[{id:"toggle-is-blocking",className:"cmmn-icon-blocking",title:"Blocking",active:Kc(e).isBlocking,action:function(n,i){var r=!i.active;t._modeling.updateControls(e,{isBlocking:r})}}]},ru.prototype._getAutoCompleteEntry=function(e){var t=this;return[{id:"toggle-auto-complete",className:"cmmn-icon-auto-complete-marker",title:"Auto Complete",active:Kc(e).autoComplete,action:function(n,i){var r=!i.active;t._modeling.updateControls(e,{autoComplete:r})}}]},ru.prototype._getRuleEntries=function(e){var t=this;function n(n,i){return function(r,o){var a={};o.active?a[n]=void 0:a[n]=t._cmmnFactory.create(i),t._modeling.updateControls(e,a)}}var i=Zc(e),r=Xc(e),o=Qc(e),a=[{id:"toggle-required-rule",className:"cmmn-icon-required-marker",title:"Required Rule",active:r,action:n("requiredRule","cmmn:RequiredRule")}];return function(e){return Jc(Kc(e),"cmmn:Milestone")}(e)||a.push({id:"toggle-manual-activation-rule",className:"cmmn-icon-manual-activation-marker",title:"Manual Activation Rule",active:o,action:n("manualActivationRule","cmmn:ManualActivationRule")}),a.push({id:"toggle-repetition-rule",className:"cmmn-icon-repetition-marker",title:"Repetition Rule",active:i,action:n("repetitionRule","cmmn:RepetitionRule")}),a};var cu={__init__:["replaceMenuProvider"],replaceMenuProvider:["type",ru]},uu={};Object.defineProperty(uu,"__esModule",{value:!0});var lu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};uu.default=fu;var du="connect-ok",pu="connect-not-ok";function fu(e,t,n,i,r,o){function a(e,t){return i.allowed("connection.create",{source:e,target:t})}e.on("connect.move",function(e){var t,n=e.context,i=n.source,r=n.target,a=n.visual;t=function(e,t,n,i){var r=o.getShapePath(n),a=i&&o.getShapePath(i),s=o.getConnectionPath({waypoints:[e,t]});return[e=(0,dc.getElementLineIntersection)(r,s,!0)||e,t=i&&(0,dc.getElementLineIntersection)(a,s,!1)||t]}(n.sourcePosition,{x:e.x,y:e.y},i,r),(0,we.attr)(a,{points:[t[0].x,t[0].y,t[1].x,t[1].y]})}),e.on("connect.hover",function(e){var t,n=e.context,i=n.source,o=e.hover;null!==(t=n.canExecute=a(i,o))&&(n.target=o,r.addMarker(o,t?du:pu))}),e.on(["connect.out","connect.cleanup"],function(e){var t=e.context;t.target&&r.removeMarker(t.target,t.canExecute?du:pu),t.target=null,t.canExecute=!1}),e.on("connect.cleanup",function(e){var t=e.context;t.visual&&(0,we.remove)(t.visual)}),e.on("connect.start",function(e){var t,n=e.context;t=(0,we.create)("polyline"),(0,we.attr)(t,{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"}),(0,we.append)(r.getDefaultLayer(),t),n.visual=t}),e.on("connect.end",function(e){var t=e.context,i=t.source,r=t.sourcePosition,o=t.target,s={x:e.x,y:e.y},c=t.canExecute||a(i,o);if(!c)return!1;var u=null,l={connectionStart:r,connectionEnd:s};"object"===(void 0===c?"undefined":lu(c))&&(u=c),n.connect(i,o,u,l)}),this.start=function(e,n,i,r){"object"!==(void 0===i?"undefined":lu(i))&&(r=i,i=(0,dc.getMid)(n)),t.init(e,"connect",{autoActivate:r,data:{shape:n,context:{source:n,sourcePosition:i}}})}}fu.$inject=["eventBus","dragging","modeling","rules","canvas","graphicsFactory"];var hu={};Object.defineProperty(hu,"__esModule",{value:!0}),hu.default=gu;var mu=Math.round,yu="djs-drag-active";function vu(e){e.preventDefault()}function gu(e,t,n){var i,r={threshold:5,trapClick:!0};function o(e){var n=t.viewbox(),i=t._container.getBoundingClientRect();return{x:n.x+(e.x-i.left)/n.scale,y:n.y+(e.y-i.top)/n.scale}}function a(t,n){n=n||i;var r=e.createEvent((0,l.assign)({},n.payload,n.data,{isTouch:n.isTouch}));return!1!==e.fire("drag."+t,r)&&e.fire(n.prefix+"."+t,r)}function s(e,r){var s,c=i.payload,u=i.displacement,d=i.globalStart,p=(0,Zo.toPoint)(e),f=(0,Ka.delta)(p,d),h=i.localStart,y=o(p),v=(0,Ka.delta)(y,h);if(!i.active&&(r||(s=f,Math.sqrt(Math.pow(s.x,2)+Math.pow(s.y,2))>i.threshold))){if((0,l.assign)(c,{x:mu(h.x+u.x),y:mu(h.y+u.y),dx:0,dy:0},{originalEvent:e}),!1===a("start"))return m();i.active=!0,i.keepSelection||(c.previousSelection=n.get(),n.select(null)),i.cursor&&(0,Va.set)(i.cursor),t.addMarker(t.getRootElement(),yu)}(0,Zo.stopPropagation)(e),i.active&&((0,l.assign)(c,{x:mu(y.x+u.x),y:mu(y.y+u.y),dx:mu(v.x),dy:mu(v.y)},{originalEvent:e}),a("move"))}function c(e){var t=!0;i.active&&(e&&(i.payload.originalEvent=e,(0,Zo.stopPropagation)(e)),t=a("end")),!1===t&&a("rejected"),a("ended",y(!0!==t))}function u(e){27===e.which&&(vu(e),m())}function d(t){var n;i.active&&(n=(0,Ua.install)(e),setTimeout(n,400),vu(t)),c(t)}function p(e){s(e)}function f(e){var t=i.payload;t.hoverGfx=e.gfx,t.hover=e.element,a("hover")}function h(e){a("out");var t=i.payload;t.hoverGfx=null,t.hover=null}function m(e){var t;if(i){var n=i.active;n&&a("cancel"),t=y(e),n&&a("canceled",t)}}function y(r){var o,l;a("cleanup"),(0,Va.unset)(),l=i.trapClick?d:c,st.event.unbind(document,"mousemove",s),st.event.unbind(document,"dragstart",vu),st.event.unbind(document,"selectstart",vu),st.event.unbind(document,"mousedown",l,!0),st.event.unbind(document,"mouseup",l,!0),st.event.unbind(document,"keyup",u),st.event.unbind(document,"touchstart",p,!0),st.event.unbind(document,"touchcancel",m,!0),st.event.unbind(document,"touchmove",s,!0),st.event.unbind(document,"touchend",c,!0),e.off("element.hover",f),e.off("element.out",h),t.removeMarker(t.getRootElement(),yu);var y=i.payload.previousSelection;return!1!==r&&y&&!n.get().length&&n.select(y),o=i,i=null,o}e.on("diagram.destroy",m),this.init=function(t,n,y,v){i&&m(!1),"string"==typeof n&&(v=y,y=n,n=null);var g,_,x,b,E,w=(v=(0,l.assign)({},r,v||{})).data||{};b=v.trapClick?d:c,t?(g=(0,Zo.getOriginal)(t)||t,_=(0,Zo.toPoint)(t),(0,Zo.stopPropagation)(t),"dragstart"===g.type&&vu(g)):(g=null,_={x:0,y:0}),x=o(_),n||(n=x),E=function(e){return"undefined"!=typeof TouchEvent&&e instanceof TouchEvent}(g),i=(0,l.assign)({prefix:y,data:w,payload:{},globalStart:_,displacement:(0,Ka.delta)(n,x),localStart:x,isTouch:E},v),v.manual||(E?(st.event.bind(document,"touchstart",p,!0),st.event.bind(document,"touchcancel",m,!0),st.event.bind(document,"touchmove",s,!0),st.event.bind(document,"touchend",c,!0)):(st.event.bind(document,"mousemove",s),st.event.bind(document,"dragstart",vu),st.event.bind(document,"selectstart",vu),st.event.bind(document,"mousedown",b,!0),st.event.bind(document,"mouseup",b,!0)),st.event.bind(document,"keyup",u),e.on("element.hover",f),e.on("element.out",h)),a("init"),v.autoActivate&&s(t,!0)},this.move=s,this.hover=f,this.out=h,this.end=c,this.cancel=m,this.context=function(){return i},this.setOptions=function(e){(0,l.assign)(r,e)}}gu.$inject=["eventBus","canvas","selection"];var _u={};function xu(e,t,n){var i=this;e.on("drag.start",function(t){e.once("drag.move",function(){e.once("drag.move",function(e){i.ensureHover(e)})})}),this.ensureHover=function(e){if(!e.hover){var i,r,o,a=e.originalEvent;a instanceof MouseEvent&&(i=(0,Zo.toPoint)(a),(o=function(e){return(0,st.closest)(e,"svg, .djs-element",!0)}(document.elementFromPoint(i.x,i.y)))&&(r=n.get(o),t.hover({element:r,gfx:o})))}}}Object.defineProperty(_u,"__esModule",{value:!0}),_u.default=xu,xu.$inject=["eventBus","dragging","elementRegistry"];var bu={};Object.defineProperty(bu,"__esModule",{value:!0});var Eu=Su(Ea),wu=Su(hu),Mu=Su(_u);function Su(e){return e&&e.__esModule?e:{default:e}}bu.default={__init__:["hoverFix"],__depends__:[Eu.default],dragging:["type",wu.default],hoverFix:["type",Mu.default]};var Cu={};function Pu(e){this._commandStack=e.get("commandStack",!1)}Object.defineProperty(Cu,"__esModule",{value:!0}),Cu.default=Pu,Pu.$inject=["injector"],Pu.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(e,t)),void 0===n||n};var Ru={};Object.defineProperty(Ru,"__esModule",{value:!0});var Tu=function(e){return e&&e.__esModule?e:{default:e}}(Cu);Ru.default={__init__:["rules"],rules:["type",Tu.default]};var ku={};Object.defineProperty(ku,"__esModule",{value:!0});var Au=Iu(Ea),Ou=Iu(Ru),ju=Iu(bu),Nu=Iu(uu);function Iu(e){return e&&e.__esModule?e:{default:e}}ku.default={__depends__:[Au.default,Ou.default,ju.default],connect:["type",Nu.default]};var Du={};Object.defineProperty(Du,"__esModule",{value:!0}),Du.default=Bu;function Bu(e,t,n){this._providers=[],this._eventBus=t,this._overlays=n;var i=(0,l.isDefined)(e&&e.scale)?e.scale:{min:1,max:1.5};this._overlaysConfig={position:{right:-9,top:-6},scale:i},this._current=null,this._init()}Bu.$inject=["config.contextPad","eventBus","overlays"],Bu.prototype._init=function(){var e=this._eventBus,t=this;e.on("selection.changed",function(e){var n=e.newSelection;1===n.length?t.open(n[0]):t.close()}),e.on("elements.delete",function(e){var n=e.elements;(0,l.forEach)(n,function(e){t.isOpen(e)&&t.close()})}),e.on("element.changed",function(e){var n=e.element,i=t._current;i&&i.element===n&&t.open(n,!0)})},Bu.prototype.registerProvider=function(e){this._providers.push(e)},Bu.prototype.getEntries=function(e){var t={};return(0,l.forEach)(this._providers,function(n){var i=n.getContextPadEntries(e);(0,l.forEach)(i,function(e,n){t[n]=e})}),t},Bu.prototype.trigger=function(e,t,n){var i,r,o=this._current.element,a=this._current.entries,s=t.delegateTarget||t.target;if(!s)return t.preventDefault();if(i=a[(0,st.attr)(s,"data-action")].action,r=t.originalEvent||t,(0,l.isFunction)(i)){if("click"===e)return i(r,o,n)}else if(i[e])return i[e](r,o,n);t.preventDefault()},Bu.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))},Bu.prototype._updateAndOpen=function(e){var t=this.getEntries(e),n=this.getPad(e),i=n.html;(0,l.forEach)(t,function(e,t){var n,r,o,a,s=e.group||"default",c=(0,st.domify)(e.html||'<div class="entry" draggable="true"></div>');(0,st.attr)(c,"data-action",t),(n=(0,st.query)("[data-group="+s+"]",i))||(n=(0,st.domify)('<div class="group" data-group="'+s+'"></div>'),i.appendChild(n)),n.appendChild(c),e.className&&(r=c,o=e.className,a=(0,st.classes)(r),((0,l.isArray)(o)?o:o.split(/\s+/g)).forEach(function(e){a.add(e)})),e.title&&(0,st.attr)(c,"title",e.title),e.imageUrl&&c.appendChild((0,st.domify)('<img src="'+e.imageUrl+'">'))}),(0,st.classes)(i).add("open"),this._current={element:e,pad:n,entries:t},this._eventBus.fire("contextPad.open",{current:this._current})},Bu.prototype.getPad=function(e){if(this.isOpen())return this._current.pad;var t=this,n=this._overlays,i=(0,st.domify)('<div class="djs-context-pad"></div>'),r=(0,l.assign)({html:i},this._overlaysConfig);st.delegate.bind(i,".entry","click",function(e){t.trigger("click",e)}),st.delegate.bind(i,".entry","dragstart",function(e){t.trigger("dragstart",e)}),st.event.bind(i,"mousedown",function(e){e.stopPropagation()}),this._overlayId=n.add(e,"context-pad",r);var o=n.get(this._overlayId);return this._eventBus.fire("contextPad.create",{element:e,pad:o}),o},Bu.prototype.close=function(){this.isOpen()&&(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)},Bu.prototype.isOpen=function(e){return!(!this._current||e&&this._current.element!==e)};var Lu={};Object.defineProperty(Lu,"__esModule",{value:!0});var zu=Hu(sa),Fu=Hu(Yo),$u=Hu(Du);function Hu(e){return e&&e.__esModule?e:{default:e}}Lu.default={__depends__:[zu.default,Fu.default],contextPad:["type",$u.default]};var Uu={};Object.defineProperty(Uu,"__esModule",{value:!0}),Uu.default=Yu;var Wu=750,Vu="drop-ok",qu="drop-not-ok",Gu="attach-ok",Ku="new-parent";function Yu(e,t,n,i,r,o,a){function s(e,t){[Gu,Vu,qu,Ku].forEach(function(n){n===t?r.addMarker(e,n):r.removeMarker(e,n)})}e.on("create.move",function(e){var t,i=e.context,r=e.hover,o=i.shape,a=i.source,c={x:e.x,y:e.y};t=i.canExecute=r&&function(e,t,i,r){if(!t)return!1;var o,a,s,c={source:i,shape:e,target:t,position:r};return(a=n.allowed("shape.attach",c))||(o=n.allowed("shape.create",c)),(o||a)&&(s=i&&n.allowed("connection.create",{source:i,target:e,hints:{targetParent:t,targetAttach:a}})),!(!o&&!a)&&{attach:a,connect:s}}(o,r,a,c),r&&null!==t&&(i.target=r,t&&t.attach?s(r,Gu):s(r,t?Ku:qu))}),e.on("create.move",Wu,function(e){var t=e.context,n=t.shape,i=t.visual;i||(i=t.visual=function(e){var t,n,i;t=(0,we.create)("g"),(0,we.attr)(t,o.cls("djs-drag-group",["no-events"])),(0,we.append)(r.getDefaultLayer(),t),n=(0,we.create)("g"),(0,we.classes)(n).add("djs-dragger"),(0,we.append)(t,n),(0,Qe.translate)(n,e.width/-2,e.height/-2);var s=(0,we.create)("g");return(0,we.classes)(s).add("djs-visual"),(0,we.append)(n,s),i=s,a.drawShape(i,e),t}(n)),(0,Qe.translate)(i,e.x,e.y)}),e.on(["create.end","create.out","create.cleanup"],function(e){var t=e.context.target;t&&s(t,null)}),e.on("create.end",function(e){var t=e.context,n=t.source,r=t.shape,o=t.target,a=t.canExecute,s=a&&a.attach,c=a&&a.connect,u={x:e.x,y:e.y};if(!a)return!1;r=c?i.appendShape(n,r,u,o,{attach:s,connection:!0===c?{}:c}):i.createShape(r,u,o,{attach:s}),t.shape=r}),e.on("create.cleanup",function(e){var t=e.context;t.visual&&(0,we.remove)(t.visual)}),this.start=function(e,n,i){t.init(e,"create",{cursor:"grabbing",autoActivate:!0,data:{shape:n,context:{shape:n,source:i}}})}}Yu.$inject=["eventBus","dragging","rules","modeling","canvas","styles","graphicsFactory"];var Xu={};Object.defineProperty(Xu,"__esModule",{value:!0});var Zu=tl(bu),Qu=tl(Ea),Ju=tl(Ru),el=tl(Uu);function tl(e){return e&&e.__esModule?e:{default:e}}Xu.default={__depends__:[Zu.default,Qu.default,Ju.default],create:["type",el.default]};var nl={__depends__:[ku.default,Lu.default,Xu.default,Ea.default,cu],__init__:["contextPadProvider"],contextPadProvider:["type",kc]},il={};Object.defineProperty(il,"__esModule",{value:!0}),il.default=rl;function rl(e,t){this._actions={};var n=this;e.on("diagram.init",function(){n._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:n})})}function ol(e,t){return new Error(e+" "+t)}rl.$inject=["eventBus","injector"],rl.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),n=e.get("modeling",!1),i=e.get("selection",!1),r=e.get("zoomScroll",!1),o=e.get("copyPaste",!1),a=e.get("canvas",!1),s=e.get("rules",!1),c=e.get("mouseTracking",!1),u=e.get("keyboardMove",!1),d=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",function(){t.undo()}),this.register("redo",function(){t.redo()})),o&&i&&this.register("copy",function(){var e=i.get();o.copy(e)}),c&&o&&this.register("paste",function(){var e=c.getHoverContext();o.paste(e)}),r&&this.register("stepZoom",function(e){r.stepZoom(e.value)}),a&&this.register("zoom",function(e){a.zoom(e.value)}),n&&i&&s&&this.register("removeSelection",function(){var e=i.get();if(e.length){var t,r=s.allowed("elements.delete",{elements:e});!1!==r&&(t=(0,l.isArray)(r)?r:e).length&&n.removeElements(t.slice())}}),u&&this.register("moveCanvas",function(e){u.moveCanvas(e)}),d&&this.register("moveSelection",function(e){d.moveSelection(e.direction,e.accelerated)})},rl.prototype.trigger=function(e,t){if(!this._actions[e])throw ol(e,"is not a registered action");return this._actions[e](t)},rl.prototype.register=function(e,t){var n=this;if("string"==typeof e)return this._registerAction(e,t);(0,l.forEach)(e,function(e,t){n._registerAction(t,e)})},rl.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw ol(e,"is already registered");this._actions[e]=t},rl.prototype.unregister=function(e){if(!this.isRegistered(e))throw ol(e,"is not a registered action");this._actions[e]=void 0},rl.prototype.getActions=function(){return Object.keys(this._actions)},rl.prototype.isRegistered=function(e){return!!this._actions[e]};var al=il.default;function sl(e){e.invoke(al,this)}u(sl,al),sl.$inject=["injector"];var cl=sl;sl.prototype._registerDefaultActions=function(e){al.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),i=e.get("selection",!1),r=e.get("spaceTool",!1),o=e.get("lassoTool",!1),a=e.get("handTool",!1),s=e.get("globalConnect",!1),c=e.get("directEditing",!1),u=e.get("searchPad",!1);t&&n&&i&&this._registerAction("selectElements",function(){var e=t.getRootElement(),r=n.filter(function(t){return t!==e});return i.select(r),r}),r&&this._registerAction("spaceTool",function(){r.toggle()}),o&&this._registerAction("lassoTool",function(){o.toggle()}),a&&this._registerAction("handTool",function(){a.toggle()}),s&&this._registerAction("globalConnectTool",function(){s.toggle()}),i&&c&&this._registerAction("directEditing",function(){var e=i.get();e.length&&c.activate(e[0])}),u&&this._registerAction("find",function(){u.toggle()})};var ul={};Object.defineProperty(ul,"__esModule",{value:!0});var ll=function(e){return e&&e.__esModule?e:{default:e}}(il);ul.default={__init__:["editorActions"],editorActions:["type",ll.default]};var dl={__depends__:[ul.default],editorActions:["type",cl]},pl={};Object.defineProperty(pl,"__esModule",{value:!0}),pl.hasModifier=function(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey},pl.isCmd=function(e){if(e.altKey)return!1;return e.ctrlKey||e.metaKey},pl.isKey=function(e,t){return(e=(0,l.isArray)(e)?e:[e]).indexOf(t.key)>-1},pl.isShift=function(e){return e.shiftKey};var fl={};Object.defineProperty(fl,"__esModule",{value:!0}),fl.default=ml;var hl=500;function ml(e,t){var n=this;e.on("editorActions.init",hl,function(e){var i=e.editorActions;n.registerBindings(t,i)})}ml.$inject=["eventBus","keyboard"],ml.prototype.registerBindings=function(e,t){function n(n,i){t.isRegistered(n)&&e.addListener(i)}n("undo",function(e){var n=e.keyEvent;if((0,pl.isCmd)(n)&&!(0,pl.isShift)(n)&&(0,pl.isKey)(["z","Z"],n))return t.trigger("undo"),!0}),n("redo",function(e){var n=e.keyEvent;if((0,pl.isCmd)(n)&&((0,pl.isKey)(["y","Y"],n)||(0,pl.isKey)(["z","Z"],n)&&(0,pl.isShift)(n)))return t.trigger("redo"),!0}),n("copy",function(e){var n=e.keyEvent;if((0,pl.isCmd)(n)&&(0,pl.isKey)(["c","C"],n))return t.trigger("copy"),!0}),n("paste",function(e){var n=e.keyEvent;if((0,pl.isCmd)(n)&&(0,pl.isKey)(["v","V"],n))return t.trigger("paste"),!0}),n("stepZoom",function(e){var n=e.keyEvent;if((0,pl.isKey)(["+","Add"],n)&&(0,pl.isCmd)(n))return t.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(e){var n=e.keyEvent;if((0,pl.isKey)(["-","Subtract"],n)&&(0,pl.isCmd)(n))return t.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(e){var n=e.keyEvent;if((0,pl.isKey)("0",n)&&(0,pl.isCmd)(n))return t.trigger("zoom",{value:1}),!0}),n("removeSelection",function(e){var n=e.keyEvent;if((0,pl.isKey)(["Delete","Del"],n))return t.trigger("removeSelection"),!0})};var yl=fl.default;function vl(e){e.invoke(yl,this)}u(vl,yl),vl.$inject=["injector"];var gl=vl;vl.prototype.registerBindings=function(e,t){function n(n,i){t.isRegistered(n)&&e.addListener(i)}yl.prototype.registerBindings.call(this,e,t),n("selectElements",function(n){var i=n.keyEvent;if(e.isKey(["a","A"],i)&&e.isCmd(i))return t.trigger("selectElements"),!0}),n("find",function(n){var i=n.keyEvent;if(e.isKey(["f","F"],i)&&e.isCmd(i))return t.trigger("find"),!0}),n("spaceTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["s","S"],i)?(t.trigger("spaceTool"),!0):void 0}),n("lassoTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["l","L"],i)?(t.trigger("lassoTool"),!0):void 0}),n("handTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["h","H"],i)?(t.trigger("handTool"),!0):void 0}),n("globalConnectTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["c","C"],i)?(t.trigger("globalConnectTool"),!0):void 0}),n("directEditing",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["e","E"],i)?(t.trigger("directEditing"),!0):void 0})};var _l={};Object.defineProperty(_l,"__esModule",{value:!0}),_l.default=xl;function xl(e,t){var n=this;this._config=e||{},this._eventBus=t,this._keyHandler=this._keyHandler.bind(this),t.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),t.on("diagram.init",function(){n._fire("init")}),t.on("attach",function(){e&&e.bindTo&&n.bind(e.bindTo)}),t.on("detach",function(){n.unbind()})}xl.$inject=["config.keyboard","eventBus"],xl.prototype._keyHandler=function(e){if(!function(e){return e&&((0,st.matches)(e,"input, textarea")||"true"===e.contentEditable)}(e.target)){var t={keyEvent:e};this._eventBus.fire("keyboard.keydown",t)&&e.preventDefault()}},xl.prototype.bind=function(e){this.unbind(),this._node=e,st.event.bind(e,"keydown",this._keyHandler,!0),this._fire("bind")},xl.prototype.getBinding=function(){return this._node},xl.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),st.event.unbind(e,"keydown",this._keyHandler,!0)),this._node=null},xl.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})},xl.prototype.addListener=function(e,t){(0,l.isFunction)(e)&&(t=e,e=1e3),this._eventBus.on("keyboard.keydown",e,t)},xl.prototype.hasModifier=pl.hasModifier,xl.prototype.isCmd=pl.isCmd,xl.prototype.isShift=pl.isShift,xl.prototype.isKey=pl.isKey;var bl={};Object.defineProperty(bl,"__esModule",{value:!0});var El=Ml(_l),wl=Ml(fl);function Ml(e){return e&&e.__esModule?e:{default:e}}bl.default={__init__:["keyboard","keyboardBindings"],keyboard:["type",El.default],keyboardBindings:["type",wl.default]};var Sl={__depends__:[bl.default],__init__:["keyboardBindings"],keyboardBindings:["type",gl]},Cl={},Pl=e.is,Rl=J.isAny,Tl=e.getBusinessObject;function kl(e){return Pl(e,"cmmn:TextAnnotation")?"text":"name"}function Al(e){var t=Tl(e);return Pl(t,"cmmndi:CMMNEdge")&&t.cmmnElementRef&&(t=t.cmmnElementRef),t}var Ol=function(e){return Rl(e,["cmmn:PlanItem","cmmn:DiscretionaryItem","cmmn:CaseFileItem"])};Cl.getLabel=function(e){var t=Al(e),n=kl(t);if(function(e){return!Rl(e,["cmmn:Association","cmmn:Criterion","cmmndi:CMMNEdge"])}(t))return!t[n]&&Ol(e)&&(t=t.definitionRef),t[n]||""};Cl.setLabel=function(e,t,n,i){var r=Al(e),o=kl(r);return!r[o]&&Ol(e)&&i&&(r=r.definitionRef),r[o]=t,n&&(e.hidden=!t),e};var jl=e.getDefinition;function Nl(e){function t(t,n){var i=t.label||t,r=t.labelTarget||t;return Cl.setLabel(i,n,r!==i,function(t){var n=jl(t);return!n||1===e.getReferences(n).length}(t)),[i,r]}this.execute=function(e){return e.oldLabel=Cl.getLabel(e.element),t(e.element,e.newLabel)},this.revert=function(e){return t(e.element,e.oldLabel)}}Nl.$inject=["itemRegistry"];var Il=Nl,Dl=e.isCasePlanModel,Bl=e.is,Ll=e.getDefinition,zl=l.assign;function Fl(e,t,n,i){this._canvas=t,this._commandStack=i,n.registerProvider(this),i.registerHandler("element.updateLabel",Il),e.on("element.dblclick",function(e){n.activate(e.element)}),e.on(["element.mousedown","drag.init","canvas.viewbox.changed"],function(e){n.complete()}),e.on(["commandStack.changed"],function(){n.cancel()}),e.on("create.end",500,function(e){var t=e.shape,i=e.context.canExecute;e.isTouch||i&&n.activate(t)})}Fl.$inject=["eventBus","canvas","directEditing","commandStack"];var $l=Fl;Fl.prototype.activate=function(e){var t=Cl.getLabel(e);if(void 0!==t&&e.parent){var n=e.label||e,i=this.getEditingBBox(e),r=Ll(e),o={};return(Bl(r,"cmmn:Task")||Bl(r,"cmmn:Milestone"))&&(o.centerVertically=!0),Bl(e,"cmmn:TextAnnotation")&&(o.autoResize=!0,o.resizable=!0),n.labelTarget&&(o.autoResize=!0),zl({text:t,options:o},i)}},Fl.prototype.getEditingBBox=function(e,t){var n=this._canvas,i=Ll(e),r=e.label||e,o=this._canvas.getAbsoluteBBox(r),a=o.x+o.width/2,s=(o.y,o.height,{x:o.x,y:o.y}),c={},u=n.zoom();return Dl(e)&&(s.height=50,s.width=200,s.y-=30,c.textAlign="left"),Bl(i,"cmmn:PlanFragment")&&!Dl(e)&&(s.width=e.width,s.maxHeight=48,s.y+=5,c.textAlign="left"),(Bl(i,"cmmn:Task")||Bl(i,"cmmn:Milestone"))&&(u>1?(s.width=o.width,s.height=o.height):(s.width=o.width/u,s.height=o.height/u),u<1&&(s.x=o.x-(s.width/2-o.width/2),s.y=o.y-(s.height/2-o.height/2))),Bl(e,"cmmn:TextAnnotation")&&(s.width=o.width,s.height=o.height,s.minWidth=30*u,s.minHeight=10*u,c.textAlign="left"),r.labelTarget&&(s.width=150,s.minHeight=20,s.x=a-s.width/2),{bounds:s,style:c}},Fl.prototype.update=function(e,t){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t})};var Hl={};Object.defineProperty(Hl,"__esModule",{value:!0}),Hl.default=Gl;var Ul=Math.min,Wl=Math.max;function Vl(e){e.preventDefault()}function ql(e){e.stopPropagation()}function Gl(e){this.container=e.container,this.parent=(0,st.domify)('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=(0,st.query)("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=(0,l.bind)(this.autoResize,this),this.handlePaste=(0,l.bind)(this.handlePaste,this)}Gl.prototype.create=function(e,t,n,i){var r=this.parent,o=this.content,a=this.container;i=this.options=i||{},t=this.style=t||{};var s=(0,l.pick)(t,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);(0,l.assign)(r.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},s);var c=(0,l.pick)(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return(0,l.assign)(o.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},c),i.centerVertically&&(0,l.assign)(o.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},c),o.innerText=n,st.event.bind(o,"keydown",this.keyHandler),st.event.bind(o,"mousedown",ql),st.event.bind(o,"paste",this.handlePaste),i.autoResize&&st.event.bind(o,"input",this.autoResize),i.resizable&&this.resizable(t),a.appendChild(r),this.setSelection(o.lastChild,o.lastChild&&o.lastChild.length),r},Gl.prototype.handlePaste=function(e){var t,n,i=this,r=this.options,o=this.style;if(e.preventDefault(),t=e.clipboardData?e.clipboardData.getData("text/plain"):window.clipboardData.getData("Text"),!document.execCommand("insertHTML",!1,t)){var a,s,c=this.getSelection(),u=c.startContainer,l=c.endContainer,d=c.startOffset,p=c.endOffset,f=c.commonAncestorContainer,h=(n=f.childNodes,[].slice.call(n));if(f.nodeType===Node.TEXT_NODE){var m=u.textContent;u.textContent=m.substring(0,d)+t+m.substring(p),a=u,s=d+t.length}else if(u===this.content&&l===this.content){var y=document.createTextNode(t);this.content.insertBefore(y,h[d]),a=y,s=y.textContent.length}else{var v=h.indexOf(u),g=h.indexOf(l);h.forEach(function(e,n){n===v?e.textContent=u.textContent.substring(0,d)+t+l.textContent.substring(p):n>v&&n<=g&&(0,st.remove)(e)}),a=u,s=d+t.length}a&&void 0!==s&&setTimeout(function(){i.setSelection(a,s)})}if(r.autoResize){var _=this.autoResize(o);_&&this.resizeHandler(_)}},Gl.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n){var i=e.getBoundingClientRect(),r=t.scrollHeight;e.style.height=r+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:r-i.height})}},Gl.prototype.resizable=function(){var e=this,t=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,r=parseInt(this.style.minHeight)||0,o=parseInt(this.style.maxWidth)||1/0,a=parseInt(this.style.maxHeight)||1/0;if(!n){var s,c,u,d;n=this.resizeHandle=(0,st.domify)('<div class="djs-direct-editing-resize-handle"></div>');var p=function(n){Vl(n),ql(n);var l=Ul(Wl(u+n.clientX-s,i),o),p=Ul(Wl(d+n.clientY-c,r),a);t.style.width=l+"px",t.style.height=p+"px",e.resizeHandler({width:u,height:d,dx:n.clientX-s,dy:n.clientY-c})},f=function e(t){Vl(t),ql(t),st.event.unbind(document,"mousemove",p,!1),st.event.unbind(document,"mouseup",e,!1)};st.event.bind(n,"mousedown",function(e){Vl(e),ql(e),s=e.clientX,c=e.clientY;var n=t.getBoundingClientRect();u=n.width,d=n.height,st.event.bind(document,"mousemove",p),st.event.bind(document,"mouseup",f)})}(0,l.assign)(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(n)},Gl.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),st.event.unbind(t,"keydown",this.keyHandler),st.event.unbind(t,"mousedown",ql),st.event.unbind(t,"input",this.autoResize),st.event.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),(0,st.remove)(n)),(0,st.remove)(e)},Gl.prototype.getValue=function(){return this.content.innerText},Gl.prototype.getSelection=function(){return window.getSelection().getRangeAt(0)},Gl.prototype.setSelection=function(e,t){var n=document.createRange();null===e?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)};var Kl={};Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.default=Xl;var Yl=function(e){return e&&e.__esModule?e:{default:e}}(Hl);function Xl(e,t){this._eventBus=e,this._providers=[],this._textbox=new Yl.default({container:t.getContainer(),keyHandler:(0,l.bind)(this._handleKey,this),resizeHandler:(0,l.bind)(this._handleResize,this)})}Xl.$inject=["eventBus","canvas"],Xl.prototype.registerProvider=function(e){this._providers.push(e)},Xl.prototype.isActive=function(){return!!this._active},Xl.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())},Xl.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})},Xl.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0},Xl.prototype.complete=function(){var e=this._active;if(e){var t=this.getValue(),n=this.$textbox.getBoundingClientRect();(t!==e.context.text||this.resizable)&&e.provider.update(e.element,t,e.context.text,{x:n.top,y:n.left,width:n.width,height:n.height}),this._fire("complete"),this.close()}},Xl.prototype.getValue=function(){return this._textbox.getValue()},Xl.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;return 27===t?(e.preventDefault(),this.cancel()):13!==t||e.shiftKey?void 0:(e.preventDefault(),this.complete())},Xl.prototype._handleResize=function(e){this._fire("resize",e)},Xl.prototype.activate=function(e){var t;this.isActive()&&this.cancel();var n=(0,l.find)(this._providers,function(n){return(t=n.activate(e))?n:null});return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:n},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};var Zl={};Object.defineProperty(Zl,"__esModule",{value:!0});var Ql=ed(sa),Jl=ed(Kl);function ed(e){return e&&e.__esModule?e:{default:e}}Zl.default={__depends__:[Ql.default],__init__:["directEditing"],directEditing:["type",Jl.default]};var td={};function nd(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[]},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}Object.defineProperty(td,"__esModule",{value:!0}),td.default=nd,nd.$inject=["eventBus","injector"],nd.prototype.execute=function(e,t){if(!e)throw new Error("command required");var n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction(n)},nd.prototype.canExecute=function(e,t){var n={command:e,context:t},i=this._getHandler(e),r=this._fire(e,"canExecute",n);if(void 0===r){if(!i)return!1;i.canExecute&&(r=i.canExecute(t))}return r},nd.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,!1!==e&&this._fire("changed")},nd.prototype.undo=function(){var e,t=this._getUndoAction();if(t){for(this._pushAction(t);t&&(this._internalUndo(t),(e=this._getUndoAction())&&e.id===t.id);)t=e;this._popAction()}},nd.prototype.redo=function(){var e,t=this._getRedoAction();if(t){for(this._pushAction(t);t&&(this._internalExecute(t,!0),(e=this._getRedoAction())&&e.id===t.id);)t=e;this._popAction()}},nd.prototype.register=function(e,t){this._setHandler(e,t)},nd.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");var n=this._injector.instantiate(t);this.register(e,n)},nd.prototype.canUndo=function(){return!!this._getUndoAction()},nd.prototype.canRedo=function(){return!!this._getRedoAction()},nd.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]},nd.prototype._getUndoAction=function(){return this._stack[this._stackIdx]},nd.prototype._internalUndo=function(e){var t=this,n=e.command,i=e.context,r=this._getHandler(n);this._atomicDo(function(){t._fire(n,"revert",e),r.revert&&t._markDirty(r.revert(i)),t._revertedAction(e),t._fire(n,"reverted",e)})},nd.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);var i,r,o,a=t?[e+"."+t,t]:[e];for(n=this._eventBus.createEvent(n),i=0;(r=a[i])&&(o=this._eventBus.fire("commandStack."+r,n),!n.cancelBubble);i++);return o},nd.prototype._createId=function(){return this._uid++},nd.prototype._atomicDo=function(e){var t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}},nd.prototype._internalExecute=function(e,t){var n=this,i=e.command,r=e.context,o=this._getHandler(i);if(!o)throw new Error("no command handler registered for <"+i+">");this._pushAction(e),t||(this._fire(i,"preExecute",e),o.preExecute&&o.preExecute(r),this._fire(i,"preExecuted",e)),this._atomicDo(function(){n._fire(i,"execute",e),o.execute&&n._markDirty(o.execute(r)),n._executedAction(e,t),n._fire(i,"executed",e)}),t||(this._fire(i,"postExecute",e),o.postExecute&&o.postExecute(r),this._fire(i,"postExecuted",e)),this._popAction(e)},nd.prototype._pushAction=function(e){var t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)},nd.prototype._popAction=function(){var e=this._currentExecution,t=e.actions,n=e.dirty;t.pop(),t.length||(this._eventBus.fire("elements.changed",{elements:(0,l.uniqueBy)("id",n)}),n.length=0,this._fire("changed"))},nd.prototype._markDirty=function(e){var t=this._currentExecution;e&&(e=(0,l.isArray)(e)?e:[e],t.dirty=t.dirty.concat(e))},nd.prototype._executedAction=function(e,t){var n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)},nd.prototype._revertedAction=function(e){this._stackIdx--},nd.prototype._getHandler=function(e){return this._handlerMap[e]},nd.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};var id={};Object.defineProperty(id,"__esModule",{value:!0});var rd=function(e){return e&&e.__esModule?e:{default:e}}(td);id.default={commandStack:["type",rd.default]};var od={};function ad(e,t,n,i){e.on("element.changed",function(i){var r=i.element;(r.parent||r===t.getRootElement())&&(i.gfx=n.getGraphics(r)),i.gfx&&e.fire((0,Tr.getType)(r)+".changed",i)}),e.on("elements.changed",function(t){var n=t.elements;n.forEach(function(t){e.fire("element.changed",{element:t})}),i.updateContainments(n)}),e.on("shape.changed",function(e){i.update("shape",e.element,e.gfx)}),e.on("connection.changed",function(e){i.update("connection",e.element,e.gfx)})}Object.defineProperty(od,"__esModule",{value:!0}),od.default=ad,ad.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];var sd={};Object.defineProperty(sd,"__esModule",{value:!0});var cd=function(e){return e&&e.__esModule?e:{default:e}}(od);sd.default={__init__:["changeSupport"],changeSupport:["type",cd.default]};var ud={__depends__:[id.default,sd.default,Zl.default],__init__:["labelEditingProvider"],labelEditingProvider:["type",$l]},ld=l.map,dd=l.assign,pd=l.pick,fd=J.isAny;function hd(e){this._model=e}hd.$inject=["moddle"],hd.prototype._needsId=function(e){return fd(e,["cmmn:CMMNElement","cmmndi:CMMNShape","cmmndi:CMMNEdge","cmmndi:CMMNStyle","cmmndi:CMMNDiagram"])},hd.prototype._ensureId=function(e){var t=(e.$type||"").replace(/^[^:]*:/g,"")+"_";!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))},hd.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n},hd.prototype.createDiLabel=function(){return this.create("cmmndi:CMMNLabel")},hd.prototype.createDiShape=function(e,t,n){return this.create("cmmndi:CMMNShape",dd({cmmnElementRef:e,bounds:this.createDiBounds(t),label:this.createDiLabel()},n))},hd.prototype.createDiEdge=function(e,t,n){return this.create("cmmndi:CMMNEdge",dd({cmmnElementRef:e,label:this.createDiLabel()},n))},hd.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)},hd.prototype.createDiWaypoints=function(e){var t=this;return ld(e,function(e){return t.createDiWaypoint(e)})},hd.prototype.createDiWaypoint=function(e){return this.create("dc:Point",pd(e,["x","y"]))},hd.prototype.createItem=function(e,t){var n=this.create(t);return this.create(e,{definitionRef:n})},hd.prototype.createCriterion=function(e,t){return(t=t||{}).sentryRef||(t=dd({sentryRef:this.createSentry()},t)),this.create(e,t)},hd.prototype.createSentry=function(e){return this.create("cmmn:Sentry",e)},hd.prototype.createCasePlanModel=function(){var e=this.create("cmmn:Stage");this._model.ids.unclaim(e.id),e.id=this._model.ids.nextPrefixed("CasePlanModel_",e);var t=this.create("cmmn:Case",{casePlanModel:e});return e.$parent=t,e},hd.prototype.createCaseFileModel=function(e){var t=this.create("cmmn:CaseFile");return this._model.ids.unclaim(t.id),t.id=this._model.ids.nextPrefixed("CaseFileModel_",t),t.$parent=e,t},hd.prototype.createCaseFileItem=function(e){return(e=e||{}).definitionRef||(e=dd({definitionRef:this.create("cmmn:CaseFileItemDefinition")},e)),this.create("cmmn:CaseFileItem",e)};var md=hd,yd={};function vd(){}Object.defineProperty(yd,"__esModule",{value:!0}),yd.default=vd,vd.prototype.layoutConnection=function(e,t){return[(t=t||{}).connectionStart||(0,dc.getMid)(e.source),t.connectionEnd||(0,dc.getMid)(e.target)]};var gd={};Object.defineProperty(gd,"__esModule",{value:!0}),gd.repairConnection=function(e,t,n,i,r,o){(0,l.isArray)(n)&&(r=n,o=i,n=(0,dc.getMid)(e),i=(0,dc.getMid)(t));var a;o=(0,l.assign)({preferredLayouts:[]},o),r=r||[],-1!==o.preferredLayouts.indexOf("straight")&&(a=kd(e,t,n,i,o));a||(o.connectionEnd?a=(a=Ad(t,e,i,r.slice().reverse()))&&a.reverse():o.connectionStart?a=Ad(e,t,n,r):r&&r.length&&(a=r));a||(a=Rd(e,t,n,i,o));return a};var _d=20,xd=5,bd=Math.round,Ed=20,wd={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function Md(e,t,n){var i,r,o,a=(0,dc.getOrientation)(t,e,xd),s=n.split(":")[0],c=bd((t.x-e.x)/2+e.x),u=bd((t.y-e.y)/2+e.y),l=(o=a,{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[s].test(o)),d=/h|r|l/.test(s),p=!1;return l?(i=d?{x:c,y:e.y}:{x:e.x,y:u},r=d?"h:h":"v:v"):(r=d?"h:v":"v:h",function(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}(a,s)?d?(p=u===e.y,i={x:e.x+_d*(/l/.test(s)?-1:1),y:p?u+_d:u}):i={x:(p=c===e.x)?c+_d:c,y:e.y+_d*(/t/.test(s)?-1:1)}:i={x:c,y:u}),{waypoints:Cd(e,i,r).concat(i),directions:r,turnNextDirections:p}}function Sd(e){return e.split(":").reverse().join(":")}function Cd(e,t,n){if(!function(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}(n=n||"h:h"))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(Od(n)){var i=function(e,t,n){return Md(e,t,n)}(e,t,n),r=function(e,t,n){var i=Md(t,e,Sd(n));return{waypoints:i.waypoints.slice().reverse(),directions:Sd(i.directions),turnNextDirections:i.turnNextDirections}}(e,t,n),o=function(e,t){var n=e.directions.split(":")[1],i=t.directions.split(":")[0];e.turnNextDirections&&(n="h"==n?"v":"h"),t.turnNextDirections&&(i="h"==i?"v":"h");var r=n+":"+i;return{waypoints:Cd(e.waypoints[e.waypoints.length-1],t.waypoints[0],r),directions:r}}(i,r);return[].concat(i.waypoints,o.waypoints,r.waypoints)}return function(e,t,n){var i=bd((t.x-e.x)/2+e.x),r=bd((t.y-e.y)/2+e.y);if("h:v"===n)return[{x:t.x,y:e.y}];if("v:h"===n)return[{x:e.x,y:t.y}];if("h:h"===n)return[{x:i,y:e.y},{x:i,y:t.y}];if("v:v"===n)return[{x:e.x,y:r},{x:t.x,y:r}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}(e,t,n)}function Pd(e,t,n){var i=Cd(e,t,n);return i.unshift(e),i.push(t),Nd(i)}function Rd(e,t,n,i,r){var o=r&&r.preferredLayouts||[],a=(0,l.without)(o,"straight")[0]||"h:h",s=wd[a]||0,c=(0,dc.getOrientation)(e,t,s),u=function(e,t){if(Od(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}(c,a);n=n||(0,dc.getMid)(e),i=i||(0,dc.getMid)(t);var d=u.split(":");return Pd(jd(n,e,d[0],function(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}(c)),jd(i,t,d[1],c),u)}function Td(e,t,n){return function(e,t,n){return e>=t&&e<=n}(t[e],n[e],n[e]+n[{x:"width",y:"height"}[e]])}function kd(e,t,n,i,r){var o,a,s={};return a=(0,dc.getOrientation)(e,t),/^(top|bottom|left|right)$/.test(a)?(/top|bottom/.test(a)&&(o="x"),/left|right/.test(a)&&(o="y"),"target"===r.preserveDocking?Td(o,i,e)?(s[o]=i[o],[{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y,original:{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y}},{x:i.x,y:i.y}]):null:Td(o,n,t)?(s[o]=n[o],[{x:n.x,y:n.y},{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y,original:{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y}}]):null):null}function Ad(e,t,n,i){if(function(e,t,n){return n.length<3||!(n.length>4)&&!!(0,l.find)(n,function(e,t){var i=n[t-1];return i&&(0,Ts.pointDistance)(e,i)<3})}(0,0,i))return null;var r,o=i[0],a=i.slice();return a[0]=n,a[1]=function(e,t,n){switch((0,Ts.pointsAligned)(t,e)){case"v":return{x:e.x,y:n.y};case"h":return{x:n.x,y:e.y}}return{x:e.x,y:e.y}}(a[1],o,n),(r=function(e,t,n){var i;for(i=e.length-2;0!==i;i--)if((0,Ts.pointInRect)(e[i],t,Ed)||(0,Ts.pointInRect)(e[i],n,Ed))return e.slice(i);return e}(a,e,t))!==a?Ad(e,t,n,r):a}function Od(e){return e&&/t|r|b|l/.test(e)}function jd(e,t,n,i){if("h"===n&&(n=/left/.test(i)?"l":"r"),"v"===n&&(n=/top/.test(i)?"t":"b"),"t"===n)return{original:e,x:e.x,y:t.y};if("r"===n)return{original:e,x:t.x+t.width,y:e.y};if("b"===n)return{original:e,x:e.x,y:t.y+t.height};if("l"===n)return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+n+">")}function Nd(e){return e.reduce(function(t,n,i){var r=t[t.length-1],o=e[i+1];return(0,Ts.pointsOnLine)(r,o,n,0)||t.push(n),t},[])}var Id=yd.default,Dd=dc.getMid;function Bd(){}u(Bd,Id);var Ld=Bd;function zd(e,t){return e?e.original||e:Dd(t)}Bd.prototype.layoutConnection=function(e,t){t=t||{};var n=e.source,i=e.target,r=e.waypoints,o=t.connectionStart,a=t.connectionEnd;return o||(o=zd(r&&r[0],n)),a||(a=zd(r&&r[r.length-1],i)),gd.repairConnection(n,i,o,a,r,t)||[o,a]};var Fd=l.assign,$d=ds.default,Hd=e.getBusinessObject,Ud=e.is,Wd=e.isCasePlanModel,Vd=J.getParent,qd=J.isLabel,Gd=J.isAny;function Kd(e,t,n,i){$d.call(this,e),this._cmmnFactory=t,this._itemRegistry=n;var r=this;function o(e){var t=e.context.shape;r.updateBounds(t)}function a(e){r.updateConnection(e.context)}function s(e){r.updateConnectionWaypoints(e.context.connection)}function c(e){r.updateAttachment(e.context)}function u(e){var t=e.context.shape,i=Hd(t);n.add(i)}function l(e){var t=e.context.shape;if(!qd(t)){var i=Hd(t);n.remove(i)}}this.executed(["connection.layout","connection.create","connection.reconnectEnd","connection.reconnectStart"],function(e){var t,n=e.context;n.cropped||((t=n.connection).waypoints=i.getCroppedWaypoints(t),n.cropped=!0)}),this.reverted(["connection.layout","connection.create","connection.reconnectEnd","connection.reconnectStart"],function(e){delete e.context.cropped}),this.executed(["shape.create","shape.move","shape.delete","connection.delete","connection.create"],Xd(function(e){var t=e.context;r.updateParent(t.shape||t.connection,t.oldParent)})),this.reverted(["shape.create","shape.move","shape.delete","connection.delete","connection.create"],Xd(function(e){var t=e.context,n=t.shape||t.connection,i=t.parent||t.newParent;r.updateParent(n,i)})),this.executed(["shape.create","shape.move","shape.resize"],Xd(function(e){"label"!==e.context.shape.type&&o(e)})),this.reverted(["shape.create","shape.move","shape.resize"],Xd(function(e){"label"!==e.context.shape.type&&o(e)})),e.on("shape.changed",function(e){"label"===e.element.type&&o({context:{shape:e.element}})}),this.executed(["connection.create","connection.move","connection.delete","connection.reconnectEnd","connection.reconnectStart"],Xd(a)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnectEnd","connection.reconnectStart"],Xd(a)),this.executed(["connection.create","connection.layout","connection.move","connection.reconnectStart","connection.reconnectEnd","connection.updateWaypoints"],Xd(s)),this.reverted(["connection.create","connection.layout","connection.move","connection.reconnectStart","connection.reconnectEnd","connection.updateWaypoints"],Xd(s)),this.executed(["element.updateAttachment"],Xd(c)),this.reverted(["element.updateAttachment"],Xd(c)),this.executed("shape.create",Xd(u)),this.reverted("shape.create",Xd(l)),this.executed("shape.delete",Xd(l)),this.reverted("shape.delete",Xd(u))}u(Kd,$d);var Yd=Kd;function Xd(e){return function(t){var n=t.context,i=n.shape||n.connection;(Ud(i,"cmmn:CMMNElement")||Ud(i,"cmmndi:CMMNDiagramElement"))&&e(t)}}function Zd(e){return Vd(e,"cmmn:Definitions")}Kd.$inject=["eventBus","cmmnFactory","itemRegistry","connectionDocking"],Kd.prototype.updateAttachment=function(e){var t=e.shape,n=Hd(t),i=t.host,r=i&&Hd(i);this.updateSemanticParent(n,r)},Kd.prototype.updateParent=function(e,t){if(!qd(e)){var n,i=Hd(e),r=Hd(e.parent),o=i.di||i,a=r&&r.di;(n=(n=i).businessObject||n).cmmnElementRef&&Ud(n.cmmnElementRef,"cmmn:Association")&&(i=i.cmmnElementRef),function(e){return!Gd(e,["cmmn:CaseFileItem","cmmn:Criterion","cmmn:DiscretionaryItem","cmmn:OnPart","cmmndi:CMMNEdge"])}(i)&&this.updateSemanticParent(i,r),Ud(r,"cmmndi:CMMNDiagram")&&(a=r),this.updateDiParent(o,a)}},Kd.prototype.updateSemanticParent=function(e,t){var n;if(e.$parent!==t){if(Ud(e,"cmmn:PlanItem")?(n="planItems",t&&!Wd(t)&&(t=t.definitionRef)):Wd(e)?(n="cases",e=e.$parent,t=t&&Zd(t)):Ud(e,"cmmn:EntryCriterion")?(Wd(t)&&(t=null),n="entryCriteria"):Ud(e,"cmmn:ExitCriterion")?n="exitCriteria":Ud(e,"cmmn:Artifact")&&(t=t&&Zd(t),n="artifacts"),!n)throw new Error("no parent for ",e,t);var i;e.$parent&&(i=e.$parent.get(n),Cn.remove(i,e)),t?((i=t.get(n)).push(e),e.$parent=t):e.$parent=null}},Kd.prototype.updateDiParent=function(e,t){if(t&&!Ud(t,"cmmndi:CMMNDiagram")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("diagramElements");t?(n.push(e),e.$parent=t):(Cn.remove(n,e),e.$parent=null)}},Kd.prototype.updateBounds=function(e){var t=e.businessObject.di||e.businessObject,n=qd(e)?this._getLabel(t).bounds:t.bounds;Fd(n,{x:e.x,y:e.y,width:e.width,height:e.height})},Kd.prototype.updateConnectionWaypoints=function(e){e.businessObject.set("waypoint",this._cmmnFactory.createDiWaypoints(e.waypoints))},Kd.prototype.updateConnection=function(e){var t,n,i,r,o,a=e.connection,s=Hd(a),c=Hd(a.source),u=Hd(a.target),l=s.cmmnElementRef;Ud(l,"cmmn:Association")?(t=l,n=l,i="sourceRef",r="targetRef"):(n=s,r="targetCMMNElementRef",Ud(l,"cmmn:OnPart")?(t=l,i="sourceRef",Ud(c,"cmmn:ExitCriterion")&&(c=Vd(o=c)),l.exitCriterionRef!==o&&(l.exitCriterionRef=o)):(t=s,i="sourceCMMNElementRef"));i&&t[i]!==c&&(t[i]=c),r&&n[r]!==u&&(n[r]=u),this.updateConnectionWaypoints(a)},Kd.prototype._getLabel=function(e){return e.label||(e.label=this._cmmnFactory.createDiLabel()),e.label.bounds||(e.label.bounds=this._cmmnFactory.createDiBounds()),e.label};var Qd=l.assign,Jd=Ur.default,ep=e.is,tp=e.getDefinition,np=e.isCasePlanModel,ip=ye.isCollapsed;function rp(e,t){Jd.call(this),this._cmmnFactory=e,this._moddle=t}u(rp,Jd),rp.$inject=["cmmnFactory","moddle"];var op=rp;rp.prototype.baseCreate=Jd.prototype.create,rp.prototype.create=function(e,t){return"label"===e?this.baseCreate(e,Qd({type:"label"},un.DEFAULT_LABEL_SIZE,t)):"root"===e?this.baseCreate(e,t):this.createCmmnElement(e,t)},rp.prototype.createCmmnElement=function(e,t){var n,i=(t=t||{}).businessObject;if(!i){if(!t.type)throw new Error("no shape type specified");var r={};t.name&&Qd(r,{name:t.name}),i=this._cmmnFactory.create(t.type,r)}if("connection"===e&&(ep(i,"cmmndi:CMMNEdge")||(i=this._cmmnFactory.createDiEdge(i,[],{id:i.id+"_di"})),i.label||(i.label=this._cmmnFactory.createDiLabel()),t.type="cmmndi:CMMNEdge"),t.definitionType){var o=this._cmmnFactory.create(t.definitionType);i.definitionRef=o}return t.sentryRef&&(i.sentryRef=t.sentryRef),"shape"!==e||i.di||(i.di=this._cmmnFactory.createDiShape(i,{},{id:i.id+"_di"})),t.isCollapsed&&(i.di.isCollapsed=t.isCollapsed),t.isPlanningTableCollapsed&&(i.di.isPlanningTableCollapsed=t.isPlanningTableCollapsed),t.isStandardEventVisible&&(i.isStandardEventVisible=t.isStandardEventVisible),void 0!==t.isBlocking&&(i.definitionRef.isBlocking=t.isBlocking),t.autoComplete&&(i.definitionRef.autoComplete=!0),n=this._getDefaultSize(i),t=Qd({businessObject:i,id:i.id},n,t),this.baseCreate(e,t)},rp.prototype._getDefaultSize=function(e){var t=tp(e);return np(e)?{width:400,height:250}:ep(t,"cmmn:PlanFragment")?ip(e)?{width:100,height:80}:{width:350,height:200}:ep(t,"cmmn:Milestone")?{width:100,height:40}:ep(t,"cmmn:EventListener")?{width:36,height:36}:ep(e,"cmmn:Criterion")?{width:20,height:28}:ep(e,"cmmn:TextAnnotation")?{width:100,height:30}:ep(e,"cmmn:CaseFileItem")?{width:36,height:50}:{width:100,height:80}},rp.prototype.createPlanItemShape=function(e){return this.createShape({type:"cmmn:PlanItem",businessObject:this._cmmnFactory.createItem("cmmn:PlanItem",e)})},rp.prototype.createDiscretionaryItemShape=function(e){return this.createShape({type:"cmmn:DiscretionaryItem",businessObject:this._cmmnFactory.createItem("cmmn:DiscretionaryItem",e)})},rp.prototype.createCasePlanModelShape=function(){return this.createShape({type:"cmmn:Stage",businessObject:this._cmmnFactory.createCasePlanModel()})},rp.prototype.createCriterionShape=function(e){return this.createShape({type:e,businessObject:this._cmmnFactory.createCriterion(e)})},rp.prototype.createCaseFileItemShape=function(){return this.createShape({type:"cmmn:CaseFileItem",businessObject:this._cmmnFactory.createCaseFileItem()})};var ap={};function sp(e){this._modeling=e}Object.defineProperty(ap,"__esModule",{value:!0}),ap.default=sp,sp.$inject=["modeling"],sp.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var n=e.target||t.parent,i=e.shape;i=e.shape=this._modeling.createShape(i,e.position,n,{attach:e.attach}),e.shape=i},sp.prototype.postExecute=function(e){var t,n,i=e.connectionParent||e.shape.parent;t=e.source,n=e.shape,(0,l.some)(t.outgoing,function(e){return e.target===n})||this._modeling.connect(e.source,e.shape,e.connection,i)};var cp=e.is;function up(e,t){this._modeling=e,this._cmmnRules=t}u(up,ap.default),up.$inject=["modeling","cmmnRules"];var lp=up;function dp(e){this._moddle=e}up.prototype.preExecute=function(e){if(!e.source)throw new Error("source required");var t=this._cmmnRules,n=e.shape,i=e.source,r=e.target||e.source.parent,o=e.position,a=e.attach;cp(n,"cmmn:Criterion")&&(a="attach"===t.canAttach(n,r,i,o)),e.shape=this._modeling.createShape(n,o,r,{attach:a,nested:!0})},dp.$inject=["moddle"];var pp=dp;dp.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element;e.claiming?t.claim(n,i):t.unclaim(n)},dp.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element;e.claiming?t.unclaim(n):t.claim(n,i)};var fp={};function hp(){}Object.defineProperty(fp,"__esModule",{value:!0}),fp.default=hp,hp.$inject=[],hp.prototype.execute=function(e){var t,n=e.newSource,i=e.newTarget,r=e.connection,o=e.dockingOrPoints,a=r.waypoints;if(!n&&!i)throw new Error("newSource or newTarget are required");if(n&&i)throw new Error("must specify either newSource or newTarget");return e.oldWaypoints=a,(0,l.isArray)(o)?t=o:(t=a.slice()).splice(n?0:-1,1,o),n&&(e.oldSource=r.source,r.source=n),i&&(e.oldTarget=r.target,r.target=i),r.waypoints=t,r},hp.prototype.revert=function(e){var t=e.newSource,n=e.newTarget,i=e.connection;return t&&(i.source=e.oldSource),n&&(i.target=e.oldTarget),i.waypoints=e.oldWaypoints,i};var mp=l.isArray;function yp(e){this._rules=e}u(yp,fp.default),yp.$inject=["rules"];var vp=yp;yp.prototype.execute=function(e){var t,n=e.newSource,i=e.newTarget,r=e.connection,o=e.dockingOrPoints,a=r.waypoints;if(!n&&!i)throw new Error("newSource or newTarget are required");return e.oldWaypoints=a,mp(o)?t=o:(t=a.slice()).splice(n?0:-1,1,o),n&&(e.oldSource=r.source,r.source=n),i&&(e.oldTarget=r.target,r.target=i),r.waypoints=t,r};var gp={};function _p(e,t){this._modeling=e,this._rules=t}function xp(e,t){this._modeling=e,this._rules=t}Object.defineProperty(gp,"__esModule",{value:!0}),gp.default=_p,_p.$inject=["modeling","rules"],_p.prototype.preExecute=function(e){var t,n=this,i=this._modeling,r=this._rules,o=e.oldShape,a=e.newData,s=e.hints;function c(e,t,n,i){return r.allowed(e,{source:t,target:n,connection:i})}var u,d={x:a.x,y:a.y};t=e.newShape=e.newShape||n.createShape(a,d,o.parent,s),o.host&&i.updateAttachment(t,o.host),!1!==s.moveChildren&&(u=o.children.slice(),i.moveElements(u,{x:0,y:0},t));var p=o.incoming.slice(),f=o.outgoing.slice();(0,l.forEach)(p,function(e){var i=e.waypoints,r=i[i.length-1];c("connection.reconnectEnd",e.source,t,e)&&n.reconnectEnd(e,t,r)}),(0,l.forEach)(f,function(e){var i=e.waypoints[0],r=e.target;c("connection.reconnectStart",t,r,e)&&n.reconnectStart(e,t,i)})},_p.prototype.postExecute=function(e){var t=this._modeling,n=e.oldShape,i=e.newShape;(0,l.forEach)(i.incoming,function(e){t.layoutConnection(e,{endChanged:!0})}),(0,l.forEach)(i.outgoing,function(e){t.layoutConnection(e,{startChanged:!0})}),t.removeShape(n)},_p.prototype.execute=function(e){},_p.prototype.revert=function(e){},_p.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)},_p.prototype.reconnectStart=function(e,t,n){this._modeling.reconnectStart(e,t,n)},_p.prototype.reconnectEnd=function(e,t,n){this._modeling.reconnectEnd(e,t,n)},u(xp,gp.default),xp.$inject=["modeling","rules"];var bp=xp;xp.prototype.createShape=function(e,t,n){return this._modeling.createShape(e,t,n,{nested:!0})},xp.prototype.reconnectStart=function(e,t,n){this._modeling.reconnectStart(e,t,n,{nested:!0,startChanged:!0})},xp.prototype.reconnectEnd=function(e,t,n){this._modeling.reconnectEnd(e,t,n,{nested:!0,endChanged:!0})};var Ep=l.filter,wp=l.forEach,Mp=e.getBusinessObject,Sp=e.getItemControl,Cp=e.getDefaultControl,Pp=e.getDefinition,Rp=e.hasPlanningTable,Tp=Ac.isPlanningTableCapable;function kp(e,t,n,i){this._itemRegistry=e,this._modeling=t,this._cmmnReplace=n,this._cmmnFactory=i}kp.$inject=["itemRegistry","modeling","cmmnReplace","cmmnFactory"];var Ap=kp,Op=["requiredRule","repetitionRule","manualActivationRule"];function jp(e,t){var n={};return n[e]=t,n}function Np(e){return!(Tp(e)&&Rp(e))}kp.prototype.preExecute=function(e){var t=this,n=e.element,i=e.values;if(!n)throw new Error("element required");wp(i,function(e,i){-1!==Op.indexOf(i)?t._updateRule(n,i,e):t._updateDecorator(n,i,e)})},kp.prototype.execute=function(){},kp.prototype.revert=function(){},kp.prototype._updateDecorator=function(e,t,n){var i=this._modeling,r=Pp(e),o=jp(t,n),a=[];r[t]!==n&&((a=this._getReferencingShapes(r)).length>1&&Np(r)&&(r=this._replaceDefinition(e),a=e),i.updateProperties(r,o,a))},kp.prototype._updateRule=function(e,t,n){var i=this,r=i._modeling,o=i._cmmnFactory,a=Sp(e),s=Cp(e),c=Pp(e),u=jp(t,n);function l(e,t){return e&&e[t]}function d(e){return!(!e||e.repetitionRule||e.requiredRule||e.manualActivationRule)}n?function(){a||(a=o.create("cmmn:PlanItemControl"),r.updateProperties(e,{itemControl:a}),r.updateSemanticParent(a,Mp(e)));r.updateProperties(a,u,e),r.updateSemanticParent(n,a)}():function(){var n;l(a,t)&&(n=a[t],r.updateProperties(a,u,e),r.updateSemanticParent(n),d(a)&&(r.updateProperties(e,{itemControl:void 0}),r.updateSemanticParent(a)));if(l(s,t)){n=s[t];var o=i._getReferencingShapes(c);o.length>1&&Np(c)&&(o=Ep(o,function(e){var n=Sp(e),i=Cp(e);return!l(n,t)&&l(i,t)})).length>1&&(i._replaceDefinition(e),s=Cp(e),o=e),r.updateProperties(s,u,o),r.updateSemanticParent(n),d(s)&&(r.updateProperties(c,{defaultControl:void 0},o),r.updateSemanticParent(s))}}()},kp.prototype._replaceDefinition=function(e){var t=this._modeling,n=this._cmmnReplace,i=Pp(e),r=n.replacePlanItemDefinition(i);return t.updateProperties(e,{definitionRef:r}),t.updateSemanticParent(r,i.$parent,"planItemDefinitions"),r},kp.prototype._getReferencingShapes=function(e){return this._itemRegistry.getShapes(e)};var Ip=l.reduce,Dp=l.keys,Bp=l.forEach,Lp=l.assign,zp=e.getBusinessObject,Fp="id",$p="definitionRef",Hp="sentryRef",Up=l.flatten;function Wp(e,t,n){this._elementRegistry=e,this._itemRegistry=t,this._moddle=n}Wp.$inject=["elementRegistry","itemRegistry","moddle"];var Vp=Wp;function qp(e,t){return Fp in e&&e[Fp]!==t[Fp]}function Gp(e,t){return $p in e&&e[$p]!==t[$p]}function Kp(e,t){return Hp in e&&e[Hp]!==t[Hp]}function Yp(e,t){Bp(t,function(t,n){e.set(n,t)})}Wp.prototype.preExecute=function(e){var t=e.element,n=e.shape;if(!t)throw new Error("element required");var i=t.businessObject||t;e.businessObject=i;var r=[];t.businessObject&&r.push(t),n&&r.push(n),e.changed=Up(r)},Wp.prototype.execute=function(e){var t=this._elementRegistry,n=this._itemRegistry,i=this._moddle.ids,r=e.changed,o=e.element,a=e.businessObject,s=function(e){var t=Lp({},e);return Xp.forEach(function(n){n in e&&(t[n]=zp(t[n]))}),t}(e.properties),c=e.oldProperties||function(e,t){return Ip(t,function(t,n){return t[n]=e.get(n),t},{})}(a,Dp(s));if(qp(s,a)){i.unclaim(a[Fp]),n.updateId(a,s[Fp]);var u=t.get(o.id);u&&t.updateId(u,s[Fp]),i.claim(s[Fp],a)}return Gp(s,a)&&n.updateReference(a,s[$p]),Kp(s,a)&&n.updateReference(a,s[Hp]),"name"in s&&Bp(r,function(e){e.label&&r.push(e.label)}),("standardEvent"in s||"isStandardEventVisible"in s)&&Bp(r,function(e){e.label&&r.push(e.label)}),Yp(a,s),e.oldProperties=c,r},Wp.prototype.revert=function(e){var t=e.properties,n=e.oldProperties,i=e.businessObject,r=this._elementRegistry,o=this._itemRegistry,a=this._moddle.ids;if(qp(n,i)&&o.updateId(i,n[Fp]),Gp(n,i)&&o.updateReference(i,n[$p]),Kp(n,i)&&o.updateReference(i,n[Hp]),Yp(i,n),qp(t,i)){a.unclaim(t[Fp]);var s=r.get(t[Fp]);s&&r.updateId(s,n[Fp]),a.claim(n[Fp],i)}return e.changed};var Xp=["default"];var Zp=l.flatten;function Qp(){}var Jp=Qp;Qp.prototype.preExecute=function(e){var t=e.element,n=e.shape;if(!t)throw new Error("element required");var i=t.businessObject||t;e.businessObject=i,e.oldParent=i.$parent;var r=[];t.businessObject&&r.push(t),n&&r.push(n),e.changed=Zp(r)},Qp.prototype.execute=function(e){var t=e.businessObject,n=e.newParent,i=e.containment;return this.updateSemanticParent(t,n,i),e.changed},Qp.prototype.revert=function(e){var t=e.businessObject,n=e.oldParent,i=e.containment;return this.updateSemanticParent(t,n,i),e.changed},Qp.prototype.updateSemanticParent=function(e,t,n){var i;e.$parent!==t&&(e.$parent&&n&&(i=e.$parent.get(n),Cn.remove(i,e)),e.$parent=null,t&&(n&&(i=t.get(n)).push(e),e.$parent=t))};var ef={};function tf(e,t){this._modeling=e,this._canvas=t}Object.defineProperty(ef,"__esModule",{value:!0}),ef.default=tf,tf.$inject=["modeling","canvas"],tf.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,i=e.alignment;(0,l.forEach)(n,function(e){var n={x:0,y:0};i.left?n.x=i.left-e.x:i.right?n.x=i.right-e.width-e.x:i.center?n.x=i.center-Math.round(e.width/2)-e.x:i.top?n.y=i.top-e.y:i.bottom?n.y=i.bottom-e.height-e.y:i.middle&&(n.y=i.middle-Math.round(e.height/2)-e.y),t.moveElements([e],n,e.parent)})},tf.prototype.postExecute=function(e){};var nf={};function rf(e,t){this._canvas=e,this._layouter=t}Object.defineProperty(nf,"__esModule",{value:!0}),nf.default=rf,rf.$inject=["canvas","layouter"],rf.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,r=e.parent,o=e.parentIndex,a=e.hints;if(!n||!i)throw new Error("source and target required");if(!r)throw new Error("parent required");return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,a)),this._canvas.addConnection(t,r,o),t},rf.prototype.revert=function(e){var t=e.connection;this._canvas.removeConnection(t),t.source=null,t.target=null};var of={};Object.defineProperty(of,"__esModule",{value:!0}),of.default=sf;var af=Math.round;function sf(e){this._canvas=e}sf.$inject=["canvas"],sf.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,r=e.parentIndex;if(!i)throw new Error("parent required");if(!n)throw new Error("position required");return void 0!==n.width?(0,l.assign)(t,n):(0,l.assign)(t,{x:n.x-af(t.width/2),y:n.y-af(t.height/2)}),this._canvas.addShape(t,i,r),t},sf.prototype.revert=function(e){this._canvas.removeShape(e.shape)};var cf={};Object.defineProperty(cf,"__esModule",{value:!0}),cf.default=pf;var uf=df(u),lf=df(of);function df(e){return e&&e.__esModule?e:{default:e}}function pf(e){lf.default.call(this,e)}(0,uf.default)(pf,lf.default),pf.$inject=["canvas"];var ff=lf.default.prototype.execute;pf.prototype.execute=function(e){var t=e.shape;return function(e){["width","height"].forEach(function(t){void 0===e[t]&&(e[t]=0)})}(t),t.labelTarget=e.labelTarget,ff.call(this,e)};var hf=lf.default.prototype.revert;pf.prototype.revert=function(e){return e.shape.labelTarget=null,hf.call(this,e)};var mf={};function yf(e,t){this._canvas=e,this._modeling=t}Object.defineProperty(mf,"__esModule",{value:!0}),mf.default=yf,yf.$inject=["canvas","modeling"],yf.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=(0,Cn.indexOf)(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t},yf.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,(0,Cn.add)(n.children,t,i),this._canvas.addConnection(t,n),t};var vf={};function gf(e,t){this._modeling=e,this._elementRegistry=t}Object.defineProperty(vf,"__esModule",{value:!0}),vf.default=gf,gf.$inject=["modeling","elementRegistry"],gf.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry,i=e.elements;(0,l.forEach)(i,function(e){n.get(e.id)&&(e.waypoints?t.removeConnection(e):t.removeShape(e))})};var _f={};Object.defineProperty(_f,"__esModule",{value:!0}),_f.saveClear=function(e,t){if("function"!=typeof t)throw new Error("removeFn iterator must be a function");if(!e)return;var n;for(;n=e[0];)t(n);return e};var xf={};function bf(e,t){this._canvas=e,this._modeling=t}Object.defineProperty(xf,"__esModule",{value:!0}),xf.default=bf,bf.$inject=["canvas","modeling"],bf.prototype.preExecute=function(e){var t=this._modeling,n=e.shape;(0,_f.saveClear)(n.incoming,function(e){t.removeConnection(e,{nested:!0})}),(0,_f.saveClear)(n.outgoing,function(e){t.removeConnection(e,{nested:!0})}),(0,_f.saveClear)(n.children,function(e){e.waypoints?t.removeConnection(e,{nested:!0}):t.removeShape(e,{nested:!0})})},bf.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=(0,Cn.indexOf)(i.children,n),t.removeShape(n),n},bf.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,r=e.oldParentIndex;return(0,Cn.add)(i.children,n,r),t.addShape(n,i),n};var Ef={};function wf(e){this._modeling=e}Object.defineProperty(Ef,"__esModule",{value:!0}),Ef.default=wf,wf.$inject=["modeling"];var Mf={x:"y",y:"x"};wf.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,i=e.axis,r=e.dimension;function o(e,t){e.range.min=Math.min(t[i],e.range.min),e.range.max=Math.max(t[i]+t[r],e.range.max)}function a(e){return e[i]+e[r]/2}function s(e){return e.length-1}function c(e){return e.max-e.min}var u,d,p=n[0],f=s(n),h=n[f],m=0;(0,l.forEach)(n,function(e,u){var d,p,h;e.elements.length<2?u&&u!==n.length-1&&(o(e,e.elements[0]),m+=c(e.range)):(p=(d=(0,l.sortBy)(e.elements,i))[0],u===f&&(p=d[s(d)]),h=a(p),e.range=null,(0,l.forEach)(d,function(n){!function(e,n){var r={y:0};r[i]=e-a(n),r[i]&&(r[Mf[i]]=0,t.moveElements([n],r,n.parent))}(h,n),null!==e.range?o(e,n):e.range={min:n[i],max:n[i]+n[r]}}),u&&u!==n.length-1&&(m+=c(e.range)))}),d=Math.abs(h.range.min-p.range.max),(u=Math.round((d-m)/(n.length-1)))<n.length-1||(0,l.forEach)(n,function(e,o){var a,s={};e!==p&&e!==h&&(a=n[o-1],e.range.max=0,(0,l.forEach)(e.elements,function(n,o){s[Mf[i]]=0,s[i]=a.range.max-n[i]+u,e.range.min!==n[i]&&(s[i]+=n[i]-e.range.min),s[i]&&t.moveElements([n],s,n.parent),e.range.max=Math.max(n[i]+n[r],o?e.range.max:0)}))})},wf.prototype.postExecute=function(e){};var Sf={};function Cf(e,t){this._layouter=e,this._canvas=t}Object.defineProperty(Sf,"__esModule",{value:!0}),Sf.default=Cf,Cf.$inject=["layouter","canvas"],Cf.prototype.execute=function(e){var t=e.connection,n=t.waypoints;return(0,l.assign)(e,{oldWaypoints:n}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t},Cf.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t};var Pf={};function Rf(){}Object.defineProperty(Pf,"__esModule",{value:!0}),Pf.default=Rf,Rf.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldParent=o,e.oldParentIndex=(0,Cn.remove)(o.children,t),(0,Cn.add)(i.children,t,r),t.parent=i,(0,l.forEach)(t.waypoints,function(e){e.x+=n.x,e.y+=n.y,e.original&&(e.original.x+=n.x,e.original.y+=n.y)}),t},Rf.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,r=e.oldParentIndex,o=e.delta;return(0,Cn.remove)(n.children,t),(0,Cn.add)(i.children,t,r),t.parent=i,(0,l.forEach)(t.waypoints,function(e){e.x-=o.x,e.y-=o.y,e.original&&(e.original.x-=o.x,e.original.y-=o.y)}),t};var Tf={};Object.defineProperty(Tf,"__esModule",{value:!0}),Tf.getNewAttachPoint=function(e,t,n){var i=(0,Ka.center)(t),r=(0,Ka.center)(n),o=(0,Ka.delta)(e,i),a={x:o.x*(n.width/t.width),y:o.y*(n.height/t.height)};return(0,dc.roundPoint)({x:r.x+a.x,y:r.y+a.y})},Tf.getNewAttachShapeDelta=function(e,t,n){var i=(0,Ka.center)(e),r=(0,Ka.center)(t),o=(0,Ka.center)(n),a=(0,Ka.delta)(e,i),s=(0,Ka.delta)(i,r),c={x:s.x*(n.width/t.width),y:s.y*(n.height/t.height)},u={x:o.x+c.x,y:o.y+c.y};return(0,dc.roundPoint)({x:u.x+a.x-e.x,y:u.y+a.y-e.y})};var kf={};function Af(e,t,n){var i=Nf(e)[0];return(0,Tf.getNewAttachPoint)(i.original||i,n,t)}function Of(e,t,n){var i=Nf(e),r=i[i.length-1];return(0,Tf.getNewAttachPoint)(r.original||r,n,t)}function jf(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function Nf(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}Object.defineProperty(kf,"__esModule",{value:!0}),kf.getResizedSourceAnchor=Af,kf.getResizedTargetAnchor=Of,kf.getMovedSourceAnchor=function(e,t,n){return Af(e,t,jf(t,n))},kf.getMovedTargetAnchor=function(e,t,n){return Of(e,t,jf(t,n))};var If={};function Df(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}Object.defineProperty(If,"__esModule",{value:!0}),If.default=Df,Df.prototype.add=function(e,t){return this.addAll([e],t)},Df.prototype.addAll=function(e,t){var n=(0,Tr.getClosure)(e,!!t,this);return(0,l.assign)(this,n),this};var Bf={};Object.defineProperty(Bf,"__esModule",{value:!0}),Bf.default=zf;var Lf=function(e){return e&&e.__esModule?e:{default:e}}(If);function zf(e){this._modeling=e}zf.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]},zf.prototype.moveClosure=function(e,t,n,i,r){var o=this._modeling,a=e.allShapes,s=e.allConnections,c=e.enclosedConnections,u=e.topLevel,d=!1;r&&r.parent===n&&(d=!0),(0,l.forEach)(a,function(e){o.moveShape(e,t,u[e.id]&&!d&&n,{recurse:!1,layout:!1})}),(0,l.forEach)(s,function(e){var i=!!a[e.source.id],r=!!a[e.target.id];c[e.id]&&i&&r?o.moveConnection(e,t,u[e.id]&&!d&&n):o.layoutConnection(e,{connectionStart:i&&(0,kf.getMovedSourceAnchor)(e,e.source,t),connectionEnd:r&&(0,kf.getMovedTargetAnchor)(e,e.target,t)})})},zf.prototype.getClosure=function(e){return(new Lf.default).addAll(e,!0)};var Ff={};Object.defineProperty(Ff,"__esModule",{value:!0}),Ff.default=Hf;var $f=function(e){return e&&e.__esModule?e:{default:e}}(Bf);function Hf(e){this._helper=new $f.default(e)}Hf.$inject=["modeling"],Hf.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)},Hf.prototype.postExecute=function(e){var t,n=e.hints;n&&n.primaryShape&&(t=n.primaryShape,n.oldParent=t.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,t)};var Uf={};Object.defineProperty(Uf,"__esModule",{value:!0}),Uf.default=Vf;var Wf=function(e){return e&&e.__esModule?e:{default:e}}(Bf);function Vf(e){this._modeling=e,this._helper=new Wf.default(e)}Vf.$inject=["modeling"],Vf.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldBounds=(0,l.pick)(t,["x","y","width","height"]),e.oldParent=o,e.oldParentIndex=(0,Cn.remove)(o.children,t),(0,Cn.add)(i.children,t,r),(0,l.assign)(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t},Vf.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,r=this._modeling;!1!==i.layout&&((0,l.forEach)(t.incoming,function(e){r.layoutConnection(e,{connectionEnd:(0,kf.getMovedTargetAnchor)(e,t,n)})}),(0,l.forEach)(t.outgoing,function(e){r.layoutConnection(e,{connectionStart:(0,kf.getMovedSourceAnchor)(e,t,n)})})),!1!==i.recurse&&this.moveChildren(e)},Vf.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,r=e.delta;return(0,Cn.add)(n.children,t,i),(0,l.assign)(t,{parent:n,x:t.x-r.x,y:t.y-r.y}),t},Vf.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)},Vf.prototype.getNewParent=function(e){return e.newParent||e.shape.parent};var qf={};function Gf(e,t){(0,l.forEach)(t,function(t){e[t]&&delete e[t]})}function Kf(e,t,n,i,r,o){this._eventBus=e,this._canvas=t,this._selection=n,this._elementFactory=i,this._modeling=r,this._rules=o}Object.defineProperty(qf,"__esModule",{value:!0}),qf.default=Kf,Kf.$inject=["eventBus","canvas","selection","elementFactory","modeling","rules"],Kf.prototype.preExecute=function(e){var t=this._eventBus,n=this,i=e.tree,r=e.topParent,o=e.position;i.createdElements={},i.labels=[],(0,l.forEach)(i,function(e,a){var s=parseInt(a,10);isNaN(s)||(s||(e=(0,l.map)(e,function(e){return e.parent=r,e})),e=(0,l.sortBy)(e,"priority"),(0,l.forEach)(e,function(e){var a,c=e.id,u=e.parent,d={},p=(0,l.assign)({},e);if(s&&(p.parent=n._getCreatedElement(u,i)),u)if(t.fire("element.paste",{createdElements:i.createdElements,descriptor:p}),u=p.parent,p.waypoints)(p=n._createConnection(p,u,o,i))&&(i.createdElements[c]={element:p,descriptor:e});else{if(p.parent!==r&&(d.root=!1),p.host&&(d.attach=!0,u=n._getCreatedElement(p.host,i)),p.labelTarget)return i.labels.push(p);a={x:Math.round(o.x+p.delta.x+p.width/2),y:Math.round(o.y+p.delta.y+p.height/2)},Gf(p,["id","parent","delta","host","priority"]),(p=n._createShape(p,u,a,d))&&(i.createdElements[c]={element:p,descriptor:e})}}))})},Kf.prototype.postExecute=function(e){var t=this._modeling,n=this._selection,i=this,r=e.tree,o=r.labels,a=[];(0,l.forEach)(o,function(e){var n,o,a,s=i._getCreatedElement(e.labelTarget,r);s&&(n=s.labels)&&n.length&&(o={x:s.x,y:s.y},s.waypoints&&(o=s.waypoints[0]),(0,l.forEach)(n,function(n){a={x:Math.round(o.x-n.x+e.delta.x),y:Math.round(o.y-n.y+e.delta.y)},t.moveShape(n,a,s.parent)}))}),(0,l.forEach)(r[0],function(e){var t=e.id,n=r.createdElements[t];n&&a.push(n.element)}),n.select(a)},Kf.prototype._createConnection=function(e,t,n,i){var r,o,a=this._modeling,s=this._rules;return e.waypoints=(0,l.map)(e.waypoints,function(t,i){return{x:Math.round(n.x+e.delta[i].x),y:Math.round(n.y+e.delta[i].y)}}),r=this._getCreatedElement(e.source,i),o=this._getCreatedElement(e.target,i),r&&o&&s.allowed("element.paste",{source:r,target:o})?(Gf(e,["id","parent","delta","source","target","width","height","priority"]),a.createConnection(r,o,e,t)):null},Kf.prototype._createShape=function(e,t,n,i,r){var o=this._modeling,a=this._elementFactory;if(!this._rules.allowed("element.paste",{element:e,position:n,parent:t}))return null;var s=a.createShape(e);return o.createShape(s,n,t,i,r),s},Kf.prototype._getCreatedElement=function(e,t){return t.createdElements[e]&&t.createdElements[e].element};var Yf={};function Xf(e){this._modeling=e}Object.defineProperty(Yf,"__esModule",{value:!0}),Yf.default=Xf,Xf.$inject=["modeling"],Xf.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(void 0===n.x||void 0===n.y||void 0===n.width||void 0===n.height)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},(0,l.assign)(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t},Xf.prototype.postExecute=function(e){var t=e.shape,n=e.oldBounds,i=this._modeling;(0,l.forEach)(t.incoming,function(e){i.layoutConnection(e,{connectionEnd:(0,kf.getResizedTargetAnchor)(e,t,n)})}),(0,l.forEach)(t.outgoing,function(e){i.layoutConnection(e,{connectionStart:(0,kf.getResizedSourceAnchor)(e,t,n)})})},Xf.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return(0,l.assign)(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};var Zf={};Object.defineProperty(Zf,"__esModule",{value:!0}),Zf.getDirection=function(e,t){if("x"===e){if(t>0)return"e";if(t<0)return"w"}if("y"===e){if(t>0)return"s";if(t<0)return"n"}return null},Zf.resizeBounds=function(e,t,n){var i=n.x,r=n.y;switch(t){case"n":return{x:e.x,y:e.y+r,width:e.width,height:e.height-r};case"s":return{x:e.x,y:e.y,width:e.width,height:e.height+r};case"w":return{x:e.x+i,y:e.y,width:e.width-i,height:e.height};case"e":return{x:e.x,y:e.y,width:e.width+i,height:e.height};default:throw new Error("unrecognized direction: "+t)}};var Qf={};function Jf(e){this._modeling=e}Object.defineProperty(Qf,"__esModule",{value:!0}),Qf.default=Jf,Jf.$inject=["modeling"],Jf.prototype.preExecute=function(e){var t=this._modeling,n=e.resizingShapes,i=e.delta,r=e.direction;(0,l.forEach)(n,function(e){var n=(0,Zf.resizeBounds)(e,r,i);t.resizeShape(e,n)})},Jf.prototype.postExecute=function(e){var t=this._modeling,n=e.movingShapes,i=e.delta;t.moveElements(n,i,void 0,{autoResize:!1,attach:!1})},Jf.prototype.execute=function(e){},Jf.prototype.revert=function(e){};var eh={};function th(e){this._modeling=e}Object.defineProperty(eh,"__esModule",{value:!0}),eh.default=th,th.$inject=["modeling"],th.prototype.execute=function(e){var t,n=e.shape,i=n.children;return e.oldChildrenVisibility=(t={},i.forEach(function(e){t[e.id]=e.hidden}),t),n.collapsed=!n.collapsed,function(e,t){e.forEach(function(e){e.hidden=t})}(i,n.collapsed),[n].concat(i)},th.prototype.revert=function(e){var t,n=e.shape,i=e.oldChildrenVisibility,r=n.children;return t=i,r.forEach(function(e){e.hidden=t[e.id]}),n.collapsed=!n.collapsed,[n].concat(r)};var nh={};function ih(e){this._modeling=e}function rh(e,t){return(0,Cn.remove)(e&&e.attachers,t)}function oh(e,t,n){if(e){var i=e.attachers;i||(e.attachers=i=[]),(0,Cn.add)(i,t,n)}}Object.defineProperty(nh,"__esModule",{value:!0}),nh.default=ih,ih.$inject=["modeling"],ih.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=rh(i,t),oh(n,t),t.host=n,t},ih.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,r=e.attacherIdx;return t.host=i,rh(n,t),oh(i,t,r),t};var ah={};function sh(){}Object.defineProperty(ah,"__esModule",{value:!0}),ah.default=sh,sh.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t},sh.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t};var ch={};Object.defineProperty(ch,"__esModule",{value:!0});var uh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};ch.default=Oh;var lh=Ah(ap),dh=Ah(of),ph=Ah(xf),fh=Ah(Uf),hh=Ah(Yf),mh=Ah(gp),yh=Ah(eh),vh=Ah(Qf),gh=Ah(cf),_h=Ah(nf),xh=Ah(mf),bh=Ah(Pf),Eh=Ah(Sf),wh=Ah(ah),Mh=Ah(fp),Sh=Ah(Ff),Ch=Ah(vf),Ph=Ah(Ef),Rh=Ah(ef),Th=Ah(nh),kh=Ah(qf);function Ah(e){return e&&e.__esModule?e:{default:e}}function Oh(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",function(){i.registerHandlers(n)})}Oh.$inject=["eventBus","elementFactory","commandStack"],Oh.prototype.getHandlers=function(){return{"shape.append":lh.default,"shape.create":dh.default,"shape.delete":ph.default,"shape.move":fh.default,"shape.resize":hh.default,"shape.replace":mh.default,"shape.toggleCollapse":yh.default,spaceTool:vh.default,"label.create":gh.default,"connection.create":_h.default,"connection.delete":xh.default,"connection.move":bh.default,"connection.layout":Eh.default,"connection.updateWaypoints":wh.default,"connection.reconnectStart":Mh.default,"connection.reconnectEnd":Mh.default,"elements.move":Sh.default,"elements.delete":Ch.default,"elements.distribute":Ph.default,"elements.align":Rh.default,"element.updateAttachment":Th.default,"elements.paste":kh.default}},Oh.prototype.registerHandlers=function(e){(0,l.forEach)(this.getHandlers(),function(t,n){e.registerHandler(n,t)})},Oh.prototype.moveShape=function(e,t,n,i,r){"object"===(void 0===i?"undefined":uh(i))&&(r=i,i=null);var o={shape:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("shape.move",o)},Oh.prototype.updateAttachment=function(e,t){var n={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",n)},Oh.prototype.moveElements=function(e,t,n,i){var r,o=(i=i||{}).attach,a=n;!0===o?(r=n,a=n.parent):!1===o&&(r=null);var s={shapes:e,delta:t,newParent:a,newHost:r,hints:i};this._commandStack.execute("elements.move",s)},Oh.prototype.moveConnection=function(e,t,n,i,r){"object"===(void 0===i?"undefined":uh(i))&&(r=i,i=void 0);var o={connection:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("connection.move",o)},Oh.prototype.layoutConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",n)},Oh.prototype.createConnection=function(e,t,n,i,r,o){"object"===(void 0===n?"undefined":uh(n))&&(o=r,r=i,i=n,n=void 0);var a={source:e,target:t,parent:r,parentIndex:n,connection:i=this._create("connection",i),hints:o};return this._commandStack.execute("connection.create",a),a.connection},Oh.prototype.createShape=function(e,t,n,i,r){"number"!=typeof i&&(r=i,i=void 0);var o,a,s=(r=r||{}).attach;e=this._create("shape",e),s?(o=n.parent,a=n):o=n;var c={position:t,shape:e,parent:o,parentIndex:i,host:a,hints:r};return this._commandStack.execute("shape.create",c),c.shape},Oh.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);var r={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",r),r.shape},Oh.prototype.appendShape=function(e,t,n,i,r){r=r||{};var o={source:e,position:n,target:i,shape:t=this._create("shape",t),connection:r.connection,connectionParent:r.connectionParent,attach:r.attach};return this._commandStack.execute("shape.append",o),o.shape},Oh.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)},Oh.prototype.distributeElements=function(e,t,n){var i={groups:e,axis:t,dimension:n};this._commandStack.execute("elements.distribute",i)},Oh.prototype.removeShape=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",n)},Oh.prototype.removeConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",n)},Oh.prototype.replaceShape=function(e,t,n){var i={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape},Oh.prototype.pasteElements=function(e,t,n){var i={tree:e,topParent:t,position:n};this._commandStack.execute("elements.paste",i)},Oh.prototype.alignElements=function(e,t){var n={elements:e,alignment:t};this._commandStack.execute("elements.align",n)},Oh.prototype.resizeShape=function(e,t,n){var i={shape:e,newBounds:t,minBounds:n};this._commandStack.execute("shape.resize",i)},Oh.prototype.createSpace=function(e,t,n,i){var r={movingShapes:e,resizingShapes:t,delta:n,direction:i};this._commandStack.execute("spaceTool",r)},Oh.prototype.updateWaypoints=function(e,t,n){var i={connection:e,newWaypoints:t,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)},Oh.prototype.reconnectStart=function(e,t,n){var i={connection:e,newSource:t,dockingOrPoints:n};this._commandStack.execute("connection.reconnectStart",i)},Oh.prototype.reconnectEnd=function(e,t,n){var i={connection:e,newTarget:t,dockingOrPoints:n};this._commandStack.execute("connection.reconnectEnd",i)},Oh.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)},Oh.prototype._create=function(e,t){return t instanceof L.Base?t:this._elementFactory.create(e,t)},Oh.prototype.toggleCollapse=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",n)};var jh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nh=l.assign,Ih=ch.default;function Dh(e,t,n,i,r){Ih.call(this,e,t,n),this._cmmnRules=i,this._rules=r}u(Dh,Ih),Dh.$inject=["eventBus","elementFactory","commandStack","cmmnRules","rules"];var Bh=Dh;Dh.prototype.getHandlers=function(){var e=Ih.prototype.getHandlers.call(this);return e["shape.append"]=lp,e["shape.replace"]=bp,e["connection.reconnectStart"]=vp,e["connection.reconnectEnd"]=vp,e["element.updateProperties"]=Vp,e["element.updateSemanticParent"]=Jp,e["element.updateControls"]=Ap,e["id.updateClaim"]=pp,e},Dh.prototype.connect=function(e,t,n){var i=this._rules;return n||(n=i.allowed("connection.create",{source:e,target:t})||{type:"cmmn:Association"}),n.reverse?this.createConnection(t,e,n,t.parent):this.createConnection(e,t,n,e.parent)},Dh.prototype.createConnection=function(e,t,n,i,r){"object"===(void 0===n?"undefined":jh(n))&&(r=i,i=n,n=void 0);var o={source:e,target:t,parent:r,parentIndex:n,canExecute:i};return i=this._create("connection",i),Nh(o,{connection:i}),this._commandStack.execute("connection.create",o),o.connection},Dh.prototype.reconnectStart=function(e,t,n,i){var r={connection:e,newSource:t,dockingOrPoints:n,hints:i||{}};this._commandStack.execute("connection.reconnectStart",r)},Dh.prototype.reconnectEnd=function(e,t,n,i){var r={connection:e,newTarget:t,dockingOrPoints:n,hints:i||{}};this._commandStack.execute("connection.reconnectEnd",r)},Dh.prototype.updateProperties=function(e,t,n){this._commandStack.execute("element.updateProperties",{element:e,properties:t,shape:n})},Dh.prototype.updateSemanticParent=function(e,t,n,i){this._commandStack.execute("element.updateSemanticParent",{element:e,newParent:t,containment:n,shape:i})},Dh.prototype.updateControls=function(e,t){this._commandStack.execute("element.updateControls",{element:e,values:t})},Dh.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})},Dh.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})};var Lh=ds.default,zh=e.is,Fh=e.isCasePlanModel;function $h(e){Lh.call(this,e),this.preExecute(["shape.create","elements.move"],function(e){var t=e.shape,n=e.shapes,i=e.parent||e.newParent,r=e.host||e.newHost;i&&r&&Fh(r)&&(n&&n.length>1||(t=t||n[0],zh(t,"cmmn:Criterion")&&(e.parent=e.parent&&r,e.newParent=e.newParent&&r)))},!0)}$h.$inject=["eventBus"],u($h,Lh);var Hh=$h,Uh=ds.default,Wh=l.forEach,Vh=l.filter,qh=l.reduce,Gh=e.getDefinition,Kh=e.getBusinessObject,Yh=e.is,Xh=J.getCase,Zh=J.getParent,Qh=J.isSameCase,Jh=J.isLabel;function em(e,t,n,i){this._cmmnFactory=n,this._modeling=i,Uh.call(this,e);var r="caseFileItems";function o(e){var t=Xh(e),r=t.caseFileModel;return r||(r=n.createCaseFileModel(t),i.updateProperties(t,{caseFileModel:r})),r}function a(e){var t=e&&e.get(r);if(t&&!t.length){var n="caseFileModel",o=e.$parent;im(e)||(n="children");var a={};a[n]=void 0,i.updateProperties(o,a),i.updateSemanticParent(e)}}function s(e){var t=(e=Kh(e)).sourceRef;t&&(c(t,function(t){return e===t}),i.updateProperties(e,{sourceRef:void 0}))}function c(e,t){var n,r=(e=Kh(e))&&e.get("targetRefs");r&&r.length&&(n=r.slice(),Wh(r,function(r){if(!t||t(r)){r.sourceRef===e&&i.updateProperties(r,{sourceRef:void 0});var o=n.indexOf(r);-1!==o&&n.splice(o,1)}}),r.length!==n.length&&i.updateProperties(e,{targetRefs:n}))}function u(e,t,n){var o=(e=Kh(e)).children,s=o&&o.get(r);s&&s.length&&(Wh(s,function(e){(!n||n(e))&&i.updateSemanticParent(e,t,r)}),a(o))}this.preExecuted("shape.create",function(e){var t,n,a,s=e.shape,c=e.parent,u=Kh(c);nm(s)&&((n=Gh(s))&&(t=Zh(u,"cmmn:Definitions"),i.updateSemanticParent(n,t,"caseFileItemDefinitions")),a=o(c),i.updateSemanticParent(s,a,r))},!0),this.preExecuted("elements.move",function(e){var t,n=e.newParent,l=e.hints,d=l&&l.primaryShape&&l.primaryShape.parent,p=(e.closure||{}).allShapes;n&&d!==n&&((p=Vh(p,function(e){return nm(e)&&!Jh(e)&&!Qh(e.parent,n)}))&&p.length&&(t=o(n),p=qh(p,function(e,t){return e[t.id]=t,e},{}),Wh(p,function(e){var n=Kh(e),o=rm(n),l=Zh(n);if(im(l))i.updateSemanticParent(e,t,r);else{var d=Zh(n,"cmmn:CaseFileItem");p[d.id]||i.updateSemanticParent(e,t,r)}var f=n.sourceRef;f&&!p[f.id]&&s(n),c(n,function(e){return!p[e.id]}),u(n,o,function(e){return!p[e.id]}),a(l)})))},!0),this.postExecuted("shape.delete",function(e){var n,o=e.shape,l=Kh(o);if(nm(o)&&!Jh(o)){var d,p=Zh(l),f=rm(l);i.updateSemanticParent(o,null,r),s(o),c(o),u(l,f),a(p),(d=Gh(o))&&1===t.getReferences(d).length&&(n=Gh(o),i.updateSemanticParent(n,null,"caseFileItemDefinitions"))}},!0)}em.$inject=["eventBus","itemRegistry","cmmnFactory","modeling"],u(em,Uh);var tm=em;function nm(e){return Yh(e,"cmmn:CaseFileItem")}function im(e){return Yh(e,"cmmn:CaseFile")}function rm(e){return Zh(Kh(e),"cmmn:CaseFile")}var om=l.assign,am=e.getBusinessObject,sm=e.getName,cm=un.hasExternalLabel,um=un.getExternalLabelMid,lm=ye.isStandardEventVisible,dm=J.isAny,pm=ds.default;function fm(e,t,n){pm.call(this,e),this.postExecuted(["shape.create","connection.create"],200,function(e){var n,i=e.context,r=i.shape||i.connection,o=r.businessObject;cm(o)&&(n=um(r),t.createLabel(r,n,{id:o.id+"_label",hidden:!sm(r)&&!lm(o),businessObject:o}))}),this.postExecute(["connection.updateWaypoints"],function(e){var n=e.context.connection,i=n.label;if(i&&i.hidden){var r=um(n),o={x:r.x-i.x-i.width/2,y:r.y-i.y-i.height/2};t.moveShape(i,o)}}),this.postExecute(["shape.replace"],function(e){var t=e.context,n=t.newShape,i=t.oldShape,r=am(n);r&&cm(r)&&(n.label.x=i.label.x,n.label.y=i.label.y)}),this.executed(["label.create"],function(e){var t,i,r=e.context.shape;r.labelTarget&&dm(r.labelTarget||r,["cmmn:CMMNElement","cmmndi:CMMNDiagramElement"])&&((i=(t=r.businessObject).di||t).label||(i.label=n.createDiLabel()),i.label.bounds||(i.label.bounds=n.createDiBounds()),om(i.label.bounds,{x:r.x,y:r.y,width:r.width,height:r.height}))})}u(fm,pm),fm.$inject=["eventBus","modeling","cmmnFactory"];var hm=fm,mm=l.forEach,ym=l.unionBy,vm=l.filter,gm=ds.default,_m=e.is,xm=e.getDefinition,bm=e.getBusinessObject,Em=J.getParents,wm=J.getParent,Mm=J.getCase,Sm=J.isLabel,Cm=Ac.getAllDiscretionaryItems,Pm=Ac.getDirectItemCapables,Rm=Ac.isItemCapable,Tm=Ac.isHumanTask,km=400;function Am(e,t,n,i){this._modeling=t,this._cmmnReplace=n,this._itemRegistry=i;var r=this;gm.call(this,e);this.postExecuted("shape.create",function(e){var n=e.shape;if(Rm(n)){var i=bm(n),r=xm(i),o=jm(i);wm(r)||t.updateSemanticParent(r,o,"planItemDefinitions")}},!0),this.postExecuted("shape.replace",function(e){var t=e.newShape;Rm(t)&&r.updatePlanItemDefinitions([t])},!0),this.postExecuted("shape.delete",function(e){var t,n=e.shape,i={};Rm(n)&&!Sm(n)&&(i[(t=xm(n)).id]=t,r.deletePlanItemDefinitions(i))},!0),this.preExecuted("shape.delete",function(e){var t=e.shape,n=xm(t);Tm(n)&&!n.$parent&&(e.discretionaryItems=e.discretionaryItems||Cm(n))},!0),this.postExecuted("shape.delete",km,function(e){var t=e.discretionaryItems,n=[];mm(t,function(e){var t=i.getShape(e.id);t&&n.push(t)}),n&&n.length&&r.updatePlanItemDefinitions(n)},!0),this.preExecuted("elements.move",function(e){var r,o,a=e.closure.allShapes,s=e.newParent,c=e.hints,u=c&&c.primaryShape&&c.primaryShape.parent,l={},d={};s&&u!==s&&(o=Mm(s),r=vm(a,function(e){if(Rm(e)&&!Sm(e)&&Mm(e)!==o){var t=xm(e);return d[t.id]=d[t.id]||[],d[t.id].push(e),!0}return!1}),mm(r,function(e){var r,o,a,s=xm(e);l[s.id]?a=l[s.id]:(r=i.getReferences(s.id),o=d[s.id],r.length>o.length&&(a=l[s.id]=n.replacePlanItemDefinition(s))),a&&a!==s&&t.updateProperties(e,{definitionRef:a})}),e.definitionReplacements=l)},!0),this.postExecuted("elements.move",km,function(e){var t=e.shapes,n=e.newParent,i=e.hints&&e.hints.oldParent;n&&i!==n&&(t=vm(t,function(e){return Rm(e)&&!Sm(e)}))&&t.length&&r.updatePlanItemDefinitions(t)},!0),this.postExecuted(["connection.create","connection.delete","connection.reconnectEnd","connection.reconnectStart"],km,function(e){var t=e.connection,n=(e.newSource||e.source||t.source,e.newTarget||e.target||t.target,[]);(function(e,t,n){return!e.businessObject.cmmnElementRef})(t)&&(t.target&&n.push(t.target),!t.target&&e.target&&n.push(e.target),e.oldTarget&&n.push(e.oldTarget),n&&n.length&&r.updatePlanItemDefinitions(n))},!0),this.deletePlanItemDefinitions=function(e){mm(e,function(e){i.getReferences(e).length||t.updateSemanticParent(e,null,"planItemDefinitions")})},this.updatePlanItemDefinitions=function(e){!function(e,t){var n={};!function e(r,o){mm(r,function(r){if(!function(e){return!!n[e.id]}(r)){!function(e){n[e.id]=e}(r),r=i.getShape(r.id)||r;var a=t(r);a&&a.length&&e(a)}o&&(n={})})}(e,!0)}(e,function(e){var n,r=bm(e),o=xm(r),a=function(e){var t,n;if(e.length)if(n=e.splice(0,1)[0],e.length){var i=Nm(n);mm(e,function(e){var t,n;t=i,n=Nm(e),i=vm(t,function(e){return-1!==n.indexOf(e)})}),t=i[0]}else t=jm(n);return t}(i.getReferences(o));a||(a=(n=wm(r,"cmmn:Case"))&&n.casePlanModel),a&&a!==o.$parent&&t.updateSemanticParent(o,a,"planItemDefinitions");var s=Pm(o),c=[];return _m(o,"cmmn:PlanFragment")&&e.children&&e.children.length&&mm(e.children,function(e){var t=bm(e);Rm(t)&&!Sm(t)&&-1===s.indexOf(t)&&c.push(t)}),ym("id",s,c)})}}Am.$inject=["eventBus","modeling","cmmnReplace","itemRegistry"],u(Am,gm);var Om=Am;function jm(e){return e=bm(e),wm(e,"cmmn:Stage")}function Nm(e){return e=bm(e),Em(e,"cmmn:Stage")}var Im=ds.default,Dm=l.some,Bm=l.forEach,Lm=e.is,zm=e.isCasePlanModel,Fm=e.getDefinition,$m=e.getBusinessObject,Hm=J.getParent,Um=J.isLabel,Wm=J.getParents,Vm=Ac.isDiscretionaryToHumanTask,qm=Ac.isDiscretionaryItem,Gm=Ac.isPlanFragment,Km=Ac.getAllDiscretionaryItems,Ym=Ac.isHumanTask;function Xm(e,t,n,i){this._cmmnFactory=t,this._modeling=n,this._itemRegistry=i;var r=this;Im.call(this,e);function o(e){return!e.businessObject.cmmnElementRef}this.preExecuted(["connection.delete","connection.reconnectEnd","connection.reconnectStart"],function(e){var t=e.context,i="connection.reconnectStart"===e.command,a=t.connection,s=a.target;if(o(a)){if(i){if(!t.newSource||!t.newTarget)return;s=t.newSource,t.oldPlanningTable=Jm(s)}if(t.planningTable=Jm(s),s!==t.newTarget&&!function(e,t){return Dm(e.incoming,function(e){return e!==t&&o(e)})}(s,a)){var c=Qm(s.parent),u=r.createPlanningTable(c);n.updateSemanticParent(s,u,"tableItems")}}}),this.postExecuted("connection.delete",function(e){o(e.connection)&&r.deletePlanningTable(e.planningTable)},!0),this.postExecuted("connection.reconnectEnd",function(e){var t=e.connection,i=t.target;if(o(t)){var a=Jm(i);n.updateSemanticParent(i,e.planningTable,"tableItems"),r.deletePlanningTable(a)}},!0),this.postExecuted("connection.reconnectStart",function(e){o(e.connection)&&e.newSource&&e.newTarget&&r.deletePlanningTable(e.oldPlanningTable)},!0),this.preExecuted(["connection.create","connection.reconnectStart"],function(e){var t=e.connection,i=e.newSource||e.source,a=e.target||e.newTarget||t.target;if(o(t)){e.planningTable=Jm(a);var s=Fm(i);if(t.source)if(Fm(t.source)===s)return;var c=r.createPlanningTable(s);n.updateSemanticParent(a,c,"tableItems")}},!0),this.postExecuted(["connection.create","connection.reconnectStart"],function(e){o(e.connection)&&r.deletePlanningTable(e.planningTable)},!0),this.preExecuted("elements.move",500,function(e){var o=e.closure.allShapes,a=e.newParent,s=e.hints,c=s&&s.primaryShape&&s.primaryShape.parent,u=e.definitionReplacements,l=[],d={};a&&c!==a&&Bm(o,function(e){var a,s,c,p,f,h=$m(e),m=[];if(qm(e)&&!Um(e)&&(a=Hm(h,"cmmn:PlanItemDefinition"),Lm(a,"cmmn:HumanTask")&&(s=u[a.id])&&-1===(Km(s)||[]).indexOf(h))){if(c=Km(a),!Dm(c,function(e){return!o[e.id]})){var y=a.planningTable;return n.updateProperties(s,{planningTable:y},i.getShapes(s)),n.updateSemanticParent(y,s),void n.updateProperties(a,{planningTable:void 0},i.getShapes(a))}if((p=Wm(h,"cmmn:PlanningTable"))&&p.length){Bm(p,function(e){var i,r=l.indexOf(e);i=-1===r?function(e){var n=t.create("cmmn:PlanningTable",{applicabilityRules:e.applicabilityRules}),i=l.push(e);return d[i-1]=n,n}(e):d[r],f&&!f.$parent&&n.updateSemanticParent(f,i,"tableItems"),f=i,m.push(i)}),s.planningTable||(n.updateProperties(s,{planningTable:f},i.getShapes(s)),n.updateSemanticParent(f,s));var v=m.splice(0,1)[0],g=Jm(h);n.updateSemanticParent(h,v,"tableItems"),r.deletePlanningTable(g)}}})},!0),this.preExecuted(["shape.create","shape.move"],function(e){var t=e.shape;if(qm(t)&&!Um(t)&&!Vm(t)){e.planningTable=Jm(t);var i=e.parent||e.newParent;if(i){var o=Qm(i),a=r.createPlanningTable(o);n.updateSemanticParent(t,a,"tableItems")}}},!0),this.postExecuted("shape.move",function(e){var t=e.shape;qm(t)&&!Um(t)&&(Vm(t)||r.deletePlanningTable(e.planningTable))},!0),this.preExecuted("shape.delete",function(e){var t=e.shape;qm(t)&&!Um(t)&&(e.planningTable=Jm(t),n.updateSemanticParent(t,null,"tableItems"))},!0),this.postExecuted("shape.delete",function(e){var t=e.shape;qm(t)&&!Um(t)&&r.deletePlanningTable(e.planningTable)},!0),this.postExecuted("shape.delete",500,function(e){var t=e.shape,o=Fm(t);if(Ym(o)&&!o.$parent){var a=Km(o);Bm(a,function(e){var t=i.getShape(e.id);if(t){var o=Qm(t.parent),a=r.createPlanningTable(o);n.updateSemanticParent(t,a,"tableItems")}}),o.planningTable&&r.deletePlanningTable(o.planningTable)}},!0),this.createPlanningTable=function(e){var t=e.planningTable;if(!t){t=r._cmmnFactory.create("cmmn:PlanningTable");var o=i.getShapes(e);n.updateProperties(e,{planningTable:t},o),n.updateSemanticParent(t,e)}return t},this.deletePlanningTable=function(e){if(!(e.get("tableItems").length>0)){for(var t=e.$parent;Lm(t,"cmmn:PlanningTable")&&!e.get("tableItems").length;)n.updateSemanticParent(e,null,"tableItems"),e=t,t=t.$parent;if(Lm(t,"cmmn:PlanItemDefinition")&&e&&!e.get("tableItems").length){var r=Hm(e,"cmmn:PlanItemDefinition"),o=i.getShapes(r);n.updateProperties(r,{planningTable:void 0},o),n.updateSemanticParent(e,null,null)}}}}Xm.$inject=["eventBus","cmmnFactory","modeling","itemRegistry"],u(Xm,Im);var Zm=Xm;function Qm(e){var t=function e(t){if(t&&!zm(t)){var n=Fm(t);Gm(n)&&(t=Hm(t,["cmmn:Stage","cmmn:PlanItem","cmmn:DiscretionaryItem"]),t=e(t))}return t}(e);return Fm(t)||$m(t)}function Jm(e){return e=$m(e),Hm(e,"cmmn:PlanningTable")}var ey=l.forEach,ty=l.assign,ny=l.isArray,iy=ds.default,ry=e.is,oy=200,ay=5e3;function sy(e,t,n,i,r){function o(e,t){return n.canConnectPlanItemOnPartConnection(e,t)}function a(e,t){return n.canConnectCaseFileItemOnPartConnection(e,t)}function s(e,t,i){return n.canConnectDiscretionaryConnection(e,t,i)}function c(e,r,c,u){var l=e.parent;if(u=u||{},r=r||e.source,c=c||e.target,l){var d,p,f=ly(e);if(f?(ry(f,"cmmn:PlanItemOnPart")&&(o(r,c)||(d=!0),a(r,c)&&(p={type:"cmmn:CaseFileItemOnPart",name:f.name,isStandardEventVisible:uy(e)}),s(r,c,e)&&(p={type:"cmmndi:CMMNEdge"})),ry(f,"cmmn:CaseFileItemOnPart")&&(a(r,c)||(d=!0),o(r,c)&&(p={type:"cmmn:PlanItemOnPart",name:f.name,isStandardEventVisible:uy(e)})),ry(f,"cmmn:Association")&&!function(e,t){return n.canConnectAssociation(e,t)}(r,c)&&(d=!0)):(s(r,c,e)||(d=!0),o(r,c)&&(p={type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0})),d&&(p||!dy(r)&&!dy(c)||(p={type:"cmmn:Association"}),t.removeConnection(e)),p){var h=ty({waypoints:e.waypoints.slice()},p),m=t.connect(r,c,h);return!1!==u.select&&i.select(m),m}}}iy.call(this,e),this.postExecuted("elements.move",oy,function(e){var t=e.closure.allConnections;ey(t,function(e){c(e,null,null,{select:!1})})},!0),this.preExecute(["connection.reconnectEnd","connection.reconnectStart"],ay+oy,function(e){var t=e.command,n="connection.reconnectStart"===t,i=e.context,o=i.connection,a=i.newSource||o.source,s=i.newTarget||o.target,c=i.dockingOrPoints,u=i.canExecute;if(!i.hints||!i.hints.nested){if(void 0===u){var l={connection:o};l[n?"hover":"source"]=a,l[n?"target":"hover"]=s,u=function(e,t){return r.allowed(e,t)}(t,l)}if(u&&u.reverse){if(!ny(c)){var d=o.waypoints.slice();d.splice(n?0:-1,1,c),c=d}i.newSource=s,i.newTarget=a,i.dockingOrPoints=c.reverse()}}}),this.preExecute(["connection.reconnectStart","connection.reconnectEnd"],ay,function(e){var t=e.connection,n=e.newSource||t.source,i=e.newTarget||t.target,r=e.hints||{};e.connection=c(t,n,i,{select:!r.nested})||t},!0),this.postExecuted("shape.replace",function(e){var n=e.newShape,i=n.businessObject,r=function(e){var t=e.attachers,n=[];return ey(t,function(e){ey(e.outgoing,function(e){n.push(e)})}),n}(n);ey(r,function(e){var n=e.source,r=e.target,a=ly(e);ry(a,"cmmn:PlanItemOnPart")&&(o(n,r)?t.updateProperties(a,{sourceRef:i},e):t.removeConnection(e))})},!0),this.postExecuted("element.updateProperties",function(e){var t=e.properties,n=e.changed;t&&!1===t.isBlocking&&ey(n,function(e){var t=e.outgoing;ey(t,function(e){c(e,null,null,{select:!1})})})},!0)}u(sy,iy),sy.$inject=["eventBus","modeling","cmmnRules","selection","rules"];var cy=sy;function uy(e){return e.businessObject.isStandardEventVisible}function ly(e){return e.businessObject&&e.businessObject.cmmnElementRef}function dy(e){return ry(e,"cmmn:TextAnnotation")}var py=ds.default,fy=_f.saveClear,hy=e.is,my=e.getDefinition,yy=e.getSentry,vy=l.forEach,gy=l.filter,_y=l.assign,xy=6e3,by=500,Ey=100;function wy(e,t,n,i,r,o,a,s){py.call(this,r),this._cmmnReplace=e,this._cmmnRules=t,this._elementFactory=n,this._elementRegistry=i,this._modeling=o,this._selection=a,this._rules=s;var c=this;this.preExecute(["shape.create","shape.append"],xy,function(e){var i=e.shape,r=e.source,o=e.parent||e.target||r&&r.parent,a=e.host,s=e.position;if(!(e.hints||{}).nested&&(a&&Sy(i)&&(o=a),!t.canCreate(i,o,r,s))){var c=t.canReplace([i],o,s,r);if(c&&c.replacements){var u=c.replacements[0],l=my(i),d=yy(i),p=u.newElementType,f=u.newDefinitionType||l&&l.$type,h=_y({},{type:p});f&&_y(h,{definitionType:f}),d&&_y(h,{sentryRef:d}),e.shape=n.createShape(h)}}},!0),this.postExecuted("elements.move",by,function(e){var n=e.newParent,i=e.newHost,r=e.shapes.slice();if(1===r.length&&i?n=i:r=gy(r,function(e){return!Sy(e)}),n&&!t.canMove(r,n)){var o=t.canReplace(r,n);o&&o.replacements&&c.replaceElements(r,o.replacements)}},!0),this.postExecuted(["shape.replace"],1500,function(e){var t=e.context,n=t.oldShape,i=t.newShape;o.unclaimId(n.businessObject.id,n.businessObject),o.updateProperties(i,{id:n.id})}),this.preExecute("connection.create",xy,function(e){var t=e.source,n=e.target,i=e.canExecute||function(e,t){return s.allowed("connection.create",{source:e,target:t})}(t,n);if(i&&i.replacements){var r=c.replaceElements([t,n],i.replacements,{select:!1});e.source=r[t.id]||e.source,e.target=r[n.id]||e.target,_y(i,{replacedBy:i.reverse?e.source:e.target})}},!0),r.on("connect.end",by+Ey,function(e){var t=e.context.canExecute,n=t&&t.replacedBy;n&&(e.context.target=n)}),this.preExecute(["connection.reconnectStart","connection.reconnectEnd"],xy,function(e){var t,n=e.command,i="connection.reconnectStart"===n,r=e.context,o=r.connection,a=r.newSource||o.source,u=r.newTarget||o.target,l={connection:o};if(!r.hints||!r.hints.nested){if(l[i?"hover":"source"]=a,l[i?"target":"hover"]=u,(t=function(e,t){return s.allowed(e,t)}(n,l))&&t.replacements){var d=c.replaceElements([a,u],t.replacements,{select:!1});r.newSource=d[a.id]||r.newSource,r.newTarget=d[u.id]||r.newTarget}r.canExecute=t}}),this.preExecute("shape.delete",xy,function(e){var t=e.shape,n=Sy(t)?t.host:t.parent,i=my(n);hy(i,"cmmn:Stage")||fy(t.incoming,function(e){o.removeConnection(e,{nested:!0,endChanged:!0})})},!0),this.postExecuted(["connection.delete","connection.reconnectEnd"],by,function(e){var n=e.target||e.oldTarget,i=[n],r=Sy(n)?n.host:n.parent;if(!(e.hints||{}).endChanged&&r&&!t.canMove(i,r)){var o=t.canReplace(i,r);o&&o.replacements&&c.replaceElements(i,o.replacements,{select:!1})}},!0),this.postExecuted("element.updateProperties",function(e){var n=e.properties,i=e.changed;n&&!1===n.isBlocking&&vy(i,function(e){var n=e.attachers,i=t.canReplace(n,e);i&&c.replaceElements(n,i.replacements,{select:!1})})},!0),this.replaceElements=function(e,t,n){var i=this,r=this._elementRegistry,o=this._selection,a={};return n=n||{},vy(t,function(t){var n,o=r.get(t.oldElementId),s=e.indexOf(o);o&&(n=i.replaceElement(o,t),-1!==s&&(e[s]=n),a[o.id]=n)}),t&&!1!==n.select&&o.select(e),a},this.replaceElement=function(e,t){var n=this._cmmnReplace,i=my(e),r=t.newDefinitionType||i&&i.$type;if(e){var o={type:t.newElementType};return r&&_y(o,{definitionType:r}),n.replaceElement(e,o,{select:!1})}}}wy.$inject=["cmmnReplace","cmmnRules","elementFactory","elementRegistry","eventBus","modeling","selection","rules"],u(wy,py);var My=wy;function Sy(e){return hy(e,"cmmn:Criterion")}var Cy={};Object.defineProperty(Cy,"__esModule",{value:!0});var Py="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Cy.resizeBounds=function(e,t,n){var i=n.x,r=n.y;switch(t){case"nw":return{x:e.x+i,y:e.y+r,width:e.width-i,height:e.height-r};case"sw":return{x:e.x+i,y:e.y,width:e.width-i,height:e.height+r};case"ne":return{x:e.x,y:e.y+r,width:e.width+i,height:e.height-r};case"se":return{x:e.x,y:e.y,width:e.width+i,height:e.height+r};default:throw new Error("unrecognized direction: "+t)}},Cy.ensureConstraints=function(e,t){if(!t)return e;var n=(0,dc.asTRBL)(e);return(0,dc.asBounds)({top:Ay("top",n,t),right:Ay("right",n,t),bottom:Ay("bottom",n,t),left:Ay("left",n,t)})},Cy.getMinResizeBounds=function(e,t,n,i){var r=(0,dc.asTRBL)(t),o={top:/n/.test(e)?r.bottom-n.height:r.top,left:/w/.test(e)?r.right-n.width:r.left,bottom:/s/.test(e)?r.top+n.height:r.bottom,right:/e/.test(e)?r.left+n.width:r.right},a=i?(0,dc.asTRBL)(i):o,s={top:Ty(o.top,a.top),left:Ty(o.left,a.left),bottom:Ry(o.bottom,a.bottom),right:Ry(o.right,a.right)};return(0,dc.asBounds)(s)},Cy.addPadding=jy,Cy.computeChildrenBBox=function(e,t){var n;n=void 0===e.length?(0,l.filter)(e.children,Ny):e;if(n.length)return jy((0,Tr.getBBox)(n),t)};var Ry=Math.max,Ty=Math.min,ky=20;function Ay(e,t,n){var i=t[e],r=n.min&&n.min[e],o=n.max&&n.max[e];return(0,l.isNumber)(r)&&(i=(/top|left/.test(e)?Ty:Ry)(i,r)),(0,l.isNumber)(o)&&(i=(/top|left/.test(e)?Ry:Ty)(i,o)),i}function Oy(e,t){return void 0!==e?e:ky}function jy(e,t){var n,i,r,o;return"object"===(void 0===t?"undefined":Py(t))?(n=Oy(t.left),i=Oy(t.right),r=Oy(t.top),o=Oy(t.bottom)):n=i=r=o=Oy(t),{x:e.x-n,y:e.y-r,width:e.width+n+i,height:e.height+r+o}}function Ny(e){return!e.waypoints&&"label"!==e.type}var Iy=e.is,Dy=e.getBusinessObject,By=e.isCasePlanModel,Ly=l.filter,zy=Tr.getBBox,Fy=1001,$y=10;function Hy(e){var t,n,i=e.shape,r=e.direction;return t=e.minDimensions||{width:$y,height:$y},n=function(e,t){var n=Ly(e.children,function(t){return function(e,t){if(t.waypoints)return!1;if("label"===t.type)return!1;if(Iy(t,"cmmn:ExitCriterion")){var n=Dy(e),i=n.get("exitCriteria"),r=Dy(t);if(i.indexOf(r)>=0)return!1}return!0}(e,t)});if(n.length)return Cy.addPadding(zy(n),t)}(i,e.childrenBoxPadding),Cy.getMinResizeBounds(r,i,t,n)}function Uy(e,t){e.on("resize.start",Fy,function(e){var t=e.context,n=t.shape;By(n)&&(t.minBounds=Hy(t))})}Uy.$inject=["eventBus","modeling"];var Wy=Uy,Vy=ds.default,qy=l.forEach,Gy=l.flatten,Ky=l.groupBy,Yy=l.map,Xy=l.some,Zy=e.is,Qy=e.isCasePlanModel,Jy=e.getSentry,ev=e.getBusinessObject,tv=e.getDefinition,nv=e.getStandardEvents,iv=J.getParent,rv=Ac.isItemCapable,ov=Ac.getAllDiscretionaryItems,av=Ac.getDirectItemCapables,sv=Ac.isHumanTask,cv=300;function uv(e,t,n,i,r){var o=this;Vy.call(this,e);function a(e){var t=pv(e);return s(e,function(e){var n=tv(e);if(sv(n)){var i=ov(e);return i&&i.length&&(t=t.concat(pv(i))),i}return av(e)}),Gy(t)}function s(e,t){var i={};!function e(r,o){qy(r,function(r){if(!function(e){return!!i[e.id]}(r)){!function(e){i[e.id]=e}(r),r=n.getShape(r.id)||r;var a=t(r);a&&a.length&&e(a)}o&&(i={})})}(e,!0)}function c(e){var t=r.createSentry();return u(e,t),t}function u(e,n){t.updateProperties(e,{sentryRef:n})}function l(e,n){t.updateProperties(e,{cmmnElementRef:n})}function d(e){var t={name:e.name,sourceRef:e.sourceRef,standardEvent:e.standardEvent};return Zy(e,"cmmn:PlanItemOnPart")&&(t.exitCriterionRef=e.exitCriterionRef),r.create(e.$type,t)}function p(e){var t=e.businessObject.cmmnElementRef;return Zy(t,"cmmn:OnPart")}this.postExecuted("connection.create",function(e){var n=e.connection;if(p(n)){var i=hv(n),r=n.target,o=r.host,a=Jy(r);a||(a=c(r),t.updateSemanticParent(a,dv(o),"sentries")),t.updateSemanticParent(i,a,"onParts",n)}},!0),this.preExecuted("connection.delete",function(e){var n=e.connection;if(p(n)){var i=n.source,r=hv(n);fv(i,n)&&l(n,r=d(r)),t.updateSemanticParent(r,null,"onParts",n)}},!0),this.preExecuted("connection.reconnectStart",function(e){var n=e.connection,i=n.source;if(p(n)){var r=hv(n),o=n.target,a=Jy(o);fv(i,n)&&(l(n,r=d(r)),t.updateSemanticParent(r,a,"onParts",n))}},!0),this.preExecuted("connection.reconnectEnd",function(e){var n=e.connection,i=n.source;if(p(n)){var r=hv(n),o=n.target,a=Jy(o),s=e.newTarget,u=Jy(s);a!==u&&(u||(u=c(s),t.updateSemanticParent(u,dv(s.host),"sentries")),fv(i,n)&&l(n,r=d(r)),t.updateSemanticParent(r,u,"onParts",n))}},!0),this.postExecuted(["connection.create","connection.reconnectStart"],function(e){var n=e.connection;if(p(n)){var i,r=hv(n);(function(e){var t=hv(e),n=t.standardEvent,i=nv(t);return n&&-1!==i.indexOf(n)})(n)||(i=function(e){if(e=hv(e),Zy(e.sourceRef,"cmmn:CaseFileItem"))return"update";if(Zy(e.exitCriterionRef,"cmmn:ExitCriterion"))return"exit";if(Zy(e.sourceRef,"cmmn:PlanItem")){var t=tv(e.sourceRef);return Zy(t,"cmmn:EventListener")||Zy(t,"cmmn:Milestone")?"occur":"complete"}}(n),t.updateProperties(r,{standardEvent:i},n))}},!0),this.postExecuted("element.updateAttachment",function(e){var t=e.shape;Zy(t,"cmmn:Criterion")&&(t.host?o.updateSentriesSemanticParent([t]):o.deleteSentry(t))},!0),this.preExecuted("shape.delete",function(e){var t=tv(e.shape);sv(t)&&(e.discretionaryItems=e.discretionaryItems||ov(t))},!0),this.postExecuted("shape.delete",cv,function(e){var t;(t=a(e.discretionaryItems))&&t.length&&o.updateSentriesSemanticParent(t)},!0),this.postExecuted(["connection.create","connection.delete","connection.reconnectEnd","connection.reconnectStart"],cv,function(e){var t,n=e.connection,i=(e.newSource||e.source||n.source,e.newTarget||e.target||n.target,[]);(function(e,t,n){return!e.businessObject.cmmnElementRef})(n)&&(n.target&&i.push(n.target),!n.target&&e.target&&i.push(e.target),e.oldTarget&&i.push(e.oldTarget),(t=a(i))&&t.length&&o.updateSentriesSemanticParent(t))},!0),this.postExecuted("elements.move",cv,function(e){var t,n=e.shapes,i=e.newParent;(e.hints&&e.hints.oldParent)!==i&&(t=a(n))&&t.length&&o.updateSentriesSemanticParent(t)},!0),this.deleteSentry=function(e){var i=Jy(e);i&&n.getReferences(i).length<=1&&t.updateSemanticParent(i,null,"sentries")},this.updateSentriesSemanticParent=function(e){var r=function(e){return Ky(e,function(e){var t=Jy(e);return t&&t.id})}(e),o={};function a(e,t){o[e.id]=t}function c(e){return o[e.id]||e}s(e,function(e){var s=Jy(e);if(s){var p=dv(e.host);if(!p){var f=iv(ev(e));p=f&&dv(f)}if(s.$parent===p)return;if(!o[s.id]&&function(e,t){var i=n.getReferences(e),o=r[e.id]||[];return n.getReferences(e).length>o.length&&(!t||Xy(i,function(e){var i=n.getShape(e);return i&&t!==dv(i.host)}))}(s,p)){var h=i.replaceSentry(s);a(s,h),qy(e.incoming,function(e){var t=e.businessObject.cmmnElementRef;t&&Zy(t,"cmmn:OnPart")&&a(t,d(t))})}s=c(s),Jy(e)!==s&&u(e,s),qy(e.incoming,function(e){var n=e.businessObject.cmmnElementRef;if(n&&Zy(n,"cmmn:OnPart")){var i=c(n);i&&n!==i&&(l(e,i),t.updateSemanticParent(i,s,"onParts"))}}),t.updateSemanticParent(s,p,"sentries")}})}}uv.$inject=["eventBus","modeling","itemRegistry","cmmnReplace","cmmnFactory"],u(uv,Vy);var lv=uv;function dv(e){if(Qy(e))return ev(e);if(rv(e)){var t=ev(e);return iv(t,"cmmn:PlanFragment")}}function pv(e){return Gy(Yy(e,function(e){var t=[];if(e.attachers)t=e.attachers;else{var n=ev(e),i=n.get("exitCriteria");qy(i,function(e){t.push(e)});var r=n.get("entryCriteria");qy(r,function(e){t.push(e)})}return t||[]}))}function fv(e,t){var n=hv(t);return Xy(e.outgoing,function(e){return t!==e&&n===hv(e)})}function hv(e){return(e=ev(e)).cmmnElementRef}var mv=l.forEach,yv=ds.default;function vv(e,t){yv.call(this,e),this.preExecute("elements.delete",function(e){var n=e.context.elements;mv(n,function(e){t.unclaimId(e.businessObject.id,e.businessObject)})})}u(vv,yv),vv.$inject=["eventBus","modeling"];var gv={__init__:["attachCriterionBehavior","caseFileItemUpdater","labelBehavior","planItemDefinitionUpdater","planningTableUpdater","replaceConnectionBehavior","replaceElementBehavior","resizeCasePlanModelBehavior","sentryUpdater","unclaimIdBehavior"],attachCriterionBehavior:["type",Hh],caseFileItemUpdater:["type",tm],labelBehavior:["type",hm],planItemDefinitionUpdater:["type",Om],planningTableUpdater:["type",Zm],replaceConnectionBehavior:["type",cy],replaceElementBehavior:["type",My],resizeCasePlanModelBehavior:["type",Wy],sentryUpdater:["type",lv],unclaimIdBehavior:["type",vv]},_v={};Object.defineProperty(_v,"__esModule",{value:!0}),_v.default=wv;var xv=Ev(u),bv=Ev(ds);function Ev(e){return e&&e.__esModule?e:{default:e}}function wv(e){bv.default.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],function(e){var n=e.context,i=n.shape||n.connection,r=n.parent,o=t.getOrdering(i,r);o&&(void 0!==o.parent&&(n.parent=o.parent),n.parentIndex=o.index)}),this.preExecute(["shape.move","connection.move"],function(e){var n=e.context,i=n.shape||n.connection,r=n.newParent||i.parent,o=t.getOrdering(i,r);o&&(void 0!==o.parent&&(n.newParent=o.parent),n.newParentIndex=o.index)})}wv.prototype.getOrdering=function(e,t){return null},(0,xv.default)(wv,bv.default);var Mv=_v.default,Sv=l.findIndex,Cv=l.find,Pv=e.is,Rv=J.isAny;function Tv(e){Mv.call(this,e);var t=[{type:"label",order:{level:10}},{type:"cmmn:Criterion",order:{level:6}},{type:"cmmn:OnPart",order:{level:9,containers:["cmmn:Stage"]}},{type:"cmmn:Association",order:{level:9,containers:["cmmndi:CMMNDiagram"]}},{type:"cmmndi:CMMNEdge",order:{level:9,containers:["cmmn:PlanItem","cmmn:DiscretionaryItem","cmmn:Stage"]}}];function n(e){var n=e.order;return n||(e.order=n=function(e){kv(e)&&(e=e.businessObject.cmmnElementRef||e);var n=Cv(t,function(t){return Pv(e,t.type)});return n&&n.order||{level:1}}(e)),n}this.getOrdering=function(e,t){var i=n(e);i.containers&&(t=function(e,t,n){var i=t;for(kv(e)&&e.source&&(i=e.source.parent);i&&!Rv(i,n);)i=i.parent;if(!i)throw new Error("no parent for "+e.id+" in "+t.id);return i}(e,t,i.containers));var r=t.children.indexOf(e),o=Sv(t.children,function(t){return!(!e.labelTarget&&t.labelTarget)&&i.level<n(t).level});return-1!==o&&-1!==r&&r<o&&(o-=1),{index:o,parent:t}}}function kv(e){return Pv(e,"cmmndi:CMMNEdge")}Tv.$inject=["eventBus"],u(Tv,Mv);var Av={__init__:["cmmnOrderingProvider"],cmmnOrderingProvider:["type",Tv]},Ov=e.is,jv=e.getDefinition,Nv=e.isAutoComplete,Iv=ye.isCollapsed,Dv=ye.isPlanningTableCollapsed,Bv=Ac.isPlanningTableCapable,Lv=Ac.isItemCapable;function zv(e,t,n,i){function r(t,n){var i;return t&&(n=n||t.$type,i=e.createCriterion(n,{sentryRef:t.sentryRef,name:t.name})),i}function o(t,n){n=n||t.$type;var i=e.create(n,{name:t.name});if(Vv(i)&&t.defaultControl){var r=s(t.defaultControl,i);l(r,i),i.defaultControl=r}return Wv(i)&&t.autoComplete&&(i.autoComplete=t.autoComplete),Hv(t)&&Hv(i)&&(i.isBlocking=t.isBlocking),i}function a(t,n,i){n=n||t.$type,i=i||jv(t);var r=e.create(n,{name:t.name,definitionRef:i});if(Vv(r)&&t.itemControl){var o=s(t.itemControl,r);l(o,r),r.itemControl=o}return r}function s(t,n){var r;if(t){r=e.create("cmmn:PlanItemControl");var o=t.repetitionRule;!o||n&&!i.canSetRepetitionRule(n)||(l(o=c(o),r),r.repetitionRule=o);var a=t.requiredRule;!a||n&&!i.canSetRequiredRule(n)||(l(a=c(a),r),r.requiredRule=a);var s=t.manualActivationRule;!s||n&&!i.canSetManualActivationRule(n)||(l(s=c(s),r),r.manualActivationRule=s)}return r}function c(t){var n;if(t){var i=t.$type,r=u(t.condition);l(r,n=e.create(i,{condition:r}))}return n}function u(t){var n;return t&&(n=e.create("cmmn:Expression",{language:t.language,body:t.body})),n}function l(e,t){e&&(e.$parent=t)}this.replaceElement=function(i,s,c){c=c||{};var u,l=s.type,d=i.businessObject,p={type:l};if(function(e){return Ov(e,"cmmn:Criterion")}(d)&&(u=r(d,l)),Lv(d)){var f=jv(d),h=s.definitionType,m=f;f.$type!==h&&(m=o(f,h)),u=a(d,l,m),Uv(f)&&Uv(m)&&!1!==s.isCollapsed&&(p.isCollapsed=Iv(d)),Hv(f)&&!0===s.isCollapsed&&(p.isCollapsed=!0),Hv(m)&&!1===s.isBlocking&&(p.isBlocking=!1),Bv(f)&&Bv(m)&&(p.isPlanningTableCollapsed=Dv(d)),Wv(f)&&Wv(m)&&(p.autoComplete=Nv(d)),Iv(d)||s.isCollapsed||Hv(f)||(p.width=i.width,p.height=i.height)}return p.businessObject=u||e.create(l),p=t.replaceElement(i,p,c),!1!==c.select&&n.select(p),p},this.replaceCriterion=r,this.replaceSentry=function(t){var n;if(t&&(n=e.createSentry({name:t.name}),t.ifPart)){var i=e.create("cmmn:IfPart");l(i,n),n.ifPart=i;var r=u(t.ifPart.condition);l(r,i),i.condition=r}return n},this.replacePlanItemDefinition=o,this.replaceItemCapable=a,this.replacePlanItemControl=s,this.replaceRule=c,this.replaceCondition=u}zv.$inject=["cmmnFactory","replace","selection","cmmnRules"];var Fv=zv;function $v(e,t){return e=jv(e),Ov(e,t)}function Hv(e){return $v(e,"cmmn:Task")}function Uv(e){return $v(e,"cmmn:PlanFragment")}function Wv(e){return $v(e,"cmmn:Stage")}function Vv(e){return Hv(e)||Wv(e)||function(e){return $v(e,"cmmn:Milestone")}(e)}var qv={};Object.defineProperty(qv,"__esModule",{value:!0}),qv.default=Gv;function Gv(e,t,n){var i=(0,l.isDefined)(e&&e.scale)?e.scale:{min:1,max:1.5};this._config={scale:i},this._eventBus=t,this._canvas=n,this._providers={},this._current={}}Gv.$inject=["config.popupMenu","eventBus","canvas"],Gv.prototype.registerProvider=function(e,t){this._providers[e]=t},Gv.prototype.isEmpty=function(e,t){if(!e)throw new Error("element parameter is missing");if(!t)throw new Error("providerId parameter is missing");var n=this._providers[t],i=n.getEntries(e),r=n.getHeaderEntries&&n.getHeaderEntries(e),o=i.length>0,a=r&&r.length>0;return!o&&!a},Gv.prototype.open=function(e,t,n){var i=this._providers[t];if(!e)throw new Error("Element is missing");if(!i)throw new Error("Provider is not registered: "+t);if(!n)throw new Error("the position argument is missing");this.isOpen()&&this.close(),this._emit("open");var r=this._current={provider:i,className:t,element:e,position:n};i.getHeaderEntries&&(r.headerEntries=i.getHeaderEntries(e)),r.entries=i.getEntries(e),r.container=this._createContainer();var o=r.headerEntries||[],a=r.entries||[];o.length&&r.container.appendChild(this._createEntries(r.headerEntries,"djs-popup-header")),a.length&&r.container.appendChild(this._createEntries(r.entries,"djs-popup-body"));var s=this._canvas.getContainer();this._attachContainer(r.container,s,n.cursor)},Gv.prototype.close=function(){this.isOpen()&&(this._emit("close"),this._unbindHandlers(),(0,st.remove)(this._current.container),this._current.container=null)},Gv.prototype.isOpen=function(){return!!this._current.container},Gv.prototype.trigger=function(e){e.preventDefault();var t=e.delegateTarget||e.target,n=(0,st.attr)(t,"data-id"),i=this._getEntry(n);if(i.action)return i.action.call(null,e,i)},Gv.prototype._getEntry=function(e){var t=(0,l.matchPattern)({id:e}),n=(0,l.find)(this._current.entries,t)||(0,l.find)(this._current.headerEntries,t);if(!n)throw new Error("entry not found");return n},Gv.prototype._emit=function(e){this._eventBus.fire("popupMenu."+e)},Gv.prototype._createContainer=function(){var e=(0,st.domify)('<div class="djs-popup">'),t=this._current.position,n=this._current.className;return(0,l.assign)(e.style,{position:"absolute",left:t.x+"px",top:t.y+"px",visibility:"hidden"}),(0,st.classes)(e).add(n),e},Gv.prototype._attachContainer=function(e,t,n){var i=this;st.delegate.bind(e,".entry","click",function(e){i.trigger(e)}),this._updateScale(e),t.appendChild(e),n&&this._assureIsInbounds(e,n),this._bindHandlers()},Gv.prototype._updateScale=function(e){var t,n,i,r,o=this._canvas.zoom(),a=this._config.scale,s=o;!0!==a&&(!1===a?(t=1,n=1):(t=a.min,n=a.max),(0,l.isDefined)(t)&&o<t&&(s=t),(0,l.isDefined)(n)&&o>n&&(s=n)),r="scale("+s+")",(i=e).style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(e){i.style[e+"transform"]=r})},Gv.prototype._assureIsInbounds=function(e,t){var n,i,r=this._canvas._container.getBoundingClientRect(),o=e.offsetLeft,a=e.offsetTop,s=e.scrollWidth,c=e.scrollHeight,u={},d=t.x-r.left,p=t.y-r.top;o+s>r.width&&(u.x=!0),a+c>r.height&&(u.y=!0),u.x&&u.y?(n=d-s+"px",i=p-c+"px"):u.x?(n=d-s+"px",i=p+"px"):u.y&&p<c?(n=d+"px",i="10px"):u.y&&(n=d+"px",i=p-c+"px"),(0,l.assign)(e.style,{left:n,top:i},{visibility:"visible","z-index":1e3})},Gv.prototype._createEntries=function(e,t){var n=(0,st.domify)("<div>"),i=this;return(0,st.classes)(n).add(t),(0,l.forEach)(e,function(e){var t=i._createEntry(e,n);n.appendChild(t)}),n},Gv.prototype._createEntry=function(e){if(!e.id)throw new Error("every entry must have the id property set");var t=(0,st.domify)("<div>"),n=(0,st.classes)(t);if(n.add("entry"),e.className&&e.className.split(" ").forEach(function(e){n.add(e)}),(0,st.attr)(t,"data-id",e.id),e.label){var i=(0,st.domify)("<span>");i.textContent=e.label,t.appendChild(i)}return e.imageUrl&&t.appendChild((0,st.domify)('<img src="'+e.imageUrl+'" />')),!0===e.active&&n.add("active"),!0===e.disabled&&n.add("disabled"),e.title&&(t.title=e.title),t},Gv.prototype._bindHandlers=function(){var e=this._eventBus,t=this;function n(){t.close()}e.once("contextPad.close",n),e.once("canvas.viewbox.changing",n),e.once("commandStack.changed",n)},Gv.prototype._unbindHandlers=function(){var e=this._eventBus,t=this;function n(){t.close()}e.off("contextPad.close",n),e.off("canvas.viewbox.changed",n),e.off("commandStack.changed",n)};var Kv={};Object.defineProperty(Kv,"__esModule",{value:!0});var Yv=function(e){return e&&e.__esModule?e:{default:e}}(qv);Kv.default={__init__:["popupMenu"],popupMenu:["type",Yv.default]};var Xv={};Object.defineProperty(Xv,"__esModule",{value:!0}),Xv.default=Qv;var Zv=Math.round;function Qv(e){this._modeling=e}Qv.$inject=["modeling"],Qv.prototype.replaceElement=function(e,t,n){var i=this._modeling,r=null;return e.waypoints||(t.x=Zv(e.x+(t.width||e.width)/2),t.y=Zv(e.y+(t.height||e.height)/2),r=i.replaceShape(e,t,n)),r};var Jv={};Object.defineProperty(Jv,"__esModule",{value:!0});var eg=function(e){return e&&e.__esModule?e:{default:e}}(Xv);Jv.default={__init__:["replace"],replace:["type",eg.default]};var tg={__depends__:[Kv.default,Jv.default,Ea.default],cmmnReplace:["type",Fv]},ng={},ig=dc.getOrientation,rg=e.is,og=e.getDefinition;function ag(e,t,n,i){return e.x-i<t.x&&e.y-i<t.y?"corner":e.x+i>t.x+t.width&&e.y-i<t.y?"corner":e.x-i<t.x&&e.y+i>t.y+t.height?"corner":e.x+i>t.x+t.width&&e.y+i>t.y+t.height?"corner":ig(e,t,n)}ng.getCriterionAttachment=function(e,t){var n,i=og(t);return"intersect"!==(n=rg(t,"cmmn:PlanItem")&&rg(i,"cmmn:Stage")?ag(e,t,-15,20):rg(i,"cmmn:Milestone")?ag(e,t,-3,7):ig(e,t,-15))?n:null};var sg=l.some,cg=l.forEach,ug=l.assign,lg=l.filter,dg=e.is,pg=e.isCasePlanModel,fg=e.getDefinition,hg=e.getBusinessObject,mg=ye.isCollapsed,yg=J.isAny,vg=J.isSame,gg=J.isSameCase,_g=J.getParent,xg=J.getParents,bg=Ac.isDiscretionaryToHumanTask,Eg=Ac.isHumanTask,wg=Ac.isDiscretionaryItem,Mg=ng.getCriterionAttachment,Sg=fs.default;function Cg(e){Sg.call(this,e)}u(Cg,Sg),Cg.$inject=["eventBus"];var Pg=Cg;function Rg(e,t){return-1!==xg(t).indexOf(e)}function Tg(e){return Lg(e)||Bg(e)||dg(fg(e),"cmmn:Stage")}function kg(e){return!e||Ag(e)}function Ag(e){return e.labelTarget}function Og(e){return e.waypoints}function jg(e){return!e.businessObject.cmmnElementRef}function Ng(e){return sg(e.incoming,function(e){return dg(e.businessObject.cmmnElementRef,"cmmn:OnPart")})}function Ig(e,t){var n=fg(e)||e;return!!dg(n,"cmmn:PlanFragment")&&!(!t&&dg(n,"cmmn:Stage"))}function Dg(e){return dg(fg(e),"cmmn:EventListener")}function Bg(e){return dg(fg(e),"cmmn:Milestone")}function Lg(e){return dg(fg(e),"cmmn:Task")}function zg(e){return!(!(e=fg(e))||!e.isBlocking)}function Fg(e){return dg(e,"cmmn:Criterion")}function $g(e){return dg(e,"cmmn:EntryCriterion")}function Hg(e){return dg(e,"cmmn:ExitCriterion")}function Ug(e){return dg(e,"cmmn:TextAnnotation")}function Wg(e){return dg(e,"cmmn:CaseFileItem")}function Vg(e){return dg(e,"cmmn:PlanItem")}Cg.prototype.init=function(){var e=this;this.addRule("connection.start",function(e){return function(e){if(kg(e))return null;return yg(e,["cmmn:CaseFileItem","cmmn:Criterion","cmmn:DiscretionaryItem","cmmn:PlanItem"])}(e.source)}),this.addRule("connection.create",function(t){var n=t.source,i=t.target,r=!1,o=t.hints||{},a=o.targetParent;if(o.targetAttach)return!1;a&&(i.parent=a);try{(r=e.canConnect(n,i)||e.canReplaceConnectionEnd(n,i,"target"))||(r=e.canConnect(i,n)||e.canReplaceConnectionEnd(i,n,"source"))&&ug(r,{reverse:!0})}finally{a&&(i.parent=null)}return r}),this.addRule("connection.reconnectStart",function(t){var n=t.connection,i=t.hover,r=i||t.source,o=n.target,a=!1;return!(a=e.canConnect(r,o,n))&&i&&((a=e.canReplaceConnectionEnd(i,o,"source"))||(a=e.canConnect(o,i,n)||e.canReplaceConnectionEnd(o,i,"target"))&&ug(a,{reverse:!0})),a}),this.addRule("connection.reconnectEnd",function(t){var n=t.connection,i=n.source,r=t.hover,o=r||t.target,a=!1;return!(a=e.canConnect(i,o,n))&&r&&((a=e.canReplaceConnectionEnd(i,r,"target"))||(a=e.canConnect(r,i,n)||e.canReplaceConnectionEnd(r,i,"source"))&&ug(a,{reverse:!0})),a}),this.addRule("shape.attach",function(t){return e.canAttach(t.shape,t.target,null,t.position)}),this.addRule("shape.create",function(t){var n=t.target,i=t.shape,r=t.source,o=t.position,a=[i];return e.canCreate(i,n,r,o)||e.canReplace(a,n,o,r)}),this.addRule("shape.resize",function(t){var n=t.shape,i=t.newBounds;return e.canResize(n,i)}),this.addRule("elements.move",function(t){var n=t.target,i=t.shapes,r=t.position;return e.canAttach(i,n,null,r)||e.canMove(i,n,r)||e.canReplace(i,n,r)}),this.addRule("shape.replace",function(e){var t,n=e.element;if(Fg(n)){if(t=n.host,pg(t))return!1;if(Lg(t)&&!zg(t))return!1;if(Bg(t)||Dg(t))return!1}}),this.addRule(["elements.delete"],function(t){return e.canRemove(t.elements)})},Cg.prototype.canRemove=function(e){return lg(e,function(e){return!Ag(e)})},Cg.prototype.canMove=function(e,t){var n=this;return!t||e.every(function(i){return!(wg(i)&&!n.canMoveDiscretionaryItem(i,e,t))&&n.canDrop(i,t)})},Cg.prototype.canMoveDiscretionaryItem=function(e,t,n){return!Ig(n)||sg(e.incoming,function(e){var i=e.source;if(jg(e))return Rg(n,i)||-1!==t.indexOf(i)})},Cg.prototype.canCreate=function(e,t,n,i){return!!t&&(Ag(t)?null:!vg(n,t)&&((!n||!Rg(n,t))&&(!(wg(e)&&!this.canCreateDiscretionaryItem(e,t,n))&&this.canDrop(e,t,i))))},Cg.prototype.canCreateDiscretionaryItem=function(e,t,n){return!Ig(t)||Rg(t,n)},Cg.prototype.canDrop=function(e,t){return!(!Ag(e)||Og(t))||(function(e){Og(e)&&(e=e.businessObject.cmmnElementRef);return dg(e,"cmmn:Artifact")}(e)?dg(t,"cmmndi:CMMNDiagram")||Ig(t,!0):!Fg(e)&&(pg(e)?dg(t,"cmmndi:CMMNDiagram"):!!Ig(t,!0)&&!mg(t)))},Cg.prototype.canResize=function(e,t){return Ig(e,!0)?!mg(e)&&(!t||t.width>=100&&t.height>=80):!!Ug(e)},Cg.prototype.canConnect=function(e,t,n){return kg(e)||kg(t)?null:!vg(e,t)&&(this.canConnectPlanItemOnPartConnection(e,t)?{type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0}:this.canConnectCaseFileItemOnPartConnection(e,t)?{type:"cmmn:CaseFileItemOnPart",isStandardEventVisible:!0}:this.canConnectDiscretionaryConnection(e,t,n)?{type:"cmmndi:CMMNEdge"}:n&&dg(n.businessObject.cmmnElementRef,"cmmn:Association")&&this.canConnectAssociation(e,t)?{type:"cmmn:Association"}:!(!Ug(e)&&!Ug(t))&&{type:"cmmn:Association"})},Cg.prototype.canConnectDiscretionaryConnection=function(e,t,n){if(!Eg(fg(e)))return!1;if(!zg(e))return!1;if(!wg(t))return!1;var i=fg(e),r=fg(t);if(vg(i,r))return!1;var o=_g(e),a=_g(t);if(!vg(o,a))return!1;if(bg(t)){if(!function(e,t,n){return!sg(t.incoming,function(i){return i!==n&&jg(i)&&i.source===e&&i.target===t})}(e,t,n))return!1;var s=_g(hg(t),"cmmn:HumanTask");if(!vg(fg(e),s)&&function(e,t){return sg(e.incoming,function(e){return e!==t&&jg(e)})}(t,n))return!1}return!0},Cg.prototype.canConnectPlanItemOnPartConnection=function(e,t){return!!gg(e,t)&&(Hg(e)&&(e=e.host),!vg(e,t.host)&&(!Rg(e,t.host)&&((!$g(t)||!Rg(t.host,e))&&(Vg(e)&&Fg(t)))))},Cg.prototype.canConnectCaseFileItemOnPartConnection=function(e,t){return!!(gg(e,t)&&Wg(e)&&Fg(t))},Cg.prototype.canConnectAssociation=function(e,t){return!Og(e)&&!Og(t)&&(!Rg(t,e)&&!Rg(e,t))},Cg.prototype.canAttach=function(e,t,n,i){if(vg(n,t))return!1;if(Array.isArray(e)||(e=[e]),1!==e.length)return!1;var r=e[0];return!Ag(r)&&(!!Fg(r)&&(!t||!!this.canAttachCriterion(r,t,i,n)&&"attach"))},Cg.prototype.canAttachEntryCriterion=function(e,t,n,i){return!!this.canAttachCriterion(e,t,n,i)&&((!i||!Rg(t,i))&&(!pg(t)&&(!Ig(t,!0)||!sg(e.incoming,function(e){if(dg(e.businessObject.cmmnElementRef,"cmmn:PlanItemOnPart"))return Rg(t,e.source)}))))},Cg.prototype.canAttachExitCriterion=function(e,t,n,i){return!!this.canAttachCriterion(e,t,n,i)&&(!Bg(t)&&!(Lg(t)&&!zg(t)))},Cg.prototype.canAttachCriterion=function(e,t,n,i){return(!i||!Rg(i,t))&&(!Fg(t)&&(!Dg(t)&&(!Ig(t)&&(!Ug(t)&&(!Wg(t)&&!(n&&!Mg(n,t)))))))},Cg.prototype.canReplace=function(e,t,n,i){if(!t)return!1;if(vg(i,t))return!1;var r={replacements:[]},o=this;return cg(e,function(a){if($g(a)&&!o.canAttachEntryCriterion(a,t,n,i)&&o.canAttachExitCriterion(a,t,n,i)&&r.replacements.push({oldElementId:a.id,newElementType:"cmmn:ExitCriterion"}),Hg(a)&&!o.canAttachExitCriterion(a,t,n,i)&&o.canAttachEntryCriterion(a,t,n,i)&&r.replacements.push({oldElementId:a.id,newElementType:"cmmn:EntryCriterion"}),Ig(t)&&wg(a)&&o.canDrop(a,t)&&!o.canMoveDiscretionaryItem(a,e,t)){var s={oldElementId:a.id,newElementType:"cmmn:PlanItem"};Ig(a)&&ug(s,{newDefinitionType:"cmmn:Stage"}),r.replacements.push(s)}}),!!r.replacements.length&&r},Cg.prototype.canReplaceConnectionEnd=function(e,t,n){return!(!e||!t)&&(!vg(e,t)&&(!!gg(e,t)&&("source"===n?this.canReplaceSource(e,t):this.canReplaceTarget(e,t))))},Cg.prototype.canReplaceSource=function(e,t){return wg(e)&&Fg(t)?!vg(e,t.host)&&(!Ig(e)&&(!Rg(e,t.host)&&((!$g(t)||!Rg(t.host,e))&&{type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0,replacements:[{oldElementId:e.id,newElementType:"cmmn:PlanItem"}]}))):!(!$g(e)||!$g(t))&&(!vg(e.host,t.host)&&(!Rg(t.host,e.host)&&!Rg(e.host,t.host)&&(!Ng(e)&&(!!this.canAttachExitCriterion(e,e.host)&&{type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0,replacements:[{oldElementId:e.id,newElementType:"cmmn:ExitCriterion"}]}))))},Cg.prototype.canReplaceTarget=function(e,t){return Eg(fg(e))&&Vg(t)?!!zg(e)&&(!Dg(t)&&!Bg(t)&&(n=t,!vg(fg(e),fg(n))&&(!!function(e,t){return vg(_g(e),_g(t))}(e,t)&&{type:"cmmndi:CMMNEdge",replacements:[{oldElementId:t.id,newElementType:"cmmn:DiscretionaryItem"}]}))):!(!Vg(e)&&!Hg(e)||!$g(t))&&(!vg(e.host||e,t.host)&&(!!Rg(t.host,e.host||e)&&(!Ng(t)&&(!!this.canAttachExitCriterion(t,t.host)&&{type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0,replacements:[{oldElementId:t.id,newElementType:"cmmn:ExitCriterion"}]}))));var n},Cg.prototype.canSetRepetitionRule=function(e){return Tg(e)},Cg.prototype.canSetRequiredRule=function(e){return Tg(e)},Cg.prototype.canSetManualActivationRule=function(e){return!Bg(e)&&Tg(e)};var qg={__depends__:[Ru.default],__init__:["cmmnRules"],cmmnRules:["type",Pg]},Gg={};Object.defineProperty(Gg,"__esModule",{value:!0}),Gg.default=Jg;var Kg=Xg(u),Yg=Xg(ds);function Xg(e){return e&&e.__esModule?e:{default:e}}var Zg=251,Qg=1401;function Jg(e,t,n,i){Yg.default.call(this,t);var r=e.get("movePreview",!1);t.on("shape.move.start",Qg,function(e){var t,n,i=e.context,r=i.shapes,o=i.validatedShapes;i.shapes=(n=e_(t=r),(0,l.unionBy)("id",t,n)),i.validatedShapes=function(e){var t=(0,l.groupBy)(e,"id");return(0,l.filter)(e,function(e){for(;e;){if(e.host&&t[e.host.id])return!1;e=e.parent}return!0})}(o)}),r&&t.on("shape.move.start",Zg,function(e){var t=e.context,n=e_(t.shapes);(0,l.forEach)(n,function(e){r.makeDraggable(t,e,!0),(0,l.forEach)(e.labels,function(e){r.makeDraggable(t,e,!0)})})}),this.preExecuted("elements.move",Qg,function(e){var t=e.context,n=t.closure,i=e_(t.shapes);(0,l.forEach)(i,function(e){n.add(e,n.topLevel[e.host.id])})}),this.postExecuted("elements.move",function(e){var t,n=e.context,r=n.shapes,o=n.newHost;r.length>1||(t=o?r:(0,l.filter)(r,function(e){return!!e.host}),(0,l.forEach)(t,function(e){i.updateAttachment(e,o)}))}),this.postExecuted("elements.move",function(e){var t=e.context.shapes;(0,l.forEach)(t,function(e){(0,l.forEach)(e.attachers,function(e){(0,l.forEach)(e.outgoing.slice(),function(e){n.allowed("connection.reconnectStart",{connection:e,source:e.source,target:e.target})||i.removeConnection(e)}),(0,l.forEach)(e.incoming.slice(),function(e){n.allowed("connection.reconnectEnd",{connection:e,source:e.source,target:e.target})||i.removeConnection(e)})})})}),this.postExecute("shape.create",function(e){var t=e.context,n=t.shape,r=t.host;r&&i.updateAttachment(n,r)}),this.postExecute("shape.replace",function(e){var t=e.context,r=t.oldShape,o=t.newShape;(0,_f.saveClear)(r.attachers,function(e){"attach"===n.allowed("elements.move",{target:o,shapes:[e]})?i.updateAttachment(e,o):i.removeShape(e)}),o.attachers.length&&(0,l.forEach)(o.attachers,function(e){var t=(0,Tf.getNewAttachShapeDelta)(e,r,o);i.moveShape(e,t,e.parent)})}),this.postExecute("shape.resize",function(e){var t=e.context,n=t.shape,r=t.oldBounds,o=t.newBounds,a=n.attachers;(0,l.forEach)(a,function(e){var t=(0,Tf.getNewAttachShapeDelta)(e,r,o);i.moveShape(e,t,e.parent),(0,l.forEach)(e.labels,function(e){i.moveShape(e,t,e.parent)})})}),this.preExecute("shape.delete",function(e){var t=e.context.shape;(0,_f.saveClear)(t.attachers,function(e){i.removeShape(e)}),t.host&&i.updateAttachment(t,null)}),t.on("spaceTool.move",function(e){var t=e.context,n=t.initialized,i=t.attachSupportInitialized;if(n&&!i){var r=t.movingShapes,o=(0,l.filter)(r,function(e){var t=e.host;return t&&-1===r.indexOf(t)});(0,l.forEach)(o,function(e){(0,Cn.remove)(r,e),(0,l.forEach)(e.labels,function(t){(0,Cn.remove)(r,e.label)})}),t.attachSupportInitialized=!0}})}function e_(e){return(0,l.flatten)((0,l.map)(e,function(e){return e.attachers||[]}))}(0,Kg.default)(Jg,Yg.default),Jg.$inject=["injector","eventBus","rules","modeling"];var t_={};Object.defineProperty(t_,"__esModule",{value:!0});var n_=r_(Ru),i_=r_(Gg);function r_(e){return e&&e.__esModule?e:{default:e}}t_.default={__depends__:[n_.default],__init__:["attachSupport"],attachSupport:["type",i_.default]};var o_={};Object.defineProperty(o_,"__esModule",{value:!0}),o_.default=d_;var a_=c_(u),s_=c_(ds);function c_(e){return e&&e.__esModule?e:{default:e}}var u_=250,l_=1400;function d_(e,t,n){s_.default.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",l_,function(e){var t=e.context,n=t.shapes,i=t.validatedShapes;t.shapes=p_(n),t.validatedShapes=p_(i)}),i&&t.on("shape.move.start",u_,function(e){var t=e.context,n=t.shapes,r=[];(0,l.forEach)(n,function(e){(0,l.forEach)(e.labels,function(n){n.hidden||-1!==t.shapes.indexOf(n)||r.push(n),e.labelTarget&&r.push(e)})}),(0,l.forEach)(r,function(e){i.makeDraggable(t,e,!0)})}),this.preExecuted("elements.move",l_,function(e){var t=e.context.closure,n=t.enclosedElements,i=[];(0,l.forEach)(n,function(e){(0,l.forEach)(e.labels,function(e){n[e.id]||i.push(e)})}),t.addAll(i)}),this.preExecute(["connection.delete","shape.delete"],function(e){var t=e.context,i=t.connection||t.shape;(0,_f.saveClear)(i.labels,function(e){n.removeShape(e,{nested:!0})})}),this.execute("shape.delete",function(e){var t=e.context,n=t.shape,i=n.labelTarget;i&&(t.labelTargetIndex=(0,Cn.indexOf)(i.labels,n),t.labelTarget=i,n.labelTarget=null)}),this.revert("shape.delete",function(e){var t=e.context,n=t.shape,i=t.labelTarget,r=t.labelTargetIndex;i&&((0,Cn.add)(i.labels,n,r),n.labelTarget=i)})}function p_(e){return(0,l.filter)(e,function(t){return-1===e.indexOf(t.labelTarget)})}(0,a_.default)(d_,s_.default),d_.$inject=["injector","eventBus","modeling"];var f_={};Object.defineProperty(f_,"__esModule",{value:!0});var h_=function(e){return e&&e.__esModule?e:{default:e}}(o_);f_.default={__init__:["labelSupport"],labelSupport:["type",h_.default]};var m_={};function y_(e){return(0,l.assign)({original:e.point.original||e.point},e.actual)}function v_(e,t){this._elementRegistry=e,this._graphicsFactory=t}Object.defineProperty(m_,"__esModule",{value:!0}),m_.default=v_,v_.$inject=["elementRegistry","graphicsFactory"],v_.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var i=this.getDockingPoint(e,t,!0),r=this.getDockingPoint(e,n),o=e.waypoints.slice(i.idx+1,r.idx);return o.unshift(y_(i)),o.push(y_(r)),o},v_.prototype.getDockingPoint=function(e,t,n){var i,r,o=e.waypoints;return{point:r=o[i=n?0:o.length-1],actual:this._getIntersection(t,e,n)||r,idx:i}},v_.prototype._getIntersection=function(e,t,n){var i=this._getShapePath(e),r=this._getConnectionPath(t);return(0,dc.getElementLineIntersection)(i,r,n)},v_.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)},v_.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)},v_.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};var g_={__init__:["modeling","cmmnUpdater"],__depends__:[gv,Av,tg,qg,id.default,Ea.default,f_.default,t_.default,sd.default],cmmnFactory:["type",md],cmmnUpdater:["type",Yd],elementFactory:["type",op],modeling:["type",Bh],layouter:["type",Ld],connectionDocking:["type",m_.default]},__=ua.default,x_=e.isCasePlanModel,b_=we.attr;function E_(e,t,n){__.call(this,e,t,n)}u(E_,__),E_.$inject=["eventBus","styles","elementRegistry"],E_.prototype.baseUpdateShapeOutline=__.prototype.updateShapeOutline,E_.prototype.updateShapeOutline=function(e,t){x_(t)?b_(e,{x:-this.offset,y:-this.offset-18,width:t.width+2*this.offset,height:t.height+18+2*this.offset}):this.baseUpdateShapeOutline(e,t)};var w_={__init__:["outline"],outline:["type",E_]},M_=l.assign;function S_(e,t,n,i,r,o,a){this._create=e,this._elementFactory=t,this._globalConnect=n,this._handTool=i,this._palette=o,this._lassoTool=r,this._spaceTool=a,o.registerProvider(this)}var C_=S_;S_.$inject=["create","elementFactory","globalConnect","handTool","lassoTool","palette","spaceTool"],S_.prototype.getPaletteEntries=function(e){var t={},n=this._create,i=this._elementFactory,r=this._spaceTool,o=this._lassoTool,a=this._globalConnect,s=this._handTool;function c(e,t,r,o){function a(t){n.start(t,i.createPlanItemShape(e))}var s=e.replace(/^cmmn:/,"");return{group:t,className:r,title:o||"Create "+s,action:{dragstart:a,click:a}}}function u(e){n.start(e,i.createCasePlanModelShape())}function l(e){n.start(e,i.createCriterionShape("cmmn:EntryCriterion"))}function d(e){n.start(e,i.createCaseFileItemShape())}return M_(t,{"hand-tool":{group:"tools",className:"cmmn-icon-hand-tool",title:"Activate the hand tool",action:{click:function(e){s.activateHand(e)}}},"lasso-tool":{group:"tools",className:"cmmn-icon-lasso-tool",title:"Activate the lasso tool",action:{click:function(e){o.activateSelection(e)}}},"space-tool":{group:"tools",className:"cmmn-icon-space-tool",title:"Activate the create/remove space tool",action:{click:function(e){r.activateSelection(e)}}},"global-connect-tool":{group:"tools",className:"cmmn-icon-connection",title:"Activate the global connect tool",action:{click:function(e){a.toggle(e)}}},"tool-separator":{group:"tools",separator:!0},"create.task":c("cmmn:Task","planItem","cmmn-icon-task"),"create.stage":c("cmmn:Stage","planItem","cmmn-icon-stage-expanded","Create expanded Stage"),"create.milestone":c("cmmn:Milestone","planItem","cmmn-icon-milestone"),"create.eventListener":c("cmmn:EventListener","planItem","cmmn-icon-event-listener"),"create.criterion":{group:"criterion",className:"cmmn-icon-entry-criterion",title:"Create Criterion",action:{dragstart:l,click:l}},"create.casePlanModel":{group:"casePlanModel",className:"cmmn-icon-case-plan-model",title:"Create CasePlanModel",action:{dragstart:u,click:u}},"create.caseFileItem":{group:"caseFileItem",className:"cmmn-icon-case-file-item",title:"Create Case File Item",action:{dragstart:d,click:d}}}),t};var P_={};Object.defineProperty(P_,"__esModule",{value:!0}),P_.default=k_;var R_="connect-ok",T_="connect-not-ok";function k_(e,t,n,i,r,o){var a=this;this._dragging=t,this._rules=o,r.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",function(e){var t=e.context,n=e.hover,r=t.canStartConnect=a.canStartConnect(n);null!==r&&(t.startTarget=n,i.addMarker(n,r?R_:T_))}),e.on(["global-connect.out","global-connect.cleanup"],function(e){var t=e.context.startTarget,n=e.context.canStartConnect;t&&i.removeMarker(t,n?R_:T_)}),e.on(["global-connect.ended"],function(t){var i=t.context.startTarget,r={x:t.x,y:t.y};if(a.canStartConnect(i))return e.once("element.out",function(){e.once(["connect.ended","connect.canceled"],function(){e.fire("global-connect.drag.ended")}),n.start(null,i,r)}),!1})}k_.$inject=["eventBus","dragging","connect","canvas","toolManager","rules"],k_.prototype.start=function(e){this._dragging.init(e,"global-connect",{trapClick:!1,data:{context:{}}})},k_.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.start()},k_.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)},k_.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})};var A_={};Object.defineProperty(A_,"__esModule",{value:!0}),A_.default=O_;function O_(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}O_.$inject=["eventBus","dragging"],O_.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error('A tool has to be registered with it\'s "events"');n.push(e),this.bindEvents(e,t)},O_.prototype.isActive=function(e){return e&&this._active===e},O_.prototype.length=function(e){return this._tools.length},O_.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))},O_.prototype.bindEvents=function(e,t){var n=this._eventBus,i=this._dragging,r=[];n.on(t.tool+".init",function(t){if(!t.context.reactivate&&this.isActive(e))return this.setActive(null),void i.cancel();this.setActive(e)},this),(0,l.forEach)(t,function(e){r.push(e+".ended"),r.push(e+".canceled")}),n.on(r,250,function(e){var t=e.originalEvent;this._active&&(t&&(0,st.closest)(t.target,'.group[data-group="tools"]')||this.setActive(null))},this)};var j_={};Object.defineProperty(j_,"__esModule",{value:!0});var N_=D_(bu),I_=D_(A_);function D_(e){return e&&e.__esModule?e:{default:e}}j_.default={__depends__:[N_.default],__init__:["toolManager"],toolManager:["type",I_.default]};var B_={};Object.defineProperty(B_,"__esModule",{value:!0});var L_=U_(ku),z_=U_(Ru),F_=U_(bu),$_=U_(j_),H_=U_(P_);function U_(e){return e&&e.__esModule?e:{default:e}}B_.default={__depends__:[L_.default,z_.default,F_.default,$_.default],globalConnect:["type",H_.default]};var W_={};Object.defineProperty(W_,"__esModule",{value:!0});var V_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};W_.default=G_;var q_=1500;function G_(e,t,n,i){this._dragging=n,i.registerTool("hand",{tool:"hand",dragging:"hand.move"}),e.on("element.mousedown",q_,function(e){if((0,ta.hasPrimaryModifier)(e))return this.activateMove(e.originalEvent),!1},this),e.on("hand.end",function(t){var n=t.originalEvent.target;if(!(t.hover||n instanceof SVGElement))return!1;e.once("hand.ended",function(){this.activateMove(t.originalEvent,{reactivate:!0})},this)},this),e.on("hand.move.move",function(e){var n=t.viewbox().scale;t.scroll({dx:e.dx*n,dy:e.dy*n})}),e.on("hand.move.end",function(t){var n=t.context.reactivate;return!(0,ta.hasPrimaryModifier)(t)&&n&&e.once("hand.move.ended",function(e){this.activateHand(e.originalEvent,!0,!0)},this),!1},this)}G_.$inject=["eventBus","canvas","dragging","toolManager"],G_.prototype.activateMove=function(e,t,n){"object"===(void 0===t?"undefined":V_(t))&&(n=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:"grab",data:{context:n||{}}})},G_.prototype.activateHand=function(e,t,n){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:"grab",data:{context:{reactivate:n}}})},G_.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateHand()},G_.prototype.isActive=function(){var e=this._dragging.context();return e&&/^hand/.test(e.prefix)};var K_={};Object.defineProperty(K_,"__esModule",{value:!0});var Y_=Z_(j_),X_=Z_(W_);function Z_(e){return e&&e.__esModule?e:{default:e}}K_.default={__depends__:[Y_.default],__init__:["handTool"],handTool:["type",X_.default]};var Q_={};Object.defineProperty(Q_,"__esModule",{value:!0}),Q_.default=J_;function J_(e,t,n,i,r,o){this._selection=r,this._dragging=n;var a=this,s=function(e){var n,i=t.getDefaultLayer();n=e.frame=(0,we.create)("rect"),(0,we.attr)(n,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),(0,we.append)(i,n)},c=function(e){var t=e.frame,n=e.bbox;(0,we.attr)(t,{x:n.x,y:n.y,width:n.width,height:n.height})},u=function(e){e.frame&&(0,we.remove)(e.frame)};o.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",function(t){var n=t.originalEvent.target;(t.hover||n instanceof SVGElement)&&e.once("lasso.selection.ended",function(){a.activateLasso(t.originalEvent,!0)})}),e.on("lasso.end",function(e){var t=ex(e),n=i.filter(function(e){return e});a.select(n,t)}),e.on("lasso.start",function(e){var t=e.context;t.bbox=ex(e),s(t)}),e.on("lasso.move",function(e){var t=e.context;t.bbox=ex(e),c(t)}),e.on("lasso.cleanup",function(e){var t=e.context;u(t)}),e.on("element.mousedown",1500,function(e){if((0,ta.hasSecondaryModifier)(e))return a.activateLasso(e.originalEvent),!0})}function ex(e){var t={x:e.x-e.dx,y:e.y-e.dy},n={x:e.x,y:e.y};return t.x<=n.x&&t.y<n.y||t.x<n.x&&t.y<=n.y?{x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}:t.x>=n.x&&t.y<n.y||t.x>n.x&&t.y<=n.y?{x:n.x,y:t.y,width:t.x-n.x,height:n.y-t.y}:t.x<=n.x&&t.y>n.y||t.x<n.x&&t.y>=n.y?{x:t.x,y:n.y,width:n.x-t.x,height:t.y-n.y}:t.x>=n.x&&t.y>n.y||t.x>n.x&&t.y>=n.y?{x:n.x,y:n.y,width:t.x-n.x,height:t.y-n.y}:{x:n.x,y:n.y,width:0,height:0}}J_.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager"],J_.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:"crosshair",data:{context:{}}})},J_.prototype.activateSelection=function(e){this._dragging.init(e,"lasso.selection",{trapClick:!1,cursor:"crosshair",data:{context:{}}})},J_.prototype.select=function(e,t){var n=(0,Tr.getEnclosedElements)(e,t);this._selection.select((0,l.values)(n))},J_.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection()},J_.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};var tx={};Object.defineProperty(tx,"__esModule",{value:!0});var nx=rx(j_),ix=rx(Q_);function rx(e){return e&&e.__esModule?e:{default:e}}tx.default={__depends__:[nx.default],__init__:["lassoTool"],lassoTool:["type",ix.default]};var ox={};Object.defineProperty(ox,"__esModule",{value:!0}),ox.default=ax;function ax(e,t){this._eventBus=e,this._canvas=t,this._providers=[];var n=this;e.on("tool-manager.update",function(e){var t=e.tool;n.updateToolHighlight(t)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._providers.length&&(n._init(),n._update())})}ax.$inject=["eventBus","canvas"],ax.prototype.registerProvider=function(e){this._providers.push(e),this._diagramInitialized&&(this._container||this._init(),this._update())},ax.prototype.getEntries=function(){var e={};return(0,l.forEach)(this._providers,function(t){var n=t.getPaletteEntries();(0,l.forEach)(n,function(t,n){e[n]=t})}),e},ax.prototype._init=function(){var e=this._canvas,t=this._eventBus,n=e.getContainer(),i=this._container=(0,st.domify)(ax.HTML_MARKUP),r=this;n.appendChild(i),st.delegate.bind(i,".djs-palette-toggle, .entry","click",function(e){var t=e.delegateTarget;if((0,st.matches)(t,".djs-palette-toggle"))return r.toggle();r.trigger("click",e)}),st.event.bind(i,"mousedown",function(e){e.stopPropagation()}),st.delegate.bind(i,".entry","dragstart",function(e){r.trigger("dragstart",e)}),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:i})},ax.prototype._toggleState=function(e){e=e||{};var t,n=this._getParentContainer(),i=this._container,r=this._eventBus,o=(0,st.classes)(i);t="twoColumn"in e?e.twoColumn:this._needsCollapse(n.clientHeight,this._entries||{}),o.toggle("two-column",t),"open"in e&&o.toggle("open",e.open),r.fire("palette.changed",{twoColumn:t,open:this.isOpen()})},ax.prototype._update=function(){var e=(0,st.query)(".djs-palette-entries",this._container),t=this._entries=this.getEntries();(0,st.clear)(e),(0,l.forEach)(t,function(t,n){var i=t.group||"default",r=(0,st.query)("[data-group="+i+"]",e);r||(r=(0,st.domify)('<div class="group" data-group="'+i+'"></div>'),e.appendChild(r));var o,a,s,c=t.html||(t.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),u=(0,st.domify)(c);r.appendChild(u),t.separator||((0,st.attr)(u,"data-action",n),t.title&&(0,st.attr)(u,"title",t.title),t.className&&(o=u,a=t.className,s=(0,st.classes)(o),((0,l.isArray)(a)?a:a.split(/\s+/g)).forEach(function(e){s.add(e)})),t.imageUrl&&u.appendChild((0,st.domify)('<img src="'+t.imageUrl+'">')))}),this.open()},ax.prototype.trigger=function(e,t,n){var i,r,o,a=this._entries,s=t.delegateTarget||t.target;if(!s)return t.preventDefault();(i=a[(0,st.attr)(s,"data-action")])&&(r=i.action,o=t.originalEvent||t,(0,l.isFunction)(r)?"click"===e&&r(o,n):r[e]&&r[e](o,n),t.preventDefault())},ax.prototype._layoutChanged=function(){this._toggleState({})},ax.prototype._needsCollapse=function(e,t){return e<46*Object.keys(t).length+50},ax.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})},ax.prototype.open=function(){this._toggleState({open:!0})},ax.prototype.toggle=function(e){this.isOpen()?this.close():this.open()},ax.prototype.isActiveTool=function(e){return e&&this._activeTool===e},ax.prototype.updateToolHighlight=function(e){var t,n;this._toolsContainer||(t=(0,st.query)(".djs-palette-entries",this._container),this._toolsContainer=(0,st.query)("[data-group=tools]",t)),n=this._toolsContainer,(0,l.forEach)(n.children,function(t){var n=t.getAttribute("data-action");if(n){var i=(0,st.classes)(t);n=n.replace("-tool",""),i.contains("entry")&&n===e?i.add("highlighted-entry"):i.remove("highlighted-entry")}})},ax.prototype.isOpen=function(){return(0,st.classes)(this._container).has("open")},ax.prototype._getParentContainer=function(){return this._canvas.getContainer()},ax.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';var sx={};Object.defineProperty(sx,"__esModule",{value:!0});var cx=function(e){return e&&e.__esModule?e:{default:e}}(ox);sx.default={__init__:["palette"],palette:["type",cx.default]};var ux={};function lx(e,t,n){this._elementRegistry=e,this._canvas=t,this._styles=n}Object.defineProperty(ux,"__esModule",{value:!0}),ux.default=lx,lx.$inject=["elementRegistry","canvas","styles"],lx.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)},lx.prototype.addDragger=function(e,t){var n=this.getGfx(e),i=(0,we.clone)(n),r=n.getBoundingClientRect();return e.waypoints&&function e(t){t.children&&(0,l.forEach)(t.children,function(t){e(t)});t.style.markerStart="";t.style.markerEnd=""}(i),(0,we.attr)(i,this._styles.cls("djs-dragger",[],{x:r.top,y:r.left})),(0,we.append)(t,i),i},lx.prototype.addFrame=function(e,t){var n=(0,we.create)("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return(0,we.append)(t,n),n};var dx={};Object.defineProperty(dx,"__esModule",{value:!0});var px=function(e){return e&&e.__esModule?e:{default:e}}(ux);dx.default={__init__:["previewSupport"],previewSupport:["type",px.default]};var fx={};Object.defineProperty(fx,"__esModule",{value:!0}),fx.default=_x;var hx=Math.abs,mx=Math.round,yx=1500,vx={x:"width",y:"height"},gx={x:"y",y:"x"};function _x(e,t,n,i,r,o){this._canvas=n,this._dragging=t,this._modeling=i,this._rules=r,this._toolManager=o;var a=this;o.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),e.on("spaceTool.selection.end",function(t){var n=t.originalEvent.target;(t.hover||n instanceof SVGElement)&&e.once("spaceTool.selection.ended",function(){a.activateMakeSpace(t.originalEvent)})}),e.on("spaceTool.move",yx,function(e){var t=e.context;t.initialized||(t.initialized=a.initializeMakeSpace(e,t))}),e.on("spaceTool.end",function(t){var n=t.context,i=n.axis,r=n.direction,o=n.movingShapes,s=n.resizingShapes;if(n.initialized){var c={x:mx(t.dx),y:mx(t.dy)};c[gx[i]]=0;var u=!0;(0,l.forEach)(s,function(e){("w"===r&&t.x>e.x+e.width||"e"===r&&t.x<e.x||"n"===r&&t.y>e.y+e.height||"s"===r&&t.y<e.y)&&(u=!1)}),u&&a.makeSpace(o,s,c,r),e.once("spaceTool.ended",function(e){a.activateSelection(e.originalEvent,!0,!0)})}})}_x.$inject=["eventBus","dragging","canvas","modeling","rules","toolManager"],_x.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{trapClick:!1,cursor:"crosshair",autoActivate:t,data:{context:{reactivate:n}}})},_x.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:"crosshair",data:{context:{}}})},_x.prototype.makeSpace=function(e,t,n,i){return this._modeling.createSpace(e,t,n,i)},_x.prototype.initializeMakeSpace=function(e,t){var n=hx(e.dx)>hx(e.dy)?"x":"y",i=e["d"+n],r=e[n]-i;if(hx(i)<5)return!1;i<0&&(i*=-1),(0,ta.hasPrimaryModifier)(e)&&(i*=-1);var o=this._canvas.getRootElement(),a=(0,Tr.selfAndAllChildren)(o,!0),s=this.calculateAdjustments(a,n,i,r);return(0,l.assign)(t,s,{axis:n,direction:(0,Zf.getDirection)(n,i)}),(0,Va.set)("resize-"+("x"===n?"ew":"ns")),!0},_x.prototype.calculateAdjustments=function(e,t,n,i){var r=[],o=[],a=this._rules;return e.forEach(function(e){var s=e[t],c=s+e[vx[t]];if(e.parent&&!e.waypoints)return n>0&&s>i?r.push(e):n<0&&c<i?r.push(e):s<i&&c>i&&a.allowed("shape.resize",{shape:e})?o.push(e):void 0}),{movingShapes:r,resizingShapes:o}},_x.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection()},_x.prototype.isActive=function(){var e=this._dragging.context();return e&&/^spaceTool/.test(e.prefix)};var xx={};Object.defineProperty(xx,"__esModule",{value:!0}),xx.default=Mx;var bx="djs-dragging",Ex="djs-resizing",wx=250;function Mx(e,t,n,i,r){function o(e,t){(0,l.forEach)(e,function(e){r.addDragger(e,t),n.addMarker(e,bx)})}e.on("spaceTool.selection.start",function(e){var t=n.getLayer("space"),r=e.context,o="M 0,-10000 L 0,10000",a="M -10000,0 L 10000,0",s=(0,we.create)("g");(0,we.attr)(s,i.cls("djs-crosshair-group",["no-events"])),(0,we.append)(t,s);var c=(0,we.create)("path");(0,we.attr)(c,"d",o),(0,we.classes)(c).add("djs-crosshair"),(0,we.append)(s,c);var u=(0,we.create)("path");(0,we.attr)(u,"d",a),(0,we.classes)(u).add("djs-crosshair"),(0,we.append)(s,u),r.crosshairGroup=s}),e.on("spaceTool.selection.move",function(e){var t=e.context.crosshairGroup;(0,Qe.translate)(t,e.x,e.y)}),e.on("spaceTool.selection.cleanup",function(e){var t=e.context.crosshairGroup;t&&(0,we.remove)(t)}),e.on("spaceTool.move",wx,function(e){var a=e.context,s=a.line,c=a.axis,u=a.movingShapes,d=a.resizingShapes;if(a.initialized){if(!a.dragGroup){var p=n.getLayer("space");s=(0,we.create)("path"),(0,we.attr)(s,"d","M0,0 L0,0"),(0,we.classes)(s).add("djs-crosshair"),(0,we.append)(p,s),a.line=s;var f=(0,we.create)("g");(0,we.attr)(f,i.cls("djs-drag-group",["no-events"])),(0,we.append)(n.getDefaultLayer(),f),o(u,f),o(a.movingConnections=t.filter(function(e){var t=!1;(0,l.forEach)(u,function(n){(0,l.forEach)(n.outgoing,function(n){e===n&&(t=!0)})});var n=!1;(0,l.forEach)(u,function(t){(0,l.forEach)(t.incoming,function(t){e===t&&(n=!0)})});var i=!1;(0,l.forEach)(d,function(t){(0,l.forEach)(t.outgoing,function(t){e===t&&(i=!0)})});var r=!1;return(0,l.forEach)(d,function(t){(0,l.forEach)(t.incoming,function(t){e===t&&(r=!0)})}),function(e){return e.waypoints}(e)&&(t||i)&&(n||r)}),f),a.dragGroup=f}if(!a.frameGroup){var h=(0,we.create)("g");(0,we.attr)(h,i.cls("djs-frame-group",["no-events"])),(0,we.append)(n.getDefaultLayer(),h);var m=[];(0,l.forEach)(d,function(e){var t=r.addFrame(e,h);m.push({element:t,initialWidth:t.getBBox().width,initialHeight:t.getBBox().height}),n.addMarker(e,Ex)}),a.frameGroup=h,a.frames=m}var y={x:"M"+e.x+", -10000 L"+e.x+", 10000",y:"M -10000, "+e.y+" L 10000, "+e.y};(0,we.attr)(s,{path:y[c],display:""});var v={x:e.dx,y:e.dy};v[{x:"y",y:"x"}[a.axis]]=0,(0,Qe.translate)(a.dragGroup,v.x,v.y),(0,l.forEach)(a.frames,function(e){e.initialWidth+v.x>5&&(0,we.attr)(e.element,{width:e.initialWidth+v.x}),e.initialHeight+v.y>5&&(0,we.attr)(e.element,{height:e.initialHeight+v.y})})}}),e.on("spaceTool.cleanup",function(e){var t=e.context,i=t.movingShapes,r=t.movingConnections,o=t.resizingShapes,a=t.line,s=t.dragGroup,c=t.frameGroup;(0,l.forEach)(i,function(e){n.removeMarker(e,bx)}),(0,l.forEach)(r,function(e){n.removeMarker(e,bx)}),s&&((0,we.remove)(a),(0,we.remove)(s)),(0,l.forEach)(o,function(e){n.removeMarker(e,Ex)}),c&&(0,we.remove)(c)})}Mx.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];var Sx={};Object.defineProperty(Sx,"__esModule",{value:!0});var Cx=Ox(bu),Px=Ox(Ru),Rx=Ox(j_),Tx=Ox(dx),kx=Ox(fx),Ax=Ox(xx);function Ox(e){return e&&e.__esModule?e:{default:e}}Sx.default={__init__:["spaceToolPreview"],__depends__:[Cx.default,Px.default,Rx.default,Tx.default],spaceTool:["type",kx.default],spaceToolPreview:["type",Ax.default]};var jx={__depends__:[sx.default,Xu.default,Sx.default,tx.default,K_.default,B_.default],__init__:["paletteProvider"],paletteProvider:["type",C_]},Nx={};(function(e){"use strict";var t,n,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t=void 0!==e?e:void 0,n=function(e){if(e.CSS&&e.CSS.escape)return e.CSS.escape;var t=function(e){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var t,n=String(e),i=n.length,r=-1,o="",a=n.charCodeAt(0);++r<i;)0!=(t=n.charCodeAt(r))?o+=t>=1&&t<=31||127==t||0==r&&t>=48&&t<=57||1==r&&t>=48&&t<=57&&45==a?"\\"+t.toString(16)+" ":(0!=r||1!=i||45!=t)&&(t>=128||45==t||95==t||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122)?n.charAt(r):"\\"+n.charAt(r):o+="�";return o};return e.CSS||(e.CSS={}),e.CSS.escape=t,t},"object"==(void 0===Nx?"undefined":i(Nx))?Nx=n(t):n(t)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Ix=ds.default,Dx=l.assign,Bx=l.forEach,Lx=Jr.getVisual,zx=Ac.isItemCapable,Fx=e.getBusinessObject,$x=e.getDefinition,Hx=st.query,Ux=we.append,Wx=we.classes,Vx=we.create,qx=we.remove,Gx=250;function Kx(e,t,n,i,r,o){function a(e){return e.visualReplacements||(e.visualReplacements={}),e.visualReplacements}function s(e){var n=e.context,i=n.canExecute||n.allowed;if("attach"===i){var r=n.position||{x:e.x,y:e.y},o=n.shapes||[n.shape],a=n.target;i=t.canReplace(o,a,r,n.source)}return i}function c(e,t){var n=e&&Lx(e);n&&(qx(n),n=Vx("g"),Wx(n).add("djs-visual"),Ux(e,n),o.drawShape(n,t))}function u(t,r,o){Bx(r,function(r){var a=r.oldElementId,s=i.get(a)||t.shape;if(!t.visualReplacements[a]){var u=function(t,i){var r={type:i.newElementType,x:t.x,y:t.y,width:t.width,height:t.height};if(zx(t)){var o,a=Fx(t),s=$x(t),c=i.newElementType,u=i.newDefinitionType;u&&(s=e.replacePlanItemDefinition(s,u)),o=e.replaceItemCapable(a,c,s),Dx(r,{businessObject:o})}return n.createShape(r)}(s,r);c(o(s),u),t.visualReplacements[a]=s}})}function l(e,t){var n=e.visualReplacements;Bx(n,function(e,i){c(t(e),e),delete n[i]})}Ix.call(this,r),r.on(["shape.move.move","create.move"],Gx,function(e){var t=e.context,n=t.dragGroup,i=t.visual,r=s(e),o=r&&r.replacements;a(t);var c=function(e){var t,r;return n?(t='[data-element-id="'+Nx(e.id)+'"]',r=n):i&&(t=".djs-dragger",r=i),r&&Hx(t,r)};o&&o.length?u(t,o,c):l(t,c)}),r.on(["bendpoint.move.move","connect.move"],Gx,function(e){var t=e.context,n=s(e),r=n&&n.replacements;a(t),r&&r.length&&u(t,r,function(e){return i.getGraphics(e)})}),r.on(["bendpoint.move.cancel","bendpoint.move.cleanup","bendpoint.move.end","bendpoint.move.out","connect.cleanup","connect.end","connect.out"],Gx,function(e){l(e.context,function(e){return i.getGraphics(e)})})}Kx.$inject=["cmmnReplace","cmmnRules","elementFactory","elementRegistry","eventBus","graphicsFactory"],u(Kx,Ix);var Yx=Kx,Xx={};Object.defineProperty(Xx,"__esModule",{value:!0}),Xx.default=tb;var Zx=500,Qx=1250,Jx=1500,eb=Math.round;function tb(e,t,n,i,r){function o(e,t,n,i){return r.allowed("elements.move",{shapes:e,delta:t,position:n,target:i})}function a(e,n,i){if(!n.waypoints&&n.parent){var r=function(e){return{x:e.x+eb(e.width/2),y:e.y+eb(e.height/2)}}(n);return t.init(e,r,"shape.move",{cursor:"grabbing",autoActivate:i,data:{shape:n,context:{}}}),!0}}e.on("shape.move.start",Jx,function(e){var t,n,r=e.context,o=e.shape,a=i.get().slice();-1===a.indexOf(o)&&(a=[o]),t=a,n=(0,l.groupBy)(t,"id"),a=(0,l.filter)(t,function(e){for(;e=e.parent;)if(n[e.id])return!1;return!0}),(0,l.assign)(r,{shapes:a,validatedShapes:a,shape:o})}),e.on("shape.move.start",Qx,function(e){var t=e.context,n=t.validatedShapes;if(!(t.canExecute=o(n)))return!1}),e.on("shape.move.move",Zx,function(e){var t,n=e.context,i=n.validatedShapes,r=e.hover,a={x:e.dx,y:e.dy};t=o(i,a,{x:e.x,y:e.y},r),n.delta=a,n.canExecute=t,n.target=null!==t?r:null}),e.on("shape.move.end",function(e){var t=e.context,i=t.delta,r=t.canExecute,o="attach"===r,a=t.shapes;if(!r)return!1;i.x=eb(i.x),i.y=eb(i.y),n.moveElements(a,i,t.target,{primaryShape:t.shape,attach:o})}),e.on("element.mousedown",function(e){var t=(0,Zo.getOriginal)(e);if(!t)throw new Error("must supply DOM mousedown event");return a(t,e.element)}),this.start=a}tb.$inject=["eventBus","dragging","modeling","selection","rules"];var nb={};Object.defineProperty(nb,"__esModule",{value:!0}),nb.default=ub;var ib=499,rb="djs-dragging",ob="drop-ok",ab="drop-not-ok",sb="new-parent",cb="attach-ok";function ub(e,t,n,i,r){function o(e){return function(e){return(0,l.filter)(e,function(t){return!function(e){return e.waypoints}(t)||(0,l.find)(e,(0,l.matchPattern)({id:t.source.id}))&&(0,l.find)(e,(0,l.matchPattern)({id:t.target.id}))})}(a(e))}function a(e){var t=(0,Tr.selfAndAllChildren)(e,!0),n=(0,l.map)(t,function(e){return(e.incoming||[]).concat(e.outgoing||[])});return(0,l.flatten)(t.concat(n))}function s(e,t){[cb,ob,ab,sb].forEach(function(i){i===t?n.addMarker(e,i):n.removeMarker(e,i)})}e.on("shape.move.start",ib,function(e){var t,s=e.context,c=s.shapes,u=s.allDraggedElements,d=o(c);if(!s.dragGroup){var p=(0,we.create)("g");(0,we.attr)(p,i.cls("djs-drag-group",["no-events"]));var f=n.getDefaultLayer();(0,we.append)(f,p),s.dragGroup=p}d.forEach(function(e){r.addDragger(e,s.dragGroup)}),u=u?(0,l.flatten)([u,a(c)]):a(c),(0,l.forEach)(u,function(e){n.addMarker(e,rb)}),s.allDraggedElements=u,s.differentParents=(t=c,1!==(0,l.size)((0,l.groupBy)(t,function(e){return e.parent&&e.parent.id})))}),e.on("shape.move.move",ib,function(e){var t=e.context,n=t.dragGroup,i=t.target,r=t.shape.parent,o=t.canExecute;i&&("attach"===o?s(i,cb):t.canExecute&&i&&i.id!==r.id?s(i,sb):s(i,t.canExecute?ob:ab)),(0,Qe.translate)(n,e.dx,e.dy)}),e.on(["shape.move.out","shape.move.cleanup"],function(e){var t=e.context.target;t&&s(t,null)}),e.on("shape.move.cleanup",function(e){var t=e.context,i=t.allDraggedElements,r=t.dragGroup;(0,l.forEach)(i,function(e){n.removeMarker(e,rb)}),r&&(0,we.clear)(r)}),this.makeDraggable=function(e,t,i){r.addDragger(t,e.dragGroup),i&&n.addMarker(t,rb),e.allDraggedElements?e.allDraggedElements.push(t):e.allDraggedElements=[t]}}ub.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];var lb={};Object.defineProperty(lb,"__esModule",{value:!0});var db=_b(sa),pb=_b(Ea),fb=_b(pa),hb=_b(Ru),mb=_b(bu),yb=_b(dx),vb=_b(Xx),gb=_b(nb);function _b(e){return e&&e.__esModule?e:{default:e}}lb.default={__depends__:[db.default,pb.default,fb.default,hb.default,mb.default,yb.default],__init__:["move","movePreview"],move:["type",vb.default],movePreview:["type",gb.default]};var xb={__depends__:[lb.default],__init__:["cmmnReplacePreview"],cmmnReplacePreview:["type",Yx]},bb=l.map,Eb=l.filter,wb=l.sortBy;function Mb(e,t,n){this._elementRegistry=e,this._canvas=n,t.registerProvider(this)}var Sb=Mb;function Cb(e){return Eb(e,function(e){return!!e.matched}).length>0}function Pb(e,t){var n=[],i=e;if(!e)return n;e=e.toLowerCase(),t=t.toLowerCase();var r=e.indexOf(t);return r>-1?(0!==r&&n.push({normal:i.substr(0,r)}),n.push({matched:i.substr(r,t.length)}),t.length+r<e.length&&n.push({normal:i.substr(t.length+r,e.length)})):n.push({normal:i}),n}Mb.$inject=["elementRegistry","searchPad","canvas"],Mb.prototype.find=function(e){var t=this._canvas.getRootElement(),n=this._elementRegistry.filter(function(e){return!e.labelTarget});return n=Eb(n,function(e){return e!==t}),n=bb(n,function(t){return{primaryTokens:Pb(Cl.getLabel(t),e),secondaryTokens:Pb(t.id,e),element:t}}),n=Eb(n,function(e){return Cb(e.primaryTokens)||Cb(e.secondaryTokens)}),n=wb(n,function(e){return Cl.getLabel(e.element)+e.element.id})};var Rb={};function Tb(e,t,n,i){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=e,this._eventBus=t,this._overlays=n,this._selection=i,this._container=(0,st.domify)(Tb.BOX_HTML),this._searchInput=(0,st.query)(Tb.INPUT_SELECTOR,this._container),this._resultsContainer=(0,st.query)(Tb.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),t.on(["canvas.destroy","diagram.destroy"],this.close,this)}function kb(e,t,n){var i=function(e){var t="";return e.forEach(function(e){e.matched?t+='<strong class="'+Tb.RESULT_HIGHLIGHT_CLASS+'">'+e.matched+"</strong>":t+=e.normal}),""!==t?t:null}(t),r=(0,st.domify)(n);r.innerHTML=i,e.appendChild(r)}Object.defineProperty(Rb,"__esModule",{value:!0}),Rb.default=Tb,Tb.$inject=["canvas","eventBus","overlays","selection"],Tb.prototype._bindEvents=function(){var e=this;function t(t,n,i,r){e._eventMaps.push({el:t,type:i,listener:st.delegate.bind(t,n,i,r)})}t(document,"html","click",function(t){e.close()}),t(this._container,Tb.INPUT_SELECTOR,"click",function(e){e.stopPropagation(),e.delegateTarget.focus()}),t(this._container,Tb.RESULT_SELECTOR,"mouseover",function(t){t.stopPropagation(),e._scrollToNode(t.delegateTarget),e._preselect(t.delegateTarget)}),t(this._container,Tb.RESULT_SELECTOR,"click",function(t){t.stopPropagation(),e._select(t.delegateTarget)}),t(this._container,Tb.INPUT_SELECTOR,"keydown",function(e){38===e.keyCode&&e.preventDefault(),40===e.keyCode&&e.preventDefault()}),t(this._container,Tb.INPUT_SELECTOR,"keyup",function(t){if(27===t.keyCode)return e.close();if(13===t.keyCode){var n=e._getCurrentResult();return n?e._select(n):e.close()}return 38===t.keyCode?e._scrollToDirection(!0):40===t.keyCode?e._scrollToDirection():void(37!==t.keyCode&&39!==t.keyCode&&e._search(t.delegateTarget.value))})},Tb.prototype._unbindEvents=function(){this._eventMaps.forEach(function(e){st.delegate.unbind(e.el,e.type,e.listener)})},Tb.prototype._search=function(e){var t=this;if(this._clearResults(),e&&""!==e){var n=this._searchProvider.find(e);if(n.length){n.forEach(function(e){var n=e.element.id,i=t._createResultNode(e,n);t._results[n]={element:e.element,node:i}});var i=(0,st.query)(Tb.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}}},Tb.prototype._scrollToDirection=function(e){var t=this._getCurrentResult();if(t){var n=e?t.previousElementSibling:t.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}},Tb.prototype._scrollToNode=function(e){if(e&&e!==this._getCurrentResult()){var t=e.offsetTop,n=this._resultsContainer.scrollTop,i=t-this._resultsContainer.clientHeight+e.clientHeight;t<n?this._resultsContainer.scrollTop=t:n<i&&(this._resultsContainer.scrollTop=i)}},Tb.prototype._clearResults=function(){(0,st.clear)(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire("searchPad.cleared")},Tb.prototype._getCurrentResult=function(){return(0,st.query)(Tb.RESULT_SELECTED_SELECTOR,this._resultsContainer)},Tb.prototype._createResultNode=function(e,t){var n=(0,st.domify)(Tb.RESULT_HTML);return e.primaryTokens.length>0&&kb(n,e.primaryTokens,Tb.RESULT_PRIMARY_HTML),kb(n,e.secondaryTokens,Tb.RESULT_SECONDARY_HTML),(0,st.attr)(n,Tb.RESULT_ID_ATTRIBUTE,t),this._resultsContainer.appendChild(n),n},Tb.prototype.registerProvider=function(e){this._searchProvider=e},Tb.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._bindEvents(),this._open=!0,(0,st.classes)(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))},Tb.prototype.close=function(){this.isOpen()&&(this._unbindEvents(),this._open=!1,(0,st.classes)(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire("searchPad.closed"))},Tb.prototype.toggle=function(){this.isOpen()?this.close():this.open()},Tb.prototype.isOpen=function(){return this._open},Tb.prototype._preselect=function(e){var t=this._getCurrentResult();if(e!==t){t&&(0,st.classes)(t).remove(Tb.RESULT_SELECTED_CLASS);var n=(0,st.attr)(e,Tb.RESULT_ID_ATTRIBUTE),i=this._results[n].element;(0,st.classes)(e).add(Tb.RESULT_SELECTED_CLASS),this._resetOverlay(i),this._centerViewbox(i),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}},Tb.prototype._select=function(e){var t=(0,st.attr)(e,Tb.RESULT_ID_ATTRIBUTE),n=this._results[t].element;this.close(),this._resetOverlay(),this._centerViewbox(n),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)},Tb.prototype._centerViewbox=function(e){var t=this._canvas.viewbox(),n=(0,Tr.getBBox)(e),i={x:n.x+n.width/2-t.outer.width/2,y:n.y+n.height/2-t.outer.height/2,width:t.outer.width,height:t.outer.height};this._canvas.viewbox(i),this._canvas.zoom(t.scale)},Tb.prototype._resetOverlay=function(e){if(this._overlayId&&this._overlays.remove(this._overlayId),e){var t=function(e){var t=e.width+12,n=e.height+12,i=["width: "+t+"px","height: "+n+"px"].join("; ");return{position:{bottom:n-6,right:t-6},show:!0,html:'<div style="'+i+'" class="'+Tb.OVERLAY_CLASS+'"></div>'}}((0,Tr.getBBox)(e));this._overlayId=this._overlays.add(e,t)}},Tb.CONTAINER_SELECTOR=".djs-search-container",Tb.INPUT_SELECTOR=".djs-search-input input",Tb.RESULTS_CONTAINER_SELECTOR=".djs-search-results",Tb.RESULT_SELECTOR=".djs-search-result",Tb.RESULT_SELECTED_CLASS="djs-search-result-selected",Tb.RESULT_SELECTED_SELECTOR="."+Tb.RESULT_SELECTED_CLASS,Tb.RESULT_ID_ATTRIBUTE="data-result-id",Tb.RESULT_HIGHLIGHT_CLASS="djs-search-highlight",Tb.OVERLAY_CLASS="djs-search-overlay",Tb.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable"><div class="djs-search-input"><input type="text"/></div><div class="djs-search-results"></div></div>',Tb.RESULT_HTML='<div class="djs-search-result"></div>',Tb.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>',Tb.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';var Ab={};Object.defineProperty(Ab,"__esModule",{value:!0});var Ob=Ib(Yo),jb=Ib(Ea),Nb=Ib(Rb);function Ib(e){return e&&e.__esModule?e:{default:e}}Ab.default={__depends__:[Ob.default,jb.default],searchPad:["type",Nb.default]};var Db={__depends__:[Ab.default],__init__:["cmmnSearch"],cmmnSearch:["type",Sb]},Bb={};Object.defineProperty(Bb,"__esModule",{value:!0}),Bb.snapTo=function(e,t,n){var i,r;for(n=void 0===n?10:n,i=0;i<t.length;i++)if(r=t[i],Lb(r-e)<=n)return r},Bb.mid=function(e,t){if(!e||isNaN(e.x)||isNaN(e.y))return t;return{x:zb(e.x+e.width/2),y:zb(e.y+e.height/2)}},Bb.isSnapped=function(e,t){var n=e.snapped;if(!n)return!1;if("string"==typeof t)return n[t];return n.x&&n.y},Bb.setSnapped=function(e,t,n){if("string"!=typeof t)throw new Error("axis must be in [x, y]");if("number"!=typeof n&&!1!==n)throw new Error("value must be Number or false");var i,r=e[t],o=e.snapped=e.snapped||{};!1===n?o[t]=!1:(o[t]=!0,i=n-r,e[t]+=i,e["d"+t]+=i);return r};var Lb=Math.abs,zb=Math.round;var Fb={};function $b(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}function Hb(e){this._snapValues={}}Object.defineProperty(Fb,"__esModule",{value:!0}),Fb.default=$b,$b.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]},$b.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,-1===this._snapLocations.indexOf(e)&&this._snapLocations.push(e)},$b.prototype.addDefaultSnap=function(e,t){var n=this._defaultSnaps[e];n||(n=this._defaultSnaps[e]=[]),n.push(t)},$b.prototype.getSnapLocations=function(){return this._snapLocations},$b.prototype.setSnapLocations=function(e){this._snapLocations=e},$b.prototype.pointsForTarget=function(e){var t=e.id||e,n=this._targets[t];return n||(n=this._targets[t]=new Hb).initDefaults(this._defaultSnaps),n},Hb.prototype.add=function(e,t){var n=this._snapValues[e];n||(n=this._snapValues[e]={x:[],y:[]}),-1===n.x.indexOf(t.x)&&n.x.push(t.x),-1===n.y.indexOf(t.y)&&n.y.push(t.y)},Hb.prototype.snap=function(e,t,n,i){var r=this._snapValues[t];return r&&(0,Bb.snapTo)(e[n],r[n],i)},Hb.prototype.initDefaults=function(e){var t=this;(0,l.forEach)(e||{},function(e,n){(0,l.forEach)(e,function(e){t.add(n,e)})})};var Ub={};Object.defineProperty(Ub,"__esModule",{value:!0});var Wb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Ub.default=Gb;var Vb=function(e){return e&&e.__esModule?e:{default:e}}(Fb);var qb=1250;function Gb(e,t){this._canvas=t;var n=this;e.on(["shape.move.start","create.start"],function(e){n.initSnap(e)}),e.on(["shape.move.move","shape.move.end","create.move","create.end"],qb,function(e){e.originalEvent&&e.originalEvent.ctrlKey||(0,Bb.isSnapped)(e)||n.snap(e)}),e.on(["shape.move.cleanup","create.cleanup"],function(e){n.hide()}),this._asyncHide=(0,l.debounce)((0,l.bind)(this.hide,this),1e3)}Gb.$inject=["eventBus","canvas"],Gb.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.snapContext;i||(i=t.snapContext=new Vb.default);var r=(0,Bb.mid)(n,e);return i.setSnapOrigin("mid",{x:r.x-e.x,y:r.y-e.y}),i},Gb.prototype.snap=function(e){var t=e.context,n=t.snapContext,i=t.shape,r=t.target,o=n.getSnapLocations();if(r){var a=n.pointsForTarget(r);a.initialized||(this.addTargetSnaps(a,i,r),a.initialized=!0);var s={x:(0,Bb.isSnapped)(e,"x"),y:(0,Bb.isSnapped)(e,"y")};(0,l.forEach)(o,function(t){var i=n.getSnapOrigin(t),r={x:e.x+i.x,y:e.y+i.y};if((0,l.forEach)(["x","y"],function(e){var n;s[e]||void 0!==(n=a.snap(r,t,e,7))&&(s[e]={value:n,originValue:n-i[e]})}),s.x&&s.y)return!1}),this.showSnapLine("vertical",s.x&&s.x.value),this.showSnapLine("horizontal",s.y&&s.y.value),(0,l.forEach)(["x","y"],function(t){var n=s[t];"object"===(void 0===n?"undefined":Wb(n))&&(0,Bb.setSnapped)(e,t,n.originValue)})}},Gb.prototype._createLine=function(e){var t=this._canvas.getLayer("snap"),n=(0,we.create)("path");return(0,we.attr)(n,{d:"M0,0 L0,0"}),(0,we.classes)(n).add("djs-snap-line"),(0,we.append)(t,n),{update:function(t){"number"!=typeof t?(0,we.attr)(n,{display:"none"}):"horizontal"===e?(0,we.attr)(n,{d:"M-100000,"+t+" L+100000,"+t,display:""}):(0,we.attr)(n,{d:"M "+t+",-100000 L "+t+", +100000",display:""})}}},Gb.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}},Gb.prototype.showSnapLine=function(e,t){var n=this.getSnapLine(e);n&&n.update(t),this._asyncHide()},Gb.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]},Gb.prototype.hide=function(){(0,l.forEach)(this._snapLines,function(e){e.update()})},Gb.prototype.addTargetSnaps=function(e,t,n){var i=this.getSiblings(t,n);(0,l.forEach)(i,function(t){e.add("mid",(0,Bb.mid)(t))})},Gb.prototype.getSiblings=function(e,t){return t&&(0,l.filter)(t.children,function(t){return!t.hidden&&!t.labelTarget&&t.host!==e&&t!==e})};var Kb=e.is,Yb=e.getDefinition,Xb=ye.isCollapsed,Zb=Ub.default,Qb=Bb.mid,Jb=Bb.isSnapped,eE=Bb.setSnapped,tE=dc.asTRBL,nE=1001,iE=l.forEach,rE=ng.getCriterionAttachment;function oE(e,t,n){Zb.call(this,e,t),e.on("resize.start",nE+500,function(e){var t=e.context,n=t.shape;Kb(Yb(n),"cmmn:PlanFragment")&&!Xb(n)&&(t.minDimensions={width:140,height:120}),Kb(n,"cmmn:TextAnnotation")&&(t.minDimensions={width:50,height:30})}),e.on(["create.move","create.end","shape.move.move","shape.move.end"],1500,function(e){var t=e.context,i=t.target,r=t.shape;i&&!Jb(e)&&function(e,t,i){return"attach"===n.canAttach([e],t,null,i)}(r,i,e)&&function(e,t,n){var i=tE(n),r=rE(e,n);/top/.test(r)?eE(e,"y",i.top):/bottom/.test(r)&&eE(e,"y",i.bottom);/left/.test(r)?eE(e,"x",i.left):/right/.test(r)&&eE(e,"x",i.right)}(e,0,i)})}u(oE,Zb),oE.$inject=["eventBus","canvas","cmmnRules"];var aE=oE;oE.prototype.addTargetSnaps=function(e,t,n){var i=this.getSiblings(t,n)||[];iE(i,function(t){t.waypoints||e.add("mid",Qb(t))}),iE(t.incoming,function(t){-1===i.indexOf(t.source)&&e.add("mid",Qb(t.source));var n=t.waypoints[0];e.add(t.id+"-docking",n.original||n)}),iE(t.outgoing,function(t){-1===i.indexOf(t.target)&&e.add("mid",Qb(t.target));var n=t.waypoints[t.waypoints.length-1];e.add(t.id+"-docking",n.original||n)})};var sE={__init__:["snapping"],snapping:["type",aE]},cE={};function uE(e,t,n,i){this._canvas=n,this._mouseTracking=i,this._opts=(0,l.assign)({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var r=this;t.on("drag.move",function(e){var t=r._toBorderPoint(e);r.startScroll(t)}),t.on(["drag.cleanup"],function(){r.stopScroll()})}function lE(e,t,n){return t<e&&e<n}Object.defineProperty(cE,"__esModule",{value:!0}),cE.default=uE,uE.$inject=["config.autoScroll","eventBus","canvas","mouseTracking"],uE.prototype.startScroll=function(e){var t=this._canvas,n=this._opts,i=this,r=t.getContainer().getBoundingClientRect(),o=[e.x,e.y,r.width-e.x,r.height-e.y];this.stopScroll();for(var a=0,s=0,c=0;c<4;c++)lE(o[c],n.scrollThresholdOut[c],n.scrollThresholdIn[c])&&(0===c?a=n.scrollStep:1==c?s=n.scrollStep:2==c?a=-n.scrollStep:3==c&&(s=-n.scrollStep));0===a&&0===s||(t.scroll({dx:a,dy:s}),this._scrolling=setTimeout(function(){i.startScroll(e)},n.scrollRepeatTimeout))},uE.prototype.stopScroll=function(){clearTimeout(this._scrolling)},uE.prototype.setOptions=function(e){this._opts=(0,l.assign)({},this._opts,e)},uE.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),n=(0,Zo.toPoint)(e.originalEvent);return{x:n.x-t.left,y:n.y-t.top}};var dE={};function pE(e,t){this._eventBus=e,this._canvas=t,this._init()}Object.defineProperty(dE,"__esModule",{value:!0}),dE.default=pE,pE.$inject=["eventBus","canvas"],pE.prototype.getHoverContext=function(){var e=this._canvas.viewbox();return{element:this._hoverElement,point:{x:e.x+Math.round(this._mouseX/e.scale),y:e.y+Math.round(this._mouseY/e.scale)}}},pE.prototype._init=function(){var e=this._eventBus,t=this._canvas.getContainer();this._setMousePosition=(0,l.bind)(this._setMousePosition,this),t.addEventListener("mousemove",this._setMousePosition),e.on("diagram.destroy",function(){t.removeEventListener("mousemove",this._setMousePosition)},this),e.on("element.hover",this._setHoverElement,this)},pE.prototype._setHoverElement=function(e){this._hoverElement=e.element},pE.prototype._setMousePosition=function(e){this._mouseX=e.layerX,this._mouseY=e.layerY};var fE={};Object.defineProperty(fE,"__esModule",{value:!0});var hE=function(e){return e&&e.__esModule?e:{default:e}}(dE);fE.default={__init__:["mouseTracking"],mouseTracking:["type",hE.default]};var mE={};Object.defineProperty(mE,"__esModule",{value:!0});var yE=_E(bu),vE=_E(fE),gE=_E(cE);function _E(e){return e&&e.__esModule?e:{default:e}}mE.default={__depends__:[yE.default,vE.default],__init__:["autoScroll"],autoScroll:["type",gE.default]};var xE={};Object.defineProperty(xE,"__esModule",{value:!0}),xE.SEGMENT_DRAGGER_CLS=xE.BENDPOINT_CLS=void 0,xE.toCanvasCoordinates=function(e,t){var n,i=(0,Zo.toPoint)(t),r=e._container.getBoundingClientRect();n={x:r.left,y:r.top};var o=e.viewbox();return{x:o.x+(i.x-n.x)/o.scale,y:o.y+(i.y-n.y)/o.scale}},xE.addBendpoint=function(e,t){var n=(0,we.create)("g");(0,we.classes)(n).add(bE),(0,we.append)(e,n);var i=(0,we.create)("circle");(0,we.attr)(i,{cx:0,cy:0,r:4}),(0,we.classes)(i).add("djs-visual"),(0,we.append)(n,i);var r=(0,we.create)("circle");(0,we.attr)(r,{cx:0,cy:0,r:10}),(0,we.classes)(r).add("djs-hit"),(0,we.append)(n,r),t&&(0,we.classes)(n).add(t);return n},xE.addSegmentDragger=function(e,t,n){var i=(0,we.create)("g"),r=(0,Ts.getMidPoint)(t,n),o=(0,Ts.pointsAligned)(t,n);return(0,we.append)(e,i),function(e,t,n){var i=(0,we.create)("g");(0,we.append)(e,i);var r=(0,we.create)("rect");(0,we.attr)(r,{x:-7,y:-1.5,width:14,height:3}),(0,we.classes)(r).add("djs-visual"),(0,we.append)(i,r);var o=(0,we.create)("rect");(0,we.attr)(o,{x:-10,y:-4.5,width:20,height:9}),(0,we.classes)(o).add("djs-hit"),(0,we.append)(i,o),(0,Qe.rotate)(i,"h"===n?90:0,0,0)}(i,0,o),(0,we.classes)(i).add(EE),(0,we.classes)(i).add("h"===o?"vertical":"horizontal"),(0,Qe.translate)(i,r.x,r.y),i};var bE=xE.BENDPOINT_CLS="djs-bendpoint",EE=xE.SEGMENT_DRAGGER_CLS="djs-segment-dragger";var wE={};Object.defineProperty(wE,"__esModule",{value:!0}),wE.default=OE;var ME="connect-ok",SE="connect-not-ok",CE="connect-hover",PE="djs-updating",RE="connection.updateWaypoints",TE="connection.reconnectStart",kE="connection.reconnectEnd",AE=Math.round;function OE(e,t,n,i,r,o,a){var s=e.get("connectionDocking",!1);function c(e){r.update("connection",e.connection,e.connectionGfx)}this.start=function(e,t,r,o){var a,s=t.waypoints,c=n.getGraphics(t);a={connection:t,bendpointIndex:r,insert:o,type:o||0!==r?o||r!==s.length-1?RE:kE:TE},i.init(e,"bendpoint.move",{data:{connection:t,connectionGfx:c,context:a}})},t.on("bendpoint.move.start",function(e){var t=e.context,i=t.connection,r=i.waypoints,o=r.slice(),a=t.insert,s=t.bendpointIndex;t.originalWaypoints=r,a&&o.splice(s,0,null),i.waypoints=o,t.draggerGfx=(0,xE.addBendpoint)(n.getLayer("overlays")),(0,we.classes)(t.draggerGfx).add("djs-dragging"),n.addMarker(i,PE)}),t.on("bendpoint.move.hover",function(e){var t=e.context;if(t.hover=e.hover,e.hover){n.addMarker(e.hover,CE);var i=t.allowed=o.allowed(t.type,t);i?(n.removeMarker(t.hover,SE),n.addMarker(t.hover,ME),t.target=t.hover):!1===i&&(n.removeMarker(t.hover,ME),n.addMarker(t.hover,SE),t.target=null)}}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(e){var t=e.context.hover;t&&(n.removeMarker(t,CE),n.removeMarker(t,e.context.target?ME:SE))}),t.on("bendpoint.move.move",function(e){var t,n,i=e.context,r=i.type,o=e.connection;o.waypoints[i.bendpointIndex]={x:e.x,y:e.y},s&&(i.hover&&(r===TE&&(t=i.hover),r===kE&&(n=i.hover)),o.waypoints=s.getCroppedWaypoints(o,t,n)),(0,Qe.translate)(i.draggerGfx,e.x,e.y),c(e)}),t.on(["bendpoint.move.end","bendpoint.move.cancel"],function(e){var t=e.context,i=t.hover,r=t.connection;(0,we.remove)(t.draggerGfx),t.newWaypoints=r.waypoints.slice(),r.waypoints=t.originalWaypoints,n.removeMarker(r,PE),i&&(n.removeMarker(i,ME),n.removeMarker(i,SE))}),t.on("bendpoint.move.end",function(e){var t,n=e.context,i=n.newWaypoints,r=n.bendpointIndex,o=i[r],s=n.allowed;if(o.x=AE(o.x),o.y=AE(o.y),s&&n.type===TE)a.reconnectStart(n.connection,n.target,o);else if(s&&n.type===kE)a.reconnectEnd(n.connection,n.target,o);else{if(!1===s||n.type!==RE)return c(e),!1;t={bendpointMove:{insert:e.context.insert,bendpointIndex:r}},a.updateWaypoints(n.connection,function(e){e=e.slice();for(var t,n,i,r=0;e[r];)t=e[r],n=e[r-1],i=e[r+1],0===(0,Ts.pointDistance)(t,i)||(0,Ts.pointsOnLine)(n,i,t)?e.splice(r,1):r++;return e}(i),t)}}),t.on("bendpoint.move.cancel",function(e){c(e)})}OE.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","rules","modeling"];var jE={};Object.defineProperty(jE,"__esModule",{value:!0}),jE.default=BE;var NE=Math.abs,IE=Math.round,DE=10;function BE(e){function t(e,t){if((0,l.isArray)(e)){for(var n=e.length;n--;)if(NE(e[n]-t)<=DE)return e[n]}else{var i=t%(e=+e);if(i<DE)return t-i;if(i>e-DE)return t-i+e}return t}function n(e){if(e.width)return{x:IE(e.width/2+e.x),y:IE(e.height/2+e.y)}}e.on("connectionSegment.move.move",1500,function(e){var i,r,o=function(e){var t=e.snapPoints,i=e.connection,r=i.waypoints,o=e.segmentStart,a=e.segmentStartIndex,s=e.segmentEnd,c=e.segmentEndIndex,u=e.axis;if(t)return t;var d=[r[a-1],o,s,r[c+1]];return a<2&&d.unshift(n(i.source)),c>r.length-3&&d.unshift(n(i.target)),e.snapPoints=t={horizontal:[],vertical:[]},(0,l.forEach)(d,function(e){e&&(e=e.original||e,"y"===u&&t.horizontal.push(e.y),"x"===u&&t.vertical.push(e.x))}),t}(e.context),a=e.x,s=e.y;if(o){var c=a-(i=t(o.vertical,a)),u=s-(r=t(o.horizontal,s));(0,l.assign)(e,{dx:e.dx-c,dy:e.dy-u,x:i,y:r})}}),e.on("bendpoint.move.move",1500,function(e){var i=e.context,r=function(e){var t=e.snapPoints,n=e.connection.waypoints,i=e.bendpointIndex;if(t)return t;var r=[n[i-1],n[i+1]];return e.snapPoints=t={horizontal:[],vertical:[]},(0,l.forEach)(r,function(e){e&&(e=e.original||e,t.horizontal.push(e.y),t.vertical.push(e.x))}),t}(i),o=i.target,a=o&&n(o),s=e.x,c=e.y;if(r){var u=s-t(a?r.vertical.concat([a.x]):r.vertical,s),d=c-t(a?r.horizontal.concat([a.y]):r.horizontal,c);(0,l.assign)(e,{dx:e.dx-u,dy:e.dy-d,x:e.x-u,y:e.y-d})}})}BE.$inject=["eventBus"];var LE={};Object.defineProperty(LE,"__esModule",{value:!0}),LE.getApproxIntersection=function(e,t){return function(e,t){var n,i;for(n=0;i=e[n];n++)if((0,Ts.pointDistance)(i,t)<=HE)return{point:e[n],bendpoint:!0,index:n};return null}(e,t)||function(e,t){var n,i=(0,zE.default)((c=t,u=HE,l=c.x,d=c.y,[["M",l,d],["m",0,-u],["a",u,u,0,1,1,0,2*u],["a",u,u,0,1,1,0,-2*u],["z"]]),(a=e,s=[],a.forEach(function(e,t){s.push([0===t?"M":"L",e.x,e.y])}),s)),r=i[0],o=i[i.length-1];var a,s;var c,u,l,d;if(!r)return null;if(r!==o)return r.segment2!==o.segment2?(n=$E(r.segment2,o.segment2)-1,{point:e[n],bendpoint:!0,index:n}):{point:{x:FE(r.x+o.x)/2,y:FE(r.y+o.y)/2},index:r.segment2};return{point:{x:FE(r.x),y:FE(r.y)},index:r.segment2}}(e,t)};var zE=function(e){return e&&e.__esModule?e:{default:e}}(lc);var FE=Math.round,$E=Math.max;var HE=10;var UE={};Object.defineProperty(UE,"__esModule",{value:!0}),UE.default=VE;var WE=function(e){return e&&e.__esModule?e:{default:e}}(Nx);function VE(e,t,n,i,r){function o(e,n){var i=(0,xE.toCanvasCoordinates)(t,n);return(0,LE.getApproxIntersection)(e,i)}function a(e,t){var n=t.waypoints,a=o(n,e);if(a)return!function(e,t,n){var i,r,o,a,s,c,u=e.index,l=e.point;return!(u<=0||e.bendpoint)&&(i=t[u-1],r=t[u],o=(0,Ts.getMidPoint)(i,r),a=(0,Ts.pointsAligned)(i,r),s=Math.abs(l.x-o.x),c=Math.abs(l.y-o.y),a&&s<=n&&c<=n)}(a,n,10)?i.start(e,t,a.index,!a.bendpoint):r.start(e,t,a.index),!0}function s(e,t,i){st.event.bind(e,t,function(e){n.triggerMouseEvent(t,e,i),e.stopPropagation()})}function c(e,n){var i=t.getLayer("overlays"),r=(0,st.query)('.djs-bendpoints[data-element-id="'+(0,WE.default)(e.id)+'"]',i);return!r&&n&&(r=(0,we.create)("g"),(0,we.attr)(r,{"data-element-id":e.id}),(0,we.classes)(r).add("djs-bendpoints"),(0,we.append)(i,r),s(r,"mousedown",e),s(r,"click",e),s(r,"dblclick",e)),r}function u(e,t){t.waypoints.forEach(function(t,n){var i=(0,xE.addBendpoint)(e);(0,we.append)(e,i),(0,Qe.translate)(i,t.x,t.y)}),(0,xE.addBendpoint)(e,"floating")}function d(e,t){for(var n,i,r=t.waypoints,o=1;o<r.length;o++)n=r[o-1],i=r[o],(0,Ts.pointsAligned)(n,i)&&(0,xE.addSegmentDragger)(e,n,i)}function p(e){var t=c(e);return t||(u(t=c(e,!0),e),d(t,e)),t}function f(e){var t=c(e);t&&(!function(e){(0,l.forEach)((0,st.queryAll)("."+xE.SEGMENT_DRAGGER_CLS,e),function(e){(0,we.remove)(e)})}(t),function(e){(0,l.forEach)((0,st.queryAll)("."+xE.BENDPOINT_CLS,e),function(e){(0,we.remove)(e)})}(t),d(t,e),u(t,e))}e.on("connection.changed",function(e){f(e.element)}),e.on("connection.remove",function(e){var t=c(e.element);t&&(0,we.remove)(t)}),e.on("element.marker.update",function(e){var t,n=e.element;n.waypoints&&(t=p(n),e.add?(0,we.classes)(t).add(e.marker):(0,we.classes)(t).remove(e.marker))}),e.on("element.mousemove",function(e){var t,n,i,r=e.element,a=r.waypoints;if(a){if(t=c(r,!0),!(n=(0,st.query)(".floating",t)))return;(i=o(a,e.originalEvent))&&(0,Qe.translate)(n,i.point.x,i.point.y)}}),e.on("element.mousedown",function(e){var t=e.originalEvent,n=e.element,i=n.waypoints;if(i)return a(t,n)}),e.on("selection.changed",function(e){var t=e.newSelection[0];t&&t.waypoints&&p(t)}),e.on("element.hover",function(e){var t=e.element;t.waypoints&&(p(t),n.registerEvent(e.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(e){n.unregisterEvent(e.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(e){var t=e.element,n=e.newId;if(t.waypoints){var i=c(t);i&&(0,we.attr)(i,{"data-element-id":n})}}),this.addHandles=p,this.updateHandles=f,this.getBendpointsContainer=c}VE.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];var qE={};Object.defineProperty(qE,"__esModule",{value:!0}),qE.default=JE;var GE="connect-hover",KE="djs-updating";function YE(e,t,n){return XE(e,t,e[t]+n)}function XE(e,t,n){return{x:"x"===t?n:e.x,y:"y"===t?n:e.y}}function ZE(e){return"x"===e?"y":"x"}function QE(e,t,n){var i,r;return e.original?e.original:(i=(0,dc.getMid)(t),XE(e,r=ZE(n),i[r]))}function JE(e,t,n,i,r,o,a){var s=e.get("connectionDocking",!1);function c(e,t){if(!s)return t;var n,i=e.waypoints;return e.waypoints=t,n=s.getCroppedWaypoints(e),e.waypoints=i,n}function u(e){r.update("connection",e.connection,e.connectionGfx)}function l(e,t,n){var i=e.newWaypoints,r=function(e,t,n,i){var r=Math.max(t[i],n[i]),o=Math.min(t[i],n[i]);return XE(t,i,Math.min(Math.max(o+20,e[i]),r-20))}(n,i[e.segmentStartIndex+t],i[e.segmentEndIndex+t],ZE(e.axis));(0,Qe.translate)(e.draggerGfx,r.x,r.y)}this.start=function(e,t,r){var o,a,s,c=n.getGraphics(t),u=r-1,l=r,d=t.waypoints,p=d[u],f=d[l];(a=(0,Ts.pointsAligned)(p,f))&&(s="v"===a?"y":"x",0===u&&(p=QE(p,t.source,s)),l===d.length-1&&(f=QE(f,t.target,s)),o={connection:t,segmentStartIndex:u,segmentEndIndex:l,segmentStart:p,segmentEnd:f,axis:s},i.init(e,{x:(p.x+f.x)/2,y:(p.y+f.y)/2},"connectionSegment.move",{cursor:"x"===s?"resize-ew":"resize-ns",data:{connection:t,connectionGfx:c,context:o}}))},t.on("connectionSegment.move.start",function(e){var t=e.context,i=e.connection,r=n.getLayer("overlays");t.originalWaypoints=i.waypoints.slice(),t.draggerGfx=(0,xE.addSegmentDragger)(r,t.segmentStart,t.segmentEnd),(0,we.classes)(t.draggerGfx).add("djs-dragging"),n.addMarker(i,KE)}),t.on("connectionSegment.move.move",function(e){var t,n,i=e.context,r=i.connection,o=i.segmentStartIndex,a=i.segmentEndIndex,s=i.segmentStart,d=i.segmentEnd,p=i.axis,f=i.originalWaypoints.slice(),h=YE(s,p,e["d"+p]),m=YE(d,p,e["d"+p]),y=f.length,v=0;f[o]=h,f[a]=m,o<2&&(t=(0,dc.getOrientation)(r.source,h),1===o?"intersect"===t&&(f.shift(),f[0]=h,v--):"intersect"!==t&&(f.unshift(s),v++)),a>y-3&&(n=(0,dc.getOrientation)(r.target,m),a===y-2?"intersect"===n&&(f.pop(),f[f.length-1]=m):"intersect"!==n&&f.push(d)),i.newWaypoints=r.waypoints=c(r,f),l(i,v,e),i.newSegmentStartIndex=o+v,u(e)}),t.on("connectionSegment.move.hover",function(e){e.context.hover=e.hover,n.addMarker(e.hover,GE)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(e){var t=e.context.hover;t&&n.removeMarker(t,GE)}),t.on("connectionSegment.move.cleanup",function(e){var t=e.context,i=t.connection;t.draggerGfx&&(0,we.remove)(t.draggerGfx),n.removeMarker(i,KE)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(e){var t=e.context;t.connection.waypoints=t.originalWaypoints,u(e)}),t.on("connectionSegment.move.end",function(e){var t=e.context,n=t.connection,i=t.newWaypoints,r=t.newSegmentStartIndex,o=function(e,t){var n=0;return{waypoints:e.filter(function(i,r){return!(0,Ts.pointsOnLine)(e[r-1],e[r+1],i)||(n=r<=t?n-1:n,!1)}),segmentOffset:n}}(i=i.map(function(e){return{original:e.original,x:Math.round(e.x),y:Math.round(e.y)}}),r),s=c(n,o.waypoints),u=o.segmentOffset,l={segmentMove:{segmentStartIndex:t.segmentStartIndex,newSegmentStartIndex:r+u}};a.updateWaypoints(n,s,l)})}JE.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","rules","modeling"];var ew={};Object.defineProperty(ew,"__esModule",{value:!0});var tw=sw(bu),nw=sw(Ru),iw=sw(UE),rw=sw(wE),ow=sw(qE),aw=sw(jE);function sw(e){return e&&e.__esModule?e:{default:e}}ew.default={__depends__:[tw.default,nw.default],__init__:["bendpoints","bendpointSnapping"],bendpoints:["type",iw.default],bendpointMove:["type",rw.default],connectionSegmentMove:["type",ow.default],bendpointSnapping:["type",aw.default]};var cw={};Object.defineProperty(cw,"__esModule",{value:!0}),cw.default=fw;var uw={moveSpeed:1,moveSpeedAccelerated:10},lw=1500,dw={ArrowLeft:"left",Left:"left",ArrowUp:"up",Up:"up",ArrowRight:"right",Right:"right",ArrowDown:"down",Down:"down"},pw={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function fw(e,t,n,i){var r=this;this._config=(0,l.assign)({},uw,e||{}),t.addListener(lw,function(e){var n=e.keyEvent,i=dw[n.key];if(i&&!t.isCmd(n)){var o=t.isShift(n);return r.moveSelection(i,o),!0}}),this.moveSelection=function(e,t){var r=i.get();if(r.length){var o=this._config[t?"moveSpeedAccelerated":"moveSpeed"],a=pw[e](o);n.moveElements(r,a)}}}fw.$inject=["config.keyboardMoveSelection","keyboard","modeling","selection"];var hw={};Object.defineProperty(hw,"__esModule",{value:!0});var mw=gw(bl),yw=gw(Ea),vw=gw(cw);function gw(e){return e&&e.__esModule?e:{default:e}}hw.default={__depends__:[mw.default,yw.default],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",vw.default]};var _w={};Object.defineProperty(_w,"__esModule",{value:!0}),_w.default=xw;function xw(e,t,n,i){this._dragging=i,this._rules=t;var r=this;e.on("resize.start",function(e){var t,n,i;t=e.context,n=t.resizeConstraints,i=t.minBounds,void 0===n&&(void 0===i&&(i=r.computeMinResizeBox(t)),t.resizeConstraints={min:(0,dc.asTRBL)(i)})}),e.on("resize.move",function(e){var t={x:e.dx,y:e.dy};!function(e,t){var n,i=e.shape,o=e.direction,a=e.resizeConstraints;e.delta=t,n=(0,Cy.resizeBounds)(i,o,t),e.newBounds=(0,Cy.ensureConstraints)(n,a),e.canExecute=r.canResize(e)}(e.context,t)}),e.on("resize.end",function(e){var t,i,r,o;t=e.context,i=t.shape,r=t.canExecute,o=t.newBounds,r&&(o=(0,dc.roundBounds)(o),n.resizeShape(i,o))})}xw.prototype.canResize=function(e){var t=this._rules,n=(0,l.pick)(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",n)},xw.prototype.activate=function(e,t,n){var i,r,o=this._dragging;if("string"==typeof n&&(n={direction:n}),!(r=(i=(0,l.assign)({shape:t},n)).direction))throw new Error("must provide a direction (nw|se|ne|sw)");o.init(e,"resize",{autoActivate:!0,cursor:"resize-"+(/nw|se/.test(r)?"nwse":"nesw"),data:{shape:t,context:i}})},xw.prototype.computeMinResizeBox=function(e){var t,n,i=e.shape,r=e.direction;return t=e.minDimensions||{width:10,height:10},n=(0,Cy.computeChildrenBBox)(i,e.childrenBoxPadding),(0,Cy.getMinResizeBounds)(r,i,t,n)},xw.$inject=["eventBus","rules","modeling","dragging"];var bw={};Object.defineProperty(bw,"__esModule",{value:!0}),bw.default=Ew;function Ew(e,t,n,i){this._resize=i,this._canvas=t;var r=this;e.on("selection.changed",function(e){var t=e.newSelection;r.removeResizers(),1===t.length&&(0,l.forEach)(t,(0,l.bind)(r.addResizer,r))}),e.on("shape.changed",function(e){var t=e.element;n.isSelected(t)&&(r.removeResizers(),r.addResizer(t))})}Ew.prototype.makeDraggable=function(e,t,n){var i=this._resize;function r(t){(0,ta.isPrimaryButton)(t)&&i.activate(t,e,n)}st.event.bind(t,"mousedown",r),st.event.bind(t,"touchstart",r)},Ew.prototype._createResizer=function(e,t,n,i,r){var o=this._getResizersParent(),a=(0,we.create)("g");(0,we.classes)(a).add("djs-resizer"),(0,we.classes)(a).add("djs-resizer-"+e.id),(0,we.classes)(a).add("djs-resizer-"+r),(0,we.append)(o,a);var s=(0,we.create)("rect");(0,we.attr)(s,{x:-7,y:-7,width:5,height:5}),(0,we.classes)(s).add("djs-resizer-visual"),(0,we.append)(a,s);var c=(0,we.create)("rect");return(0,we.attr)(c,{x:-7,y:-7,width:20,height:20}),(0,we.classes)(c).add("djs-resizer-hit"),(0,we.append)(a,c),(0,Qe.transform)(a,t,n,i),a},Ew.prototype.createResizer=function(e,t){var n,i=(0,dc.asTRBL)(e);n="nw"===t?this._createResizer(e,i.left,i.top,0,t):"ne"===t?this._createResizer(e,i.right,i.top,90,t):"se"===t?this._createResizer(e,i.right,i.bottom,180,t):this._createResizer(e,i.left,i.bottom,270,t),this.makeDraggable(e,n,t)},Ew.prototype.addResizer=function(e){this._resize.canResize({shape:e})&&(this.createResizer(e,"nw"),this.createResizer(e,"ne"),this.createResizer(e,"se"),this.createResizer(e,"sw"))},Ew.prototype.removeResizers=function(){var e=this._getResizersParent();(0,we.clear)(e)},Ew.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")},Ew.$inject=["eventBus","canvas","selection","resize"];var ww={};Object.defineProperty(ww,"__esModule",{value:!0}),ww.default=Pw;var Mw="djs-resizing",Sw="resize-not-ok",Cw=500;function Pw(e,t,n){e.on("resize.move",Cw,function(e){var i,r,o,a;i=e.context,r=i.shape,o=i.newBounds,(a=i.frame)||(a=i.frame=n.addFrame(r,t.getDefaultLayer()),t.addMarker(r,Mw)),o.width>5&&(0,we.attr)(a,{x:o.x,width:o.width}),o.height>5&&(0,we.attr)(a,{y:o.y,height:o.height}),i.canExecute?(0,we.classes)(a).remove(Sw):(0,we.classes)(a).add(Sw)}),e.on("resize.cleanup",function(e){var n,i;n=e.context,i=n.shape,n.frame&&(0,we.remove)(n.frame),t.removeMarker(i,Mw)})}Pw.$inject=["eventBus","canvas","previewSupport"];var Rw={};Object.defineProperty(Rw,"__esModule",{value:!0});var Tw=Iw(Ru),kw=Iw(bu),Aw=Iw(dx),Ow=Iw(_w),jw=Iw(ww),Nw=Iw(bw);function Iw(e){return e&&e.__esModule?e:{default:e}}Rw.default={__depends__:[Tw.default,kw.default,Aw.default],__init__:["resize","resizePreview","resizeHandles"],resize:["type",Ow.default],resizePreview:["type",jw.default],resizeHandles:["type",Nw.default]};var Dw={};Object.defineProperty(Dw,"__esModule",{value:!0}),Dw.default=Lw;var Bw={moveSpeed:50,moveSpeedAccelerated:200};function Lw(e,t,n){var i=this;this._config=(0,l.assign)({},Bw,e||{}),t.addListener(function(e){var n=e.keyEvent,r=i._config;if(!t.isCmd(n))return;if(t.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],n)){var o,a=t.isShift(n)?r.moveSpeedAccelerated:r.moveSpeed;switch(n.key){case"ArrowLeft":case"Left":o="left";break;case"ArrowUp":case"Up":o="up";break;case"ArrowRight":case"Right":o="right";break;case"ArrowDown":case"Down":o="down"}return i.moveCanvas({speed:a,direction:o}),!0}}),this.moveCanvas=function(e){var t=0,i=0,r=e.speed/Math.min(Math.sqrt(n.viewbox().scale),1);switch(e.direction){case"left":t=r;break;case"up":i=r;break;case"right":t=-r;break;case"down":i=-r}n.scroll({dx:t,dy:i})}}Lw.$inject=["config.keyboardMove","keyboard","canvas"];var zw={};Object.defineProperty(zw,"__esModule",{value:!0});var Fw=Hw(bl),$w=Hw(Dw);function Hw(e){return e&&e.__esModule?e:{default:e}}zw.default={__depends__:[Fw.default],__init__:["keyboardMove"],keyboardMove:["type",$w.default]};var Uw={},Ww=Uw=function(e,t){if(t||(t=16),void 0===e&&(e=128),e<=0)return"0";for(var n=Math.log(Math.pow(2,e))/Math.log(t),i=2;n===1/0;i*=2)n=Math.log(Math.pow(2,e/i))/Math.log(t)*i;var r=n-Math.floor(n),o="";for(i=0;i<Math.floor(n);i++){o=Math.floor(Math.random()*t).toString(t)+o}if(r){var a=Math.pow(t,r);o=Math.floor(Math.random()*a).toString(t)+o}var s=parseInt(o,t);return s!==1/0&&s>=Math.pow(2,e)?Ww(e,t):o};function Vw(e){if(!(this instanceof Vw))return new Vw(e);e=e||[128,36,1],this._seed=e.length?Uw.rack(e[0],e[1],e[2]):e}Ww.rack=function(e,t,n){var i=function(i){var o=0;do{if(o++>10){if(!n)throw new Error("too many ID collisions, use more bits");e+=n}var a=Ww(e,t)}while(Object.hasOwnProperty.call(r,a));return r[a]=i,a},r=i.hats={};return i.get=function(e){return i.hats[e]},i.set=function(e,t){return i.hats[e]=t,i},i.bits=e||128,i.base=t||16,i};var qw=Vw;Vw.prototype.next=function(e){return this._seed(e||!0)},Vw.prototype.nextPrefixed=function(e,t){var n;do{n=e+this.next(!0)}while(this.assigned(n));return this.claim(n,t),n},Vw.prototype.claim=function(e,t){this._seed.set(e,t||!0)},Vw.prototype.assigned=function(e){return this._seed.get(e)||!1},Vw.prototype.unclaim=function(e){delete this._seed.hats[e]},Vw.prototype.clear=function(){var e,t=this._seed.hats;for(e in t)this.unclaim(e)};var Gw={};function Kw(e){$a.call(this,e),this.on("import.parse.complete",function(e){e.error||this._collectIds(e.definitions,e.context)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}return u(Kw,$a),(Gw=Kw).Viewer=$a,Gw.NavigatedViewer=ls,Kw.prototype.createDiagram=function(e){return this.importXML('<?xml version="1.0" encoding="UTF-8"?><cmmn:definitions xmlns:dc="http://www.omg.org/spec/CMMN/20151109/DC" xmlns:di="http://www.omg.org/spec/CMMN/20151109/DI" xmlns:cmmndi="http://www.omg.org/spec/CMMN/20151109/CMMNDI" xmlns:cmmn="http://www.omg.org/spec/CMMN/20151109/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Test" targetNamespace="http://bpmn.io/schema/cmmn"><cmmn:case id="Case_1"><cmmn:casePlanModel id="CasePlanModel_1" name="A CasePlanModel"><cmmn:planItem id="PlanItem_1" definitionRef="Task_1" /><cmmn:task id="Task_1" /></cmmn:casePlanModel></cmmn:case><cmmndi:CMMNDI><cmmndi:CMMNDiagram id="CMMNDiagram_1"><cmmndi:Size width="500" height="500" /><cmmndi:CMMNShape id="DI_CasePlanModel_1" cmmnElementRef="CasePlanModel_1"><dc:Bounds x="114" y="63" width="534" height="389" /><cmmndi:CMMNLabel /></cmmndi:CMMNShape><cmmndi:CMMNShape id="PlanItem_1_di" cmmnElementRef="PlanItem_1"><dc:Bounds x="150" y="96" width="100" height="80" /><cmmndi:CMMNLabel /></cmmndi:CMMNShape></cmmndi:CMMNDiagram></cmmndi:CMMNDI></cmmn:definitions>',e)},Kw.prototype._createModdle=function(e){var t=$a.prototype._createModdle.call(this,e);return t.ids=new qw([32,36,1]),t},Kw.prototype._collectIds=function(e,t){var n,i=e.$model.ids;for(n in i.clear(),t.elementsById)i.claim(n,t.elementsById[n])},Kw.prototype._interactionModules=[mE.default,zw.default,Qa.default,ss.default,w_],Kw.prototype._modelingModules=[ew.default,hw.default,lb.default,Rw.default,wc,nl,dl,Sl,ud,g_,jx,sE,Db,xb],Kw.prototype._modules=[].concat(Kw.prototype._modules,Kw.prototype._interactionModules,Kw.prototype._modelingModules),Gw});